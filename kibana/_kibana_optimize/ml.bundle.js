/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
var __kbnBundles__=typeof __kbnBundles__==="object"?__kbnBundles__:{};__kbnBundles__["ml"]=function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var executeModules=data[2];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}deferredModules.push.apply(deferredModules,executeModules||[]);return checkDeferredModules()}function checkDeferredModules(){var result;for(var i=0;i<deferredModules.length;i++){var deferredModule=deferredModules[i];var fulfilled=true;for(var j=1;j<deferredModule.length;j++){var depId=deferredModule[j];if(installedChunks[depId]!==0)fulfilled=false}if(fulfilled){deferredModules.splice(i--,1);result=__webpack_require__(__webpack_require__.s=deferredModule[0])}}return result}var installedModules={};var installedChunks={14:0};var deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="__REPLACE_WITH_PUBLIC_PATH__";var jsonpArray=window["webpackJsonp"]=window["webpackJsonp"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([2747,0]);return checkDeferredModules()}([,,,,,,,function(module,exports){module.exports=vendors},,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ml=void 0;var _lodash=__webpack_require__(3);var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);var _annotations=__webpack_require__(2765);var _data_frame=__webpack_require__(2766);var _filters=__webpack_require__(2767);var _results=__webpack_require__(2768);var _jobs=__webpack_require__(2769);var _datavisualizer=__webpack_require__(2770);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var ml={getJobs:function getJobs(obj){var jobId=obj&&obj.jobId?"/".concat(obj.jobId):"";return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors").concat(jobId)})},getJobStats:function getJobStats(obj){var jobId=obj&&obj.jobId?"/".concat(obj.jobId):"";return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors").concat(jobId,"/_stats")})},addJob:function addJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId),method:"PUT",data:obj.job})},openJob:function openJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"/_open"),method:"POST"})},closeJob:function closeJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"/_close"),method:"POST"})},deleteJob:function deleteJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId),method:"DELETE"})},forceDeleteJob:function forceDeleteJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"?force=true"),method:"DELETE"})},updateJob:function updateJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"/_update"),method:"POST",data:obj.job})},estimateBucketSpan:function estimateBucketSpan(obj){return(0,_http_service.http)({url:"".concat(basePath,"/validate/estimate_bucket_span"),method:"POST",data:obj})},validateJob:function validateJob(obj){return(0,_http_service.http)({url:"".concat(basePath,"/validate/job"),method:"POST",data:obj})},validateCardinality:function validateCardinality(obj){return(0,_http_service.http)({url:"".concat(basePath,"/validate/cardinality"),method:"POST",data:obj})},getDatafeeds:function getDatafeeds(obj){var datafeedId=obj&&obj.datafeedId?"/".concat(obj.datafeedId):"";return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds").concat(datafeedId)})},getDatafeedStats:function getDatafeedStats(obj){var datafeedId=obj&&obj.datafeedId?"/".concat(obj.datafeedId):"";return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds").concat(datafeedId,"/_stats")})},addDatafeed:function addDatafeed(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId),method:"PUT",data:obj.datafeedConfig})},updateDatafeed:function updateDatafeed(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId,"/_update"),method:"POST",data:obj.datafeedConfig})},deleteDatafeed:function deleteDatafeed(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId),method:"DELETE"})},forceDeleteDatafeed:function forceDeleteDatafeed(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId,"?force=true"),method:"DELETE"})},startDatafeed:function startDatafeed(obj){var data={};if(obj.start!==undefined){data.start=obj.start}if(obj.end!==undefined){data.end=obj.end}return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId,"/_start"),method:"POST",data:data})},stopDatafeed:function stopDatafeed(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId,"/_stop"),method:"POST"})},datafeedPreview:function datafeedPreview(obj){return(0,_http_service.http)({url:"".concat(basePath,"/datafeeds/").concat(obj.datafeedId,"/_preview"),method:"GET"})},validateDetector:function validateDetector(obj){return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/_validate/detector"),method:"POST",data:obj.detector})},forecast:function forecast(obj){var data={};if(obj.duration!==undefined){data.duration=obj.duration}return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"/_forecast"),method:"POST",data:data})},overallBuckets:function overallBuckets(obj){var data=(0,_lodash.pick)(obj,["topN","bucketSpan","start","end"]);return(0,_http_service.http)({url:"".concat(basePath,"/anomaly_detectors/").concat(obj.jobId,"/results/overall_buckets"),method:"POST",data:data})},checkPrivilege:function checkPrivilege(obj){return(0,_http_service.http)({url:"".concat(basePath,"/_has_privileges"),method:"POST",data:obj})},getNotificationSettings:function getNotificationSettings(){return(0,_http_service.http)({url:"".concat(basePath,"/notification_settings"),method:"GET"})},getFieldCaps:function getFieldCaps(obj){var data={};if(obj.index!==undefined){data.index=obj.index}if(obj.fields!==undefined){data.fields=obj.fields}return(0,_http_service.http)({url:"".concat(basePath,"/indices/field_caps"),method:"POST",data:data})},recognizeIndex:function recognizeIndex(obj){return(0,_http_service.http)({url:"".concat(basePath,"/modules/recognize/").concat(obj.indexPatternTitle),method:"GET"})},listDataRecognizerModules:function listDataRecognizerModules(){return(0,_http_service.http)({url:"".concat(basePath,"/modules/get_module"),method:"GET"})},getDataRecognizerModule:function getDataRecognizerModule(obj){return(0,_http_service.http)({url:"".concat(basePath,"/modules/get_module/").concat(obj.moduleId),method:"GET"})},dataRecognizerModuleJobsExist:function dataRecognizerModuleJobsExist(obj){return(0,_http_service.http)({url:"".concat(basePath,"/modules/jobs_exist/").concat(obj.moduleId),method:"GET"})},setupDataRecognizerConfig:function setupDataRecognizerConfig(obj){var data=(0,_lodash.pick)(obj,["prefix","groups","indexPatternName","query","useDedicatedIndex"]);return(0,_http_service.http)({url:"".concat(basePath,"/modules/setup/").concat(obj.moduleId),method:"POST",data:data})},getVisualizerFieldStats:function getVisualizerFieldStats(obj){var data=(0,_lodash.pick)(obj,["query","timeFieldName","earliest","latest","samplerShardSize","interval","fields","maxExamples"]);return(0,_http_service.http)({url:"".concat(basePath,"/data_visualizer/get_field_stats/").concat(obj.indexPatternTitle),method:"POST",data:data})},getVisualizerOverallStats:function getVisualizerOverallStats(obj){var data=(0,_lodash.pick)(obj,["query","timeFieldName","earliest","latest","samplerShardSize","aggregatableFields","nonAggregatableFields"]);return(0,_http_service.http)({url:"".concat(basePath,"/data_visualizer/get_overall_stats/").concat(obj.indexPatternTitle),method:"POST",data:data})},calendars:function calendars(obj){var calendarId=obj&&obj.calendarId?"/".concat(obj.calendarId):"";return(0,_http_service.http)({url:"".concat(basePath,"/calendars").concat(calendarId),method:"GET"})},addCalendar:function addCalendar(obj){return(0,_http_service.http)({url:"".concat(basePath,"/calendars"),method:"PUT",data:obj})},updateCalendar:function updateCalendar(obj){var calendarId=obj&&obj.calendarId?"/".concat(obj.calendarId):"";return(0,_http_service.http)({url:"".concat(basePath,"/calendars").concat(calendarId),method:"PUT",data:obj})},deleteCalendar:function deleteCalendar(obj){return(0,_http_service.http)({url:"".concat(basePath,"/calendars/").concat(obj.calendarId),method:"DELETE"})},mlNodeCount:function mlNodeCount(){return(0,_http_service.http)({url:"".concat(basePath,"/ml_node_count"),method:"GET"})},mlInfo:function mlInfo(){return(0,_http_service.http)({url:"".concat(basePath,"/info"),method:"GET"})},calculateModelMemoryLimit:function calculateModelMemoryLimit(obj){var data=(0,_lodash.pick)(obj,["indexPattern","splitFieldName","query","fieldNames","influencerNames","timeFieldName","earliestMs","latestMs"]);return(0,_http_service.http)({url:"".concat(basePath,"/validate/calculate_model_memory_limit"),method:"POST",data:data})},getCardinalityOfFields:function getCardinalityOfFields(obj){var data=(0,_lodash.pick)(obj,["index","fieldNames","query","timeFieldName","earliestMs","latestMs"]);return(0,_http_service.http)({url:"".concat(basePath,"/fields_service/field_cardinality"),method:"POST",data:data})},getTimeFieldRange:function getTimeFieldRange(obj){var data=(0,_lodash.pick)(obj,["index","timeFieldName","query"]);return(0,_http_service.http)({url:"".concat(basePath,"/fields_service/time_field_range"),method:"POST",data:data})},esSearch:function esSearch(obj){return(0,_http_service.http)({url:"".concat(basePath,"/es_search"),method:"POST",data:obj})},getIndices:function getIndices(){var tempBasePath=_chrome.default.addBasePath("/api");return(0,_http_service.http)({url:"".concat(tempBasePath,"/index_management/indices"),method:"GET"})},annotations:_annotations.annotations,dataFrame:_data_frame.dataFrame,filters:_filters.filters,results:_results.results,jobs:_jobs.jobs,fileDatavisualizer:_datavisualizer.fileDatavisualizer};exports.ml=ml},,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlJobService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _angular=_interopRequireDefault(__webpack_require__(26));var _moment=_interopRequireDefault(__webpack_require__(16));var _i18n=__webpack_require__(4);var _parse_interval=__webpack_require__(275);var _ml_api_service=__webpack_require__(24);var _messagebar_service=__webpack_require__(268);var _string_utils=__webpack_require__(67);var _job_utils=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var msgs=_messagebar_service.mlMessageBarService;var jobs=[];var datafeedIds={};var JobService=function(){function JobService(){var _this=this;_classCallCheck(this,JobService);_defineProperty(this,"loadJobsWrapper",function(){return _this.loadJobs().then(function(resp){return resp}).catch(function(error){console.log("Error loading jobs in route resolve.",error);Promise.resolve([])})});this.currentJob=undefined;this.jobs=[];this.basicJobs={};this.jobDescriptions={};this.detectorsByJob={};this.customUrlsByJob={};this.jobStats={activeNodes:{label:_i18n.i18n.translate("xpack.ml.jobService.activeMLNodesLabel",{defaultMessage:"Active ML Nodes"}),value:0,show:true},total:{label:_i18n.i18n.translate("xpack.ml.jobService.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:true},open:{label:_i18n.i18n.translate("xpack.ml.jobService.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:true},closed:{label:_i18n.i18n.translate("xpack.ml.jobService.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:true},failed:{label:_i18n.i18n.translate("xpack.ml.jobService.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:false},activeDatafeeds:{label:_i18n.i18n.translate("xpack.ml.jobService.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:true}};this.jobUrls={}}_createClass(JobService,[{key:"getBlankJob",value:function getBlankJob(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"15m",influencers:[],detectors:[]},data_description:{time_field:"",time_format:"",field_delimiter:"",quote_character:'"',format:"delimited"}}}},{key:"loadJobs",value:function loadJobs(){var _this2=this;return new Promise(function(resolve,reject){jobs=[];datafeedIds={};_ml_api_service.ml.getJobs().then(function(resp){_angular.default.copy(resp.jobs,jobs);_ml_api_service.ml.getJobStats().then(function(statsResp){for(var i=0;i<jobs.length;i++){var job=jobs[i];job.data_counts={};job.model_size_stats={};job.datafeed_config={};for(var j=0;j<statsResp.jobs.length;j++){if(job.job_id===statsResp.jobs[j].job_id){var jobStats=_angular.default.copy(statsResp.jobs[j]);job.state=jobStats.state;job.data_counts=jobStats.data_counts;job.model_size_stats=jobStats.model_size_stats;if(jobStats.node){job.node=jobStats.node}if(jobStats.open_time){job.open_time=jobStats.open_time}}}}_this2.loadDatafeeds().then(function(datafeedsResp){for(var _i=0;_i<jobs.length;_i++){for(var _j=0;_j<datafeedsResp.datafeeds.length;_j++){if(jobs[_i].job_id===datafeedsResp.datafeeds[_j].job_id){jobs[_i].datafeed_config=datafeedsResp.datafeeds[_j];datafeedIds[jobs[_i].job_id]=datafeedsResp.datafeeds[_j].datafeed_id}}}processBasicJobInfo(_this2,jobs);_this2.jobs=jobs;createJobStats(_this2.jobs,_this2.jobStats);createJobUrls(_this2.jobs,_this2.jobUrls);resolve({jobs:_this2.jobs})})}).catch(function(err){error(err)})}).catch(function(err){error(err)});function error(err){console.log("jobService error getting list of jobs:",err);msgs.error(_i18n.i18n.translate("xpack.ml.jobService.jobsListCouldNotBeRetrievedErrorMessage",{defaultMessage:"Jobs list could not be retrieved"}));msgs.error("",err);reject({jobs:jobs,err:err})}})}},{key:"refreshJob",value:function refreshJob(jobId){var _this3=this;return new Promise(function(resolve,reject){_ml_api_service.ml.getJobs({jobId:jobId}).then(function(resp){var newJob={};if(resp.jobs&&resp.jobs.length){_angular.default.copy(resp.jobs[0],newJob);_ml_api_service.ml.getJobStats({jobId:jobId}).then(function(statsResp){for(var j=0;j<statsResp.jobs.length;j++){if(newJob.job_id===statsResp.jobs[j].job_id){var statsJob=statsResp.jobs[j];newJob.state=statsJob.state;newJob.data_counts={};newJob.model_size_stats={};_angular.default.copy(statsJob.data_counts,newJob.data_counts);_angular.default.copy(statsJob.model_size_stats,newJob.model_size_stats);if(newJob.node){_angular.default.copy(statsJob.node,newJob.node)}if(statsJob.open_time){newJob.open_time=statsJob.open_time}}}for(var i=0;i<jobs.length;i++){if(jobs[i].job_id===newJob.job_id){jobs[i]=newJob}}var datafeedId=_this3.getDatafeedId(jobId);_this3.loadDatafeeds(datafeedId).then(function(datafeedsResp){for(var _i2=0;_i2<jobs.length;_i2++){for(var _j2=0;_j2<datafeedsResp.datafeeds.length;_j2++){if(jobs[_i2].job_id===datafeedsResp.datafeeds[_j2].job_id){jobs[_i2].datafeed_config=datafeedsResp.datafeeds[_j2];datafeedIds[jobs[_i2].job_id]=datafeedsResp.datafeeds[_j2].datafeed_id}}}_this3.jobs=jobs;createJobStats(_this3.jobs,_this3.jobStats);createJobUrls(_this3.jobs,_this3.jobUrls);resolve({jobs:_this3.jobs})})}).catch(function(err){error(err)})}}).catch(function(err){error(err)});function error(err){console.log("JobService error getting list of jobs:",err);msgs.error(_i18n.i18n.translate("xpack.ml.jobService.jobsListCouldNotBeRetrievedErrorMessage",{defaultMessage:"Jobs list could not be retrieved"}));msgs.error("",err);reject({jobs:jobs,err:err})}})}},{key:"loadDatafeeds",value:function loadDatafeeds(datafeedId){return new Promise(function(resolve,reject){var datafeeds=[];var sId=datafeedId!==undefined?{datafeed_id:datafeedId}:undefined;_ml_api_service.ml.getDatafeeds(sId).then(function(resp){_angular.default.copy(resp.datafeeds,datafeeds);_ml_api_service.ml.getDatafeedStats().then(function(statsResp){for(var i=0;i<datafeeds.length;i++){var datafeed=datafeeds[i];for(var j=0;j<statsResp.datafeeds.length;j++){if(datafeed.datafeed_id===statsResp.datafeeds[j].datafeed_id){datafeed.state=statsResp.datafeeds[j].state}}}resolve({datafeeds:datafeeds})}).catch(function(err){error(err)})}).catch(function(err){error(err)});function error(err){console.log("loadDatafeeds error getting list of datafeeds:",err);msgs.error(_i18n.i18n.translate("xpack.ml.jobService.datafeedsListCouldNotBeRetrievedErrorMessage",{defaultMessage:"datafeeds list could not be retrieved"}));msgs.error("",err);reject({jobs:jobs,err:err})}})}},{key:"updateSingleJobDatafeedState",value:function updateSingleJobDatafeedState(jobId){var _this4=this;return new Promise(function(resolve,reject){var datafeedId=_this4.getDatafeedId(jobId);_ml_api_service.ml.getDatafeedStats({datafeedId:datafeedId}).then(function(resp){var datafeeds=resp.datafeeds;var state="UNKNOWN";if(datafeeds&&datafeeds.length){state=datafeeds[0].state}resolve(state)}).catch(function(resp){reject(resp)})})}},{key:"saveNewJob",value:function saveNewJob(job){function func(resp){console.log("Response for job query:",resp);var success=checkSaveResponse(resp,job);return{success:success,job:job,resp:resp}}return _ml_api_service.ml.addJob({jobId:job.job_id,job:job}).then(func).catch(func)}},{key:"cloneJob",value:function cloneJob(job){var tempJob=_angular.default.copy(job);delete tempJob.state;delete tempJob.job_version;delete tempJob.data_counts;delete tempJob.create_time;delete tempJob.finished_time;delete tempJob.last_data_time;delete tempJob.model_size_stats;delete tempJob.node;delete tempJob.average_bucket_processing_time_ms;delete tempJob.model_snapshot_id;delete tempJob.open_time;delete tempJob.established_model_memory;delete tempJob.calendars;delete tempJob.analysis_config.use_per_partition_normalization;_lodash.default.each(tempJob.analysis_config.detectors,function(d){delete d.detector_index});if(tempJob.datafeed_config){delete tempJob.datafeed_config.datafeed_id;delete tempJob.datafeed_config.job_id;delete tempJob.datafeed_config.state;delete tempJob.datafeed_config.node;if(tempJob.datafeed_config.query_delay){var interval=(0,_parse_interval.parseInterval)(tempJob.datafeed_config.query_delay);if(interval!==null){var queryDelay=interval.asSeconds();if(queryDelay>60&&queryDelay<120){delete tempJob.datafeed_config.query_delay}}}}if(tempJob.custom_settings&&tempJob.custom_settings.created_by){delete tempJob.custom_settings.created_by}return tempJob}},{key:"updateJob",value:function updateJob(jobId,job){return _ml_api_service.ml.updateJob({jobId:jobId,job:job}).then(function(resp){console.log("update job",resp);return{success:true}}).catch(function(err){msgs.error(_i18n.i18n.translate("xpack.ml.jobService.couldNotUpdateJobErrorMessage",{defaultMessage:"Could not update job: {jobId}",values:{jobId:jobId}}));console.log("update job",err);return{success:false,message:err.message}})}},{key:"validateJob",value:function validateJob(obj){return _ml_api_service.ml.validateJob(obj).then(function(messages){console.log("validate job",messages);return{success:true,messages:messages}}).catch(function(err){msgs.error(_i18n.i18n.translate("xpack.ml.jobService.jobValidationErrorMessage",{defaultMessage:"Job Validation Error: {errorMessage}",values:{errorMessage:err.message}}));console.log("validate job",err);return{success:false,messages:[{status:"error",text:err.message}]}})}},{key:"getJob",value:function getJob(jobId){var job=_lodash.default.find(jobs,function(j){return j.job_id===jobId});return job}},{key:"searchPreview",value:function searchPreview(job){return new Promise(function(resolve,reject){if(job.datafeed_config){var query={match_all:{}};if(job.datafeed_config.query){query=job.datafeed_config.query}_ml_api_service.ml.getTimeFieldRange({index:job.datafeed_config.indices,timeFieldName:job.data_description.time_field,query:query}).then(function(timeRange){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);var earliestMs=timeRange.start.epoch;var latestMs=+timeRange.start.epoch+10*bucketSpan.asMilliseconds();var body={query:{bool:{must:[{range:_defineProperty({},job.data_description.time_field,{gte:earliestMs,lt:latestMs,format:"epoch_millis"})},query]}}};var aggregations=job.datafeed_config.aggs||job.datafeed_config.aggregations;if(aggregations&&Object.keys(aggregations).length){body.size=0;body.aggregations=aggregations;var scriptFields=job.datafeed_config.script_fields;if(scriptFields&&Object.keys(scriptFields).length){body.script_fields=scriptFields}}else{body.size=_job_utils.ML_DATA_PREVIEW_COUNT;var _scriptFields=job.datafeed_config.script_fields;if(_scriptFields&&Object.keys(_scriptFields).length){body.script_fields=_scriptFields}var fields={};if(job.analysis_config.detectors){_lodash.default.each(job.analysis_config.detectors,function(dtr){if(dtr.by_field_name){fields[dtr.by_field_name]={}}if(dtr.field_name){fields[dtr.field_name]={}}if(dtr.over_field_name){fields[dtr.over_field_name]={}}if(dtr.partition_field_name){fields[dtr.partition_field_name]={}}})}if(job.analysis_config.influencers){_lodash.default.each(job.analysis_config.influencers,function(inf){fields[inf]={}})}if(job.analysis_config.categorization_field_name){fields[job.analysis_config.categorization_field_name]={}}if(job.analysis_config.summary_count_field_name){fields[job.analysis_config.summary_count_field_name]={}}if(job.data_description.time_field){fields[job.data_description.time_field]={}}var fieldsList=Object.keys(fields);if(fieldsList.length){body._source=fieldsList}}var data={index:job.datafeed_config.indices,body:body};_ml_api_service.ml.esSearch(data).then(function(resp){resolve(resp)}).catch(function(resp){reject(resp)})}).catch(function(resp){reject(resp)})}})}},{key:"openJob",value:function openJob(jobId){return _ml_api_service.ml.openJob({jobId:jobId})}},{key:"closeJob",value:function closeJob(jobId){return _ml_api_service.ml.closeJob({jobId:jobId})}},{key:"saveNewDatafeed",value:function saveNewDatafeed(datafeedConfig,jobId){var datafeedId="datafeed-".concat(jobId);datafeedConfig.job_id=jobId;return _ml_api_service.ml.addDatafeed({datafeedId:datafeedId,datafeedConfig:datafeedConfig})}},{key:"updateDatafeed",value:function updateDatafeed(datafeedId,datafeedConfig){return _ml_api_service.ml.updateDatafeed({datafeedId:datafeedId,datafeedConfig:datafeedConfig}).then(function(resp){console.log("update datafeed",resp);return{success:true}}).catch(function(err){msgs.error(_i18n.i18n.translate("xpack.ml.jobService.couldNotUpdateDatafeedErrorMessage",{defaultMessage:"Could not update datafeed: {datafeedId}",values:{datafeedId:datafeedId}}));console.log("update datafeed",err);return{success:false,message:err.message}})}},{key:"startDatafeed",value:function startDatafeed(datafeedId,jobId,start,end){return new Promise(function(resolve,reject){if(_lodash.default.isNumber(end)){end++}_ml_api_service.ml.startDatafeed({datafeedId:datafeedId,start:start,end:end}).then(function(resp){resolve(resp)}).catch(function(err){console.log("jobService error starting datafeed:",err);msgs.error(_i18n.i18n.translate("xpack.ml.jobService.couldNotStartDatafeedErrorMessage",{defaultMessage:"Could not start datafeed for {jobId}",values:{jobId:jobId}}),err);reject(err)})})}},{key:"stopDatafeed",value:function stopDatafeed(datafeedId,jobId){return new Promise(function(resolve,reject){_ml_api_service.ml.stopDatafeed({datafeedId:datafeedId}).then(function(resp){resolve(resp)}).catch(function(err){console.log("jobService error stopping datafeed:",err);var couldNotStopDatafeedErrorMessage=_i18n.i18n.translate("xpack.ml.jobService.couldNotStopDatafeedErrorMessage",{defaultMessage:"Could not stop datafeed for {jobId}",values:{jobId:jobId}});if(err.statusCode===500){msgs.error(couldNotStopDatafeedErrorMessage);msgs.error(_i18n.i18n.translate("xpack.ml.jobService.requestMayHaveTimedOutErrorMessage",{defaultMessage:"Request may have timed out and may still be running in the background."}))}else{msgs.error(couldNotStopDatafeedErrorMessage,err)}reject(err)})})}},{key:"forceStartDatafeeds",value:function forceStartDatafeeds(dIds,start,end){return _ml_api_service.ml.jobs.forceStartDatafeeds(dIds,start,end)}},{key:"stopDatafeeds",value:function stopDatafeeds(dIds){return _ml_api_service.ml.jobs.stopDatafeeds(dIds)}},{key:"deleteJobs",value:function deleteJobs(jIds){return _ml_api_service.ml.jobs.deleteJobs(jIds)}},{key:"closeJobs",value:function closeJobs(jIds){return _ml_api_service.ml.jobs.closeJobs(jIds)}},{key:"validateDetector",value:function validateDetector(detector){return new Promise(function(resolve,reject){if(detector){_ml_api_service.ml.validateDetector({detector:detector}).then(function(resp){resolve(resp)}).catch(function(resp){reject(resp)})}else{reject({})}})}},{key:"getDatafeedId",value:function getDatafeedId(jobId){var datafeedId=datafeedIds[jobId];if(datafeedId===undefined){datafeedId="datafeed-".concat(jobId)}return datafeedId}},{key:"getDatafeedPreview",value:function getDatafeedPreview(jobId){var datafeedId=this.getDatafeedId(jobId);return _ml_api_service.ml.datafeedPreview({datafeedId:datafeedId})}},{key:"getJobGroups",value:function getJobGroups(){var groups=[];var tempGroups={};this.jobs.forEach(function(job){if(Array.isArray(job.groups)){job.groups.forEach(function(group){if(tempGroups[group]===undefined){tempGroups[group]=[job]}else{tempGroups[group].push(job)}})}});_lodash.default.each(tempGroups,function(js,id){groups.push({id:id,jobs:js})});return groups}},{key:"createResultsUrlForJobs",value:function createResultsUrlForJobs(jobsList,resultsPage){return _createResultsUrlForJobs(jobsList,resultsPage)}},{key:"createResultsUrl",value:function createResultsUrl(jobIds,from,to,resultsPage){return _createResultsUrl(jobIds,from,to,resultsPage)}}]);return JobService}();function checkSaveResponse(resp,origJob){if(resp){if(resp.job_id){if(resp.job_id===origJob.job_id){console.log("checkSaveResponse(): save successful");return true}}else{if(resp.errorCode){console.log("checkSaveResponse(): save failed",resp);return false}}}else{console.log("checkSaveResponse(): response is empty");return false}}function processBasicJobInfo(localJobService,jobsList){var processedJobsList=[];var detectorsByJob={};var customUrlsByJob={};var jobsListCopy=_lodash.default.cloneDeep(jobsList);_lodash.default.each(jobsListCopy,function(jobObj){var analysisConfig=jobObj.analysis_config;var bucketSpan=(0,_parse_interval.parseInterval)(analysisConfig.bucket_span);var job={id:jobObj.job_id,bucketSpanSeconds:bucketSpan.asSeconds()};if(_lodash.default.has(jobObj,"description")&&/^\s*$/.test(jobObj.description)===false){job.description=jobObj.description}else{job.description=jobObj.job_id}job.detectors=_lodash.default.get(analysisConfig,"detectors",[]);detectorsByJob[job.id]=job.detectors;if(_lodash.default.has(jobObj,"custom_settings.custom_urls")){job.customUrls=[];_lodash.default.each(jobObj.custom_settings.custom_urls,function(url){if(_lodash.default.has(url,"url_name")&&_lodash.default.has(url,"url_value")&&(0,_string_utils.isWebUrl)(url.url_value)){job.customUrls.push(url)}});if(job.customUrls.length>0){customUrlsByJob[job.id]=job.customUrls}}localJobService.jobDescriptions[job.id]=job.description;localJobService.basicJobs[job.id]=job;processedJobsList.push(job)});localJobService.detectorsByJob=detectorsByJob;localJobService.customUrlsByJob=customUrlsByJob;return processedJobsList}function createJobStats(jobsList,jobStats){jobStats.activeNodes.value=0;jobStats.total.value=0;jobStats.open.value=0;jobStats.closed.value=0;jobStats.failed.value=0;jobStats.activeDatafeeds.value=0;var mlNodes={};var failedJobs=0;_lodash.default.each(jobsList,function(job){if(job.state==="opened"){jobStats.open.value++}else if(job.state==="closed"){jobStats.closed.value++}else if(job.state==="failed"){failedJobs++}if(job.datafeed_config&&job.datafeed_config.state==="started"){jobStats.activeDatafeeds.value++}if(job.node&&job.node.name){mlNodes[job.node.name]={}}});jobStats.total.value=jobsList.length;if(failedJobs){jobStats.failed.value=failedJobs;jobStats.failed.show=true}else{jobStats.failed.show=false}jobStats.activeNodes.value=Object.keys(mlNodes).length}function createJobUrls(jobsList,jobUrls){_lodash.default.each(jobsList,function(job){if(job.data_counts){var from=(0,_moment.default)(job.data_counts.earliest_record_timestamp).toISOString();var to=(0,_moment.default)(job.data_counts.latest_record_timestamp).toISOString();var path=_createResultsUrl([job.job_id],to,from);if(jobUrls[job.job_id]){jobUrls[job.job_id].url=path}else{jobUrls[job.job_id]={url:path}}}})}function _createResultsUrlForJobs(jobsList,resultsPage){var from=undefined;var to=undefined;if(jobsList.length===1){from=jobsList[0].earliestTimestampMs;to=jobsList[0].latestTimestampMs}else{var jobsWithData=jobsList.filter(function(j){return j.earliestTimestampMs!==undefined});if(jobsWithData.length>0){from=Math.min.apply(Math,_toConsumableArray(jobsWithData.map(function(j){return j.earliestTimestampMs})));to=Math.max.apply(Math,_toConsumableArray(jobsWithData.map(function(j){return j.latestTimestampMs})))}}var timeFormat="YYYY-MM-DD HH:mm:ss";var fromString=(0,_moment.default)(from).format(timeFormat);var toString=(0,_moment.default)(to).format(timeFormat);var jobIds=jobsList.map(function(j){return j.id});return _createResultsUrl(jobIds,fromString,toString,resultsPage)}function _createResultsUrl(jobIds,start,end,resultsPage){var idString=jobIds.map(function(j){return"'".concat(j,"'")}).join(",");var from=(0,_moment.default)(start).toISOString();var to=(0,_moment.default)(end).toISOString();var path="";if(resultsPage!==undefined){path+="ml#/";path+=resultsPage}path+="?_g=(ml:(jobIds:!(".concat(idString,"))");path+=",refreshInterval:(display:Off,pause:!f,value:0),time:(from:'".concat(from,"'");path+=",mode:absolute,to:'".concat(to,"'");path+="))&_a=(query:(query_string:(analyze_wildcard:!t,query:'*')))";return path}var mlJobService=new JobService;exports.mlJobService=mlJobService},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var check_license_1=__webpack_require__(66);var get_privileges_1=__webpack_require__(2764);var privileges={};function checkGetJobsPrivilege(kbnUrl){return new Promise(function(resolve,reject){get_privileges_1.getPrivileges().then(function(priv){privileges=priv;if(privileges.canGetJobs){return resolve(privileges)}else{kbnUrl.redirect("/access-denied");return reject()}})})}exports.checkGetJobsPrivilege=checkGetJobsPrivilege;function checkCreateJobsPrivilege(kbnUrl){return new Promise(function(resolve,reject){get_privileges_1.getPrivileges().then(function(priv){privileges=priv;if(privileges.canCreateJob){return resolve(privileges)}else{kbnUrl.redirect("/jobs");return reject()}})})}exports.checkCreateJobsPrivilege=checkCreateJobsPrivilege;function checkFindFileStructurePrivilege(kbnUrl){return new Promise(function(resolve,reject){get_privileges_1.getPrivileges().then(function(priv){privileges=priv;if(privileges.canFindFileStructure){return resolve(privileges)}else{kbnUrl.redirect("/access-denied");return reject()}})})}exports.checkFindFileStructurePrivilege=checkFindFileStructurePrivilege;function checkGetDataFrameJobsPrivilege(kbnUrl){return new Promise(function(resolve,reject){get_privileges_1.getPrivileges().then(function(priv){privileges=priv;if(privileges.canGetDataFrameJobs){return resolve(privileges)}else{kbnUrl.redirect("/data_frames/access-denied");return reject()}})})}exports.checkGetDataFrameJobsPrivilege=checkGetDataFrameJobsPrivilege;function checkCreateDataFrameJobsPrivilege(kbnUrl){return new Promise(function(resolve,reject){get_privileges_1.getPrivileges().then(function(priv){privileges=priv;if(privileges.canCreateDataFrameJob&&privileges.canPreviewDataFrameJob&&privileges.canStartStopDataFrameJob){return resolve(privileges)}else{kbnUrl.redirect("/data_frames");return reject()}})})}exports.checkCreateDataFrameJobsPrivilege=checkCreateDataFrameJobsPrivilege;function checkPermission(privilegeType){var licenseHasExpired=check_license_1.hasLicenseExpired();return privileges[privilegeType]===true&&licenseHasExpired!==true}exports.checkPermission=checkPermission;function createPermissionFailureMessage(privilegeType){var message="";var licenseHasExpired=check_license_1.hasLicenseExpired();if(licenseHasExpired){message=i18n_1.i18n.translate("xpack.ml.privilege.licenseHasExpiredTooltip",{defaultMessage:"Your license has expired."})}else if(privilegeType==="canCreateJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.createMLJobsTooltip",{defaultMessage:"You do not have permission to create Machine Learning jobs."})}else if(privilegeType==="canStartStopDatafeed"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDatafeedsTooltip",{defaultMessage:"You do not have permission to start or stop datafeeds."})}else if(privilegeType==="canUpdateJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.editJobsTooltip",{defaultMessage:"You do not have permission to edit jobs."})}else if(privilegeType==="canDeleteJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.deleteJobsTooltip",{defaultMessage:"You do not have permission to delete jobs."})}else if(privilegeType==="canCreateCalendar"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.createCalendarsTooltip",{defaultMessage:"You do not have permission to create calendars."})}else if(privilegeType==="canDeleteCalendar"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.deleteCalendarsTooltip",{defaultMessage:"You do not have permission to delete calendars."})}else if(privilegeType==="canForecastJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.runForecastsTooltip",{defaultMessage:"You do not have permission to run forecasts."})}else if(privilegeType==="canCreateDataFrameJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.createDataFrameJobsTooltip",{defaultMessage:"You do not have permission to create data frame jobs."})}else if(privilegeType==="canStartStopDataFrameJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDataFrameJobTooltip",{defaultMessage:"You do not have permission to start or stop data frame jobs."})}else if(privilegeType==="canDeleteDataFrameJob"){message=i18n_1.i18n.translate("xpack.ml.privilege.noPermission.deleteFrameJobTooltip",{defaultMessage:"You do not have permission to delete data frame jobs."})}return i18n_1.i18n.translate("xpack.ml.privilege.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:message}})}exports.createPermissionFailureMessage=createPermissionFailureMessage},,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.calculateDatafeedFrequencyDefaultSeconds=calculateDatafeedFrequencyDefaultSeconds;exports.isTimeSeriesViewJob=isTimeSeriesViewJob;exports.isTimeSeriesViewDetector=isTimeSeriesViewDetector;exports.isSourceDataChartableForDetector=isSourceDataChartableForDetector;exports.isModelPlotChartableForDetector=isModelPlotChartableForDetector;exports.getPartitioningFieldNames=getPartitioningFieldNames;exports.isModelPlotEnabled=isModelPlotEnabled;exports.isJobVersionGte=isJobVersionGte;exports.mlFunctionToESAggregation=mlFunctionToESAggregation;exports.isJobIdValid=isJobIdValid;exports.prefixDatafeedId=prefixDatafeedId;exports.getSafeAggregationName=getSafeAggregationName;exports.uniqWithIsEqual=uniqWithIsEqual;exports.basicJobValidation=basicJobValidation;exports.validateModelMemoryLimit=validateModelMemoryLimit;exports.validateModelMemoryLimitUnits=validateModelMemoryLimitUnits;exports.validateGroupNames=validateGroupNames;exports.ML_DATA_PREVIEW_COUNT=exports.ML_MEDIAN_PERCENTS=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _semver=_interopRequireDefault(__webpack_require__(675));var _numeral=_interopRequireDefault(__webpack_require__(217));var _validation=__webpack_require__(572);var _parse_interval=__webpack_require__(313);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function calculateDatafeedFrequencyDefaultSeconds(bucketSpanSeconds){var freq=3600;if(bucketSpanSeconds<=120){freq=60}else if(bucketSpanSeconds<=1200){freq=Math.floor(bucketSpanSeconds/2)}else if(bucketSpanSeconds<=43200){freq=600}return freq}function isTimeSeriesViewJob(job){var isViewable=false;var dtrs=job.analysis_config.detectors;for(var i=0;i<dtrs.length;i++){isViewable=isTimeSeriesViewDetector(job,i);if(isViewable===true){break}}return isViewable}function isTimeSeriesViewDetector(job,dtrIndex){return isSourceDataChartableForDetector(job,dtrIndex)||isModelPlotChartableForDetector(job,dtrIndex)}function isSourceDataChartableForDetector(job,detectorIndex){var isSourceDataChartable=false;var dtrs=job.analysis_config.detectors;if(detectorIndex>=0&&detectorIndex<dtrs.length){var dtr=dtrs[detectorIndex];var functionName=dtr.function;isSourceDataChartable=mlFunctionToESAggregation(functionName)!==null&&dtr.by_field_name!=="mlcategory"&&dtr.partition_field_name!=="mlcategory"&&dtr.over_field_name!=="mlcategory";var usesScriptFields=_lodash.default.has(job,"datafeed_config.script_fields");if(isSourceDataChartable===true&&usesScriptFields===true){var scriptFields=usesScriptFields?_lodash.default.keys(job.datafeed_config.script_fields):[];isSourceDataChartable=scriptFields.indexOf(dtr.field_name)===-1&&scriptFields.indexOf(dtr.partition_field_name)===-1&&scriptFields.indexOf(dtr.by_field_name)===-1&&scriptFields.indexOf(dtr.over_field_name)===-1}}return isSourceDataChartable}function isModelPlotChartableForDetector(job,detectorIndex){var isModelPlotChartable=false;var modelPlotEnabled=_lodash.default.get(job,["model_plot_config","enabled"],false);var dtrs=job.analysis_config.detectors;if(detectorIndex>=0&&detectorIndex<dtrs.length&&modelPlotEnabled===true){var dtr=dtrs[detectorIndex];var functionName=dtr.function;isModelPlotChartable=mlFunctionToESAggregation(functionName)!==null||["varp","high_varp","low_varp","info_content","high_info_content","low_info_content"].includes(functionName)===true}return isModelPlotChartable}function getPartitioningFieldNames(job,detectorIndex){var fieldNames=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){fieldNames.push(detector.partition_field_name)}if(_lodash.default.has(detector,"by_field_name")){fieldNames.push(detector.by_field_name)}if(_lodash.default.has(detector,"over_field_name")){fieldNames.push(detector.over_field_name)}return fieldNames}function isModelPlotEnabled(job,detectorIndex,entityFields){var isEnabled=_lodash.default.get(job,["model_plot_config","enabled"],false);if(isEnabled===true&&entityFields!==undefined&&entityFields.length>0){var termsStr=_lodash.default.get(job,["model_plot_config","terms"],"");if(termsStr!==""){var detector=job.analysis_config.detectors[detectorIndex];var detectorHasPartitionField=_lodash.default.has(detector,"partition_field_name");var detectorHasByField=_lodash.default.has(detector,"by_field_name");var terms=termsStr.split(",");if(detectorHasPartitionField===true){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});isEnabled=partitionEntity!==undefined&&terms.indexOf(partitionEntity.fieldValue)!==-1}if(isEnabled===true&&detectorHasByField===true){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});isEnabled=byEntity!==undefined&&terms.indexOf(byEntity.fieldValue)!==-1}}}return isEnabled}function isJobVersionGte(job,version){var jobVersion=_lodash.default.get(job,"job_version","0.0.0");return _semver.default.gte(jobVersion,version)}function mlFunctionToESAggregation(functionName){if(functionName==="mean"||functionName==="high_mean"||functionName==="low_mean"||functionName==="metric"){return"avg"}if(functionName==="sum"||functionName==="high_sum"||functionName==="low_sum"||functionName==="non_null_sum"||functionName==="low_non_null_sum"||functionName==="high_non_null_sum"){return"sum"}if(functionName==="count"||functionName==="high_count"||functionName==="low_count"||functionName==="non_zero_count"||functionName==="low_non_zero_count"||functionName==="high_non_zero_count"){return"count"}if(functionName==="distinct_count"||functionName==="low_distinct_count"||functionName==="high_distinct_count"){return"cardinality"}if(functionName==="median"||functionName==="high_median"||functionName==="low_median"){return"percentiles"}if(functionName==="min"||functionName==="max"){return functionName}if(functionName==="rare"){return"count"}return null}function isJobIdValid(jobId){return jobId.match(/^[a-z0-9\-\_]{1,64}$/g)&&!jobId.match(/^([_-].*)?(.*[_-])?$/g)?true:false}var ML_MEDIAN_PERCENTS="50.0";exports.ML_MEDIAN_PERCENTS=ML_MEDIAN_PERCENTS;var ML_DATA_PREVIEW_COUNT=10;exports.ML_DATA_PREVIEW_COUNT=ML_DATA_PREVIEW_COUNT;function prefixDatafeedId(datafeedId,prefix){return datafeedId.match(/^datafeed-/)?datafeedId.replace(/^datafeed-/,"datafeed-".concat(prefix)):"".concat(prefix).concat(datafeedId)}function getSafeAggregationName(fieldName,index){return fieldName.match(/^[a-zA-Z0-9-_.]+$/)?fieldName:"field_".concat(index)}function uniqWithIsEqual(arr){return arr.reduce(function(dedupedArray,value){if(dedupedArray.filter(function(compareValue){return _lodash.default.isEqual(compareValue,value)}).length===0){dedupedArray.push(value)}return dedupedArray},[])}function basicJobValidation(job,fields,limits){var skipMmlChecks=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var messages=[];var valid=true;if(job){if(_lodash.default.isEmpty(job.job_id)){messages.push({id:"job_id_empty"});valid=false}else if(isJobIdValid(job.job_id)===false){messages.push({id:"job_id_invalid"});valid=false}else{messages.push({id:"job_id_valid"})}var _validateGroupNames=validateGroupNames(job),groupsMessages=_validateGroupNames.messages,groupsValid=_validateGroupNames.valid;messages.push.apply(messages,_toConsumableArray(groupsMessages));valid=valid&&groupsValid;if(job.analysis_config.categorization_filters){var v=true;_lodash.default.each(job.analysis_config.categorization_filters,function(d){try{new RegExp(d)}catch(e){v=false}if(job.analysis_config.categorization_field_name===undefined||job.analysis_config.categorization_field_name===""){v=false}if(d===""){v=false}});if(v){messages.push({id:"categorization_filters_valid"})}else{messages.push({id:"categorization_filters_invalid"});valid=false}}if(job.analysis_config.detectors.length===0){messages.push({id:"detectors_empty"});valid=false}else{var _v=true;_lodash.default.each(job.analysis_config.detectors,function(d){if(_lodash.default.isEmpty(d.function)){_v=false}});if(_v){messages.push({id:"detectors_function_not_empty"})}else{messages.push({id:"detectors_function_empty"});valid=false}}if(job.analysis_config.detectors.length>=2){var compareSubSet=job.analysis_config.detectors.map(function(d){return _lodash.default.pick(d,["function","field_name","by_field_name","over_field_name","partition_field_name"])});var dedupedSubSet=uniqWithIsEqual(compareSubSet);if(compareSubSet.length!==dedupedSubSet.length){messages.push({id:"detectors_duplicates"});valid=false}}if(job.analysis_config.bucket_span===""||job.analysis_config.bucket_span===undefined){messages.push({id:"bucket_span_empty"});valid=false}else{var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span,false);if(bucketSpan===null||bucketSpan.asMilliseconds()===0){messages.push({id:"bucket_span_invalid"});valid=false}else{messages.push({id:"bucket_span_valid",bucketSpan:job.analysis_config.bucket_span})}}if(typeof fields!=="undefined"){var loadedFields=Object.keys(fields);if(loadedFields.length===0){messages.push({id:"index_fields_invalid"});valid=false}else{messages.push({id:"index_fields_valid"})}}if(skipMmlChecks===false){var _validateModelMemoryL=validateModelMemoryLimitUnits(job),mmlUnitMessages=_validateModelMemoryL.messages,mmlUnitValid=_validateModelMemoryL.valid;messages.push.apply(messages,_toConsumableArray(mmlUnitMessages));valid=valid&&mmlUnitValid;if(mmlUnitValid){var _validateModelMemoryL2=validateModelMemoryLimit(job,limits),mmlMessages=_validateModelMemoryL2.messages,mmlValid=_validateModelMemoryL2.valid;messages.push.apply(messages,_toConsumableArray(mmlMessages));valid=valid&&mmlValid}}}else{valid=false}return{messages:messages,valid:valid,contains:function contains(id){return messages.some(function(m){return id===m.id})},find:function find(id){return messages.find(function(m){return id===m.id})}}}function validateModelMemoryLimit(job,limits){var messages=[];var valid=true;if(typeof job.analysis_limits!=="undefined"&&typeof job.analysis_limits.model_memory_limit!=="undefined"){if(_typeof(limits)==="object"&&typeof limits.max_model_memory_limit!=="undefined"){var max=limits.max_model_memory_limit.toUpperCase();var mml=job.analysis_limits.model_memory_limit.toUpperCase();var mmlBytes=(0,_numeral.default)(mml).value();var maxBytes=(0,_numeral.default)(max).value();if(mmlBytes>maxBytes){messages.push({id:"model_memory_limit_invalid"});valid=false}else{messages.push({id:"model_memory_limit_valid"})}}}return{valid:valid,messages:messages,contains:function contains(id){return messages.some(function(m){return id===m.id})},find:function find(id){return messages.find(function(m){return id===m.id})}}}function validateModelMemoryLimitUnits(job){var messages=[];var valid=true;if(typeof job.analysis_limits!=="undefined"&&typeof job.analysis_limits.model_memory_limit!=="undefined"){var mml=job.analysis_limits.model_memory_limit.toUpperCase();var mmlSplit=mml.match(/\d+(\w+)/);var unit=mmlSplit&&mmlSplit.length===2?mmlSplit[1]:null;if(_validation.ALLOWED_DATA_UNITS.indexOf(unit)===-1){messages.push({id:"model_memory_limit_units_invalid"});valid=false}else{messages.push({id:"model_memory_limit_units_valid"})}}return{valid:valid,messages:messages,contains:function contains(id){return messages.some(function(m){return id===m.id})},find:function find(id){return messages.find(function(m){return id===m.id})}}}function validateGroupNames(job){var messages=[];var valid=true;if(job.groups!==undefined){var groupIdValid=true;job.groups.forEach(function(group){if(isJobIdValid(group)===false){groupIdValid=false;valid=false}});if(job.groups.length>0&&groupIdValid){messages.push({id:"job_group_id_valid"})}else if(job.groups.length>0&&!groupIdValid){messages.push({id:"job_group_id_invalid"})}}return{valid:valid,messages:messages,contains:function contains(id){return messages.some(function(m){return id===m.id})},find:function find(id){return messages.find(function(m){return id===m.id})}}}},,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkFullLicense=checkFullLicense;exports.checkBasicLicense=checkBasicLicense;exports.checkLicenseExpired=checkLicenseExpired;exports.hasLicenseExpired=hasLicenseExpired;exports.isFullLicense=isFullLicense;exports.xpackFeatureProvider=xpackFeatureProvider;var _react=_interopRequireDefault(__webpack_require__(0));var _xpack_info=__webpack_require__(65);var _notify=__webpack_require__(14);var _license=__webpack_require__(2763);var _chrome=_interopRequireDefault(__webpack_require__(9));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var licenseHasExpired=true;var licenseType=null;var expiredLicenseBannerId;function checkFullLicense(Private,kbnBaseUrl,kbnUrl){var features=getFeatures(Private);licenseType=features.licenseType;if(features.isAvailable===false){return redirectToKibana(features,kbnBaseUrl)}else if(features.licenseType===_license.LICENSE_TYPE.BASIC){return redirectToBasic(kbnUrl)}else{setLicenseExpired(features);return Promise.resolve(features)}}function checkBasicLicense(Private,kbnBaseUrl){var features=getFeatures(Private);licenseType=features.licenseType;if(features.isAvailable===false){return redirectToKibana(features,kbnBaseUrl)}else{setLicenseExpired(features);return Promise.resolve(features)}}function checkLicenseExpired(Private,kbnBaseUrl,kbnUrl){return checkFullLicense(Private,kbnBaseUrl,kbnUrl).then(function(features){if(features.hasExpired){kbnUrl.redirect("/jobs");return Promise.halt()}else{return Promise.resolve(features)}}).catch(function(){return Promise.halt()})}function setLicenseExpired(features){licenseHasExpired=features.hasExpired||false;if(licenseHasExpired){var message=features.message;if(expiredLicenseBannerId===undefined){expiredLicenseBannerId=_notify.banners.add({component:_react.default.createElement(_eui.EuiCallOut,{iconType:"iInCircle",color:"warning",title:message})})}}}function getFeatures(Private){var xpackInfo=Private(_xpack_info.XPackInfoProvider);return xpackInfo.get("features.ml")}function redirectToKibana(features,kbnBaseUrl){var message=features.message;var newUrl=(0,_notify.addAppRedirectMessageToUrl)(_chrome.default.addBasePath(kbnBaseUrl),message||"");window.location.href=newUrl;return Promise.halt()}function redirectToBasic(kbnUrl){kbnUrl.redirect("/datavisualizer");return Promise.halt()}function hasLicenseExpired(){return licenseHasExpired}function isFullLicense(){return licenseType===_license.LICENSE_TYPE.FULL}function xpackFeatureProvider(Private){var xpackInfo=Private(_xpack_info.XPackInfoProvider);return{isAvailable:function isAvailable(feature){return xpackInfo.get("features.".concat(feature,".isAvailable"),false)}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.replaceStringTokens=replaceStringTokens;exports.detectorToString=detectorToString;exports.sortByKey=sortByKey;exports.guessTimeFormat=guessTimeFormat;exports.toLocaleString=toLocaleString;exports.mlEscape=mlEscape;exports.escapeForElasticsearchQuery=escapeForElasticsearchQuery;exports.isWebUrl=isWebUrl;exports.calculateTextWidth=calculateTextWidth;var _lodash=_interopRequireDefault(__webpack_require__(3));var _d=_interopRequireDefault(__webpack_require__(27));var _relative_to_absolute=__webpack_require__(829);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function replaceStringTokens(str,valuesByTokenName,encodeForURI){return String(str).replace(/\$([^?&$\'"]{1,40})\$/g,function(match,name){var tokenValue=_lodash.default.get(valuesByTokenName,name,null);if(encodeForURI===true&&tokenValue!==null){tokenValue=encodeURIComponent(tokenValue)}return tokenValue!==null?tokenValue:match})}function detectorToString(dtr){var BY_TOKEN=" by ";var OVER_TOKEN=" over ";var USE_NULL_OPTION=" use_null=";var PARTITION_FIELD_OPTION=" partition_field_name=";var EXCLUDE_FREQUENT_OPTION=" exclude_frequent=";var txt="";if(dtr.function!==undefined&&dtr.function!==""){txt+=dtr.function;if(dtr.field_name!==undefined&&dtr.field_name!==""){txt+="("+quoteField(dtr.field_name)+")"}}else if(dtr.field_name!==undefined&&dtr.field_name!==""){txt+=quoteField(dtr.field_name)}if(dtr.by_field_name!==undefined&&dtr.by_field_name!==""){txt+=BY_TOKEN+quoteField(dtr.by_field_name)}if(dtr.over_field_name!==undefined&&dtr.over_field_name!==""){txt+=OVER_TOKEN+quoteField(dtr.over_field_name)}if(dtr.use_null!==undefined){txt+=USE_NULL_OPTION+dtr.use_null}if(dtr.partition_field_name!==undefined&&dtr.partition_field_name!==""){txt+=PARTITION_FIELD_OPTION+quoteField(dtr.partition_field_name)}if(dtr.exclude_frequent!==undefined&&dtr.exclude_frequent!==""){txt+=EXCLUDE_FREQUENT_OPTION+dtr.exclude_frequent}return txt}function quoteField(field){if(field.match(/\W/g)){return'"'+field+'"'}else{return field}}function sortByKey(list,reverse,comparator){var keys=_lodash.default.sortBy(_lodash.default.keys(list),function(key){return comparator?comparator(list[key],key):key});if(reverse){keys=keys.reverse()}return _lodash.default.object(keys,_lodash.default.map(keys,function(key){return list[key]}))}function guessTimeFormat(time){var format="";var matched=false;if(isNaN(time)){var match;if(!matched){var reg="";reg+="(";reg+="(";reg+="(\\d{4})";reg+="([-/.\\s])";reg+="(";reg+="([01]\\d)";reg+="|";reg+="(\\w{3})";reg+=")";reg+="([-/.\\s])";reg+="([0-3]\\d)";reg+=")";reg+="|";reg+="(";reg+="(";reg+="(\\d{1,2})";reg+="|";reg+="(\\w{3})";reg+=")";reg+="([-/.\\s])";reg+="(";reg+="(\\d{1,2})";reg+="|";reg+="(\\w{3})";reg+=")";reg+="([-/.\\s])";reg+="(\\d{4})";reg+=")";reg+=")";reg+="([T\\s])?";reg+="([0-2]\\d)";reg+="([:.])";reg+="([0-5]\\d)";reg+="(";reg+="([:.])";reg+="([0-5]\\d)";reg+=")?";reg+="(";reg+="([:.])";reg+="(\\d{3})";reg+=")?";reg+="(";reg+="([+-]\\d{2}[:.]\\d{2}[:.]\\d{2})";reg+="|";reg+="([+-]\\d{2}[:.]\\d{2})";reg+="|";reg+="([+-]\\d{6})";reg+="|";reg+="([+-]\\d{4})";reg+="|";reg+="(Z)";reg+="|";reg+="([+-]\\d{2})";reg+="|";reg+="(";reg+="(\\s)";reg+="(\\w{1,4})";reg+=")";reg+=")?";console.log("guessTimeFormat: time format regex: "+reg);match=time.match(new RegExp(reg));if(match){if(match[2]!==undefined){format+="yyyy";format+=match[4];if(match[6]!==undefined){format+="MM"}else if(match[7]!==undefined){format+="MMM"}format+=match[8];format+="dd"}else if(match[10]!==undefined){if(match[13]!==undefined){format+="MMM";format+=match[14];format+="dd"}else if(match[17]!==undefined){format+="dd";format+=match[14];format+="MMM"}else{if(match[12]!==undefined&&+match[12]>12){format+="dd";format+=match[14];format+="MM"}else{format+="MM";format+=match[14];format+="dd"}}format+=match[18];format+="yyyy"}format+=match[20]==="T"?"'"+match[20]+"'":match[20];format+="HH";format+=match[22];format+="mm";if(match[24]!==undefined){format+=match[25];format+="ss"}if(match[27]!==undefined){format+=match[28];format+="SSS"}if(match[31]!==undefined){format+="XXXXX"}else if(match[32]!==undefined){format+="XXX"}else if(match[33]!==undefined){format+="XXXX"}else if(match[34]!==undefined){format+="Z"}else if(match[35]!==undefined||match[36]!==undefined){format+="X"}else if(match[37]!==undefined){if(match[38]!==undefined){format+=match[38]}for(var i=0;i<match[39].length;i++){format+="z"}}matched=true}}}else{if(time>1e10){format="epoch_ms"}else{format="epoch"}matched=true}if(matched){console.log("guessTimeFormat: guessed time format: ",format)}else{console.log("guessTimeFormat: time format could not be guessed from: "+time)}return format}function toLocaleString(x){var result=x;if(x&&typeof x==="number"){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");result=parts.join(".")}return result}function mlEscape(str){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(str).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})}function escapeForElasticsearchQuery(str){return String(str).replace(/[-[\]{}()+!<>=?:\/\\^"~*&|\s]/g,"\\$&")}function isWebUrl(str){var absoluteUrl=(0,_relative_to_absolute.relativeToAbsolute)(str);return absoluteUrl.startsWith("http://")||absoluteUrl.startsWith("https://")}function calculateTextWidth(txt,isNumber,elementSelection){txt=isNumber?_d.default.format(",")(txt):txt;var svg=elementSelection;var $el;if(elementSelection===undefined){var $body=_d.default.select("body");$el=$body.append("div");svg=$el.append("svg")}var tempLabelText=svg.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data("a").enter().append("text").text(txt);var width=tempLabelText[0][0].getBBox().width;_d.default.select(".temp-axis-label").remove();if($el!==undefined){$el.remove()}return Math.ceil(width)}},,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkMlNodesAvailable=checkMlNodesAvailable;exports.getMlNodeCount=getMlNodeCount;exports.mlNodesAvailable=mlNodesAvailable;exports.permissionToViewMlNodeCount=permissionToViewMlNodeCount;var _ml_api_service=__webpack_require__(24);var mlNodeCount=0;var userHasPermissionToViewMlNodeCount=false;function checkMlNodesAvailable(kbnUrl){getMlNodeCount().then(function(nodes){if(nodes.count!==undefined&&nodes.count>0){Promise.resolve()}else{kbnUrl.redirect("/jobs");Promise.reject()}})}function getMlNodeCount(){return new Promise(function(resolve){_ml_api_service.ml.mlNodeCount().then(function(nodes){mlNodeCount=nodes.count;userHasPermissionToViewMlNodeCount=true;resolve(nodes)}).catch(function(error){mlNodeCount=0;if(error.statusCode===403){userHasPermissionToViewMlNodeCount=false}else{console.error(error)}resolve({count:0})})})}function mlNodesAvailable(){return mlNodeCount!==0}function permissionToViewMlNodeCount(){return userHasPermissionToViewMlNodeCount}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadIndexPatterns=loadIndexPatterns;exports.getIndexPatterns=getIndexPatterns;exports.getIndexPatternNames=getIndexPatternNames;exports.getIndexPatternIdFromName=getIndexPatternIdFromName;exports.loadCurrentIndexPattern=loadCurrentIndexPattern;exports.getIndexPatternById=getIndexPatternById;exports.loadCurrentSavedSearch=loadCurrentSavedSearch;exports.getCurrentIndexPattern=getCurrentIndexPattern;exports.getCurrentSavedSearch=getCurrentSavedSearch;exports.timeBasedIndexCheck=timeBasedIndexCheck;exports.refreshIndexPatterns=void 0;var _notify=__webpack_require__(14);var _saved_objects=__webpack_require__(79);var _i18n=__webpack_require__(4);var indexPatternCache=[];var fullIndexPatterns=[];var currentIndexPattern=null;var currentSavedSearch=null;var refreshIndexPatterns=null;exports.refreshIndexPatterns=refreshIndexPatterns;function loadIndexPatterns(Private,indexPatterns){fullIndexPatterns=indexPatterns;var savedObjectsClient=Private(_saved_objects.SavedObjectsClientProvider);return savedObjectsClient.find({type:"index-pattern",fields:["id","title","type","fields"],perPage:1e4}).then(function(response){indexPatternCache=response.savedObjects;if(refreshIndexPatterns===null){exports.refreshIndexPatterns=refreshIndexPatterns=function refreshIndexPatterns(){return new Promise(function(resolve,reject){loadIndexPatterns(Private,indexPatterns).then(function(resp){resolve(resp)}).catch(function(error){reject(error)})})}}return indexPatternCache})}function getIndexPatterns(){return indexPatternCache}function getIndexPatternNames(){return indexPatternCache.map(function(i){return i.attributes&&i.attributes.title})}function getIndexPatternIdFromName(name){for(var j=0;j<indexPatternCache.length;j++){if(indexPatternCache[j].get("title")===name){return indexPatternCache[j].id}}return name}function loadCurrentIndexPattern(indexPatterns,$route){fullIndexPatterns=indexPatterns;currentIndexPattern=fullIndexPatterns.get($route.current.params.index);return currentIndexPattern}function getIndexPatternById(id){return fullIndexPatterns.get(id)}function loadCurrentSavedSearch($route,savedSearches){currentSavedSearch=savedSearches.get($route.current.params.savedSearchId);return currentSavedSearch}function getCurrentIndexPattern(){return currentIndexPattern}function getCurrentSavedSearch(){return currentSavedSearch}function timeBasedIndexCheck(indexPattern){var showNotification=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(indexPattern.isTimeBased()===false){if(showNotification){_notify.toastNotifications.addWarning({title:_i18n.i18n.translate("xpack.ml.indexPatternNotBasedOnTimeSeriesNotificationTitle",{defaultMessage:"The index pattern {indexPatternTitle} is not based on a time series",values:{indexPatternTitle:indexPattern.title}}),text:_i18n.i18n.translate("xpack.ml.indexPatternNotBasedOnTimeSeriesNotificationDescription",{defaultMessage:"Anomaly detection only runs over time-based indices"})})}return false}else{return true}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);tslib_1.__exportStar(__webpack_require__(2949),exports);tslib_1.__exportStar(__webpack_require__(2950),exports);tslib_1.__exportStar(__webpack_require__(2951),exports);tslib_1.__exportStar(__webpack_require__(2952),exports);tslib_1.__exportStar(__webpack_require__(1374),exports);tslib_1.__exportStar(__webpack_require__(2953),exports)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlMessageBarService=void 0;var _notify=__webpack_require__(14);var _ml_error=__webpack_require__(2774);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var messages=[];var MSG_STYLE={INFO:"ml-message-info",WARNING:"ml-message-warning",ERROR:"ml-message-error"};function getMessages(){return messages}function addMessage(msg){if(messages.find(function(m){return m.text===msg.text&&m.style===msg.style})===undefined){messages.push(msg)}}function removeMessage(index){messages.splice(index,1)}function clear(){messages.length=0}function info(text){addMessage({text:text,style:MSG_STYLE.INFO})}function warning(text){addMessage({text:text,style:MSG_STYLE.WARNING})}function error(text,resp){text="".concat(text," ").concat(expandErrorMessageObj(resp));addMessage({text:text,style:MSG_STYLE.ERROR})}function expandErrorMessageObj(resp){var txt="";if(resp!==undefined&&_typeof(resp)==="object"){try{var respObj=JSON.parse(resp.response);if(_typeof(respObj)==="object"&&respObj.error!==undefined){txt=respObj.error.reason}}catch(e){txt=resp.message}}return txt}function errorNotify(text,resp){var err=null;if(_typeof(text)==="object"&&text.response!==undefined){resp=text.response}else if(_typeof(text)==="object"&&text.message!==undefined){err=new Error(text.message)}else{err=new Error(text)}_notify.notify.error(new _ml_error.MLRequestFailure(err,resp))}var mlMessageBarService={getMessages:getMessages,addMessage:addMessage,removeMessage:removeMessage,clear:clear,info:info,warning:warning,error:error,notify:{error:errorNotify}};exports.mlMessageBarService=mlMessageBarService},,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var format_1=__webpack_require__(495);function formatHumanReadableDate(ts){return format_1.formatDate(ts,"MMMM Do YYYY")}exports.formatHumanReadableDate=formatHumanReadableDate;function formatHumanReadableDateTime(ts){return format_1.formatDate(ts,"MMMM Do YYYY, HH:mm")}exports.formatHumanReadableDateTime=formatHumanReadableDateTime;function formatHumanReadableDateTimeSeconds(ts){return format_1.formatDate(ts,"MMMM Do YYYY, HH:mm:ss")}exports.formatHumanReadableDateTimeSeconds=formatHumanReadableDateTimeSeconds},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.chartLimits=chartLimits;exports.drawLineChartDots=drawLineChartDots;exports.filterAxisLabels=filterAxisLabels;exports.getChartType=getChartType;exports.getExploreSeriesLink=getExploreSeriesLink;exports.showMultiBucketAnomalyMarker=showMultiBucketAnomalyMarker;exports.showMultiBucketAnomalyTooltip=showMultiBucketAnomalyTooltip;exports.numTicks=numTicks;exports.numTicksForDateFormat=numTicksForDateFormat;exports.getTickValues=getTickValues;exports.isLabelLengthAboveThreshold=isLabelLengthAboveThreshold;exports.getXTransform=getXTransform;exports.removeLabelOverlap=removeLabelOverlap;exports.SCHEDULED_EVENT_SYMBOL_HEIGHT=exports.MULTI_BUCKET_SYMBOL_SIZE=exports.LINE_CHART_ANOMALY_RADIUS=void 0;var _d=_interopRequireDefault(__webpack_require__(27));var _string_utils=__webpack_require__(67);var _multi_bucket_impact=__webpack_require__(887);var _moment=_interopRequireDefault(__webpack_require__(16));var _risonNode=_interopRequireDefault(__webpack_require__(239));var _chrome=_interopRequireDefault(__webpack_require__(9));var _timefilter=__webpack_require__(22);var _explorer_constants=__webpack_require__(339);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LINE_CHART_ANOMALY_RADIUS=7;exports.LINE_CHART_ANOMALY_RADIUS=LINE_CHART_ANOMALY_RADIUS;var MULTI_BUCKET_SYMBOL_SIZE=100;exports.MULTI_BUCKET_SYMBOL_SIZE=MULTI_BUCKET_SYMBOL_SIZE;var SCHEDULED_EVENT_SYMBOL_HEIGHT=5;exports.SCHEDULED_EVENT_SYMBOL_HEIGHT=SCHEDULED_EVENT_SYMBOL_HEIGHT;var MAX_LABEL_WIDTH=100;function chartLimits(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var domain=_d.default.extent(data,function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}return metricValue});var limits={max:domain[1],min:domain[0]};if(limits.max===limits.min){limits.max=_d.default.max(data,function(d){if(d.typical){return Math.max(d.value,d.typical)}else{return d.value}});limits.min=_d.default.min(data,function(d){if(d.typical){return Math.min(d.value,d.typical)}else{return d.value}})}if(limits.max===limits.min){var padding=limits.max*.05;limits.max+=padding;limits.min-=padding}return limits}function drawLineChartDots(data,lineChartGroup,lineChartValuesLine){var radius=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1.5;var dotsData=data.reduce(function(p,c,i){var previous=data[i-1];var next=data[i+1];if((typeof previous==="undefined"||previous&&previous.value===null)&&c.value!==null&&(typeof next==="undefined"||next&&next.value===null)){p.push(c)}return p},[]);var dotGroup=lineChartGroup.select(".values-dots").empty()?lineChartGroup.append("g").classed("values-dots",true):lineChartGroup.select(".values-dots");var dots=dotGroup.selectAll("circle").data(dotsData);dots.enter().append("circle").attr("r",radius);dots.attr("cx",lineChartValuesLine.x()).attr("cy",lineChartValuesLine.y());dots.exit().remove()}function filterAxisLabels(selection,chartWidth){if(selection===undefined||selection.selectAll===undefined){throw new Error("Missing selection parameter")}selection.selectAll(".tick text").text(function(){var parent=_d.default.select(this.parentNode);var labelWidth=parent.node().getBBox().width;var labelXPos=_d.default.transform(parent.attr("transform")).translate[0];var minThreshold=labelXPos-labelWidth/2;var maxThreshold=labelXPos+labelWidth/2;if(minThreshold>=0&&maxThreshold<=chartWidth){return this.textContent}else{parent.remove()}})}var EVENT_DISTRIBUTION_ENABLED=true;var POPULATION_DISTRIBUTION_ENABLED=true;function getChartType(config){var chartType=_explorer_constants.CHART_TYPE.SINGLE_METRIC;if(EVENT_DISTRIBUTION_ENABLED&&config.functionDescription==="rare"&&config.entityFields.some(function(f){return f.fieldType==="over"})===false){chartType=_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION}else if(POPULATION_DISTRIBUTION_ENABLED&&config.functionDescription!=="rare"&&config.entityFields.some(function(f){return f.fieldType==="over"})&&config.metricFunction!==null){chartType=_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION}if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){if(config.datafeedConfig!==undefined&&config.datafeedConfig.script_fields!==undefined){var scriptFields=Object.keys(config.datafeedConfig.script_fields);var checkFields=config.entityFields.map(function(entity){return entity.fieldName});if(config.metricFieldName){checkFields.push(config.metricFieldName)}var usesScriptFields=checkFields.find(function(fieldName){return scriptFields.includes(fieldName)})!==undefined;if(usesScriptFields===true){chartType=_explorer_constants.CHART_TYPE.SINGLE_METRIC}}}return chartType}function getExploreSeriesLink(series){var bounds=_timefilter.timefilter.getActiveBounds();var from=bounds.min.toISOString();var to=bounds.max.toISOString();var zoomFrom=(0,_moment.default)(series.plotEarliest).toISOString();var zoomTo=(0,_moment.default)(series.plotLatest).toISOString();var entityCondition={};series.entityFields.forEach(function(entity){entityCondition[entity.fieldName]=entity.fieldValue});var _g=_risonNode.default.encode({ml:{jobIds:[series.jobId]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var _a=_risonNode.default.encode({mlTimeSeriesExplorer:{zoom:{from:zoomFrom,to:zoomTo},detectorIndex:series.detectorIndex,entities:entityCondition},query:{query_string:{analyze_wildcard:true,query:"*"}}});return"".concat(_chrome.default.getBasePath(),"/app/ml#/timeseriesexplorer?_g=").concat(_g,"&_a=").concat(encodeURIComponent(_a))}function showMultiBucketAnomalyMarker(point){return point.multiBucketImpact!==undefined&&point.multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.MEDIUM}function showMultiBucketAnomalyTooltip(point){return point.multiBucketImpact!==undefined&&point.multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.LOW}function numTicks(axisWidth){return axisWidth/MAX_LABEL_WIDTH}function numTicksForDateFormat(axisWidth,dateFormat){var tickWidth=(0,_string_utils.calculateTextWidth)((0,_moment.default)().format(dateFormat),false);return axisWidth/(1.75*tickWidth)}var TICK_DIRECTION={NEXT:"next",PREVIOUS:"previous"};function getTickValues(startTimeMs,tickInterval,earliest,latest){if(tickInterval<=0){throw Error("tickInterval must be larger than 0.")}var tickValues=[startTimeMs];function addTicks(ts,operator){var newTick;var addAnotherTick;switch(operator){case TICK_DIRECTION.PREVIOUS:newTick=ts-tickInterval;addAnotherTick=newTick>=earliest;break;case TICK_DIRECTION.NEXT:newTick=ts+tickInterval;addAnotherTick=newTick<=latest;break}if(addAnotherTick){tickValues.push(newTick);addTicks(newTick,operator)}}addTicks(startTimeMs,TICK_DIRECTION.PREVIOUS);addTicks(startTimeMs,TICK_DIRECTION.NEXT);tickValues.sort();return tickValues}var LABEL_WRAP_THRESHOLD=60;function isLabelLengthAboveThreshold(_ref){var detectorLabel=_ref.detectorLabel,entityFields=_ref.entityFields;var labelLength=detectorLabel.length+entityFields.map(function(d){return"".concat(d.fieldName," ").concat(d.fieldValue)}).join(" ").length;return labelLength>LABEL_WRAP_THRESHOLD}function getXTransform(t){var regexResult=/translate\(\s*([^\s,)]+)([ ,]([^\s,)]+))?\)/.exec(t);if(Array.isArray(regexResult)&&regexResult.length>=2){return Number(regexResult[1])}return NaN}function removeLabelOverlap(axis,startTimeMs,tickInterval,width){axis.selectAll("g.tick").select("line").classed("ml-tick-emphasis",true);function getNeighborTickFactory(operator){return function(ts){switch(operator){case TICK_DIRECTION.PREVIOUS:return ts-tickInterval;case TICK_DIRECTION.NEXT:return ts+tickInterval}}}function getTickDataFactory(operator){var getNeighborTick=getNeighborTickFactory(operator);var fn=function fn(ts){var filteredTicks=axis.selectAll(".tick").filter(function(d){return d===ts});if(filteredTicks.length===0||filteredTicks[0].length===0){return false}var tick=_d.default.selectAll(filteredTicks[0]);var textNode=tick.select("text").node();if(textNode===null){return fn(getNeighborTick(ts))}var tickWidth=textNode.getBBox().width;var padding=15;var xTransform=getXTransform(tick.attr("transform"));var xMinOffset=xTransform-(tickWidth/2+padding);var xMaxOffset=xTransform+(tickWidth/2+padding);return{tick:tick,ts:ts,xMinOffset:xMinOffset,xMaxOffset:xMaxOffset}};return fn}function checkTicks(ts,operator){var getTickData=getTickDataFactory(operator);var currentTickData=getTickData(ts);if(currentTickData===false){return}var getNeighborTick=getNeighborTickFactory(operator);var newTickData=getTickData(getNeighborTick(ts));if(newTickData!==false){if(newTickData.xMinOffset<0||newTickData.xMaxOffset>width||newTickData.xMaxOffset>currentTickData.xMinOffset&&operator===TICK_DIRECTION.PREVIOUS||newTickData.xMinOffset<currentTickData.xMaxOffset&&operator===TICK_DIRECTION.NEXT){newTickData.tick.select("text").remove();newTickData.tick.select("line").classed("ml-tick-emphasis",false);checkTicks(currentTickData.ts,operator)}else{checkTicks(newTickData.ts,operator)}}}checkTicks(startTimeMs,TICK_DIRECTION.PREVIOUS);checkTicks(startTimeMs,TICK_DIRECTION.NEXT)}},,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSeverity=getSeverity;exports.getSeverityWithLow=getSeverityWithLow;exports.getSeverityColor=getSeverityColor;exports.getMultiBucketImpactLabel=getMultiBucketImpactLabel;exports.getEntityFieldName=getEntityFieldName;exports.getEntityFieldValue=getEntityFieldValue;exports.getEntityFieldList=getEntityFieldList;exports.showActualForFunction=showActualForFunction;exports.showTypicalForFunction=showTypicalForFunction;exports.isRuleSupported=isRuleSupported;exports.aggregationTypeTransform=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _detector_rule=__webpack_require__(435);var _multi_bucket_impact=__webpack_require__(887);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DISPLAY_ACTUAL_FUNCTIONS=["count","distinct_count","lat_long","mean","max","min","sum","median","varp","info_content","time"];var DISPLAY_TYPICAL_FUNCTIONS=["count","distinct_count","lat_long","mean","max","min","sum","median","varp","info_content","time"];var severityTypes;function getSeverityTypes(){if(severityTypes){return severityTypes}return severityTypes={critical:{id:"critical",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severity.criticalLabel",{defaultMessage:"critical"})},major:{id:"major",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severity.majorLabel",{defaultMessage:"major"})},minor:{id:"minor",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severity.minorLabel",{defaultMessage:"minor"})},warning:{id:"warning",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severity.warningLabel",{defaultMessage:"warning"})},unknown:{id:"unknown",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severity.unknownLabel",{defaultMessage:"unknown"})},low:{id:"low",label:_i18n.i18n.translate("xpack.ml.anomalyUtils.severityWithLow.lowLabel",{defaultMessage:"low"})}}}function getSeverity(normalizedScore){var severityTypesList=getSeverityTypes();if(normalizedScore>=75){return severityTypesList.critical}else if(normalizedScore>=50){return severityTypesList.major}else if(normalizedScore>=25){return severityTypesList.minor}else if(normalizedScore>=0){return severityTypesList.warning}else{return severityTypesList.unknown}}function getSeverityWithLow(normalizedScore){var severityTypesList=getSeverityTypes();if(normalizedScore>=75){return severityTypesList.critical}else if(normalizedScore>=50){return severityTypesList.major}else if(normalizedScore>=25){return severityTypesList.minor}else if(normalizedScore>=3){return severityTypesList.warning}else if(normalizedScore>=0){return severityTypesList.low}else{return severityTypesList.unknown}}function getSeverityColor(normalizedScore){if(normalizedScore>=75){return"#fe5050"}else if(normalizedScore>=50){return"#fba740"}else if(normalizedScore>=25){return"#fdec25"}else if(normalizedScore>=3){return"#8bc8fb"}else if(normalizedScore>=0){return"#d2e9f7"}else{return"#ffffff"}}function getMultiBucketImpactLabel(multiBucketImpact){if(multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.HIGH){return _i18n.i18n.translate("xpack.ml.anomalyUtils.multiBucketImpact.highLabel",{defaultMessage:"high"})}else if(multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.MEDIUM){return _i18n.i18n.translate("xpack.ml.anomalyUtils.multiBucketImpact.mediumLabel",{defaultMessage:"medium"})}else if(multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.LOW){return _i18n.i18n.translate("xpack.ml.anomalyUtils.multiBucketImpact.lowLabel",{defaultMessage:"low"})}else{return _i18n.i18n.translate("xpack.ml.anomalyUtils.multiBucketImpact.noneLabel",{defaultMessage:"none"})}}function getEntityFieldName(record){if(_lodash.default.has(record,"by_field_name")&&_lodash.default.has(record,"by_field_value")){return record.by_field_name}if(_lodash.default.has(record,"over_field_name")){return record.over_field_name}if(_lodash.default.has(record,"partition_field_name")){return record.partition_field_name}return undefined}function getEntityFieldValue(record){if(_lodash.default.has(record,"by_field_value")){return record.by_field_value}if(_lodash.default.has(record,"over_field_value")){return record.over_field_value}if(_lodash.default.has(record,"partition_field_value")){return record.partition_field_value}return undefined}function getEntityFieldList(record){var entityFields=[];if(record.partition_field_name!==undefined){entityFields.push({fieldName:record.partition_field_name,fieldValue:record.partition_field_value,fieldType:"partition"})}if(record.over_field_name!==undefined){entityFields.push({fieldName:record.over_field_name,fieldValue:record.over_field_value,fieldType:"over"})}if(record.by_field_name!==undefined&&record.over_field_name===undefined){entityFields.push({fieldName:record.by_field_name,fieldValue:record.by_field_value,fieldType:"by"})}return entityFields}function showActualForFunction(functionDescription){return _lodash.default.indexOf(DISPLAY_ACTUAL_FUNCTIONS,functionDescription)>-1}function showTypicalForFunction(functionDescription){return _lodash.default.indexOf(DISPLAY_TYPICAL_FUNCTIONS,functionDescription)>-1}function isRuleSupported(record){return _detector_rule.CONDITIONS_NOT_SUPPORTED_FUNCTIONS.indexOf(record.function)===-1||getEntityFieldName(record)!==undefined}var aggregationTypeTransform={toES:function toES(oldAggType){var newAggType=oldAggType;if(newAggType==="mean"){newAggType="avg"}else if(newAggType==="distinct_count"){newAggType="cardinality"}else if(newAggType==="median"){newAggType="percentiles"}return newAggType},toML:function toML(oldAggType){var newAggType=oldAggType;if(newAggType==="avg"){newAggType="mean"}else if(newAggType==="cardinality"){newAggType="distinct_count"}else if(newAggType==="percentiles"){newAggType="median"}return newAggType}};exports.aggregationTypeTransform=aggregationTypeTransform},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SearchItemsProvider=SearchItemsProvider;exports.createJobForSaving=createJobForSaving;exports.addNewJobToRecentlyAccessed=addNewJobToRecentlyAccessed;exports.moveToAdvancedJobCreationProvider=moveToAdvancedJobCreationProvider;exports.focusOnResultsLink=focusOnResultsLink;exports.checkCardinalitySuccess=checkCardinalitySuccess;exports.getMinimalValidJob=getMinimalValidJob;var _lodash=_interopRequireDefault(__webpack_require__(3));var _jquery=_interopRequireDefault(__webpack_require__(21));var _esQuery=__webpack_require__(38);var _recently_accessed=__webpack_require__(677);var _job_service=__webpack_require__(36);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SearchItemsProvider(Private,$route,config){function createSearchItems(){var indexPattern=$route.current.locals.indexPattern;var query={query:"",language:"lucene"};var combinedQuery={bool:{must:[{match_all:{}}]}};var savedSearch=$route.current.locals.savedSearch;if(indexPattern.id===undefined&&savedSearch.id!==undefined){var searchSource=savedSearch.searchSource;indexPattern=searchSource.getField("index");query=searchSource.getField("query");var fs=searchSource.getField("filter");var filters=fs.length?fs:[];var esQueryConfigs=(0,_esQuery.getEsQueryConfig)(config);combinedQuery=(0,_esQuery.buildEsQuery)(indexPattern,[query],filters,esQueryConfigs)}return{indexPattern:indexPattern,savedSearch:savedSearch,query:query,combinedQuery:combinedQuery}}return createSearchItems}function createJobForSaving(job){var newJob=_lodash.default.cloneDeep(job);delete newJob.datafeed_config;return newJob}function addNewJobToRecentlyAccessed(jobId,resultsUrl){var urlParts=resultsUrl.match(/ml#\/(.+?)(\?.+)/);(0,_recently_accessed.addItemToRecentlyAccessed)(urlParts[1],jobId,urlParts[2])}function moveToAdvancedJobCreationProvider($location){return function moveToAdvancedJobCreation(job){_job_service.mlJobService.currentJob=job;$location.path("jobs/new_job/advanced")}}function focusOnResultsLink(linkId,$timeout){$timeout(function(){(0,_jquery.default)("#".concat(linkId)).focus()},0)}function checkCardinalitySuccess(data){var response={success:true};if(Array.isArray(data)&&data.length===0){return response}for(var i=0;i<data.length;i++){if(data[i].id==="success_cardinality"){break}if(data[i].id==="cardinality_model_plot_high"){response.success=false;response.highCardinality=data[i].modelPlotCardinality;break}}return response}function getMinimalValidJob(){return{analysis_config:{bucket_span:"15m",detectors:[],influencers:[]},data_description:{time_field:"@timestamp"},datafeed_config:{indices:[]}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ES_FIELD_TYPES;(function(ES_FIELD_TYPES){ES_FIELD_TYPES["ATTACHMENT"]="attachment";ES_FIELD_TYPES["BOOLEAN"]="boolean";ES_FIELD_TYPES["BYTE"]="byte";ES_FIELD_TYPES["DATE"]="date";ES_FIELD_TYPES["DOUBLE"]="double";ES_FIELD_TYPES["FLOAT"]="float";ES_FIELD_TYPES["GEO_POINT"]="geo_point";ES_FIELD_TYPES["GEO_SHAPE"]="geo_shape";ES_FIELD_TYPES["HALF_FLOAT"]="half_float";ES_FIELD_TYPES["INTEGER"]="integer";ES_FIELD_TYPES["IP"]="ip";ES_FIELD_TYPES["KEYWORD"]="keyword";ES_FIELD_TYPES["LONG"]="long";ES_FIELD_TYPES["MURMUR3"]="murmur3";ES_FIELD_TYPES["SCALED_FLOAT"]="scaled_float";ES_FIELD_TYPES["SHORT"]="short";ES_FIELD_TYPES["TEXT"]="text";ES_FIELD_TYPES["TOKEN_COUNT"]="token_count";ES_FIELD_TYPES["_ID"]="_id";ES_FIELD_TYPES["_SOURCE"]="_source";ES_FIELD_TYPES["_TYPE"]="_type"})(ES_FIELD_TYPES=exports.ES_FIELD_TYPES||(exports.ES_FIELD_TYPES={}));var KBN_FIELD_TYPES;(function(KBN_FIELD_TYPES){KBN_FIELD_TYPES["ATTACHMENT"]="attachment";KBN_FIELD_TYPES["BOOLEAN"]="boolean";KBN_FIELD_TYPES["DATE"]="date";KBN_FIELD_TYPES["GEO_POINT"]="geo_point";KBN_FIELD_TYPES["GEO_SHAPE"]="geo_shape";KBN_FIELD_TYPES["IP"]="ip";KBN_FIELD_TYPES["MURMUR3"]="murmur3";KBN_FIELD_TYPES["NUMBER"]="number";KBN_FIELD_TYPES["STRING"]="string";KBN_FIELD_TYPES["_SOURCE"]="_source";KBN_FIELD_TYPES["UNKNOWN"]="unknown";KBN_FIELD_TYPES["CONFLICT"]="conflict"})(KBN_FIELD_TYPES=exports.KBN_FIELD_TYPES||(exports.KBN_FIELD_TYPES={}));var ML_JOB_FIELD_TYPES;(function(ML_JOB_FIELD_TYPES){ML_JOB_FIELD_TYPES["BOOLEAN"]="boolean";ML_JOB_FIELD_TYPES["DATE"]="date";ML_JOB_FIELD_TYPES["GEO_POINT"]="geo_point";ML_JOB_FIELD_TYPES["IP"]="ip";ML_JOB_FIELD_TYPES["KEYWORD"]="keyword";ML_JOB_FIELD_TYPES["NUMBER"]="number";ML_JOB_FIELD_TYPES["TEXT"]="text";ML_JOB_FIELD_TYPES["UNKNOWN"]="unknown"})(ML_JOB_FIELD_TYPES=exports.ML_JOB_FIELD_TYPES||(exports.ML_JOB_FIELD_TYPES={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlFieldFormatService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _job_utils=__webpack_require__(58);var _index_utils=__webpack_require__(226);var _job_service=__webpack_require__(36);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var FieldFormatService=function(){function FieldFormatService(){_classCallCheck(this,FieldFormatService);this.indexPatternIdsByJob={};this.formatsByJob={}}_createClass(FieldFormatService,[{key:"populateFormats",value:function populateFormats(jobIds,indexPatterns){var _this=this;return new Promise(function(resolve,reject){_lodash.default.each(jobIds,function(jobId){var jobObj=_job_service.mlJobService.getJob(jobId);var datafeedIndices=jobObj.datafeed_config.indices;var indexPattern=_lodash.default.find(indexPatterns,function(index){return _lodash.default.find(datafeedIndices,function(datafeedIndex){return index.get("title")===datafeedIndex})});if(indexPattern!==undefined){_this.indexPatternIdsByJob[jobId]=indexPattern.id}});var promises=jobIds.map(function(jobId){return Promise.all([_this.getFormatsForJob(jobId)])});Promise.all(promises).then(function(fmtsByJobByDetector){_lodash.default.each(fmtsByJobByDetector,function(formatsByDetector,index){_this.formatsByJob[jobIds[index]]=formatsByDetector[0]});resolve(_this.formatsByJob)}).catch(function(err){console.log("fieldFormatService error populating formats:",err);reject({formats:{},err:err})})})}},{key:"getFieldFormat",value:function getFieldFormat(jobId,detectorIndex){return _lodash.default.get(this.formatsByJob,[jobId,detectorIndex])}},{key:"getFieldFormatFromIndexPattern",value:function getFieldFormatFromIndexPattern(fullIndexPattern,fieldName,esAggName){var fieldFormat=undefined;if(esAggName!=="cardinality"){var indexPatternFields=_lodash.default.get(fullIndexPattern,"fields.byName",[]);fieldFormat=_lodash.default.get(indexPatternFields,[fieldName,"format"])}return fieldFormat}},{key:"getFormatsForJob",value:function getFormatsForJob(jobId){var _this2=this;return new Promise(function(resolve,reject){var jobObj=_job_service.mlJobService.getJob(jobId);var detectors=jobObj.analysis_config.detectors||[];var formatsByDetector={};var indexPatternId=_this2.indexPatternIdsByJob[jobId];if(indexPatternId!==undefined){(0,_index_utils.getIndexPatternById)(indexPatternId).then(function(indexPatternData){var fieldsByName=_lodash.default.get(indexPatternData,"fields.byName",[]);_lodash.default.each(detectors,function(dtr){var esAgg=(0,_job_utils.mlFunctionToESAggregation)(dtr.function);if(dtr.field_name!==undefined&&esAgg!=="cardinality"){formatsByDetector[dtr.detector_index]=_lodash.default.get(fieldsByName,[dtr.field_name,"format"])}});resolve(formatsByDetector)}).catch(function(err){reject(err)})}else{resolve(formatsByDetector)}})}}]);return FieldFormatService}();var mlFieldFormatService=new FieldFormatService;exports.mlFieldFormatService=mlFieldFormatService},,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.parseInterval=parseInterval;var _moment=_interopRequireDefault(__webpack_require__(16));var _datemath=_interopRequireDefault(__webpack_require__(55));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var INTERVAL_STRING_RE=new RegExp("^([0-9]*)\\s*("+_datemath.default.units.join("|")+")$");var SUPPORT_ZERO_DURATION_UNITS=["ms","s","m","h"];function parseInterval(interval){var matches=String(interval).trim().match(INTERVAL_STRING_RE);if(!Array.isArray(matches))return null;if(matches.length<3)return null;try{var value=parseInt(matches[1]);var unit=matches[2];if(isNaN(value)||value<1&&SUPPORT_ZERO_DURATION_UNITS.indexOf(unit)===-1){return null}return _moment.default.duration(value,unit)}catch(e){return null}}},,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadNewJobDefaults=loadNewJobDefaults;exports.newJobDefaults=newJobDefaults;exports.newJobLimits=newJobLimits;var _ml_api_service=__webpack_require__(24);var defaults={anomaly_detectors:{},datafeeds:{}};var limits={};function loadNewJobDefaults(){return new Promise(function(resolve){_ml_api_service.ml.mlInfo().then(function(resp){defaults=resp.defaults;limits=resp.limits;resolve({defaults:defaults,limits:limits})}).catch(function(){resolve({defaults:defaults,limits:limits})})})}function newJobDefaults(){return defaults}function newJobLimits(){return limits}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IntervalHelperProvider=IntervalHelperProvider;exports.getBoundsRoundedToInterval=getBoundsRoundedToInterval;exports.calcEsInterval=calcEsInterval;var _lodash=_interopRequireDefault(__webpack_require__(3));var _moment=_interopRequireDefault(__webpack_require__(16));var _datemath=_interopRequireDefault(__webpack_require__(55));var _ml_calc_auto_interval=__webpack_require__(2871);var _inherits=__webpack_require__(2872);var _time_buckets=__webpack_require__(312);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var unitsDesc=_datemath.default.unitsDesc;var largeMax=unitsDesc.indexOf("w");function IntervalHelperProvider(Private,config){var calcAuto=Private(_ml_calc_auto_interval.TimeBucketsCalcAutoIntervalProvider);(0,_inherits.inherits)(MlTimeBuckets,_time_buckets.TimeBuckets);function MlTimeBuckets(){this.barTarget=config.get("histogram:barTarget");this.maxBars=config.get("histogram:maxBars")}MlTimeBuckets.prototype.setBarTarget=function(bt){this.barTarget=bt};MlTimeBuckets.prototype.setMaxBars=function(mb){this.maxBars=mb};MlTimeBuckets.prototype.getInterval=function(){var self=this;var duration=self.getDuration();return decorateInterval(maybeScaleInterval(readInterval()),duration);function readInterval(){var interval=self._i;if(_moment.default.isDuration(interval))return interval;return calcAuto.near(self.barTarget,duration)}function maybeScaleInterval(interval){if(!self.hasBounds())return interval;var maxLength=self.maxBars;var approxLen=duration/interval;var scaled;if(approxLen>maxLength){scaled=calcAuto.lessThan(maxLength,duration)}else{return interval}if(+scaled===+interval)return interval;decorateInterval(interval,duration);return _lodash.default.assign(scaled,{preScaled:interval,scale:interval/scaled,scaled:true})}};MlTimeBuckets.prototype.getIntervalToNearestMultiple=function(divisorSecs){var interval=this.getInterval();var intervalSecs=interval.asSeconds();var remainder=intervalSecs%divisorSecs;if(remainder===0){return interval}var nearestMultiple=remainder>divisorSecs/2?intervalSecs+divisorSecs-remainder:intervalSecs-remainder;nearestMultiple=nearestMultiple===0?divisorSecs:nearestMultiple;var nearestMultipleInt=_moment.default.duration(nearestMultiple,"seconds");decorateInterval(nearestMultipleInt,this.getDuration());var preScaled=_lodash.default.get(interval,"preScaled");if(preScaled!==undefined&&preScaled<nearestMultipleInt){nearestMultipleInt.preScaled=preScaled;nearestMultipleInt.scale=preScaled/nearestMultipleInt;nearestMultipleInt.scaled=true}return nearestMultipleInt};function decorateInterval(interval,originalDuration){var esInterval=calcEsInterval(interval);interval.esValue=esInterval.value;interval.esUnit=esInterval.unit;interval.expression=esInterval.expression;interval.overflow=originalDuration>interval?_moment.default.duration(interval-originalDuration):false;var prettyUnits=_moment.default.normalizeUnits(esInterval.unit);if(esInterval.value===1){interval.description=prettyUnits}else{interval.description="".concat(esInterval.value," ").concat(prettyUnits,"s")}return interval}return MlTimeBuckets}function getBoundsRoundedToInterval(bounds,interval){var inclusiveEnd=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var intervalMs=interval.asMilliseconds();var adjustedMinMs=Math.floor(bounds.min.valueOf()/intervalMs)*intervalMs;var adjustedMaxMs=Math.ceil(bounds.max.valueOf()/intervalMs)*intervalMs;if(inclusiveEnd===false){adjustedMaxMs=adjustedMaxMs-1}return{min:(0,_moment.default)(adjustedMinMs),max:(0,_moment.default)(adjustedMaxMs)}}function calcEsInterval(duration){for(var i=0;i<unitsDesc.length;i++){var unit=unitsDesc[i];var val=duration.as(unit);if(val>=1&&Math.floor(val)===val){if(i<=largeMax&&val!==1){continue}return{value:val,unit:unit,expression:val+unit}}}var ms=duration.as("ms");return{value:ms,unit:"ms",expression:ms+"ms"}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VIEW_BY_JOB_LABEL=exports.MAX_INFLUENCER_FIELD_NAMES=exports.MAX_INFLUENCER_FIELD_VALUES=exports.MAX_CATEGORY_EXAMPLES=exports.CHART_TYPE=exports.SWIMLANE_TYPE=exports.APP_STATE_ACTION=exports.FILTER_ACTION=exports.EXPLORER_ACTION=exports.DRAG_SELECT_ACTION=void 0;var _i18n=__webpack_require__(4);var DRAG_SELECT_ACTION={NEW_SELECTION:"newSelection",ELEMENT_SELECT:"elementSelect",DRAG_START:"dragStart"};exports.DRAG_SELECT_ACTION=DRAG_SELECT_ACTION;var EXPLORER_ACTION={IDLE:"idle",INITIALIZE:"initialize",JOB_SELECTION_CHANGE:"jobSelectionChange",LOAD_JOBS:"loadJobs",REDRAW:"redraw",RELOAD:"reload"};exports.EXPLORER_ACTION=EXPLORER_ACTION;var FILTER_ACTION={ADD:"+",REMOVE:"-"};exports.FILTER_ACTION=FILTER_ACTION;var APP_STATE_ACTION={CLEAR_INFLUENCER_FILTER_SETTINGS:"clearInfluencerFilterSettings",CLEAR_SELECTION:"clearSelection",SAVE_SELECTION:"saveSelection",SAVE_SWIMLANE_VIEW_BY_FIELD_NAME:"saveSwimlaneViewByFieldName",SAVE_INFLUENCER_FILTER_SETTINGS:"saveInfluencerFilterSettings"};exports.APP_STATE_ACTION=APP_STATE_ACTION;var SWIMLANE_TYPE={OVERALL:"overall",VIEW_BY:"viewBy"};exports.SWIMLANE_TYPE=SWIMLANE_TYPE;var CHART_TYPE={EVENT_DISTRIBUTION:"event_distribution",POPULATION_DISTRIBUTION:"population_distribution",SINGLE_METRIC:"single_metric"};exports.CHART_TYPE=CHART_TYPE;var MAX_CATEGORY_EXAMPLES=10;exports.MAX_CATEGORY_EXAMPLES=MAX_CATEGORY_EXAMPLES;var MAX_INFLUENCER_FIELD_VALUES=10;exports.MAX_INFLUENCER_FIELD_VALUES=MAX_INFLUENCER_FIELD_VALUES;var MAX_INFLUENCER_FIELD_NAMES=50;exports.MAX_INFLUENCER_FIELD_NAMES=MAX_INFLUENCER_FIELD_NAMES;var VIEW_BY_JOB_LABEL=_i18n.i18n.translate("xpack.ml.explorer.jobIdLabel",{defaultMessage:"job ID"});exports.VIEW_BY_JOB_LABEL=VIEW_BY_JOB_LABEL},,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WIZARD_TYPE=exports.EVENT_RATE_COUNT_FIELD=void 0;var EVENT_RATE_COUNT_FIELD="__ml_event_rate_count__";exports.EVENT_RATE_COUNT_FIELD=EVENT_RATE_COUNT_FIELD;var WIZARD_TYPE={SINGLE_METRIC:"single-metric-wizard",MULTI_METRIC:"multi-metric-wizard",POPULATION:"population-wizard"};exports.WIZARD_TYPE=WIZARD_TYPE},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlChartTooltipService=void 0;var _jquery=_interopRequireDefault(__webpack_require__(21));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var doc=document.documentElement;var FADE_TIMEOUT_MS=200;var mlChartTooltipService={element:null,fadeTimeout:null,visible:false};exports.mlChartTooltipService=mlChartTooltipService;mlChartTooltipService.show=function(contents,target){var offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{x:0,y:0};if(this.element===null||typeof target==="undefined"){return}this.visible=true;if(this.fadeTimeout!==null){clearTimeout(this.fadeTimeout)}this.element.html(contents);var navOffset=(0,_jquery.default)(".euiNavDrawer").width()||0;var contentWidth=(0,_jquery.default)("body").width()-navOffset;var tooltipWidth=this.element.width();var pos=target.getBoundingClientRect();var left=pos.left+offset.x+4-navOffset;if(left+tooltipWidth>contentWidth){var markerWidthAdjustment=22;left=left-(tooltipWidth+offset.x+markerWidthAdjustment)}var scrollTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0);var topNavHeightAdjustment=75;var top=pos.top+offset.y+scrollTop-topNavHeightAdjustment;this.element.css({left:left,top:top,opacity:"0.9",display:"block"})};mlChartTooltipService.hide=function(){var _this=this;if(this.element===null){return}this.visible=false;this.element.css({opacity:"0"});this.fadeTimeout=setTimeout(function(){if(_this.visible===false){_this.element.css("display","none")}_this.fadeTimeout=null},FADE_TIMEOUT_MS)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.http=http;var _chrome=_interopRequireDefault(__webpack_require__(9));var _system_api=__webpack_require__(654);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function http(options){return new Promise(function(resolve,reject){if(options&&options.url){var url="";url=url+(options.url||"");var headers=(0,_system_api.addSystemApiHeader)(_objectSpread({"Content-Type":"application/json","kbn-version":_chrome.default.getXsrfToken()},options.headers));var allHeaders=options.headers===undefined?headers:_objectSpread({},options.headers,headers);var body=options.data===undefined?null:JSON.stringify(options.data);var payload={method:options.method||"GET",headers:allHeaders,credentials:"same-origin"};if(body!==null){payload.body=body}fetch(url,payload).then(function(resp){resp.json().then(resp.ok===true?resolve:reject)}).catch(function(resp){reject(resp)})}else{reject()}})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getJobManagementBreadcrumbs=getJobManagementBreadcrumbs;exports.getCreateJobBreadcrumbs=getCreateJobBreadcrumbs;exports.getCreateSingleMetricJobBreadcrumbs=getCreateSingleMetricJobBreadcrumbs;exports.getCreateMultiMetricJobBreadcrumbs=getCreateMultiMetricJobBreadcrumbs;exports.getCreatePopulationJobBreadcrumbs=getCreatePopulationJobBreadcrumbs;exports.getAdvancedJobConfigurationBreadcrumbs=getAdvancedJobConfigurationBreadcrumbs;exports.getCreateRecognizerJobBreadcrumbs=getCreateRecognizerJobBreadcrumbs;exports.getDataVisualizerIndexOrSearchBreadcrumbs=getDataVisualizerIndexOrSearchBreadcrumbs;var _breadcrumbs=__webpack_require__(432);var _i18n=__webpack_require__(4);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getJobManagementBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}function getCreateJobBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.createJobLabel",{defaultMessage:"Create job"}),href:"#/jobs/new_job"}]}function getCreateSingleMetricJobBreadcrumbs(){return[].concat(_toConsumableArray(getCreateJobBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.singleMetricLabel",{defaultMessage:"Single metric"}),href:""}])}function getCreateMultiMetricJobBreadcrumbs(){return[].concat(_toConsumableArray(getCreateJobBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.multiMetricLabel",{defaultMessage:"Multi metric"}),href:""}])}function getCreatePopulationJobBreadcrumbs(){return[].concat(_toConsumableArray(getCreateJobBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.populationLabel",{defaultMessage:"Population"}),href:""}])}function getAdvancedJobConfigurationBreadcrumbs(){return[].concat(_toConsumableArray(getCreateJobBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.advancedConfigurationLabel",{defaultMessage:"Advanced configuration"}),href:""}])}function getCreateRecognizerJobBreadcrumbs($routeParams){return[].concat(_toConsumableArray(getCreateJobBreadcrumbs()),[{text:$routeParams.id,href:""}])}function getDataVisualizerIndexOrSearchBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabel",{defaultMessage:"Select index or search"}),href:""}]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectSeverity=exports.severity$=exports.SEVERITY_OPTIONS=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);var _rxjs=__webpack_require__(30);var _eui=__webpack_require__(1);var _anomaly_utils=__webpack_require__(293);var _observable_utils=__webpack_require__(434);var _optionsMap;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var warningLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.warningLabel",{defaultMessage:"warning"});var minorLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.minorLabel",{defaultMessage:"minor"});var majorLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.majorLabel",{defaultMessage:"major"});var criticalLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.criticalLabel",{defaultMessage:"critical"});var optionsMap=(_optionsMap={},_defineProperty(_optionsMap,warningLabel,0),_defineProperty(_optionsMap,minorLabel,25),_defineProperty(_optionsMap,majorLabel,50),_defineProperty(_optionsMap,criticalLabel,75),_optionsMap);var SEVERITY_OPTIONS=[{val:0,display:warningLabel,color:(0,_anomaly_utils.getSeverityColor)(0)},{val:25,display:minorLabel,color:(0,_anomaly_utils.getSeverityColor)(25)},{val:50,display:majorLabel,color:(0,_anomaly_utils.getSeverityColor)(50)},{val:75,display:criticalLabel,color:(0,_anomaly_utils.getSeverityColor)(75)}];exports.SEVERITY_OPTIONS=SEVERITY_OPTIONS;function optionValueToThreshold(value){var threshold=SEVERITY_OPTIONS.find(function(opt){return opt.val===value});if(threshold===undefined){threshold=SEVERITY_OPTIONS[0]}return threshold}var severity$=new _rxjs.BehaviorSubject(SEVERITY_OPTIONS[0]);exports.severity$=severity$;var SelectSeverityUnwrapped=function(_Component){_inherits(SelectSeverityUnwrapped,_Component);function SelectSeverityUnwrapped(){var _getPrototypeOf2;var _this;_classCallCheck(this,SelectSeverityUnwrapped);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(SelectSeverityUnwrapped)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"onChange",function(valueDisplay){var threshold=optionValueToThreshold(optionsMap[valueDisplay]);severity$.next(threshold)});_defineProperty(_assertThisInitialized(_this),"getOptions",function(){return SEVERITY_OPTIONS.map(function(_ref){var color=_ref.color,display=_ref.display,val=_ref.val;return{value:display,inputDisplay:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display)),dropdownDisplay:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement("p",{className:"euiTextColor--subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.controls.selectSeverity.scoreDetailsDescription",defaultMessage:"score {value} and above",values:{value:val}}))))}})});return _this}_createClass(SelectSeverityUnwrapped,[{key:"render",value:function render(){var severity=this.props.severity;var options=this.getOptions();return _react.default.createElement(_eui.EuiSuperSelect,{className:this.props.classNames,hasDividers:true,options:options,valueOfSelected:severity.display,onChange:this.onChange})}}]);return SelectSeverityUnwrapped}(_react.Component);SelectSeverityUnwrapped.propTypes={classNames:_propTypes.default.string};SelectSeverityUnwrapped.defaultProps={classNames:""};var SelectSeverity=(0,_observable_utils.injectObservablesAsProps)({severity:severity$},SelectSeverityUnwrapped);exports.SelectSeverity=SelectSeverity},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldTypeIcon",{enumerable:true,get:function get(){return _field_type_icon.FieldTypeIcon}});__webpack_require__(2888);var _field_type_icon=__webpack_require__(1361)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ML_BREADCRUMB=void 0;var _i18n=__webpack_require__(4);var ML_BREADCRUMB=Object.freeze({text:_i18n.i18n.translate("xpack.ml.machineLearningBreadcrumbLabel",{defaultMessage:"Machine Learning"}),href:"#/"});exports.ML_BREADCRUMB=ML_BREADCRUMB},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadFullJob=loadFullJob;exports.isStartable=isStartable;exports.isStoppable=isStoppable;exports.isClosable=isClosable;exports.forceStartDatafeeds=forceStartDatafeeds;exports.stopDatafeeds=stopDatafeeds;exports.cloneJob=cloneJob;exports.closeJobs=closeJobs;exports.deleteJobs=deleteJobs;exports.filterJobs=filterJobs;exports.checkForAutoStartDatafeed=checkForAutoStartDatafeed;var _lodash=__webpack_require__(3);var _notify=__webpack_require__(14);var _messagebar_service=__webpack_require__(268);var _job_service=__webpack_require__(36);var _ml_api_service=__webpack_require__(24);var _states=__webpack_require__(573);var _i18n=__webpack_require__(4);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function loadFullJob(jobId){return new Promise(function(resolve,reject){_ml_api_service.ml.jobs.jobs(jobId).then(function(jobs){if(jobs.length){resolve(jobs[0])}else{throw new Error("Could not find job ".concat(jobId))}}).catch(function(error){reject(error)})})}function isStartable(jobs){return jobs.some(function(j){return j.datafeedState===_states.DATAFEED_STATE.STOPPED})}function isStoppable(jobs){return jobs.some(function(j){return j.datafeedState===_states.DATAFEED_STATE.STARTED})}function isClosable(jobs){return jobs.some(function(j){return j.datafeedState===_states.DATAFEED_STATE.STOPPED&&j.jobState!==_states.JOB_STATE.CLOSED})}function forceStartDatafeeds(jobs,start,end){var finish=arguments.length>3&&arguments[3]!==undefined?arguments[3]:function(){};var datafeedIds=jobs.filter(function(j){return j.hasDatafeed}).map(function(j){return j.datafeedId});_job_service.mlJobService.forceStartDatafeeds(datafeedIds,start,end).then(function(resp){showResults(resp,_states.DATAFEED_STATE.STARTED);finish()}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.startJobErrorMessage",{defaultMessage:"Jobs failed to start"}),error);finish()})}function stopDatafeeds(jobs){var finish=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var datafeedIds=jobs.filter(function(j){return j.hasDatafeed}).map(function(j){return j.datafeedId});_job_service.mlJobService.stopDatafeeds(datafeedIds).then(function(resp){showResults(resp,_states.DATAFEED_STATE.STOPPED);finish()}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.stopJobErrorMessage",{defaultMessage:"Jobs failed to stop"}),error);finish()})}function showResults(resp,action){var successes=[];var failures=[];for(var d in resp){if(resp[d][action]===true||resp[d][action]===false&&resp[d].error.statusCode===409&&action===_states.DATAFEED_STATE.STARTED){successes.push(d)}else{failures.push({id:d,result:resp[d]})}}var actionText="";var actionTextPT="";if(action===_states.DATAFEED_STATE.STARTED){actionText=_i18n.i18n.translate("xpack.ml.jobsList.startActionStatusText",{defaultMessage:"start"});actionTextPT=_i18n.i18n.translate("xpack.ml.jobsList.startedActionStatusText",{defaultMessage:"started"})}else if(action===_states.DATAFEED_STATE.STOPPED){actionText=_i18n.i18n.translate("xpack.ml.jobsList.stopActionStatusText",{defaultMessage:"stop"});actionTextPT=_i18n.i18n.translate("xpack.ml.jobsList.stoppedActionStatusText",{defaultMessage:"stopped"})}else if(action===_states.DATAFEED_STATE.DELETED){actionText=_i18n.i18n.translate("xpack.ml.jobsList.deleteActionStatusText",{defaultMessage:"delete"});actionTextPT=_i18n.i18n.translate("xpack.ml.jobsList.deletedActionStatusText",{defaultMessage:"deleted"})}else if(action===_states.JOB_STATE.CLOSED){actionText=_i18n.i18n.translate("xpack.ml.jobsList.closeActionStatusText",{defaultMessage:"close"});actionTextPT=_i18n.i18n.translate("xpack.ml.jobsList.closedActionStatusText",{defaultMessage:"closed"})}_notify.toastNotifications.addSuccess(_i18n.i18n.translate("xpack.ml.jobsList.actionExecuteSuccessfullyNotificationMessage",{defaultMessage:"{successesJobsCount, plural, one{{successJob}} other{# jobs}} {actionTextPT} successfully",values:{successesJobsCount:successes.length,successJob:successes[0],actionTextPT:actionTextPT}}));if(failures.length>0){failures.forEach(function(f){_messagebar_service.mlMessageBarService.notify.error(f.result.error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.actionFailedNotificationMessage",{defaultMessage:"{failureId} failed to {actionText}",values:{failureId:f.id,actionText:actionText}}))})}}function cloneJob(jobId){loadFullJob(jobId).then(function(job){_job_service.mlJobService.currentJob=job;window.location.href="#/jobs/new_job"}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.cloneJobErrorMessage",{defaultMessage:"Could not clone {jobId}. Job could not be found",values:{jobId:jobId}}))})}function closeJobs(jobs){var finish=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var jobIds=jobs.map(function(j){return j.id});_job_service.mlJobService.closeJobs(jobIds).then(function(resp){showResults(resp,_states.JOB_STATE.CLOSED);finish()}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.closeJobErrorMessage",{defaultMessage:"Jobs failed to close"}),error);finish()})}function deleteJobs(jobs){var finish=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var jobIds=jobs.map(function(j){return j.id});_job_service.mlJobService.deleteJobs(jobIds).then(function(resp){showResults(resp,_states.JOB_STATE.DELETED);finish()}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.jobsList.deleteJobErrorMessage",{defaultMessage:"Jobs failed to delete"}),error);finish()})}function filterJobs(jobs,clauses){if(clauses.length===0){return jobs}var matches=jobs.reduce(function(p,c){p[c.id]={job:c,count:0};return p},{});clauses.forEach(function(c){var bool=c.match==="must";var js=[];if(c.type==="term"){if(bool===true){js=jobs.filter(function(job){return stringMatch(job.id,c.value)===bool||stringMatch(job.description,c.value)===bool||stringMatch(job.memory_status,c.value)===bool})}else{js=jobs.filter(function(job){return stringMatch(job.id,c.value)===bool&&stringMatch(job.description,c.value)===bool&&stringMatch(job.memory_status,c.value)===bool})}}else{if(Array.isArray(c.value)){js=jobs.filter(function(job){return jobProperty(job,c.field).some(function(g){return c.value.indexOf(g)>=0})})}else{js=jobs.filter(function(job){return jobProperty(job,c.field)===c.value})}}js.forEach(function(j){return matches[j.id].count++})});var filteredJobs=[];(0,_lodash.each)(matches,function(m){if(m.count>=clauses.length){filteredJobs.push(m.job)}});return filteredJobs}function checkForAutoStartDatafeed(){var job=_job_service.mlJobService.currentJob;if(job!==undefined){_job_service.mlJobService.currentJob=undefined;var hasDatafeed=_typeof(job.datafeed_config)==="object"&&Object.keys(job.datafeed_config).length>0;var datafeedId=hasDatafeed?job.datafeed_config.datafeed_id:"";return{id:job.job_id,hasDatafeed:hasDatafeed,latestTimestampSortValue:0,datafeedId:datafeedId}}}function stringMatch(str,substr){return typeof str==="string"&&typeof substr==="string"&&str.toLowerCase().match(substr.toLowerCase())===null===false}function jobProperty(job,prop){var propMap={job_state:"jobState",datafeed_state:"datafeedState",groups:"groups"};return job[propMap[prop]]}},function(module,exports,__webpack_require__){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));function injectObservablesAsProps(observables,WrappedComponent){var observableKeys=Object.keys(observables);var ObservableComponent=function(_react_1$Component){_inherits(ObservableComponent,_react_1$Component);function ObservableComponent(){var _this;_classCallCheck(this,ObservableComponent);_this=_possibleConstructorReturn(this,_getPrototypeOf(ObservableComponent).apply(this,arguments));_this.state=observableKeys.reduce(function(reducedState,key){reducedState[key]=observables[key].value;return reducedState},{});_this.subscriptions={};return _this}_createClass(ObservableComponent,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;observableKeys.forEach(function(k){_this2.subscriptions[k]=observables[k].subscribe(function(v){return _this2.setState(_defineProperty({},k,v))})})}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this3=this;Object.keys(this.subscriptions).forEach(function(key){return _this3.subscriptions[key].unsubscribe()})}},{key:"render",value:function render(){return react_1.default.createElement(WrappedComponent,Object.assign({},this.props,this.state),this.props.children)}}]);return ObservableComponent}(react_1.Component);return ObservableComponent}exports.injectObservablesAsProps=injectObservablesAsProps},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CONDITIONS_NOT_SUPPORTED_FUNCTIONS=exports.OPERATOR=exports.APPLIES_TO=exports.FILTER_TYPE=exports.ACTION=void 0;var ACTION={SKIP_MODEL_UPDATE:"skip_model_update",SKIP_RESULT:"skip_result"};exports.ACTION=ACTION;var FILTER_TYPE={EXCLUDE:"exclude",INCLUDE:"include"};exports.FILTER_TYPE=FILTER_TYPE;var APPLIES_TO={ACTUAL:"actual",DIFF_FROM_TYPICAL:"diff_from_typical",TYPICAL:"typical"};exports.APPLIES_TO=APPLIES_TO;var OPERATOR={LESS_THAN:"lt",LESS_THAN_OR_EQUAL:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL:"gte"};exports.OPERATOR=OPERATOR;var CONDITIONS_NOT_SUPPORTED_FUNCTIONS=["freq_rare","lat_long","metric","rare"];exports.CONDITIONS_NOT_SUPPORTED_FUNCTIONS=CONDITIONS_NOT_SUPPORTED_FUNCTIONS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlResultsService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _job_utils=__webpack_require__(58);var _string_utils=__webpack_require__(67);var _index_patterns=__webpack_require__(497);var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getScoresByBucket(jobIds,earliestMs,latestMs,interval,maxResults){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:bucket",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{jobId:{terms:{field:"job_id",size:maxResults!==undefined?maxResults:5,order:{anomalyScore:"desc"}},aggs:{anomalyScore:{max:{field:"anomaly_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1,extended_bounds:{min:earliestMs,max:latestMs}},aggs:{anomalyScore:{max:{field:"anomaly_score"}}}}}}}}}).then(function(resp){var dataByJobId=_lodash.default.get(resp,["aggregations","jobId","buckets"],[]);_lodash.default.each(dataByJobId,function(dataForJob){var jobId=dataForJob.key;var resultsForTime={};var dataByTime=_lodash.default.get(dataForJob,["byTime","buckets"],[]);_lodash.default.each(dataByTime,function(dataForTime){var value=_lodash.default.get(dataForTime,["anomalyScore","value"]);if(value!==undefined){var time=dataForTime.key;resultsForTime[time]=_lodash.default.get(dataForTime,["anomalyScore","value"])}});obj.results[jobId]=resultsForTime});resolve(obj)}).catch(function(resp){reject(resp)})})}function getScheduledEventsByBucket(jobIds,earliestMs,latestMs,interval,maxJobs,maxEvents){return new Promise(function(resolve,reject){var obj={success:true,events:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{exists:{field:"scheduled_events"}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){jobIdFilterStr+="".concat(i>0?" OR ":"","job_id:").concat(jobId)});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:bucket",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{jobs:{terms:{field:"job_id",min_doc_count:1,size:maxJobs},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{events:{terms:{field:"scheduled_events",size:maxEvents}}}}}}}}}).then(function(resp){var dataByJobId=_lodash.default.get(resp,["aggregations","jobs","buckets"],[]);_lodash.default.each(dataByJobId,function(dataForJob){var jobId=dataForJob.key;var resultsForTime={};var dataByTime=_lodash.default.get(dataForJob,["times","buckets"],[]);_lodash.default.each(dataByTime,function(dataForTime){var time=dataForTime.key;var events=_lodash.default.get(dataForTime,["events","buckets"]);resultsForTime[time]=_lodash.default.map(events,"key")});obj.events[jobId]=resultsForTime});resolve(obj)}).catch(function(resp){reject(resp)})})}function getTopInfluencers(jobIds,earliestMs,latestMs){var maxFieldValues=arguments.length>3&&arguments[3]!==undefined?arguments[3]:10;var influencers=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];var influencersFilterQuery=arguments.length>5?arguments[5]:undefined;return new Promise(function(resolve,reject){var obj={success:true,influencers:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{influencer_score:{gt:0}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencers.length>0){boolCriteria.push({bool:{should:influencers.map(function(influencer){return{bool:{must:[{term:{influencer_field_name:influencer.fieldName}},{term:{influencer_field_value:influencer.fieldValue}}]}}}),minimum_should_match:1}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldNames:{terms:{field:"influencer_field_name",size:5,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},influencerFieldValues:{terms:{field:"influencer_field_value",size:maxFieldValues,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},sumAnomalyScore:{sum:{field:"influencer_score"}}}}}}}}}).then(function(resp){var fieldNameBuckets=_lodash.default.get(resp,["aggregations","influencerFieldNames","buckets"],[]);_lodash.default.each(fieldNameBuckets,function(nameBucket){var fieldName=nameBucket.key;var fieldValues=[];var fieldValueBuckets=_lodash.default.get(nameBucket,["influencerFieldValues","buckets"],[]);_lodash.default.each(fieldValueBuckets,function(valueBucket){var fieldValueResult={influencerFieldValue:valueBucket.key,maxAnomalyScore:valueBucket.maxAnomalyScore.value,sumAnomalyScore:valueBucket.sumAnomalyScore.value};fieldValues.push(fieldValueResult)});obj.influencers[fieldName]=fieldValues});resolve(obj)}).catch(function(resp){reject(resp)})})}function getTopInfluencerValues(jobIds,influencerFieldName,earliestMs,latestMs,maxResults){return new Promise(function(resolve,reject){var obj={success:true,results:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer AND influencer_field_name: ".concat((0,_string_utils.escapeForElasticsearchQuery)(influencerFieldName)),analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldValues:{terms:{field:"influencer_field_value",size:maxResults!==undefined?maxResults:2,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},sumAnomalyScore:{sum:{field:"influencer_score"}}}}}}}).then(function(resp){var buckets=_lodash.default.get(resp,["aggregations","influencerFieldValues","buckets"],[]);_lodash.default.each(buckets,function(bucket){var result={influencerFieldValue:bucket.key,maxAnomalyScore:bucket.maxAnomalyScore.value,sumAnomalyScore:bucket.sumAnomalyScore.value};obj.results.push(result)});resolve(obj)}).catch(function(resp){reject(resp)})})}function getOverallBucketScores(jobIds,topN,earliestMs,latestMs,interval){return new Promise(function(resolve,reject){var obj={success:true,results:{}};_ml_api_service.ml.overallBuckets({jobId:jobIds,topN:topN,bucketSpan:interval,start:earliestMs,end:latestMs}).then(function(resp){var dataByTime=_lodash.default.get(resp,["overall_buckets"],[]);_lodash.default.each(dataByTime,function(dataForTime){var value=_lodash.default.get(dataForTime,["overall_score"]);if(value!==undefined){obj.results[dataForTime.timestamp]=value}});resolve(obj)}).catch(function(resp){reject(resp)})})}function getInfluencerValueMaxScoreByTime(jobIds,influencerFieldName,influencerFieldValues,earliestMs,latestMs,interval,maxResults,influencersFilterQuery){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{influencer_score:{gt:0}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:".concat(jobId)});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencerFieldValues&&influencerFieldValues.length>0){var influencerFilterStr="";_lodash.default.each(influencerFieldValues,function(value,i){if(i>0){influencerFilterStr+=" OR "}if(value.trim().length>0){influencerFilterStr+="influencer_field_value:".concat((0,_string_utils.escapeForElasticsearchQuery)(value))}else{influencerFilterStr+='influencer_field_value:"'.concat(value,'"')}});boolCriteria.push({query_string:{analyze_wildcard:false,query:influencerFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer AND influencer_field_name: ".concat((0,_string_utils.escapeForElasticsearchQuery)(influencerFieldName)),analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldValues:{terms:{field:"influencer_field_value",size:maxResults!==undefined?maxResults:10,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}}}}}}}}}).then(function(resp){var fieldValueBuckets=_lodash.default.get(resp,["aggregations","influencerFieldValues","buckets"],[]);_lodash.default.each(fieldValueBuckets,function(valueBucket){var fieldValue=valueBucket.key;var fieldValues={};var timeBuckets=_lodash.default.get(valueBucket,["byTime","buckets"],[]);_lodash.default.each(timeBuckets,function(timeBucket){var time=timeBucket.key;var score=timeBucket.maxAnomalyScore.value;fieldValues[time]=score});obj.results[fieldValue]=fieldValues});resolve(obj)}).catch(function(resp){reject(resp)})})}function getRecordInfluencers(jobIds,threshold,earliestMs,latestMs,maxResults){return new Promise(function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{nested:{path:"influencers",query:{bool:{must:[{exists:{field:"influencers"}}]}}}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{_source:["job_id","detector_index","influencers","record_score"],query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then(function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,function(hit){obj.records.push(hit._source)})}resolve(obj)}).catch(function(resp){reject(resp)})})}function getRecordsForInfluencer(jobIds,influencers,threshold,earliestMs,latestMs,maxResults,influencersFilterQuery){return new Promise(function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencers.length>0){boolCriteria.push({bool:{should:influencers.map(function(influencer){return{nested:{path:"influencers",query:{bool:{must:[{match:{"influencers.influencer_field_name":influencer.fieldName}},{match:{"influencers.influencer_field_values":influencer.fieldValue}}]}}}}}),minimum_should_match:1}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then(function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,function(hit){obj.records.push(hit._source)})}resolve(obj)}).catch(function(resp){reject(resp)})})}function getRecordsForDetector(jobId,detectorIndex,checkForInfluencers,influencerFieldName,influencerFieldValue,threshold,earliestMs,latestMs,maxResults){return new Promise(function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{term:{job_id:jobId}},{term:{detector_index:detectorIndex}},{range:{record_score:{gte:threshold}}}];if(influencerFieldName&&influencerFieldValue){boolCriteria.push({nested:{path:"influencers",query:{bool:{must:[{match:{"influencers.influencer_field_name":influencerFieldName}},{match:{"influencers.influencer_field_values":influencerFieldValue}}]}}}})}else{if(checkForInfluencers===true){boolCriteria.push({nested:{path:"influencers",query:{bool:{must:[{exists:{field:"influencers"}}]}}}})}}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then(function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,function(hit){obj.records.push(hit._source)})}resolve(obj)}).catch(function(resp){reject(resp)})})}function getRecords(jobIds,threshold,earliestMs,latestMs,maxResults){return this.getRecordsForInfluencer(jobIds,[],threshold,earliestMs,latestMs,maxResults)}function getRecordsForCriteria(jobIds,criteriaFields,threshold,earliestMs,latestMs,maxResults){return new Promise(function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId});boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_lodash.default.each(criteriaFields,function(criteria){boolCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})});_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,rest_total_hits_as_int:true,size:maxResults!==undefined?maxResults:100,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then(function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,function(hit){obj.records.push(hit._source)})}resolve(obj)}).catch(function(resp){reject(resp)})})}function getMetricData(index,entityFields,query,metricFunction,metricFieldName,timeFieldName,earliestMs,latestMs,interval){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var mustCriteria=[];var shouldCriteria=[];mustCriteria.push({range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})});if(query){mustCriteria.push(query)}_lodash.default.each(entityFields,function(entity){if(entity.fieldValue.length!==0){mustCriteria.push({term:_defineProperty({},entity.fieldName,entity.fieldValue)})}else{shouldCriteria.push({bool:{must:[{term:_defineProperty({},entity.fieldName,"")}]}});shouldCriteria.push({bool:{must_not:[{exists:{field:entity.fieldName}}]}})}});var body={query:{bool:{must:mustCriteria}},size:0,_source:{excludes:[]},aggs:{byTime:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:0}}}};if(shouldCriteria.length>0){body.query.bool.should=shouldCriteria;body.query.bool.minimum_should_match=shouldCriteria.length/2}if(metricFieldName!==undefined&&metricFieldName!==""){body.aggs.byTime.aggs={};var metricAgg=_defineProperty({},metricFunction,{field:metricFieldName});if(metricFunction==="percentiles"){metricAgg[metricFunction].percents=[_job_utils.ML_MEDIAN_PERCENTS]}body.aggs.byTime.aggs.metric=metricAgg}_ml_api_service.ml.esSearch({index:index,body:body}).then(function(resp){var dataByTime=_lodash.default.get(resp,["aggregations","byTime","buckets"],[]);_lodash.default.each(dataByTime,function(dataForTime){if(metricFunction==="count"){obj.results[dataForTime.key]=dataForTime.doc_count}else{var value=_lodash.default.get(dataForTime,["metric","value"]);var values=_lodash.default.get(dataForTime,["metric","values"]);if(dataForTime.doc_count===0){obj.results[dataForTime.key]=null}else if(value!==undefined){obj.results[dataForTime.key]=value}else if(values!==undefined){var medianValues=values[_job_utils.ML_MEDIAN_PERCENTS];obj.results[dataForTime.key]=!isNaN(medianValues)?medianValues:null}else{obj.results[dataForTime.key]=null}}});resolve(obj)}).catch(function(resp){reject(resp)})})}function getEventRateData(index,query,timeFieldName,earliestMs,latestMs,interval){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var mustCriteria=[{range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})}];if(query){mustCriteria.push(query)}_ml_api_service.ml.esSearch({index:index,rest_total_hits_as_int:true,size:0,body:{query:{bool:{must:mustCriteria}},_source:{excludes:[]},aggs:{eventRate:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:0,extended_bounds:{min:earliestMs,max:latestMs}}}}}}).then(function(resp){var dataByTimeBucket=_lodash.default.get(resp,["aggregations","eventRate","buckets"],[]);_lodash.default.each(dataByTimeBucket,function(dataForTime){var time=dataForTime.key;obj.results[time]=dataForTime.doc_count});obj.total=resp.hits.total;resolve(obj)}).catch(function(resp){reject(resp)})})}var SAMPLER_TOP_TERMS_SHARD_SIZE=2e4;var ENTITY_AGGREGATION_SIZE=10;var AGGREGATION_MIN_DOC_COUNT=1;var CARDINALITY_PRECISION_THRESHOLD=100;function getEventDistributionData(index,splitField){var filterField=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var query=arguments.length>3?arguments[3]:undefined;var metricFunction=arguments.length>4?arguments[4]:undefined;var metricFieldName=arguments.length>5?arguments[5]:undefined;var timeFieldName=arguments.length>6?arguments[6]:undefined;var earliestMs=arguments.length>7?arguments[7]:undefined;var latestMs=arguments.length>8?arguments[8]:undefined;var interval=arguments.length>9?arguments[9]:undefined;return new Promise(function(resolve,reject){if(splitField===undefined){return resolve([])}var mustCriteria=[];mustCriteria.push({range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})});if(query){mustCriteria.push(query)}if(filterField!==null){mustCriteria.push({term:_defineProperty({},filterField.fieldName,filterField.fieldValue)})}var body={query:{function_score:{query:{bool:{must:mustCriteria}},functions:[{random_score:{seed:10,field:"_seq_no"}}]}},size:0,_source:{excludes:[]},aggs:{sample:{sampler:{shard_size:SAMPLER_TOP_TERMS_SHARD_SIZE},aggs:{byTime:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:AGGREGATION_MIN_DOC_COUNT},aggs:{entities:{terms:{field:splitField.fieldName,size:ENTITY_AGGREGATION_SIZE,min_doc_count:AGGREGATION_MIN_DOC_COUNT}}}}}}}};if(metricFieldName!==undefined&&metricFieldName!==""){body.aggs.sample.aggs.byTime.aggs.entities.aggs={};var metricAgg=_defineProperty({},metricFunction,{field:metricFieldName});if(metricFunction==="percentiles"){metricAgg[metricFunction].percents=[_job_utils.ML_MEDIAN_PERCENTS]}if(metricFunction==="cardinality"){metricAgg[metricFunction].precision_threshold=CARDINALITY_PRECISION_THRESHOLD}body.aggs.sample.aggs.byTime.aggs.entities.aggs.metric=metricAgg}_ml_api_service.ml.esSearch({index:index,body:body,rest_total_hits_as_int:true}).then(function(resp){var totalHits=_lodash.default.get(resp,["hits","total"],0);var successfulShards=_lodash.default.get(resp,["_shards","successful"],0);var normalizeFactor=1;if(totalHits>successfulShards*SAMPLER_TOP_TERMS_SHARD_SIZE){normalizeFactor=totalHits/(successfulShards*SAMPLER_TOP_TERMS_SHARD_SIZE)}var dataByTime=_lodash.default.get(resp,["aggregations","sample","byTime","buckets"],[]);var data=dataByTime.reduce(function(d,dataForTime){var date=+dataForTime.key;var entities=_lodash.default.get(dataForTime,["entities","buckets"],[]);entities.forEach(function(entity){var value=metricFunction==="count"?entity.doc_count:entity.metric.value;if(metricFunction==="count"||metricFunction==="cardinality"||metricFunction==="sum"){value=value*normalizeFactor}d.push({date:date,entity:entity.key,value:value})});return d},[]);resolve(data)}).catch(function(resp){reject(resp)})})}function getModelPlotOutput(jobId,detectorIndex,criteriaFields,earliestMs,latestMs,interval,aggType){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var modelAggs=aggType===undefined?{max:"max",min:"min"}:{max:aggType.max,min:aggType.min};var mustCriteria=[{term:{job_id:jobId}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];_lodash.default.each(criteriaFields,function(criteria){mustCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})});var shouldCriteria=[{term:{detector_index:detectorIndex}},{bool:{must_not:[{exists:{field:"detector_index"}}]}}];_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:model_plot",analyze_wildcard:true}},{bool:{must:mustCriteria,should:shouldCriteria,minimum_should_match:1}}]}},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:0},aggs:{actual:{avg:{field:"actual"}},modelUpper:_defineProperty({},modelAggs.max,{field:"model_upper"}),modelLower:_defineProperty({},modelAggs.min,{field:"model_lower"})}}}}}).then(function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,function(dataForTime){var time=dataForTime.key;var modelUpper=_lodash.default.get(dataForTime,["modelUpper","value"]);var modelLower=_lodash.default.get(dataForTime,["modelLower","value"]);var actual=_lodash.default.get(dataForTime,["actual","value"]);if(modelUpper===undefined||isFinite(modelUpper)===false){modelUpper=null}if(modelLower===undefined||isFinite(modelLower)===false){modelLower=null}obj.results[time]={actual:actual,modelUpper:modelUpper,modelLower:modelLower}});resolve(obj)}).catch(function(resp){reject(resp)})})}function getRecordMaxScoreByTime(jobId,criteriaFields,earliestMs,latestMs,interval){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var mustCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{term:{job_id:jobId}}];var shouldCriteria=[];_lodash.default.each(criteriaFields,function(criteria){if(criteria.fieldValue.length!==0){mustCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})}else{var emptyFieldCondition={bool:{must:[{term:{}}]}};emptyFieldCondition.bool.must[0].term[criteria.fieldName]="";shouldCriteria.push(emptyFieldCondition);shouldCriteria.push({bool:{must_not:[{exists:{field:criteria.fieldName}}]}})}});_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:true}},{bool:{must:mustCriteria}}]}},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{recordScore:{max:{field:"record_score"}}}}}}}).then(function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,function(dataForTime){var time=dataForTime.key;obj.results[time]={score:_lodash.default.get(dataForTime,["recordScore","value"])}});resolve(obj)}).catch(function(resp){reject(resp)})})}var mlResultsService={getScoresByBucket:getScoresByBucket,getScheduledEventsByBucket:getScheduledEventsByBucket,getTopInfluencers:getTopInfluencers,getTopInfluencerValues:getTopInfluencerValues,getOverallBucketScores:getOverallBucketScores,getInfluencerValueMaxScoreByTime:getInfluencerValueMaxScoreByTime,getRecordInfluencers:getRecordInfluencers,getRecordsForInfluencer:getRecordsForInfluencer,getRecordsForDetector:getRecordsForDetector,getRecords:getRecords,getRecordsForCriteria:getRecordsForCriteria,getMetricData:getMetricData,getEventRateData:getEventRateData,getEventDistributionData:getEventDistributionData,getModelPlotOutput:getModelPlotOutput,getRecordMaxScoreByTime:getRecordMaxScoreByTime};exports.mlResultsService=mlResultsService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatValue=formatValue;var _moment=_interopRequireDefault(__webpack_require__(16));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");var SIGFIGS_IF_ROUNDING=3;function formatValue(value,mlFunction,fieldFormat,record){if(Array.isArray(value)){if(value.length===1){return formatSingleValue(value[0],mlFunction,fieldFormat,record)}else{var values=value.map(function(val){return formatSingleValue(val,mlFunction,fieldFormat,record)});return"[".concat(values,"]")}}else{return formatSingleValue(value,mlFunction,fieldFormat,record)}}function formatSingleValue(value,mlFunction,fieldFormat,record){if(value===undefined||value===null){return""}if(mlFunction==="time_of_week"){var d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;var i=parseInt(value);var utcMoment=_moment.default.utc(d).startOf("week").add(i,"s");return(0,_moment.default)(utcMoment.valueOf()).format("ddd HH:mm")}else if(mlFunction==="time_of_day"){var _d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;var _i=parseInt(value);var _utcMoment=_moment.default.utc(_d).startOf("day").add(_i,"s");return(0,_moment.default)(_utcMoment.valueOf()).format("HH:mm")}else{if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{var absValue=Math.abs(value);if(absValue>=1e4||absValue===Math.floor(absValue)){if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{return Number(value.toFixed(0))}}else if(absValue>=10){return Number(value.toFixed(1))}else{var multiple;if(value>0){multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(value)/Math.LN10)-1)}else{multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(-1*value)/Math.LN10)-1)}return Math.round(value*multiple)/multiple}}}}_module.filter("formatValue",function(){return formatValue})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var rxjs_1=__webpack_require__(30);exports.annotation$=new rxjs_1.BehaviorSubject(null);exports.annotationsRefresh$=new rxjs_1.Subject},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ML_ANNOTATIONS_INDEX_ALIAS_READ=".ml-annotations-read";exports.ML_ANNOTATIONS_INDEX_ALIAS_WRITE=".ml-annotations-write";exports.ML_ANNOTATIONS_INDEX_PATTERN=".ml-annotations-6";exports.ML_RESULTS_INDEX_PATTERN=".ml-anomalies-*";exports.ML_NOTIFICATION_INDEX_PATTERN=".ml-notifications"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.replaceTokensInUrlValue=replaceTokensInUrlValue;exports.getUrlForRecord=getUrlForRecord;exports.openCustomUrlWindow=openCustomUrlWindow;exports.isValidLabel=isValidLabel;exports.isValidTimeRange=isValidTimeRange;var _lodash=_interopRequireDefault(__webpack_require__(3));var _moment=_interopRequireDefault(__webpack_require__(16));var _parse_interval=__webpack_require__(313);var _string_utils=__webpack_require__(67);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TIME_RANGE_AUTO="auto";function replaceTokensInUrlValue(customUrlConfig,jobBucketSpanSecs,doc,timeFieldName){var urlValue=customUrlConfig.url_value;var timestamp=doc[timeFieldName];var timeRangeInterval=(0,_parse_interval.parseInterval)(customUrlConfig.time_range);if(urlValue.includes("$earliest$")){var earliestMoment=(0,_moment.default)(timestamp);if(timeRangeInterval!==null){earliestMoment.subtract(timeRangeInterval)}else{earliestMoment.subtract(jobBucketSpanSecs,"s")}doc.earliest=earliestMoment.toISOString()}if(urlValue.includes("$latest$")){var latestMoment=(0,_moment.default)(timestamp).add(jobBucketSpanSecs,"s");if(timeRangeInterval!==null){latestMoment.add(timeRangeInterval)}else{latestMoment.add(jobBucketSpanSecs,"s")}doc.latest=latestMoment.toISOString()}return getUrlForRecord(customUrlConfig,doc)}function getUrlForRecord(urlConfig,record){if(isKibanaUrl(urlConfig)===true){return buildKibanaUrl(urlConfig,record)}else{var urlPath=(0,_string_utils.replaceStringTokens)(urlConfig.url_value,record,false);return urlPath}}function openCustomUrlWindow(fullUrl,urlConfig){if(isKibanaUrl(urlConfig)===true){window.open(fullUrl,"_blank")}else{var newWindow=window.open(fullUrl,"_blank","noopener,noreferrer");if(newWindow!==undefined&&newWindow!==null){newWindow.opener=null}}}function isKibanaUrl(urlConfig){var urlValue=urlConfig.url_value;return urlValue.startsWith("kibana#/discover")||urlValue.startsWith("kibana#/dashboard")}function buildKibanaUrl(urlConfig,record){var urlValue=urlConfig.url_value;return String(urlValue).replace(/\$([^?&$\'"]{1,40})\$/g,function(match,name){var tokenValue=_lodash.default.get(record,name,null);if(Array.isArray(tokenValue)){tokenValue=tokenValue[0]}if(tokenValue!==null&&!(name==="earliest"||name==="latest")){if(urlValue.includes("language:lucene")===true){tokenValue="".concat((0,_string_utils.escapeForElasticsearchQuery)(tokenValue))}else{tokenValue=tokenValue.replace(/\"/g,'\\"')}tokenValue=tokenValue.replace(/[!']/g,"!$&");tokenValue=encodeURIComponent(tokenValue)}return tokenValue!==null?tokenValue:match})}function isValidLabel(label,savedCustomUrls){var isValid=label!==undefined&&label.trim().length>0;if(isValid===true&&savedCustomUrls!==undefined){var existingLabels=savedCustomUrls.map(function(customUrl){return customUrl.url_name});isValid=!existingLabels.includes(label)}return isValid}function isValidTimeRange(timeRange){if(timeRange===undefined||timeRange.length===0||timeRange===TIME_RANGE_AUTO){return true}var interval=(0,_parse_interval.parseInterval)(timeRange);return interval!==null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlCreateWatchService=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _lodash=_interopRequireDefault(__webpack_require__(3));var _http_service=__webpack_require__(399);var _email=_interopRequireDefault(__webpack_require__(2817));var _emailInfluencers=_interopRequireDefault(__webpack_require__(2818));var _watch=__webpack_require__(2819);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var compiledEmailBody=_lodash.default.template(_email.default);var compiledEmailInfluencersBody=_lodash.default.template(_emailInfluencers.default);var emailSection={send_email:{throttle_period_in_millis:9e5,email:{profile:"standard",to:[],subject:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.mlWatcherAlertSubjectTitle",{defaultMessage:"ML Watcher Alert"}),body:{html:""}}}};function randomNumber(min,max){return Math.floor(Math.random()*(max-min+1)+min)}function saveWatch(watchModel){var basePath=_chrome.default.addBasePath("/api/watcher");var url="".concat(basePath,"/watch/").concat(watchModel.id);return(0,_http_service.http)({url:url,method:"PUT",data:watchModel.upstreamJSON})}var CreateWatchService=function(){function CreateWatchService(){_classCallCheck(this,CreateWatchService);_defineProperty(this,"createNewWatch",function(jobId){var _this=this;return new Promise(function(resolve,reject){_this.status.watch=_this.STATUS.SAVING;if(jobId!==undefined){var id="ml-".concat(jobId);_this.config.id=id;_watch.watch.input.search.request.body.query.bool.filter[0].term.job_id=jobId;_watch.watch.input.search.request.body.query.bool.filter[1].range.timestamp.gte="now-".concat(_this.config.interval);_watch.watch.input.search.request.body.aggs.bucket_results.filter.range.anomaly_score.gte=_this.config.threshold.val;if(_this.config.includeEmail&&_this.config.email!==""){var emails=_this.config.email.split(",");emailSection.send_email.email.to=emails;emailSection.send_email.email.body.html=compiledEmailBody({serverAddress:_chrome.default.getAppUrl(),influencersSection:_this.config.includeInfluencers===true?compiledEmailInfluencersBody({topInfluencersLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.topInfluencersLabel",{defaultMessage:"Top influencers:"})}):"",elasticStackMachineLearningAlertLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.elasticStackMachineLearningAlertLabel",{defaultMessage:"Elastic Stack Machine Learning Alert"}),jobLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.jobLabel",{defaultMessage:"Job"}),timeLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.timeLabel",{defaultMessage:"Time"}),anomalyScoreLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.anomalyScoreLabel",{defaultMessage:"Anomaly score"}),openInAnomalyExplorerLinkText:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.openInAnomalyExplorerLinkText",{defaultMessage:"Click here to open in Anomaly Explorer."}),topRecordsLabel:_i18n.i18n.translate("xpack.ml.newJob.simple.watcher.email.topRecordsLabel",{defaultMessage:"Top records:"})});_watch.watch.actions.send_email=emailSection.send_email}var triggerInterval=randomNumber(60,120);_watch.watch.trigger.schedule.interval="".concat(triggerInterval,"s");var watchModel={id:id,upstreamJSON:{id:id,type:"json",watch:_watch.watch}};if(id!==""){saveWatch(watchModel).then(function(){_this.status.watch=_this.STATUS.SAVED;_this.config.watcherEditURL="".concat(_chrome.default.getBasePath(),"/app/kibana#/management/elasticsearch/watcher/watches/watch/").concat(id,"/edit?_g=()");resolve({id:id,url:_this.config.watcherEditURL})}).catch(function(resp){_this.status.watch=_this.STATUS.SAVE_FAILED;reject(resp)})}}else{_this.status.watch=_this.STATUS.SAVE_FAILED;reject()}})});this.config={};this.STATUS={SAVE_FAILED:-1,SAVING:0,SAVED:1};this.status={realtimeJob:null,watch:null}}_createClass(CreateWatchService,[{key:"reset",value:function reset(){this.status.realtimeJob=null;this.status.watch=null;this.config.id="";this.config.includeEmail=false;this.config.email="";this.config.interval="20m";this.config.watcherEditURL="";this.config.includeInfluencers=false;this.config.threshold={display:"critical",val:75}}},{key:"loadWatch",value:function loadWatch(jobId){var id="ml-".concat(jobId);var basePath=_chrome.default.addBasePath("/api/watcher");var url="".concat(basePath,"/watch/").concat(id);return(0,_http_service.http)({url:url,method:"GET"})}}]);return CreateWatchService}();var mlCreateWatchService=new CreateWatchService;exports.mlCreateWatchService=mlCreateWatchService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFieldTypeFromMapping=getFieldTypeFromMapping;var _lodash=_interopRequireDefault(__webpack_require__(3));var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getFieldTypeFromMapping(index,fieldName){return new Promise(function(resolve,reject){if(index!==""){_ml_api_service.ml.getFieldCaps({index:index,fields:[fieldName]}).then(function(resp){var fieldType="";_lodash.default.each(resp.fields,function(field){_lodash.default.each(field,function(type){if(fieldType===""){fieldType=type.type}})});resolve(fieldType)}).catch(function(error){reject(error)})}else{reject()}})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function dictionaryToArray(dict){return Object.keys(dict).map(function(key){return dict[key]})}exports.dictionaryToArray=dictionaryToArray},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getNewConditionDefaults=getNewConditionDefaults;exports.getNewRuleDefaults=getNewRuleDefaults;exports.getScopeFieldDefaults=getScopeFieldDefaults;exports.isValidRule=isValidRule;exports.saveJobRule=saveJobRule;exports.deleteJobRule=deleteJobRule;exports.updateJobRules=updateJobRules;exports.addItemToFilter=addItemToFilter;exports.buildRuleDescription=buildRuleDescription;exports.filterTypeToText=filterTypeToText;exports.appliesToText=appliesToText;exports.operatorToText=operatorToText;exports.getAppliesToValueFromAnomaly=getAppliesToValueFromAnomaly;var _detector_rule=__webpack_require__(435);var _lodash=__webpack_require__(3);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _i18n=__webpack_require__(4);function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getNewConditionDefaults(){return{applies_to:_detector_rule.APPLIES_TO.ACTUAL,operator:_detector_rule.OPERATOR.LESS_THAN,value:1}}function getNewRuleDefaults(){return{actions:[_detector_rule.ACTION.SKIP_RESULT],conditions:[]}}function getScopeFieldDefaults(filterListIds){var defaults={filter_type:_detector_rule.FILTER_TYPE.INCLUDE,enabled:false};if(filterListIds!==undefined&&filterListIds.length>0){defaults.filter_id=filterListIds[0]}return defaults}function isValidRule(rule){var isValid=false;var actions=rule.actions;if(actions.length>0){var conditions=rule.conditions;if(conditions!==undefined&&conditions.length>0){isValid=true}else{var scope=rule.scope;if(scope!==undefined){isValid=Object.keys(scope).some(function(field){return scope[field].enabled===true})}}}return isValid}function saveJobRule(job,detectorIndex,ruleIndex,editedRule){var detector=job.analysis_config.detectors[detectorIndex];var clonedRule=(0,_lodash.cloneDeep)(editedRule);var scope=clonedRule.scope;if(scope!==undefined){Object.keys(scope).forEach(function(field){if(scope[field].enabled===false){delete scope[field]}else{delete scope[field].enabled}})}var rules=[];if(detector.custom_rules===undefined){rules=[clonedRule]}else{rules=(0,_lodash.cloneDeep)(detector.custom_rules);if(ruleIndex<rules.length){rules[ruleIndex]=clonedRule}else{rules.push(clonedRule)}}return updateJobRules(job,detectorIndex,rules)}function deleteJobRule(job,detectorIndex,ruleIndex){var detector=job.analysis_config.detectors[detectorIndex];var customRules=[];if(detector.custom_rules!==undefined&&ruleIndex<detector.custom_rules.length){customRules=(0,_lodash.cloneDeep)(detector.custom_rules);customRules.splice(ruleIndex,1);return updateJobRules(job,detectorIndex,customRules)}else{return Promise.reject(new Error(_i18n.i18n.translate("xpack.ml.ruleEditor.deleteJobRule.ruleNoLongerExistsErrorMessage",{defaultMessage:"Rule no longer exists for detector index {detectorIndex} in job {jobId}",values:{detectorIndex:detectorIndex,jobId:job.job_id}})))}}function updateJobRules(job,detectorIndex,rules){var jobId=job.job_id;var jobData={detectors:[{detector_index:detectorIndex,custom_rules:rules}]};var customSettings={};if(job.custom_settings!==undefined){customSettings=_objectSpread({},job.custom_settings);delete customSettings.created_by;jobData.custom_settings=customSettings}return new Promise(function(resolve,reject){_job_service.mlJobService.updateJob(jobId,jobData).then(function(resp){if(resp.success){_job_service.mlJobService.refreshJob(jobId).then(function(){resolve({success:true})}).catch(function(refreshResp){reject(refreshResp)})}else{reject(resp)}}).catch(function(resp){reject(resp)})})}function addItemToFilter(item,filterId){return new Promise(function(resolve,reject){_ml_api_service.ml.filters.updateFilter(filterId,undefined,[item],undefined).then(function(updatedFilter){resolve(updatedFilter)}).catch(function(error){reject(error)})})}function buildRuleDescription(rule){var actions=rule.actions,conditions=rule.conditions,scope=rule.scope;var actionsText="";var conditionsText="";var filtersText="";actions.forEach(function(action,i){if(i>0){actionsText+=" AND "}switch(action){case _detector_rule.ACTION.SKIP_RESULT:actionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.resultActionTypeText",{defaultMessage:"result",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText +"+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break;case _detector_rule.ACTION.SKIP_MODEL_UPDATE:actionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.modelUpdateActionTypeText",{defaultMessage:"model update",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break}});if(conditions!==undefined){conditions.forEach(function(condition,i){if(i>0){conditionsText+=" AND "}conditionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.conditionsText",{defaultMessage:"{appliesTo} is {operator} {value}",values:{appliesTo:appliesToText(condition.applies_to),operator:operatorToText(condition.operator),value:condition.value},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})})}if(scope!==undefined){if(conditions!==undefined&&conditions.length>0){filtersText+=" AND "}var fieldNames=Object.keys(scope);fieldNames.forEach(function(fieldName,i){if(i>0){filtersText+=" AND "}var filter=scope[fieldName];filtersText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.filtersText",{defaultMessage:"{fieldName} is {filterType} {filterId}",values:{fieldName:fieldName,filterType:filterTypeToText(filter.filter_type),filterId:filter.filter_id},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})})}return _i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription",{defaultMessage:"skip {actions} when {conditions}{filters}",values:{actions:actionsText,conditions:conditionsText,filters:filtersText},description:"Composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText."+" (Example: skip model update when actual is less than 1 AND ip is in xxx)"})}function filterTypeToText(filterType){switch(filterType){case _detector_rule.FILTER_TYPE.INCLUDE:return _i18n.i18n.translate("xpack.ml.ruleEditor.includeFilterTypeText",{defaultMessage:"in"});case _detector_rule.FILTER_TYPE.EXCLUDE:return _i18n.i18n.translate("xpack.ml.ruleEditor.excludeFilterTypeText",{defaultMessage:"not in"});default:return filterType!==undefined?filterType:""}}function appliesToText(appliesTo){switch(appliesTo){case _detector_rule.APPLIES_TO.ACTUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.actualAppliesTypeText",{defaultMessage:"actual"});case _detector_rule.APPLIES_TO.TYPICAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.typicalAppliesTypeText",{defaultMessage:"typical"});case _detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.diffFromTypicalAppliesTypeText",{defaultMessage:"diff from typical"});default:return appliesTo!==undefined?appliesTo:""}}function operatorToText(operator){switch(operator){case _detector_rule.OPERATOR.LESS_THAN:return _i18n.i18n.translate("xpack.ml.ruleEditor.lessThanOperatorTypeText",{defaultMessage:"less than"});case _detector_rule.OPERATOR.LESS_THAN_OR_EQUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.lessThanOrEqualToOperatorTypeText",{defaultMessage:"less than or equal to"});case _detector_rule.OPERATOR.GREATER_THAN:return _i18n.i18n.translate("xpack.ml.ruleEditor.greaterThanOperatorTypeText",{defaultMessage:"greater than"});case _detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.greaterThanOrEqualToOperatorTypeText",{defaultMessage:"greater than or equal to"});default:return operator!==undefined?operator:""}}function getAppliesToValueFromAnomaly(anomaly,appliesTo){var actualValue;var typicalValue;var actual=anomaly.actual;if(actual!==undefined){actualValue=Array.isArray(actual)?actual[0]:actual}var typical=anomaly.typical;if(typical!==undefined){typicalValue=Array.isArray(typical)?typical[0]:typical}switch(appliesTo){case _detector_rule.APPLIES_TO.ACTUAL:return actualValue;case _detector_rule.APPLIES_TO.TYPICAL:return typicalValue;case _detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL:if(actual!==undefined&&typical!==undefined){return Math.abs(actualValue-typicalValue)}}return undefined}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ALLOWED_DATA_UNITS=exports.SKIP_BUCKET_SPAN_ESTIMATION=exports.VALIDATION_STATUS=void 0;var VALIDATION_STATUS={ERROR:"error",INFO:"info",SUCCESS:"success",WARNING:"warning"};exports.VALIDATION_STATUS=VALIDATION_STATUS;var SKIP_BUCKET_SPAN_ESTIMATION=true;exports.SKIP_BUCKET_SPAN_ESTIMATION=SKIP_BUCKET_SPAN_ESTIMATION;var ALLOWED_DATA_UNITS=["B","KB","MB","GB","TB","PB"];exports.ALLOWED_DATA_UNITS=ALLOWED_DATA_UNITS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JOB_STATE=exports.FORECAST_REQUEST_STATE=exports.DATAFEED_STATE=void 0;var DATAFEED_STATE={STARTED:"started",STARTING:"starting",STOPPED:"stopped",STOPPING:"stopping",DELETED:"deleted"};exports.DATAFEED_STATE=DATAFEED_STATE;var FORECAST_REQUEST_STATE={FAILED:"failed",FINISHED:"finished",SCHEDULED:"scheduled",STARTED:"started"};exports.FORECAST_REQUEST_STATE=FORECAST_REQUEST_STATE;var JOB_STATE={CLOSED:"closed",CLOSING:"closing",FAILED:"failed",OPENED:"opened",OPENING:"opening",DELETED:"deleted"};exports.JOB_STATE=JOB_STATE},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MLJobEditor",{enumerable:true,get:function get(){return _ml_job_editor.MLJobEditor}});Object.defineProperty(exports,"EDITOR_MODE",{enumerable:true,get:function get(){return _ml_job_editor.EDITOR_MODE}});var _ml_job_editor=__webpack_require__(2788)},,function(module,exports,__webpack_require__){"use strict";__webpack_require__(2862)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.kbnTypeToMLJobType=kbnTypeToMLJobType;exports.getMLJobTypeAriaLabel=exports.mlJobTypeAriaLabels=void 0;var _i18n=__webpack_require__(4);var _field_types=__webpack_require__(295);function kbnTypeToMLJobType(field){var type=undefined;switch(field.type){case _field_types.KBN_FIELD_TYPES.STRING:type=field.aggregatable?_field_types.ML_JOB_FIELD_TYPES.KEYWORD:_field_types.ML_JOB_FIELD_TYPES.TEXT;break;case _field_types.KBN_FIELD_TYPES.NUMBER:type=_field_types.ML_JOB_FIELD_TYPES.NUMBER;break;case _field_types.KBN_FIELD_TYPES.DATE:type=_field_types.ML_JOB_FIELD_TYPES.DATE;break;case _field_types.KBN_FIELD_TYPES.IP:type=_field_types.ML_JOB_FIELD_TYPES.IP;break;case _field_types.KBN_FIELD_TYPES.BOOLEAN:type=_field_types.ML_JOB_FIELD_TYPES.BOOLEAN;break;case _field_types.KBN_FIELD_TYPES.GEO_POINT:type=_field_types.ML_JOB_FIELD_TYPES.GEO_POINT;break;default:break}return type}var mlJobTypeAriaLabels={BOOLEAN:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.booleanTypeAriaLabel",{defaultMessage:"boolean type"}),DATE:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.dateTypeAriaLabel",{defaultMessage:"date type"}),GEO_POINT:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.geoPointTypeAriaLabel",{defaultMessage:"{geoPointParam} type",values:{geoPointParam:"geo point"}}),IP:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.ipTypeAriaLabel",{defaultMessage:"ip type"}),KEYWORD:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.keywordTypeAriaLabel",{defaultMessage:"keyword type"}),NUMBER:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.numberTypeAriaLabel",{defaultMessage:"number type"}),TEXT:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.textTypeAriaLabel",{defaultMessage:"text type"}),UNKNOWN:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.unknownTypeAriaLabel",{defaultMessage:"unknown type"})};exports.mlJobTypeAriaLabels=mlJobTypeAriaLabels;var getMLJobTypeAriaLabel=function getMLJobTypeAriaLabel(type){var requestedFieldType=Object.keys(_field_types.ML_JOB_FIELD_TYPES).find(function(k){return _field_types.ML_JOB_FIELD_TYPES[k]===type});return mlJobTypeAriaLabels[requestedFieldType]||null};exports.getMLJobTypeAriaLabel=getMLJobTypeAriaLabel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JOB_STATE=exports.CHART_STATE=void 0;var CHART_STATE={NOT_STARTED:0,LOADING:1,LOADED:2,NO_RESULTS:3};exports.CHART_STATE=CHART_STATE;var JOB_STATE={NOT_STARTED:0,RUNNING:1,FINISHED:2,STOPPING:3};exports.JOB_STATE=JOB_STATE},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DATA_FRAME_RUNNING_STATE;(function(DATA_FRAME_RUNNING_STATE){DATA_FRAME_RUNNING_STATE["STARTED"]="started";DATA_FRAME_RUNNING_STATE["STOPPED"]="stopped"})(DATA_FRAME_RUNNING_STATE=exports.DATA_FRAME_RUNNING_STATE||(exports.DATA_FRAME_RUNNING_STATE={}));var DataFrameJobListColumn;(function(DataFrameJobListColumn){DataFrameJobListColumn["configDestIndex"]="config.dest.index";DataFrameJobListColumn["configSourceIndex"]="config.source.index";DataFrameJobListColumn["id"]="id"})(DataFrameJobListColumn=exports.DataFrameJobListColumn||(exports.DataFrameJobListColumn={}));function isCompletedBatchJob(item){return item.state.checkpoint===1&&item.config.sync===undefined&&item.state.task_state===DATA_FRAME_RUNNING_STATE.STOPPED}exports.isCompletedBatchJob=isCompletedBatchJob},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.explorer$=exports.dragSelect$=exports.ALLOW_CELL_RANGE_SELECTION=void 0;var _rxjs=__webpack_require__(30);var ALLOW_CELL_RANGE_SELECTION=false;exports.ALLOW_CELL_RANGE_SELECTION=ALLOW_CELL_RANGE_SELECTION;var dragSelect$=new _rxjs.Subject;exports.dragSelect$=dragSelect$;var explorer$=new _rxjs.Subject;exports.explorer$=explorer$},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSettingsBreadcrumbs=getSettingsBreadcrumbs;exports.getCalendarManagementBreadcrumbs=getCalendarManagementBreadcrumbs;exports.getCreateCalendarBreadcrumbs=getCreateCalendarBreadcrumbs;exports.getEditCalendarBreadcrumbs=getEditCalendarBreadcrumbs;exports.getFilterListsBreadcrumbs=getFilterListsBreadcrumbs;exports.getCreateFilterListBreadcrumbs=getCreateFilterListBreadcrumbs;exports.getEditFilterListBreadcrumbs=getEditFilterListBreadcrumbs;var _breadcrumbs=__webpack_require__(432);var _i18n=__webpack_require__(4);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getSettingsBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}function getCalendarManagementBreadcrumbs(){return[].concat(_toConsumableArray(getSettingsBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagementLabel",{defaultMessage:"Calendar management"}),href:"#/settings/calendars_list"}])}function getCreateCalendarBreadcrumbs(){return[].concat(_toConsumableArray(getCalendarManagementBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.createLabel",{defaultMessage:"Create"}),href:"#/settings/calendars_list/new_calendar"}])}function getEditCalendarBreadcrumbs(){return[].concat(_toConsumableArray(getCalendarManagementBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.editLabel",{defaultMessage:"Edit"}),href:"#/settings/calendars_list/edit_calendar"}])}function getFilterListsBreadcrumbs(){return[].concat(_toConsumableArray(getSettingsBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterListsLabel",{defaultMessage:"Filter lists"}),href:"#/settings/filter_lists"}])}function getCreateFilterListBreadcrumbs(){return[].concat(_toConsumableArray(getFilterListsBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.createLabel",{defaultMessage:"Create"}),href:"#/settings/filter_lists/new"}])}function getEditFilterListBreadcrumbs(){return[].concat(_toConsumableArray(getFilterListsBreadcrumbs()),[{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.editLabel",{defaultMessage:"Edit"}),href:"#/settings/filter_lists/edit"}])}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnnotationsTable",{enumerable:true,get:function get(){return _annotations_table.AnnotationsTable}});var _annotations_table=__webpack_require__(1353);__webpack_require__(2790)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addItemToRecentlyAccessed=addItemToRecentlyAccessed;var _persisted_log=__webpack_require__(254);var _i18n=__webpack_require__(4);function addItemToRecentlyAccessed(page,itemId,url){var pageLabel="";var id="ml-job-".concat(itemId);switch(page){case"explorer":pageLabel=_i18n.i18n.translate("xpack.ml.anomalyExplorerPageLabel",{defaultMessage:"Anomaly Explorer"});break;case"timeseriesexplorer":pageLabel=_i18n.i18n.translate("xpack.ml.singleMetricViewerPageLabel",{defaultMessage:"Single Metric Viewer"});break;case"jobs/new_job/datavisualizer":pageLabel=_i18n.i18n.translate("xpack.ml.dataVisualizerPageLabel",{defaultMessage:"Data Visualizer"});id="ml-datavisualizer-".concat(itemId);break;default:console.error("addItemToRecentlyAccessed - No page specified");return;break}url="ml#/".concat(page,"/").concat(url);_persisted_log.recentlyAccessed.add(url,"ML - ".concat(itemId," - ").concat(pageLabel),id)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateJob=validateJob;exports.populateValidationMessages=populateValidationMessages;var _job_utils=__webpack_require__(58);var _new_job_defaults=__webpack_require__(337);var _validation=__webpack_require__(572);var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function validateJob(job,checks){var limits=(0,_new_job_defaults.newJobLimits)();var validationResults=(0,_job_utils.basicJobValidation)(job,undefined,limits);var valid=true;_lodash.default.each(checks,function(item){item.valid=true});populateValidationMessages(validationResults,checks);_lodash.default.each(checks,function(item){if(item.valid===false){valid=false}});return valid}function populateValidationMessages(validationResults,checks){var limits=(0,_new_job_defaults.newJobLimits)();if(validationResults.contains("job_id_empty")){checks.jobId.valid=false}else if(validationResults.contains("job_id_invalid")){checks.jobId.valid=false;var msg=_i18n.i18n.translate("xpack.ml.newJob.simple.validateJob.jobNameAllowedCharactersDescription",{defaultMessage:"Job name can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});checks.jobId.message=msg}if(validationResults.contains("job_group_id_invalid")){checks.groupIds.valid=false;var _msg=_i18n.i18n.translate("xpack.ml.newJob.simple.validateJob.jobGroupAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});checks.groupIds.message=_msg}if(validationResults.contains("model_memory_limit_units_invalid")){checks.modelMemoryLimit.valid=false;var str="".concat(_validation.ALLOWED_DATA_UNITS.slice(0,_validation.ALLOWED_DATA_UNITS.length-1).join(", ")," or ").concat(_toConsumableArray(_validation.ALLOWED_DATA_UNITS).pop());var _msg2=_i18n.i18n.translate("xpack.ml.newJob.simple.validateJob.modelMemoryLimitUnitsInvalidErrorMessage",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:str}});checks.modelMemoryLimit.message=_msg2}if(validationResults.contains("model_memory_limit_invalid")){checks.modelMemoryLimit.valid=false;var _msg3=_i18n.i18n.translate("xpack.ml.newJob.simple.validateJob.modelMemoryLimitRangeInvalidErrorMessage",{defaultMessage:"Model memory limit cannot be higher than the maximum value of {maxModelMemoryLimit}",values:{maxModelMemoryLimit:limits.max_model_memory_limit.toUpperCase()}});checks.modelMemoryLimit.message=_msg3}if(validationResults.contains("detectors_duplicates")){checks.duplicateDetectors.valid=false;var _msg4=_i18n.i18n.translate("xpack.ml.newJob.simple.validateJob.duplicatedDetectorsErrorMessage",{defaultMessage:"Duplicate detectors were found."});checks.duplicateDetectors.message=_msg4}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DEFAULT_REFRESH_INTERVAL_MS=3e4;exports.MINIMUM_REFRESH_INTERVAL_MS=1e3;exports.DELETING_JOBS_REFRESH_INTERVAL_MS=2e3;exports.PROGRESS_JOBS_REFRESH_INTERVAL_MS=2e3},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getMostSevereMessageStatus=getMostSevereMessageStatus;exports.addJobValidationMethods=addJobValidationMethods;var _validation=__webpack_require__(572);var contains=function contains(arr,str){return arr.findIndex(function(v){return v===str})>=0};function getMostSevereMessageStatus(messages){var statuses=messages.map(function(m){return m.status});return[_validation.VALIDATION_STATUS.INFO,_validation.VALIDATION_STATUS.WARNING,_validation.VALIDATION_STATUS.ERROR].reduce(function(previous,current){return contains(statuses,current)?current:previous},_validation.VALIDATION_STATUS.SUCCESS)}function addJobValidationMethods($scope,service){$scope.getDuration=function(){return{start:$scope.formConfig.start,end:$scope.formConfig.end}};$scope.isCurrentJobConfig=false;$scope.$watch("formConfig",function(){$scope.isCurrentJobConfig=false},true);$scope.getJobConfig=function(){$scope.isCurrentJobConfig=true;return service.getJobFromConfig($scope.formConfig)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlSimpleJobSearchService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _index_patterns=__webpack_require__(497);var _string_utils=__webpack_require__(67);var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getScoresByRecord(jobId,earliestMs,latestMs,interval,firstSplitField){return new Promise(function(resolve,reject){var obj={success:true,results:{}};var jobIdFilterStr="job_id: "+jobId;if(firstSplitField&&firstSplitField.value!==undefined){jobIdFilterStr+=" AND ".concat((0,_string_utils.escapeForElasticsearchQuery)(firstSplitField.name),":");jobIdFilterStr+='"'.concat(String(firstSplitField.value).replace(/\\/g,"\\\\"),'"')}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record"}},{bool:{must:[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{query_string:{query:jobIdFilterStr}}]}}]}},aggs:{detector_index:{terms:{field:"detector_index",order:{recordScore:"desc"}},aggs:{recordScore:{max:{field:"record_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1,extended_bounds:{min:earliestMs,max:latestMs}},aggs:{recordScore:{max:{field:"record_score"}}}}}}}}}).then(function(resp){var detectorsByIndex=_lodash.default.get(resp,["aggregations","detector_index","buckets"],[]);_lodash.default.each(detectorsByIndex,function(dtr){var dtrResults={};var dtrIndex=+dtr.key;var buckets=_lodash.default.get(dtr,["byTime","buckets"],[]);for(var j=0;j<buckets.length;j++){var bkt=buckets[j];var time=bkt.key;dtrResults[time]={recordScore:_lodash.default.get(bkt,["recordScore","value"])}}obj.results[dtrIndex]=dtrResults});resolve(obj)}).catch(function(resp){reject(resp)})})}function getCategoryFields(index,field,size,query){return new Promise(function(resolve,reject){var obj={success:true,results:{}};_ml_api_service.ml.esSearch({index:index,size:0,body:{query:query,aggs:{catFields:{terms:{field:field,size:size}}}}}).then(function(resp){obj.results.values=[];var catFields=_lodash.default.get(resp,["aggregations","catFields","buckets"],[]);_lodash.default.each(catFields,function(f){obj.results.values.push(f.key)});resolve(obj)}).catch(function(resp){reject(resp)})})}var mlSimpleJobSearchService={getScoresByRecord:getScoresByRecord,getCategoryFields:getCategoryFields};exports.mlSimpleJobSearchService=mlSimpleJobSearchService},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _i18n=__webpack_require__(15);var _index=__webpack_require__(2887);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlFullTimeRangeSelector",function(){return{restrict:"E",replace:true,scope:{indexPattern:"=",disabled:"=",query:"="},link:function link(scope,element){function renderComponent(){var props={indexPattern:scope.indexPattern,query:scope.query,disabled:scope.disabled};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_index.FullTimeRangeSelector,props)),element[0])}renderComponent();scope.$watch("disabled",renderComponent);element.on("$destroy",function(){scope.$destroy()})}}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2916)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var breadcrumbs_1=__webpack_require__(432);function getJobManagementBreadcrumbs(){return[breadcrumbs_1.ML_BREADCRUMB]}exports.getJobManagementBreadcrumbs=getJobManagementBreadcrumbs;function getDataFrameBreadcrumbs(){return[breadcrumbs_1.ML_BREADCRUMB,{text:i18n_1.i18n.translate("xpack.ml.dataFrameBreadcrumbs.dataFrameLabel",{defaultMessage:"Data Frames"}),href:""}]}exports.getDataFrameBreadcrumbs=getDataFrameBreadcrumbs;var DATA_FRAME_HOME={text:i18n_1.i18n.translate("xpack.ml.dataFrameBreadcrumbs.dataFrameLabel",{defaultMessage:"Data Frames"}),href:"#/data_frames"};function getDataFrameCreateBreadcrumbs(){return[breadcrumbs_1.ML_BREADCRUMB,DATA_FRAME_HOME,{text:i18n_1.i18n.translate("xpack.ml.dataFrameBreadcrumbs.dataFrameCreateLabel",{defaultMessage:"Create data frame"}),href:""}]}exports.getDataFrameCreateBreadcrumbs=getDataFrameCreateBreadcrumbs;function getDataFrameIndexOrSearchBreadcrumbs(){return[breadcrumbs_1.ML_BREADCRUMB,DATA_FRAME_HOME,{text:i18n_1.i18n.translate("xpack.ml.dataFrameBreadcrumbs.selectIndexOrSearchLabel",{defaultMessage:"Select index or search"}),href:""}]}exports.getDataFrameIndexOrSearchBreadcrumbs=getDataFrameIndexOrSearchBreadcrumbs},function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_COLUMNS=5;function getFlattenedFields(obj){var flatDocFields=[];var newDocFields=Object.keys(obj);newDocFields.forEach(function(f){var fieldValue=obj[f];if(_typeof(fieldValue)!=="object"||fieldValue===null||Array.isArray(fieldValue)){flatDocFields.push(f)}else{var innerFields=getFlattenedFields(fieldValue);var flattenedFields=innerFields.map(function(d){return"".concat(f,".").concat(d)});flatDocFields.push.apply(flatDocFields,_toConsumableArray(flattenedFields))}});return flatDocFields}exports.getFlattenedFields=getFlattenedFields;exports.getSelectableFields=function(docs){if(docs.length===0){return[]}var newDocFields=getFlattenedFields(docs[0]._source);newDocFields.sort();return newDocFields};exports.getDefaultSelectableFields=function(docs){if(docs.length===0){return[]}var newDocFields=getFlattenedFields(docs[0]._source);newDocFields.sort();return newDocFields.filter(function(k){var value=false;docs.forEach(function(row){var source=row._source;if(source[k]!==null){value=true}});return value}).slice(0,exports.MAX_COLUMNS)};exports.toggleSelectedField=function(selectedFields,column){var index=selectedFields.indexOf(column);if(index===-1){selectedFields.push(column)}else{selectedFields.splice(index,1)}selectedFields.sort();return selectedFields};exports.getSourceIndexDevConsoleStatement=function(query,indexPatternTitle){return"GET ".concat(indexPatternTitle,"/_search\n").concat(JSON.stringify({query:query},null,2),"\n")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initializeAppState=initializeAppState;exports.subscribeAppStateToObservable=subscribeAppStateToObservable;var _lodash=__webpack_require__(3);var _operators=__webpack_require__(48);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function hasEqualKeys(a,b){return(0,_lodash.isEqual)(Object.keys(a).sort(),Object.keys(b).sort())}function initializeAppState(AppState,stateName,defaultState){var appState=new AppState;appState.fetch();if(appState[stateName]===undefined){appState[stateName]=(0,_lodash.cloneDeep)(defaultState);appState.save()}if(defaultState===undefined||appState[stateName]===defaultState){return appState}if(_typeof(defaultState)==="object"&&!hasEqualKeys(defaultState,appState[stateName])||_typeof(defaultState)!==_typeof(appState[stateName])){appState[stateName]=(0,_lodash.cloneDeep)(defaultState);appState.save()}return appState}function subscribeAppStateToObservable(AppState,appStateName,o$,callback){var appState=initializeAppState(AppState,appStateName,o$.getValue());o$.next(appState[appStateName]);o$.pipe((0,_operators.distinctUntilChanged)()).subscribe(function(payload){appState.fetch();appState[appStateName]=payload;appState.save();if(typeof callback==="function"){callback(payload)}})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobGroup",{enumerable:true,get:function get(){return _job_group.JobGroup}});var _job_group=__webpack_require__(2780)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlTableService=void 0;var _rxjs=__webpack_require__(30);var mlTableService={rowMouseenter$:new _rxjs.Subject,rowMouseleave$:new _rxjs.Subject};exports.mlTableService=mlTableService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE=500;exports.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE=500},function(module,exports,__webpack_require__){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var react_2=__webpack_require__(5);var notify_1=__webpack_require__(14);var annotations_1=__webpack_require__(1354);var annotations_service_1=__webpack_require__(496);var observable_utils_1=__webpack_require__(434);var annotation_description_list_1=__webpack_require__(2791);var delete_annotation_modal_1=__webpack_require__(2792);var ml_api_service_1=__webpack_require__(24);var AnnotationFlyoutIntl=function(_react_1$Component){_inherits(AnnotationFlyoutIntl,_react_1$Component);function AnnotationFlyoutIntl(){var _this;_classCallCheck(this,AnnotationFlyoutIntl);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnnotationFlyoutIntl).apply(this,arguments));_this.state={isDeleteModalVisible:false};_this.annotationSub=null;_this.annotationTextChangeHandler=function(e){if(_this.props.annotation===null){return}annotations_service_1.annotation$.next(_objectSpread({},_this.props.annotation,{annotation:e.target.value}))};_this.cancelEditingHandler=function(){annotations_service_1.annotation$.next(null)};_this.deleteConfirmHandler=function(){_this.setState({isDeleteModalVisible:true})};_this.deleteHandler=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this$props,annotation,intl;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=_this.props,annotation=_this$props.annotation,intl=_this$props.intl;if(!(annotation===null)){_context.next=3;break}return _context.abrupt("return");case 3:_context.prev=3;_context.next=6;return ml_api_service_1.ml.annotations.deleteAnnotation(annotation._id);case 6:notify_1.toastNotifications.addSuccess(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.deletedAnnotationNotificationMessage",defaultMessage:"Deleted annotation for job with ID {jobId}."},{jobId:annotation.job_id}));_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](3);notify_1.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithDeletingAnnotationNotificationErrorMessage",defaultMessage:"An error occurred deleting the annotation for job with ID {jobId}: {error}"},{jobId:annotation.job_id,error:JSON.stringify(_context.t0)}));case 12:_this.closeDeleteModal();annotations_service_1.annotation$.next(null);annotations_service_1.annotationsRefresh$.next(true);case 15:case"end":return _context.stop()}}},_callee,null,[[3,9]])}));_this.closeDeleteModal=function(){_this.setState({isDeleteModalVisible:false})};_this.validateAnnotationText=function(){var _this$props2=_this.props,annotation=_this$props2.annotation,intl=_this$props2.intl;var errors=[];if(annotation===null){return errors}if(annotation.annotation.trim().length===0){errors.push(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationFlyout.noAnnotationTextError",defaultMessage:"Enter annotation text"}))}var textLength=annotation.annotation.length;if(textLength>annotations_1.ANNOTATION_MAX_LENGTH_CHARS){var charsOver=textLength-annotations_1.ANNOTATION_MAX_LENGTH_CHARS;errors.push(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationFlyout.maxLengthError",defaultMessage:"{charsOver, number} {charsOver, plural, one {character} other {characters}} above maximum length of {maxChars}"},{maxChars:annotations_1.ANNOTATION_MAX_LENGTH_CHARS,charsOver:charsOver}))}return errors};_this.saveOrUpdateAnnotation=function(){var _this$props3=_this.props,annotation=_this$props3.annotation,intl=_this$props3.intl;if(annotation===null){return}annotations_service_1.annotation$.next(null);ml_api_service_1.ml.annotations.indexAnnotation(annotation).then(function(){annotations_service_1.annotationsRefresh$.next(true);if(typeof annotation._id==="undefined"){notify_1.toastNotifications.addSuccess(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.addedAnnotationNotificationMessage",defaultMessage:"Added an annotation for job with ID {jobId}."},{jobId:annotation.job_id}))}else{notify_1.toastNotifications.addSuccess(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.updatedAnnotationNotificationMessage",defaultMessage:"Updated annotation for job with ID {jobId}."},{jobId:annotation.job_id}))}}).catch(function(resp){if(typeof annotation._id==="undefined"){notify_1.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithCreatingAnnotationNotificationErrorMessage",defaultMessage:"An error occurred creating the annotation for job with ID {jobId}: {error}"},{jobId:annotation.job_id,error:JSON.stringify(resp)}))}else{notify_1.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithUpdatingAnnotationNotificationErrorMessage",defaultMessage:"An error occurred updating the annotation for job with ID {jobId}: {error}"},{jobId:annotation.job_id,error:JSON.stringify(resp)}))}})};return _this}_createClass(AnnotationFlyoutIntl,[{key:"render",value:function render(){var _this$props4=this.props,annotation=_this$props4.annotation,intl=_this$props4.intl;var isDeleteModalVisible=this.state.isDeleteModalVisible;if(annotation===null){return null}var isExistingAnnotation=typeof annotation._id!=="undefined";var validationErrors=this.validateAnnotationText();var isInvalid=validationErrors.length>0;var lengthRatioToShowWarning=.95;var helpText=null;if(isInvalid===false&&annotation.annotation.length>annotations_1.ANNOTATION_MAX_LENGTH_CHARS*lengthRatioToShowWarning){helpText=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationFlyout.approachingMaxLengthWarning",defaultMessage:"{charsRemaining, number} {charsRemaining, plural, one {character} other {characters}} remaining"},{charsRemaining:annotations_1.ANNOTATION_MAX_LENGTH_CHARS-annotation.annotation.length})}return react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiFlyout,{onClose:this.cancelEditingHandler,size:"s","aria-labelledby":"Add annotation"},react_1.default.createElement(eui_1.EuiFlyoutHeader,{hasBorder:true},react_1.default.createElement(eui_1.EuiTitle,{size:"s"},react_1.default.createElement("h2",{id:"mlAnnotationFlyoutTitle"},isExistingAnnotation?react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.editAnnotationTitle",defaultMessage:"Edit annotation"}):react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.addAnnotationTitle",defaultMessage:"Add annotation"})))),react_1.default.createElement(eui_1.EuiFlyoutBody,null,react_1.default.createElement(annotation_description_list_1.AnnotationDescriptionList,{annotation:annotation}),react_1.default.createElement(eui_1.EuiSpacer,{size:"m"}),react_1.default.createElement(eui_1.EuiFormRow,{label:react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.annotationTextLabel",defaultMessage:"Annotation text"}),fullWidth:true,helpText:helpText,isInvalid:isInvalid,error:validationErrors},react_1.default.createElement(eui_1.EuiTextArea,{fullWidth:true,isInvalid:isInvalid,onChange:this.annotationTextChangeHandler,placeholder:"...",value:annotation.annotation}))),react_1.default.createElement(eui_1.EuiFlyoutFooter,null,react_1.default.createElement(eui_1.EuiFlexGroup,{justifyContent:"spaceBetween"},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButtonEmpty,{iconType:"cross",onClick:this.cancelEditingHandler,flush:"left"},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.cancelButtonLabel",defaultMessage:"Cancel"}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},isExistingAnnotation&&react_1.default.createElement(eui_1.EuiButtonEmpty,{color:"danger",onClick:this.deleteConfirmHandler},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.deleteButtonLabel",defaultMessage:"Delete"}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButton,{fill:true,isDisabled:isInvalid===true,onClick:this.saveOrUpdateAnnotation},isExistingAnnotation?react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.updateButtonLabel",defaultMessage:"Update"}):react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.createButtonLabel",defaultMessage:"Create"})))))),react_1.default.createElement(delete_annotation_modal_1.DeleteAnnotationModal,{cancelAction:this.closeDeleteModal,deleteAction:this.deleteHandler,isVisible:isDeleteModalVisible}))}}]);return AnnotationFlyoutIntl}(react_1.Component);exports.AnnotationFlyout=observable_utils_1.injectObservablesAsProps({annotation:annotations_service_1.annotation$},react_2.injectI18n(AnnotationFlyoutIntl))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlForecastService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _index_patterns=__webpack_require__(497);var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getForecastsSummary(job,query,earliestMs,maxResults){return new Promise(function(resolve,reject){var obj={success:true,forecasts:[]};var filterCriteria=[{term:{result_type:"model_forecast_request_stats"}},{term:{job_id:job.job_id}},{range:{timestamp:{gte:earliestMs,format:"epoch_millis"}}}];if(query){filterCriteria.push(query)}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults,rest_total_hits_as_int:true,body:{query:{bool:{filter:filterCriteria}},sort:[{forecast_create_timestamp:{order:"desc"}}]}}).then(function(resp){if(resp.hits.total!==0){obj.forecasts=resp.hits.hits.map(function(hit){return hit._source})}resolve(obj)}).catch(function(resp){reject(resp)})})}function getForecastDateRange(job,forecastId){return new Promise(function(resolve,reject){var obj={success:true,earliest:null,latest:null};var filterCriteria=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:true}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}}];_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:filterCriteria}},aggs:{earliest:{min:{field:"timestamp"}},latest:{max:{field:"timestamp"}}}}}).then(function(resp){obj.earliest=_lodash.default.get(resp,"aggregations.earliest.value",null);obj.latest=_lodash.default.get(resp,"aggregations.latest.value",null);if(obj.earliest===null||obj.latest===null){reject(resp)}else{resolve(obj)}}).catch(function(resp){reject(resp)})})}function getForecastData(job,detectorIndex,forecastId,entityFields,earliestMs,latestMs,interval,aggType){var criteriaFields=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});if(partitionEntity!==undefined){criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}}if(_lodash.default.has(detector,"over_field_name")){var overEntity=_lodash.default.find(entityFields,{fieldName:detector.over_field_name});if(overEntity!==undefined){criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}}if(_lodash.default.has(detector,"by_field_name")){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});if(byEntity!==undefined){criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}}return new Promise(function(resolve,reject){var obj={success:true,results:{}};var filterCriteria=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:true}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}},{term:{detector_index:detectorIndex}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];_lodash.default.each(criteriaFields,function(criteria){filterCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})});var forecastAggs=aggType===undefined?{avg:"avg",max:"max",min:"min"}:{avg:aggType.avg,max:aggType.max,min:aggType.min};_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:filterCriteria}},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{prediction:_defineProperty({},forecastAggs.avg,{field:"forecast_prediction"}),forecastUpper:_defineProperty({},forecastAggs.max,{field:"forecast_upper"}),forecastLower:_defineProperty({},forecastAggs.min,{field:"forecast_lower"})}}}}}).then(function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,function(dataForTime){var time=dataForTime.key;obj.results[time]={prediction:_lodash.default.get(dataForTime,["prediction","value"]),forecastUpper:_lodash.default.get(dataForTime,["forecastUpper","value"]),forecastLower:_lodash.default.get(dataForTime,["forecastLower","value"])}});resolve(obj)}).catch(function(resp){reject(resp)})})}function runForecast(jobId,duration){console.log("ML forecast service run forecast with duration:",duration);return new Promise(function(resolve,reject){_ml_api_service.ml.forecast({jobId:jobId,duration:duration}).then(function(resp){resolve(resp)}).catch(function(err){reject(err)})})}function getForecastRequestStats(job,forecastId){return new Promise(function(resolve,reject){var obj={success:true,stats:{}};var filterCriteria=[{query_string:{query:"result_type:model_forecast_request_stats",analyze_wildcard:true}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}}];_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:1,rest_total_hits_as_int:true,body:{query:{bool:{filter:filterCriteria}}}}).then(function(resp){if(resp.hits.total!==0){obj.stats=_lodash.default.first(resp.hits.hits)._source}resolve(obj)}).catch(function(resp){reject(resp)})})}var mlForecastService={getForecastsSummary:getForecastsSummary,getForecastDateRange:getForecastDateRange,getForecastData:getForecastData,runForecast:runForecast,getForecastRequestStats:getForecastRequestStats};exports.mlForecastService=mlForecastService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getNewCustomUrlDefaults=getNewCustomUrlDefaults;exports.getQueryEntityFieldNames=getQueryEntityFieldNames;exports.isValidCustomUrlSettingsTimeRange=isValidCustomUrlSettingsTimeRange;exports.isValidCustomUrlSettings=isValidCustomUrlSettings;exports.buildCustomUrlFromSettings=buildCustomUrlFromSettings;exports.getTestUrl=getTestUrl;var _constants=__webpack_require__(886);var _chrome=_interopRequireDefault(__webpack_require__(9));var _risonNode=_interopRequireDefault(__webpack_require__(239));var _index_patterns=__webpack_require__(497);var _job_utils=__webpack_require__(58);var _parse_interval=__webpack_require__(313);var _custom_url_utils=__webpack_require__(498);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _string_utils=__webpack_require__(67);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getNewCustomUrlDefaults(job,dashboards,indexPatterns){var kibanaSettings={queryFieldNames:[]};var urlType=_constants.URL_TYPE.OTHER;if(dashboards!==undefined&&dashboards.length>0){urlType=_constants.URL_TYPE.KIBANA_DASHBOARD;kibanaSettings.dashboardId=dashboards[0].id}else if(indexPatterns!==undefined&&indexPatterns.length>0){urlType=_constants.URL_TYPE.KIBANA_DISCOVER}var datafeedConfig=job.datafeed_config;if(indexPatterns!==undefined&&indexPatterns.length>0&&datafeedConfig!==undefined&&datafeedConfig.indices!==undefined&&datafeedConfig.indices.length>0){var datafeedIndex=datafeedConfig.indices[0];var defaultIndexPattern=indexPatterns.find(function(indexPattern){return indexPattern.title===datafeedIndex});if(defaultIndexPattern===undefined){defaultIndexPattern=indexPatterns[0]}kibanaSettings.discoverIndexPatternId=defaultIndexPattern.id}return{label:"",type:urlType,timeRange:{type:_constants.TIME_RANGE_TYPE.AUTO,interval:""},kibanaSettings:kibanaSettings,otherUrlSettings:{urlValue:""}}}function getQueryEntityFieldNames(job){var influencers=job.analysis_config.influencers;var detectors=job.analysis_config.detectors;var entityFieldNames=[];if(influencers!==undefined){entityFieldNames.push.apply(entityFieldNames,_toConsumableArray(influencers))}detectors.forEach(function(detector,detectorIndex){var partitioningFields=(0,_job_utils.getPartitioningFieldNames)(job,detectorIndex);partitioningFields.forEach(function(fieldName){if(entityFieldNames.indexOf(fieldName)===-1){entityFieldNames.push(fieldName)}})});return entityFieldNames}function isValidCustomUrlSettingsTimeRange(timeRangeSettings){if(timeRangeSettings.type===_constants.TIME_RANGE_TYPE.INTERVAL){var interval=(0,_parse_interval.parseInterval)(timeRangeSettings.interval);return interval!==null}return true}function isValidCustomUrlSettings(settings,savedCustomUrls){var isValid=(0,_custom_url_utils.isValidLabel)(settings.label,savedCustomUrls);if(isValid===true){isValid=isValidCustomUrlSettingsTimeRange(settings.timeRange)}return isValid}function buildCustomUrlFromSettings(settings){if(settings.type===_constants.URL_TYPE.KIBANA_DASHBOARD){return buildDashboardUrlFromSettings(settings)}else if(settings.type===_constants.URL_TYPE.KIBANA_DISCOVER){return Promise.resolve(buildDiscoverUrlFromSettings(settings))}else{var urlToAdd={url_name:settings.label,url_value:settings.otherUrlSettings.urlValue};return Promise.resolve(urlToAdd)}}function buildDashboardUrlFromSettings(settings){return new Promise(function(resolve,reject){var _settings$kibanaSetti=settings.kibanaSettings,dashboardId=_settings$kibanaSetti.dashboardId,queryFieldNames=_settings$kibanaSetti.queryFieldNames;var savedObjectsClient=_chrome.default.getSavedObjectsClient();savedObjectsClient.get("dashboard",dashboardId).then(function(response){var filters=[];var query=undefined;var searchSourceJSON=response.get("kibanaSavedObjectMeta.searchSourceJSON");if(searchSourceJSON!==undefined){var searchSourceData=JSON.parse(searchSourceJSON);if(searchSourceData.filter!==undefined){filters=searchSourceData.filter}query=searchSourceData.query}var _g=_risonNode.default.encode({time:{from:"$earliest$",to:"$latest$",mode:"absolute"}});var appState={filters:filters};var queryFromEntityFieldNames=buildAppStateQueryParam(queryFieldNames);if(queryFromEntityFieldNames!==undefined){query=queryFromEntityFieldNames}if(query!==undefined){appState.query=query}var _a=_risonNode.default.encode(appState);var urlValue="kibana#/dashboard/".concat(dashboardId,"?_g=").concat(_g,"&_a=").concat(_a);var urlToAdd={url_name:settings.label,url_value:urlValue,time_range:_constants.TIME_RANGE_TYPE.AUTO};if(settings.timeRange.type===_constants.TIME_RANGE_TYPE.INTERVAL){urlToAdd.time_range=settings.timeRange.interval}resolve(urlToAdd)}).catch(function(resp){reject(resp)})})}function buildDiscoverUrlFromSettings(settings){var _settings$kibanaSetti2=settings.kibanaSettings,discoverIndexPatternId=_settings$kibanaSetti2.discoverIndexPatternId,queryFieldNames=_settings$kibanaSetti2.queryFieldNames;var _g=_risonNode.default.encode({time:{from:"$earliest$",to:"$latest$",mode:"absolute"}});var appState={index:discoverIndexPatternId};var queryFromEntityFieldNames=buildAppStateQueryParam(queryFieldNames);if(queryFromEntityFieldNames!==undefined){appState.query=queryFromEntityFieldNames}var _a=_risonNode.default.encode(appState);var urlValue="kibana#/discover?_g=".concat(_g,"&_a=").concat(_a);var urlToAdd={url_name:settings.label,url_value:urlValue,time_range:_constants.TIME_RANGE_TYPE.AUTO};if(settings.timeRange.type===_constants.TIME_RANGE_TYPE.INTERVAL){urlToAdd.time_range=settings.timeRange.interval}return urlToAdd}function buildAppStateQueryParam(queryFieldNames){var queryParam;if(queryFieldNames!==undefined&&queryFieldNames.length>0){var queryString="";queryFieldNames.forEach(function(fieldName,i){if(i>0){queryString+=" and "}queryString+="".concat((0,_string_utils.escapeForElasticsearchQuery)(fieldName),':"$').concat(fieldName,'$"')});queryParam={language:"kuery",query:queryString}}return queryParam}function getTestUrl(job,customUrl){var urlValue=customUrl.url_value;var bucketSpanSecs=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span).asSeconds();var testUrl=customUrl.url_value;var body={query:{bool:{must:[{term:{job_id:job.job_id}},{term:{result_type:"record"}}]}},size:1,_source:{excludes:[]},sort:[{record_score:{order:"desc"}}]};return new Promise(function(resolve,reject){_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,rest_total_hits_as_int:true,body:body}).then(function(resp){if(resp.hits.total>0){var record=resp.hits.hits[0]._source;testUrl=(0,_custom_url_utils.replaceTokensInUrlValue)(customUrl,bucketSpanSecs,record,"timestamp");resolve(testUrl)}else{_job_service.mlJobService.searchPreview(job).then(function(response){var testDoc;var docTimeFieldName=job.data_description.time_field;if(response.aggregations){var firstBucket=response.aggregations.buckets.buckets[0];testDoc=_defineProperty({},docTimeFieldName,firstBucket.key);urlValue.replace(/\$([^?&$\'"]{1,40})\$/g,function(match,name){if(name!=="earliest"&&name!=="latest"&&firstBucket[name]!==undefined){var tokenBuckets=firstBucket[name];if(tokenBuckets.buckets){testDoc[name]=tokenBuckets.buckets[0].key}}})}else{if(response.hits.total>0){testDoc=response.hits.hits[0]._source}}if(testDoc!==undefined){testUrl=(0,_custom_url_utils.replaceTokensInUrlValue)(customUrl,bucketSpanSecs,testDoc,docTimeFieldName)}resolve(testUrl)})}}).catch(function(resp){reject(resp)})})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TIME_RANGE_TYPE=exports.URL_TYPE=void 0;var URL_TYPE={KIBANA_DASHBOARD:"KIBANA_DASHBOARD",KIBANA_DISCOVER:"KIBANA_DISCOVER",OTHER:"OTHER"};exports.URL_TYPE=URL_TYPE;var TIME_RANGE_TYPE={AUTO:"auto",INTERVAL:"interval"};exports.TIME_RANGE_TYPE=TIME_RANGE_TYPE},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MULTI_BUCKET_IMPACT=void 0;var MULTI_BUCKET_IMPACT={HIGH:3,MEDIUM:2,LOW:1,NONE:-5};exports.MULTI_BUCKET_IMPACT=MULTI_BUCKET_IMPACT},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filterAggTypes=filterAggTypes;var _lodash=_interopRequireDefault(__webpack_require__(3));var _angular=_interopRequireDefault(__webpack_require__(26));var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function filterAggTypes(aggTypes){var filteredAggTypes=[];var typeCopy;_lodash.default.each(aggTypes,function(type){type.mlName=type.name;type.mlModelPlotAgg={max:type.name,min:type.name};type.isCountType=false;type.isAggregatableStringType=false;_lodash.default.each(type.params,function(p){if(p.filterFieldTypes&&typeof p.filterFieldTypes==="string"){p.filterFieldTypes=p.filterFieldTypes.replace(",date","")}});if(type.name==="count"){type.mlModelPlotAgg={max:"max",min:"min"};type.isCountType=true;filteredAggTypes.push(type);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.highCountLabel",{defaultMessage:"High count"});typeCopy.mlName="high_count";filteredAggTypes.push(typeCopy);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.lowCountLabel",{defaultMessage:"Low count"});typeCopy.mlName="low_count";filteredAggTypes.push(typeCopy)}else if(type.name==="sum"){filteredAggTypes.push(type);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.highSumLabel",{defaultMessage:"High sum"});typeCopy.mlName="high_sum";filteredAggTypes.push(typeCopy);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.lowSumLabel",{defaultMessage:"Low sum"});typeCopy.mlName="low_sum";filteredAggTypes.push(typeCopy)}else if(type.name==="avg"){type.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.meanLabel",{defaultMessage:"Mean"});type.mlName="mean";filteredAggTypes.push(type);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.highMeanLabel",{defaultMessage:"High mean"});typeCopy.mlName="high_mean";filteredAggTypes.push(typeCopy);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.lowMeanLabel",{defaultMessage:"Low mean"});typeCopy.mlName="low_mean";filteredAggTypes.push(typeCopy)}else if(type.name==="median"){type.mlModelPlotAgg={max:"max",min:"min"};filteredAggTypes.push(type);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.highMedianLabel",{defaultMessage:"High median"});typeCopy.mlName="high_median";filteredAggTypes.push(typeCopy);typeCopy=_angular.default.copy(type);typeCopy.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.lowMedianLabel",{defaultMessage:"Low median"});typeCopy.mlName="low_median";filteredAggTypes.push(typeCopy)}else if(type.name==="min"){filteredAggTypes.push(type)}else if(type.name==="max"){filteredAggTypes.push(type)}else if(type.name==="cardinality"){type.title=_i18n.i18n.translate("xpack.ml.newJob.simple.filterAggTypes.distinctCountLabel",{defaultMessage:"Distinct count"});type.mlName="distinct_count";type.mlModelPlotAgg={max:"max",min:"min"};type.isAggregatableStringType=true;_lodash.default.each(type.params,function(p){if(p.filterFieldTypes){p.filterFieldTypes="number,boolean,ip,string"}});filteredAggTypes.push(type)}});return filteredAggTypes}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.adjustIntervalDisplayed=adjustIntervalDisplayed;var _parse_interval=__webpack_require__(313);function adjustIntervalDisplayed(formConfig){var makeTheSame=false;var intervalSeconds=formConfig.chartInterval.getInterval().asSeconds();var bucketSpan=(0,_parse_interval.parseInterval)(formConfig.bucketSpan);if(bucketSpan!==null){if(bucketSpan.asSeconds()>intervalSeconds){makeTheSame=true}if(formConfig.agg.type!==undefined){var mlName=formConfig.agg.type.mlName;if(mlName==="count"||mlName==="low_count"||mlName==="high_count"||mlName==="distinct_count"){makeTheSame=true}}if(makeTheSame){formConfig.chartInterval.setInterval(formConfig.bucketSpan)}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createFields=createFields;exports.getIndexedFields=getIndexedFields;var _general=__webpack_require__(361);var _field_types=__webpack_require__(295);var _job_utils=__webpack_require__(58);var _field_types_utils=__webpack_require__(578);var _i18n=__webpack_require__(4);function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function createFields(scope,indexPattern){var isPopulation=scope.formConfig.hasOwnProperty("overField");var agg=scope.formConfig.agg;var fields=[];var categoryFields=[];scope.ui.fields=[];agg.type.params.forEach(function(param){if(param.name==="field"){fields=getIndexedFields(indexPattern,[_field_types.KBN_FIELD_TYPES.NUMBER,_field_types.KBN_FIELD_TYPES.STRING,_field_types.KBN_FIELD_TYPES.IP])}if(param.name==="customLabel"){categoryFields=getIndexedFields(indexPattern,[_field_types.KBN_FIELD_TYPES.STRING,_field_types.KBN_FIELD_TYPES.IP])}});var countAgg={type:scope.ui.aggTypeOptions.find(function(o){return o.name==="count"})};var eventRateField={id:_general.EVENT_RATE_COUNT_FIELD,name:"event rate",tooltip:_i18n.i18n.translate("xpack.ml.newJob.simple.createFields.systemDefinedFieldTooltip",{defaultMessage:"System defined field"}),isCountField:true,agg:countAgg,mlType:_field_types.ML_JOB_FIELD_TYPES.NUMBER,splitField:undefined,firstSplitFieldName:undefined,cardLabels:undefined};if(isPopulation){eventRateField.splitField=undefined;eventRateField.firstSplitFieldName=undefined;eventRateField.cardLabels=undefined}scope.ui.fields.push(eventRateField);var cardinalityAgg={type:scope.ui.aggTypeOptions.find(function(o){return o.name==="cardinality"})};fields.forEach(function(field,i){var id=(0,_job_utils.getSafeAggregationName)(field.displayName,i);var f={id:id,name:field.displayName,tooltip:field.displayName,agg:field.mlType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD||field.mlType===_field_types.ML_JOB_FIELD_TYPES.IP?_objectSpread({},cardinalityAgg):_objectSpread({},agg),mlType:field.mlType};if(isPopulation){f.splitField=undefined;f.firstSplitFieldName=undefined;f.cardLabels=undefined}scope.ui.fields.push(f)});categoryFields.forEach(function(field){scope.ui.splitFields.push(field);if(isPopulation){scope.ui.overFields.push(field)}})}function getIndexedFields(indexPattern,fieldTypes){var fields=indexPattern.fields.raw.filter(function(f){return f.aggregatable===true});if(fieldTypes){fields=fields.filter(function(f){return f.displayName!=="_type"&&f.displayName!=="_id"&&f.displayName!=="_index"&&f.scripted!==true});fields=fields.filter(function(f){return fieldTypes.find(function(t){return t===f.type})});fields.forEach(function(f){return f.mlType=(0,_field_types_utils.kbnTypeToMLJobType)(f)});fields=fields.sort(orderBy(["name","type"]))}return fields}function orderBy(items){return function(a,b){var result=0;items.forEach(function(i){var aa=a[i].toLowerCase();var bb=b[i].toLowerCase();if(aa<bb){result=-1}else if(aa>bb){result=1}});return result||0}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.preLoadJob=preLoadJob;exports.jobSettingsFromJob=jobSettingsFromJob;var _job_service=__webpack_require__(36);var _app_state_settings=__webpack_require__(2873);var _general=__webpack_require__(361);var _full_time_range_selector_service=__webpack_require__(1359);function preLoadJob($scope,appState){var job=_job_service.mlJobService.currentJob;_job_service.mlJobService.currentJob=undefined;if(job!==undefined){var mlJobSettings=jobSettingsFromJob(job,$scope.ui.aggTypeOptions);(0,_app_state_settings.populateAppStateSettings)({mlJobSettings:mlJobSettings},$scope);(0,_full_time_range_selector_service.setFullTimeRange)($scope.ui.indexPattern,$scope.formConfig.combinedQuery).then(function(){return $scope.loadVis()}).catch(function(){return $scope.loadVis()})}else{(0,_app_state_settings.populateAppStateSettings)(appState,$scope)}}function jobSettingsFromJob(job,aggTypeOptions){if(job.custom_settings===undefined){return{}}function getKibanaAggName(mlAggName){var agg=aggTypeOptions.find(function(a){return a.mlName===mlAggName});return agg?agg.mlName:undefined}var jobSettings={};var dtrs=job.analysis_config.detectors;if(job.custom_settings.created_by===_general.WIZARD_TYPE.SINGLE_METRIC){var d=dtrs[0];var func=d.function;if(func==="non_zero_count"&&job.analysis_config.summary_count_field_name!==undefined&&job.analysis_config.summary_count_field_name.match(/^dc_.+/)){func="distinct_count"}var field={agg:getKibanaAggName(func)};if(d.field_name){field.fieldName=d.field_name}else if(func==="distinct_count"&&job.analysis_config.summary_count_field_name!==undefined){var fieldMatch=job.analysis_config.summary_count_field_name.match(/^dc_(.+)/);if(fieldMatch[1]!==undefined){field.fieldName=fieldMatch[1]}}jobSettings.fields=[field]}else if(job.custom_settings.created_by===_general.WIZARD_TYPE.MULTI_METRIC){var splitField="";jobSettings.fields=dtrs.map(function(d){if(d.partition_field_name){splitField=d.partition_field_name}var field={agg:getKibanaAggName(d.function)};if(d.field_name){field.fieldName=d.field_name}return field});if(splitField!==""){jobSettings.split=splitField}}else if(job.custom_settings.created_by===_general.WIZARD_TYPE.POPULATION){var overField="";var splitFields={};jobSettings.fields=dtrs.map(function(d){if(d.over_field_name){overField=d.over_field_name}var field={agg:getKibanaAggName(d.function)};if(d.field_name){field.fieldName=d.field_name}if(d.by_field_name){field.split=d.by_field_name}return field});if(overField!==""){jobSettings.population=overField}var numberOfSplits=Object.keys(splitFields).length;if(numberOfSplits>0){if(numberOfSplits>1){for(var f in splitFields){if(splitFields.hasOwnProperty(f)){var i=splitFields[f];jobSettings.fields[i]=f}}}else{jobSettings.split=Object.keys(splitFields)[0]}}}jobSettings.bucketSpan=job.analysis_config.bucket_span;if(job.analysis_limits&&job.analysis_limits.model_memory_limit){jobSettings.modelMemoryLimit=job.analysis_limits.model_memory_limit}if(job.description!==""){jobSettings.description=job.description}if(job.groups!==undefined&&job.groups.length){jobSettings.groups=job.groups}if(job.analysis_config&&job.analysis_config.influencers){jobSettings.influencers=job.analysis_config.influencers}jobSettings.resultsIndexName=job.results_index_name;return jobSettings}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2876);__webpack_require__(2879)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JsonTooltip=void 0;var _tooltips=__webpack_require__(2906);var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var JsonTooltip=function JsonTooltip(_ref){var id=_ref.id,position=_ref.position;var tooltips=(0,_tooltips.getTooltips)();var text=tooltips[id]?tooltips[id].text:"";return _react.default.createElement("span",{"aria-hidden":"true",className:"ml-info-icon"},_react.default.createElement(_eui.EuiIconTip,{content:text,position:position}),_react.default.createElement("span",{id:"ml_aria_description_".concat(id),className:"ml-info-tooltip-text"},text))};exports.JsonTooltip=JsonTooltip;JsonTooltip.propTypes={id:_propTypes.default.string,position:_propTypes.default.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EntityCell",{enumerable:true,get:function get(){return _entity_cell.EntityCell}});var _entity_cell=__webpack_require__(3027)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_CHARS=exports.ANOMALIES_TABLE_TABS=exports.INFLUENCERS_LIMIT=void 0;var INFLUENCERS_LIMIT=5;exports.INFLUENCERS_LIMIT=INFLUENCERS_LIMIT;var ANOMALIES_TABLE_TABS={DETAILS:0,CATEGORY_EXAMPLES:1};exports.ANOMALIES_TABLE_TABS=ANOMALIES_TABLE_TABS;var MAX_CHARS=500;exports.MAX_CHARS=MAX_CHARS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectInterval=exports.interval$=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _rxjs=__webpack_require__(30);var _eui=__webpack_require__(1);var _i18n=__webpack_require__(4);var _observable_utils=__webpack_require__(434);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var OPTIONS=[{value:"auto",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.autoLabel",{defaultMessage:"Auto"})},{value:"hour",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.hourLabel",{defaultMessage:"1 hour"})},{value:"day",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.dayLabel",{defaultMessage:"1 day"})},{value:"second",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.showAllLabel",{defaultMessage:"Show all"})}];function optionValueToInterval(value){var option=OPTIONS.find(function(opt){return opt.value===value});var interval=OPTIONS[0];if(option!==undefined){interval={display:option.text,val:option.value}}return interval}var interval$=new _rxjs.BehaviorSubject(optionValueToInterval(OPTIONS[0].value));exports.interval$=interval$;var SelectIntervalUnwrapped=function(_Component){_inherits(SelectIntervalUnwrapped,_Component);function SelectIntervalUnwrapped(){var _getPrototypeOf2;var _this;_classCallCheck(this,SelectIntervalUnwrapped);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(SelectIntervalUnwrapped)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"onChange",function(e){var interval=optionValueToInterval(e.target.value);interval$.next(interval)});return _this}_createClass(SelectIntervalUnwrapped,[{key:"render",value:function render(){return _react.default.createElement(_eui.EuiSelect,{options:OPTIONS,className:"ml-select-interval",value:this.props.interval.val,onChange:this.onChange})}}]);return SelectIntervalUnwrapped}(_react.Component);_defineProperty(SelectIntervalUnwrapped,"propTypes",{interval:_propTypes.default.object.isRequired});var SelectInterval=(0,_observable_utils.injectObservablesAsProps)({interval:interval$},SelectIntervalUnwrapped);exports.SelectInterval=SelectInterval},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createJobs=createJobs;exports.getClearedSelectedAnomaliesState=getClearedSelectedAnomaliesState;exports.getDefaultViewBySwimlaneData=getDefaultViewBySwimlaneData;exports.mapScopeToProps=mapScopeToProps;exports.getFilteredTopInfluencers=getFilteredTopInfluencers;exports.getInfluencers=getInfluencers;exports.getFieldsByJob=getFieldsByJob;exports.getSelectionTimeRange=getSelectionTimeRange;exports.getSelectionInfluencers=getSelectionInfluencers;exports.getViewBySwimlaneOptions=getViewBySwimlaneOptions;exports.processOverallResults=processOverallResults;exports.processViewByResults=processViewByResults;exports.loadAnnotationsTableData=loadAnnotationsTableData;exports.loadAnomaliesTableData=loadAnomaliesTableData;exports.loadDataForCharts=loadDataForCharts;exports.loadTopInfluencers=loadTopInfluencers;var _lodash=__webpack_require__(3);var _parse_interval=__webpack_require__(275);var _anomaly_utils=__webpack_require__(293);var _job_utils=__webpack_require__(58);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _results_service=__webpack_require__(436);var _explorer_constants=__webpack_require__(339);var _search=__webpack_require__(882);var _i18n=__webpack_require__(4);var _chrome=_interopRequireDefault(__webpack_require__(9));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}var mlAnnotationsEnabled=_chrome.default.getInjected("mlAnnotationsEnabled",false);function createJobs(jobs){return jobs.map(function(job){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);return{id:job.job_id,selected:false,bucketSpanSeconds:bucketSpan.asSeconds()}})}function getClearedSelectedAnomaliesState(){return{anomalyChartRecords:[],selectedCells:null,viewByLoadedForTimeFormatted:null}}function getDefaultViewBySwimlaneData(){return{fieldName:"",laneLabels:[],points:[],interval:3600}}function mapScopeToProps(scope){return{appStateHandler:scope.appStateHandler,dateFormatTz:scope.dateFormatTz,mlJobSelectService:scope.mlJobSelectService,MlTimeBuckets:scope.MlTimeBuckets}}function getFilteredTopInfluencers(_x,_x2,_x3,_x4,_x5,_x6,_x7){return _getFilteredTopInfluencers.apply(this,arguments)}function _getFilteredTopInfluencers(){_getFilteredTopInfluencers=_asyncToGenerator(regeneratorRuntime.mark(function _callee(jobIds,earliestMs,latestMs,records,influencers,noInfluencersConfigured,influencersFilterQuery){var recordInfluencersByName,uniqValuesByName,filterInfluencers;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:recordInfluencersByName={};influencers.forEach(function(influencer){var fieldName=influencer.fieldName;if(recordInfluencersByName[influencer.fieldName]===undefined){recordInfluencersByName[influencer.fieldName]=[]}recordInfluencersByName[fieldName].push(influencer.fieldValue)});records.forEach(function(record){var influencersByName=record.influencers||[];influencersByName.forEach(function(influencer){var _recordInfluencersByN;var fieldName=influencer.influencer_field_name;var fieldValues=influencer.influencer_field_values;if(recordInfluencersByName[fieldName]===undefined){recordInfluencersByName[fieldName]=[]}(_recordInfluencersByN=recordInfluencersByName[fieldName]).push.apply(_recordInfluencersByN,_toConsumableArray(fieldValues))})});uniqValuesByName={};Object.keys(recordInfluencersByName).forEach(function(fieldName){var fieldValues=recordInfluencersByName[fieldName];uniqValuesByName[fieldName]=(0,_lodash.uniq)(fieldValues)});filterInfluencers=[];Object.keys(uniqValuesByName).forEach(function(fieldName){var matchingFieldName=influencers.find(function(influencer){return influencer.fieldName===fieldName});if(matchingFieldName!==undefined){filterInfluencers.push.apply(filterInfluencers,_toConsumableArray(influencers))}else{uniqValuesByName[fieldName].forEach(function(fieldValue){filterInfluencers.push({fieldName:fieldName,fieldValue:fieldValue})})}});_context.next=9;return loadTopInfluencers(jobIds,earliestMs,latestMs,filterInfluencers,noInfluencersConfigured,influencersFilterQuery);case 9:return _context.abrupt("return",_context.sent);case 10:case"end":return _context.stop()}}},_callee)}));return _getFilteredTopInfluencers.apply(this,arguments)}function getInfluencers(){var selectedJobs=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var influencers=[];selectedJobs.forEach(function(selectedJob){var job=_job_service.mlJobService.getJob(selectedJob.id);if(job!==undefined&&job.analysis_config&&job.analysis_config.influencers){influencers.push.apply(influencers,_toConsumableArray(job.analysis_config.influencers))}});return influencers}function getFieldsByJob(){return _job_service.mlJobService.jobs.reduce(function(reducedFieldsByJob,job){var analysisConfig=job.analysis_config;var influencers=analysisConfig.influencers||[];var fieldsForJob=(analysisConfig.detectors||[]).reduce(function(reducedfieldsForJob,detector){if(detector.partition_field_name!==undefined){reducedfieldsForJob.push(detector.partition_field_name)}if(detector.over_field_name!==undefined){reducedfieldsForJob.push(detector.over_field_name)}if(detector.by_field_name!==undefined&&detector.over_field_name===undefined){reducedfieldsForJob.push(detector.by_field_name)}return reducedfieldsForJob},[]).concat(influencers);reducedFieldsByJob[job.job_id]=(0,_lodash.uniq)(fieldsForJob);reducedFieldsByJob["*"]=(0,_lodash.union)(reducedFieldsByJob["*"],reducedFieldsByJob[job.job_id]);return reducedFieldsByJob},{"*":[]})}function getSelectionTimeRange(selectedCells,interval,bounds){var earliestMs=bounds.min.valueOf();var latestMs=bounds.max.valueOf();if(selectedCells!==null&&selectedCells.times!==undefined){earliestMs=selectedCells.times[0]!==undefined?selectedCells.times[0]*1e3:bounds.min.valueOf();latestMs=bounds.max.valueOf();if(selectedCells.times[1]!==undefined){latestMs=(selectedCells.times[1]+interval)*1e3-1}}return{earliestMs:earliestMs,latestMs:latestMs}}function getSelectionInfluencers(selectedCells,fieldName){if(selectedCells!==null&&selectedCells.type!==_explorer_constants.SWIMLANE_TYPE.OVERALL&&selectedCells.viewByFieldName!==undefined&&selectedCells.viewByFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){return selectedCells.lanes.map(function(laneLabel){return{fieldName:fieldName,fieldValue:laneLabel}})}return[]}function getViewBySwimlaneOptions(_ref){var currentSwimlaneViewByFieldName=_ref.currentSwimlaneViewByFieldName,filterActive=_ref.filterActive,filteredFields=_ref.filteredFields,isAndOperator=_ref.isAndOperator,selectedCells=_ref.selectedCells,selectedJobs=_ref.selectedJobs;var selectedJobIds=selectedJobs.map(function(d){return d.id});var viewByOptions=(0,_lodash.chain)(_job_service.mlJobService.jobs.reduce(function(reducedViewByOptions,job){if(selectedJobIds.some(function(jobId){return jobId===job.job_id})){return reducedViewByOptions.concat(job.analysis_config.influencers||[])}return reducedViewByOptions},[])).uniq().sortBy(function(fieldName){return fieldName.toLowerCase()}).value();viewByOptions.push(_explorer_constants.VIEW_BY_JOB_LABEL);var viewBySwimlaneOptions=viewByOptions;var swimlaneViewByFieldName=undefined;if(viewBySwimlaneOptions.indexOf(currentSwimlaneViewByFieldName)!==-1){swimlaneViewByFieldName=currentSwimlaneViewByFieldName}else{if(selectedJobIds.length>1){swimlaneViewByFieldName=_explorer_constants.VIEW_BY_JOB_LABEL}else{var firstSelectedJob=_job_service.mlJobService.jobs.find(function(job){return job.job_id===selectedJobIds[0]});var firstJobInfluencers=firstSelectedJob.analysis_config.influencers||[];firstSelectedJob.analysis_config.detectors.forEach(function(detector){if(detector.partition_field_name!==undefined&&firstJobInfluencers.indexOf(detector.partition_field_name)!==-1){swimlaneViewByFieldName=detector.partition_field_name;return false}if(detector.over_field_name!==undefined&&firstJobInfluencers.indexOf(detector.over_field_name)!==-1){swimlaneViewByFieldName=detector.over_field_name;return false}if(detector.by_field_name!==undefined&&detector.over_field_name===undefined&&firstJobInfluencers.indexOf(detector.by_field_name)!==-1){swimlaneViewByFieldName=detector.by_field_name;return false}});if(swimlaneViewByFieldName===undefined){if(firstJobInfluencers.length>0){swimlaneViewByFieldName=firstJobInfluencers[0]}else{swimlaneViewByFieldName=viewBySwimlaneOptions.length>0?viewBySwimlaneOptions[0]:undefined}}}}if(filterActive===true&&isAndOperator===true&&selectedCells===null){viewBySwimlaneOptions=[_explorer_constants.VIEW_BY_JOB_LABEL]}else if(filterActive===true&&Array.isArray(viewBySwimlaneOptions)&&Array.isArray(filteredFields)){var filteredOptions=viewBySwimlaneOptions.filter(function(option){return filteredFields.includes(option)||option===_explorer_constants.VIEW_BY_JOB_LABEL||selectedCells&&selectedCells.viewByFieldName===option});if(filteredOptions.length>1){viewBySwimlaneOptions=filteredOptions}}return{swimlaneViewByFieldName:swimlaneViewByFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions}}function processOverallResults(scoresByTime,searchBounds,interval){var overallLabel=_i18n.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"});var dataset={laneLabels:[overallLabel],points:[],interval:interval,earliest:searchBounds.min.valueOf()/1e3,latest:searchBounds.max.valueOf()/1e3};if(Object.keys(scoresByTime).length>0){(0,_lodash.each)(scoresByTime,function(score,timeMs){var time=timeMs/1e3;dataset.points.push({laneLabel:overallLabel,time:time,value:score});dataset.earliest=Math.min(time,dataset.earliest);dataset.latest=Math.max(time+dataset.interval,dataset.latest)})}return dataset}function processViewByResults(scoresByInfluencerAndTime,sortedLaneValues,overallSwimlaneData,swimlaneViewByFieldName,interval){var dataset={fieldName:swimlaneViewByFieldName,points:[],interval:interval};dataset.earliest=overallSwimlaneData.earliest;dataset.latest=overallSwimlaneData.latest;var laneLabels=[];var maxScoreByLaneLabel={};(0,_lodash.each)(scoresByInfluencerAndTime,function(influencerData,influencerFieldValue){laneLabels.push(influencerFieldValue);maxScoreByLaneLabel[influencerFieldValue]=0;(0,_lodash.each)(influencerData,function(anomalyScore,timeMs){var time=timeMs/1e3;dataset.points.push({laneLabel:influencerFieldValue,time:time,value:anomalyScore});maxScoreByLaneLabel[influencerFieldValue]=Math.max(maxScoreByLaneLabel[influencerFieldValue],anomalyScore)})});var sortValuesLength=sortedLaneValues.length;if(sortValuesLength===0){dataset.laneLabels=laneLabels.sort(function(a,b){return maxScoreByLaneLabel[b]-maxScoreByLaneLabel[a]})}else{dataset.laneLabels=laneLabels.sort(function(a,b){var aIndex=sortedLaneValues.indexOf(a);var bIndex=sortedLaneValues.indexOf(b);aIndex=aIndex>-1?aIndex:sortValuesLength;bIndex=bIndex>-1?bIndex:sortValuesLength;return aIndex-bIndex})}return dataset}function loadAnnotationsTableData(selectedCells,selectedJobs,interval,bounds){var jobIds=selectedCells!==null&&selectedCells.viewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL?selectedCells.lanes:selectedJobs.map(function(d){return d.id});var timeRange=getSelectionTimeRange(selectedCells,interval,bounds);if(mlAnnotationsEnabled===false){return Promise.resolve([])}return new Promise(function(resolve){_ml_api_service.ml.annotations.getAnnotations({jobIds:jobIds,earliestMs:timeRange.earliestMs,latestMs:timeRange.latestMs,maxAnnotations:_search.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE}).then(function(resp){if(resp.error!==undefined||resp.annotations===undefined){return resolve([])}var annotationsData=[];jobIds.forEach(function(jobId){var jobAnnotations=resp.annotations[jobId];if(jobAnnotations!==undefined){annotationsData.push.apply(annotationsData,_toConsumableArray(jobAnnotations))}});return resolve(annotationsData.sort(function(a,b){return a.timestamp-b.timestamp}).map(function(d,i){d.key=String.fromCharCode(65+i);return d}))}).catch(function(resp){console.log("Error loading list of annotations for jobs list:",resp);return resolve([])})})}function loadAnomaliesTableData(_x8,_x9,_x10,_x11,_x12,_x13,_x14,_x15,_x16){return _loadAnomaliesTableData.apply(this,arguments)}function _loadAnomaliesTableData(){_loadAnomaliesTableData=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(selectedCells,selectedJobs,dateFormatTz,interval,bounds,fieldName,tableInterval,tableSeverity,influencersFilterQuery){var jobIds,influencers,timeRange;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:jobIds=selectedCells!==null&&selectedCells.viewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL?selectedCells.lanes:selectedJobs.map(function(d){return d.id});influencers=getSelectionInfluencers(selectedCells,fieldName);timeRange=getSelectionTimeRange(selectedCells,interval,bounds);return _context2.abrupt("return",new Promise(function(resolve,reject){_ml_api_service.ml.results.getAnomaliesTableData(jobIds,[],influencers,tableInterval,tableSeverity,timeRange.earliestMs,timeRange.latestMs,dateFormatTz,_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE,_explorer_constants.MAX_CATEGORY_EXAMPLES,influencersFilterQuery).then(function(resp){var anomalies=resp.anomalies;var detectorsByJob=_job_service.mlJobService.detectorsByJob;anomalies.forEach(function(anomaly){var jobId=anomaly.jobId;var detector=(0,_lodash.get)(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=(0,_lodash.get)(detector,["detector_description"],anomaly.source.function_description);if(detector!==undefined&&detector.custom_rules!==undefined){anomaly.rulesLength=detector.custom_rules.length}var job=_job_service.mlJobService.getJob(jobId);var isChartable=(0,_job_utils.isSourceDataChartableForDetector)(job,anomaly.detectorIndex);if(isChartable===false){var entityFields=(0,_anomaly_utils.getEntityFieldList)(anomaly.source);isChartable=(0,_job_utils.isModelPlotEnabled)(job,anomaly.detectorIndex,entityFields)}anomaly.isTimeSeriesViewRecord=isChartable;if(_job_service.mlJobService.customUrlsByJob[jobId]!==undefined){anomaly.customUrls=_job_service.mlJobService.customUrlsByJob[jobId]}});resolve({anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:true,jobIds:jobIds})}).catch(function(resp){console.log("Explorer - error loading data for anomalies table:",resp);reject()})}));case 4:case"end":return _context2.stop()}}},_callee2)}));return _loadAnomaliesTableData.apply(this,arguments)}var requestCount=0;function loadDataForCharts(_x17,_x18,_x19){return _loadDataForCharts.apply(this,arguments)}function _loadDataForCharts(){_loadDataForCharts=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(jobIds,earliestMs,latestMs){var influencers,selectedCells,influencersFilterQuery,_args3=arguments;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:influencers=_args3.length>3&&_args3[3]!==undefined?_args3[3]:[];selectedCells=_args3.length>4?_args3[4]:undefined;influencersFilterQuery=_args3.length>5?_args3[5]:undefined;return _context3.abrupt("return",new Promise(function(resolve){if(selectedCells===null&&influencers.length===0&&influencersFilterQuery===undefined){resolve([])}var newRequestCount=++requestCount;requestCount=newRequestCount;_results_service.mlResultsService.getRecordsForInfluencer(jobIds,influencers,0,earliestMs,latestMs,500,influencersFilterQuery).then(function(resp){if(newRequestCount<requestCount){resolve(undefined)}if(selectedCells!==null&&Object.keys(selectedCells).length>0||influencersFilterQuery!==undefined){console.log("Explorer anomaly charts data set:",resp.records);resolve(resp.records)}resolve(undefined)})}));case 4:case"end":return _context3.stop()}}},_callee3)}));return _loadDataForCharts.apply(this,arguments)}function loadTopInfluencers(_x20,_x21,_x22){return _loadTopInfluencers.apply(this,arguments)}function _loadTopInfluencers(){_loadTopInfluencers=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(selectedJobIds,earliestMs,latestMs){var influencers,noInfluencersConfigured,influencersFilterQuery,_args4=arguments;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:influencers=_args4.length>3&&_args4[3]!==undefined?_args4[3]:[];noInfluencersConfigured=_args4.length>4?_args4[4]:undefined;influencersFilterQuery=_args4.length>5?_args4[5]:undefined;return _context4.abrupt("return",new Promise(function(resolve){if(noInfluencersConfigured!==true){_results_service.mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,_explorer_constants.MAX_INFLUENCER_FIELD_VALUES,influencers,influencersFilterQuery).then(function(resp){console.log("Explorer top influencers data set:",resp.influencers);resolve(resp.influencers)})}else{resolve({})}}));case 4:case"end":return _context4.stop()}}},_callee4)}));return _loadTopInfluencers.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingIndicator=LoadingIndicator;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function LoadingIndicator(_ref){var height=_ref.height,label=_ref.label;height=height?+height:100;return _react.default.createElement("div",{className:"ml-loading-indicator",style:{height:"".concat(height,"px")}},_react.default.createElement("div",{className:"loading-spinner"},_react.default.createElement("i",{className:"fa fa-spinner fa-spin"})),label&&_react.default.createElement("div",{"ml-loading-indicator-label":"true"},label))}LoadingIndicator.propTypes={height:_propTypes.default.number,label:_propTypes.default.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobSelectorBadge",{enumerable:true,get:function get(){return _job_selector_badge.JobSelectorBadge}});var _job_selector_badge=__webpack_require__(3096)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setGlobalState=setGlobalState;exports.getSelectedJobIds=getSelectedJobIds;exports.getGroupsFromJobs=getGroupsFromJobs;exports.normalizeTimes=normalizeTimes;var _lodash=__webpack_require__(3);var _notify=__webpack_require__(14);var _job_service=__webpack_require__(36);var _i18n=__webpack_require__(4);var _moment=_interopRequireDefault(__webpack_require__(16));var _d=_interopRequireDefault(__webpack_require__(27));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function warnAboutInvalidJobIds(invalidIds){if(invalidIds.length>0){_notify.toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:invalidIds.length,invalidIds:invalidIds}}))}}function getInvalidJobIds(ids){return ids.filter(function(id){var jobExists=_job_service.mlJobService.jobs.some(function(job){return job.job_id===id});return jobExists===false&&id!=="*"})}function loadJobIdsFromGlobalState(globalState){var jobIds=[];var groups=[];if(globalState.ml&&globalState.ml.jobIds){var tempJobIds=[];groups=globalState.ml.groups||[];if(typeof globalState.ml.jobIds==="string"){tempJobIds.push(globalState.ml.jobIds)}else{tempJobIds=globalState.ml.jobIds}tempJobIds=tempJobIds.map(function(id){return String(id)});var invalidIds=getInvalidJobIds(tempJobIds);warnAboutInvalidJobIds(invalidIds);var validIds=(0,_lodash.difference)(tempJobIds,invalidIds);if(validIds.length===0){_notify.toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.jobSelect.noJobsSelectedWarningMessage",{defaultMessage:"No jobs selected, auto selecting first job"}));if(_job_service.mlJobService.jobs.length){validIds=[_job_service.mlJobService.jobs[0].job_id]}}jobIds.push.apply(jobIds,_toConsumableArray(validIds))}else{if(_job_service.mlJobService.jobs.length){jobIds.push(_job_service.mlJobService.jobs[0].job_id)}}return{jobIds:jobIds,selectedGroups:groups}}function setGlobalState(globalState,_ref){var selectedIds=_ref.selectedIds,selectedGroups=_ref.selectedGroups;if(globalState.ml===undefined){globalState.ml={}}globalState.ml.jobIds=selectedIds;globalState.ml.groups=selectedGroups||[];globalState.save()}function getSelectedJobIds(globalState){return loadJobIdsFromGlobalState(globalState)}function getGroupsFromJobs(jobs){var groups={};var groupsMap={};jobs.forEach(function(job){if(job.groups!==undefined){job.groups.forEach(function(g){if(groups[g]===undefined){groups[g]={id:g,jobIds:[job.job_id],timeRange:{to:job.timeRange.to,toMoment:null,from:job.timeRange.from,fromMoment:null,fromPx:job.timeRange.fromPx,toPx:job.timeRange.toPx,widthPx:null}};groupsMap[g]=[job.job_id]}else{groups[g].jobIds.push(job.job_id);groupsMap[g].push(job.job_id);if(groups[g].timeRange.to===null||job.timeRange.to>groups[g].timeRange.to){groups[g].timeRange.to=job.timeRange.to;groups[g].timeRange.toMoment=job.timeRange.toMoment}if(groups[g].timeRange.from===null||job.timeRange.from<groups[g].timeRange.from){groups[g].timeRange.from=job.timeRange.from;groups[g].timeRange.fromMoment=job.timeRange.fromMoment}if(groups[g].timeRange.toPx===null||job.timeRange.toPx>groups[g].timeRange.toPx){groups[g].timeRange.toPx=job.timeRange.toPx}if(groups[g].timeRange.fromPx===null||job.timeRange.fromPx<groups[g].timeRange.fromPx){groups[g].timeRange.fromPx=job.timeRange.fromPx}}})}});Object.keys(groups).forEach(function(groupId){var group=groups[groupId];group.timeRange.widthPx=group.timeRange.toPx-group.timeRange.fromPx;group.timeRange.toMoment=(0,_moment.default)(group.timeRange.to);group.timeRange.fromMoment=(0,_moment.default)(group.timeRange.from);var fromString=group.timeRange.fromMoment.format("MMM Do YYYY, HH:mm");var toString=group.timeRange.toMoment.format("MMM Do YYYY, HH:mm");group.timeRange.label=_i18n.i18n.translate("xpack.ml.jobSelectList.groupTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:toString}})});return{groups:Object.keys(groups).map(function(g){return groups[g]}),groupsMap:groupsMap}}function normalizeTimes(jobs,dateFormatTz,ganttBarWidth){var min=Math.min.apply(Math,_toConsumableArray(jobs.map(function(job){return+job.timeRange.from})));var max=Math.max.apply(Math,_toConsumableArray(jobs.map(function(job){return+job.timeRange.to})));var ganttScale=_d.default.scale.linear().domain([min,max]).range([1,ganttBarWidth]);jobs.forEach(function(job){if(job.timeRange.to!==undefined&&job.timeRange.from!==undefined){job.timeRange.fromPx=ganttScale(job.timeRange.from);job.timeRange.toPx=ganttScale(job.timeRange.to);job.timeRange.widthPx=job.timeRange.toPx-job.timeRange.fromPx;if(job.timeRange.widthPx<1){job.timeRange.widthPx=1}job.timeRange.toMoment=(0,_moment.default)(job.timeRange.to).tz(dateFormatTz);job.timeRange.fromMoment=(0,_moment.default)(job.timeRange.from).tz(dateFormatTz);var fromString=job.timeRange.fromMoment.format("MMM Do YYYY, HH:mm");var _toString=job.timeRange.toMoment.format("MMM Do YYYY, HH:mm");job.timeRange.label=_i18n.i18n.translate("xpack.ml.jobSelector.jobTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:_toString}})}});return jobs}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PROGRESS_STATES=void 0;var PROGRESS_STATES={UNSET:-1,WAITING:0,DONE:1,ERROR:-10};exports.PROGRESS_STATES=PROGRESS_STATES},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getCalendarSettingsData=getCalendarSettingsData;exports.validateCalendarId=validateCalendarId;exports.generateTempId=generateTempId;var _ml_api_service=__webpack_require__(24);var _job_utils=__webpack_require__(58);var _i18n=__webpack_require__(4);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function getJobIds(){return new Promise(function(resolve,reject){_ml_api_service.ml.jobs.jobsSummary().then(function(resp){resolve(resp.map(function(job){return job.id}))}).catch(function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithFetchingJobSummariesErrorMessage",{defaultMessage:"Error fetching job summaries: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)})})}function getGroupIds(){return new Promise(function(resolve,reject){_ml_api_service.ml.jobs.groups().then(function(resp){resolve(resp.map(function(group){return group.id}))}).catch(function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingGroupsErrorMessage",{defaultMessage:"Error loading groups: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)})})}function getCalendars(){return new Promise(function(resolve,reject){_ml_api_service.ml.calendars().then(function(resp){resolve(resp)}).catch(function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarsErrorMessage",{defaultMessage:"Error loading calendars: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)})})}function getCalendarSettingsData(){return new Promise(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(resolve,reject){var data,formattedData;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([getJobIds(),getGroupIds(),getCalendars()]);case 3:data=_context.sent;formattedData={jobIds:data[0],groupIds:data[1],calendars:data[2]};resolve(formattedData);_context.next=12;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);console.log(_context.t0);reject(_context.t0);case 12:case"end":return _context.stop()}}},_callee,null,[[0,8]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}())}function validateCalendarId(calendarId){var valid=true;if(calendarId===""||calendarId===undefined){valid=false}else if((0,_job_utils.isJobIdValid)(calendarId)===false){valid=false}return valid}function generateTempId(){return Math.random().toString(36).substr(2,9)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EventsTable",{enumerable:true,get:function get(){return _events_table.EventsTable}});Object.defineProperty(exports,"TIME_FORMAT",{enumerable:true,get:function get(){return _events_table.TIME_FORMAT}});var _events_table=__webpack_require__(3157)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Importer=void 0;var _ml_api_service=__webpack_require__(24);var _lodash=__webpack_require__(3);var _moment=_interopRequireDefault(__webpack_require__(16));var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CHUNK_SIZE=1e4;var IMPORT_RETRIES=5;var Importer=function(){function Importer(_ref){var settings=_ref.settings,mappings=_ref.mappings,pipeline=_ref.pipeline;_classCallCheck(this,Importer);this.settings=settings;this.mappings=mappings;this.pipeline=pipeline;this.data=[];this.docArray=[]}_createClass(Importer,[{key:"initializeImport",value:function(){var _initializeImport=_asyncToGenerator(regeneratorRuntime.mark(function _callee(index){var settings,mappings,pipeline,ingestPipeline,createIndexResp;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:settings=this.settings;mappings=this.mappings;pipeline=this.pipeline;updatePipelineTimezone(pipeline);ingestPipeline=pipeline!==undefined?{id:"".concat(index,"-pipeline"),pipeline:pipeline}:{};_context.next=7;return _ml_api_service.ml.fileDatavisualizer.import({id:undefined,index:index,data:[],settings:settings,mappings:mappings,ingestPipeline:ingestPipeline});case 7:createIndexResp=_context.sent;return _context.abrupt("return",createIndexResp);case 9:case"end":return _context.stop()}}},_callee,this)}));function initializeImport(_x){return _initializeImport.apply(this,arguments)}return initializeImport}()},{key:"import",value:function(){var _import2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(id,index,pipelineId,setImportProgress){var chunks,ingestPipeline,success,failures,error,i,aggs,retries,resp,result;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!id||!index)){_context2.next=2;break}return _context2.abrupt("return",{success:false,error:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.noIdOrIndexSuppliedErrorMessage",{defaultMessage:"no ID or index supplied"})});case 2:chunks=(0,_lodash.chunk)(this.docArray,CHUNK_SIZE);ingestPipeline={id:pipelineId};success=true;failures=[];i=0;case 7:if(!(i<chunks.length)){_context2.next=32;break}aggs={id:id,index:index,data:chunks[i],settings:{},mappings:{},ingestPipeline:ingestPipeline};retries=IMPORT_RETRIES;resp={success:false,failures:[],docCount:0};case 11:if(!(resp.success===false&&retries>0)){_context2.next=19;break}_context2.next=14;return _ml_api_service.ml.fileDatavisualizer.import(aggs);case 14:resp=_context2.sent;if(retries<IMPORT_RETRIES){console.log("Retrying import ".concat(IMPORT_RETRIES-retries))}retries--;_context2.next=11;break;case 19:if(!resp.success){_context2.next=23;break}setImportProgress((i+1)/chunks.length*100);_context2.next=28;break;case 23:console.error(resp);success=false;error=resp.error;populateFailures(resp,failures,i);return _context2.abrupt("break",32);case 28:populateFailures(resp,failures,i);case 29:i++;_context2.next=7;break;case 32:result={success:success,failures:failures,docCount:this.docArray.length};if(success){setImportProgress(100)}else{result.error=error}return _context2.abrupt("return",result);case 35:case"end":return _context2.stop()}}},_callee2,this)}));function _import(_x2,_x3,_x4,_x5){return _import2.apply(this,arguments)}return _import}()}]);return Importer}();exports.Importer=Importer;function populateFailures(error,failures,chunkCount){if(error.failures&&error.failures.length){for(var f=0;f<error.failures.length;f++){var failure=error.failures[f];failure.item=failure.item+CHUNK_SIZE*chunkCount}failures.push.apply(failures,_toConsumableArray(error.failures))}}function updatePipelineTimezone(ingestPipeline){if(ingestPipeline!==undefined&&ingestPipeline.processors&&ingestPipeline.processors){var dateProcessor=ingestPipeline.processors.find(function(p){return p.date!==undefined&&p.date.timezone==="{{ beat.timezone }}"});if(dateProcessor){dateProcessor.date.timezone=_moment.default.tz.guess()}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setUpgradeInProgress=setUpgradeInProgress;exports.isUpgradeInProgress=isUpgradeInProgress;var upgradeInProgress=false;function setUpgradeInProgress(show){upgradeInProgress=show}function isUpgradeInProgress(){return upgradeInProgress}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"actionsMenuContent",{enumerable:true,get:function get(){return _management.actionsMenuContent}});Object.defineProperty(exports,"ResultLinks",{enumerable:true,get:function get(){return _results.ResultLinks}});var _management=__webpack_require__(2777);var _results=__webpack_require__(2778)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.tabColor=tabColor;var euiVars=_interopRequireWildcard(__webpack_require__(574));var _string_utils=__webpack_require__(2781);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var COLORS=[euiVars.euiColorVis0,euiVars.euiColorVis1,euiVars.euiColorVis2,euiVars.euiColorVis3,euiVars.euiColorVis5,euiVars.euiColorVis6,euiVars.euiColorVis7,euiVars.euiColorVis8,euiVars.euiColorVis9,euiVars.euiColorDarkShade,euiVars.euiColorPrimary];var colorMap={};function tabColor(name){if(colorMap[name]===undefined){var n=(0,_string_utils.stringHash)(name);var color=COLORS[n%COLORS.length];colorMap[name]=color;return color}else{return colorMap[name]}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobIcon",{enumerable:true,get:function get(){return _job_message_icon.JobIcon}});var _job_message_icon=__webpack_require__(2782)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnnotationsTable=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _risonNode=_interopRequireDefault(__webpack_require__(239));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _services=__webpack_require__(576);var _format=__webpack_require__(495);var _chrome=_interopRequireDefault(__webpack_require__(9));var _recently_accessed=__webpack_require__(677);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _table_service=__webpack_require__(881);var _search=__webpack_require__(882);var _job_utils=__webpack_require__(58);var _annotations_service=__webpack_require__(496);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var AnnotationsTable=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(AnnotationsTable,_Component);function AnnotationsTable(props){var _this;_classCallCheck(this,AnnotationsTable);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnnotationsTable).call(this,props));_defineProperty(_assertThisInitialized(_this),"annotationsRefreshSubscription",null);_defineProperty(_assertThisInitialized(_this),"previousJobId",undefined);_defineProperty(_assertThisInitialized(_this),"openSingleMetricView",function(){var annotation=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var job=_this.getJob(annotation.job_id);var dataCounts=job.data_counts;var from=new Date(dataCounts.earliest_record_timestamp).toISOString();var to=new Date(dataCounts.latest_record_timestamp).toISOString();var globalSettings={ml:{jobIds:[job.job_id]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}};var appState={query:{query_string:{analyze_wildcard:true,query:"*"}}};if(annotation.timestamp!==undefined&&annotation.end_timestamp!==undefined){appState.mlTimeSeriesExplorer={zoom:{from:new Date(annotation.timestamp).toISOString(),to:new Date(annotation.end_timestamp).toISOString()}};if(annotation.timestamp<dataCounts.earliest_record_timestamp){globalSettings.time.from=new Date(annotation.timestamp).toISOString()}if(annotation.end_timestamp>dataCounts.latest_record_timestamp){globalSettings.time.to=new Date(annotation.end_timestamp).toISOString()}}var _g=_risonNode.default.encode(globalSettings);var _a=_risonNode.default.encode(appState);var url="?_g=".concat(_g,"&_a=").concat(_a);(0,_recently_accessed.addItemToRecentlyAccessed)("timeseriesexplorer",job.job_id,url);window.open("".concat(_chrome.default.getBasePath(),"/app/ml#/timeseriesexplorer").concat(url),"_self")});_defineProperty(_assertThisInitialized(_this),"onMouseOverRow",function(record){if(_this.mouseOverRecord!==undefined){if(_this.mouseOverRecord.rowId!==record.rowId){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord,type:"annotation"});_table_service.mlTableService.rowMouseenter$.next({record:record,type:"annotation"})}}else{_table_service.mlTableService.rowMouseenter$.next({record:record,type:"annotation"})}_this.mouseOverRecord=record});_defineProperty(_assertThisInitialized(_this),"onMouseLeaveRow",function(){if(_this.mouseOverRecord!==undefined){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord,type:"annotation"});_this.mouseOverRecord=undefined}});_this.state={annotations:[],isLoading:false,jobId:Array.isArray(_this.props.jobs)&&_this.props.jobs.length>0&&_this.props.jobs[0]!==undefined?_this.props.jobs[0].job_id:undefined};return _this}_createClass(AnnotationsTable,[{key:"getAnnotations",value:function getAnnotations(){var _this2=this;var job=this.props.jobs[0];var dataCounts=job.data_counts;this.setState({isLoading:true});if(dataCounts.processed_record_count>0){_ml_api_service.ml.annotations.getAnnotations({jobIds:[job.job_id],earliestMs:null,latestMs:null,maxAnnotations:_search.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE}).then(function(resp){_this2.setState(function(prevState,props){return{annotations:resp.annotations[props.jobs[0].job_id]||[],errorMessage:undefined,isLoading:false,jobId:props.jobs[0].job_id}})}).catch(function(resp){console.log("Error loading list of annotations for jobs list:",resp);_this2.setState({annotations:[],errorMessage:"Error loading the list of annotations for this job",isLoading:false,jobId:undefined})})}}},{key:"getJob",value:function getJob(jobId){if(Array.isArray(this.props.jobs)&&this.props.jobs.length>0){var job=this.props.jobs[0];if(jobId===undefined||job.job_id===jobId){return job}}return _job_service.mlJobService.getJob(jobId)}},{key:"componentDidMount",value:function componentDidMount(){var _this3=this;if(this.props.annotations===undefined&&Array.isArray(this.props.jobs)&&this.props.jobs.length>0){this.annotationsRefreshSubscription=_annotations_service.annotationsRefresh$.subscribe(function(){return _this3.getAnnotations()});_annotations_service.annotationsRefresh$.next(true)}}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&this.previousJobId!==this.props.jobs[0].job_id&&this.props.annotations===undefined&&this.state.isLoading===false&&this.state.jobId!==this.props.jobs[0].job_id){_annotations_service.annotationsRefresh$.next(true);this.previousJobId=this.props.jobs[0].job_id}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.annotationsRefreshSubscription!==null){this.annotationsRefreshSubscription.unsubscribe()}}},{key:"render",value:function render(){var _this4=this;var _this$props=this.props,_this$props$isSingleM=_this$props.isSingleMetricViewerLinkVisible,isSingleMetricViewerLinkVisible=_this$props$isSingleM===void 0?true:_this$props$isSingleM,_this$props$isNumberB=_this$props.isNumberBadgeVisible,isNumberBadgeVisible=_this$props$isNumberB===void 0?false:_this$props$isNumberB,intl=_this$props.intl;if(this.props.annotations===undefined){if(this.state.isLoading===true){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"})))}if(this.state.errorMessage!==undefined){return _react.default.createElement(_eui.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"})}}var annotations=this.props.annotations||this.state.annotations;if(annotations.length===0){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.annotationsNotCreatedTitle",defaultMessage:"No annotations created for this job"}),iconType:"iInCircle",role:"alert"},this.state.jobId&&(0,_job_utils.isTimeSeriesViewJob)(this.getJob(this.state.jobId))&&_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription",defaultMessage:"To create an annotation, open the {linkToSingleMetricView}",values:{linkToSingleMetricView:_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this4.openSingleMetricView()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription.singleMetricViewerLinkText",defaultMessage:"Single Metric Viewer"}))}})))}function renderDate(date){return(0,_format.formatDate)(date,TIME_FORMAT)}var columns=[{field:"annotation",name:intl.formatMessage({id:"xpack.ml.annotationsTable.annotationColumnName",defaultMessage:"Annotation"}),sortable:true,width:"50%"},{field:"timestamp",name:intl.formatMessage({id:"xpack.ml.annotationsTable.fromColumnName",defaultMessage:"From"}),dataType:"date",render:renderDate,sortable:true},{field:"end_timestamp",name:intl.formatMessage({id:"xpack.ml.annotationsTable.toColumnName",defaultMessage:"To"}),dataType:"date",render:renderDate,sortable:true},{field:"modified_time",name:intl.formatMessage({id:"xpack.ml.annotationsTable.lastModifiedDateColumnName",defaultMessage:"Last modified date"}),dataType:"date",render:renderDate,sortable:true},{field:"modified_username",name:intl.formatMessage({id:"xpack.ml.annotationsTable.lastModifiedByColumnName",defaultMessage:"Last modified by"}),sortable:true}];var jobIds=_lodash.default.uniq(annotations.map(function(a){return a.job_id}));if(jobIds.length>1){columns.unshift({field:"job_id",name:intl.formatMessage({id:"xpack.ml.annotationsTable.jobIdColumnName",defaultMessage:"job ID"}),sortable:true})}if(isNumberBadgeVisible){columns.unshift({field:"key",name:intl.formatMessage({id:"xpack.ml.annotationsTable.labelColumnName",defaultMessage:"Label"}),sortable:true,width:"60px",render:function render(key){return _react.default.createElement(_eui.EuiBadge,{color:"default"},key)}})}var actions=[];actions.push({render:function render(annotation){var editAnnotationsTooltipText=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.editAnnotationsTooltip",defaultMessage:"Edit annotation"});var editAnnotationsTooltipAriaLabelText=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.editAnnotationsTooltipAriaLabel",defaultMessage:"Edit annotation"});return _react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:editAnnotationsTooltipText},_react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return _annotations_service.annotation$.next(annotation)},iconType:"pencil","aria-label":editAnnotationsTooltipAriaLabelText}))}});if(isSingleMetricViewerLinkVisible){actions.push({render:function render(annotation){var isDrillDownAvailable=(0,_job_utils.isTimeSeriesViewJob)(_this4.getJob(annotation.job_id));var openInSingleMetricViewerTooltipText=isDrillDownAvailable?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerTooltip",defaultMessage:"Job configuration not supported in Single Metric Viewer"});var openInSingleMetricViewerAriaLabelText=isDrillDownAvailable?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerAriaLabel",defaultMessage:"Open in Single Metric Viewer"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerAriaLabel",defaultMessage:"Job configuration not supported in Single Metric Viewer"});return _react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:openInSingleMetricViewerTooltipText},_react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return _this4.openSingleMetricView(annotation)},disabled:!isDrillDownAvailable,iconType:"stats","aria-label":openInSingleMetricViewerAriaLabelText}))}})}columns.push({align:_services.RIGHT_ALIGNMENT,width:"60px",name:intl.formatMessage({id:"xpack.ml.annotationsTable.actionsColumnName",defaultMessage:"Actions"}),actions:actions});var getRowProps=function getRowProps(item){return{onMouseOver:function onMouseOver(){return _this4.onMouseOverRow(item)},onMouseLeave:function onMouseLeave(){return _this4.onMouseLeaveRow()}}};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiInMemoryTable,{className:"eui-textOverflowWrap",compressed:true,items:annotations,columns:columns,pagination:{pageSizeOptions:[5,10,25]},sorting:{sort:{field:"timestamp",direction:"asc"}},rowProps:getRowProps}))}}]);return AnnotationsTable}(_react.Component),_defineProperty(_class,"propTypes",{annotations:_propTypes.default.array,jobs:_propTypes.default.array,isSingleMetricViewerLinkVisible:_propTypes.default.bool,isNumberBadgeVisible:_propTypes.default.bool}),_temp));exports.AnnotationsTable=AnnotationsTable},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ANNOTATION_TYPE;(function(ANNOTATION_TYPE){ANNOTATION_TYPE["ANNOTATION"]="annotation";ANNOTATION_TYPE["COMMENT"]="comment"})(ANNOTATION_TYPE=exports.ANNOTATION_TYPE||(exports.ANNOTATION_TYPE={}));exports.ANNOTATION_USER_UNKNOWN="<user unknown>";exports.ANNOTATION_MAX_LENGTH_CHARS=1e3},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.saveJob=saveJob;exports.loadSavedDashboards=loadSavedDashboards;exports.loadIndexPatterns=loadIndexPatterns;var _lodash=__webpack_require__(3);var _chrome=_interopRequireDefault(__webpack_require__(9));var _new_job_defaults=__webpack_require__(337);var _job_service=__webpack_require__(36);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function saveJob(job,newJobData,finish){return new Promise(function(resolve,reject){var jobData=_objectSpread({},extractDescription(job,newJobData),extractGroups(job,newJobData),extractMML(job,newJobData),extractDetectorDescriptions(job,newJobData),extractCustomSettings(job,newJobData));var datafeedData=_objectSpread({},extractDatafeed(job,newJobData));if(jobData.custom_settings!==undefined){jobData.custom_settings=processCustomSettings(jobData,datafeedData)}var saveDatafeedWrapper=function saveDatafeedWrapper(){saveDatafeed(datafeedData,job,finish).then(function(){resolve()}).catch(function(error){reject(error)})};if(Object.keys(jobData).length){_job_service.mlJobService.updateJob(job.job_id,jobData).then(function(resp){if(resp.success){saveDatafeedWrapper()}else{reject(resp)}}).catch(function(error){reject(error)})}else{saveDatafeedWrapper()}})}function saveDatafeed(datafeedData,job){return new Promise(function(resolve,reject){if(Object.keys(datafeedData).length){var datafeedId=job.datafeed_config.datafeed_id;_job_service.mlJobService.updateDatafeed(datafeedId,datafeedData).then(function(resp){if(resp.success){resolve()}else{reject(resp)}})}else{resolve()}})}function loadSavedDashboards(maxNumber){return new Promise(function(resolve,reject){var savedObjectsClient=_chrome.default.getSavedObjectsClient();savedObjectsClient.find({type:"dashboard",fields:["title"],perPage:maxNumber}).then(function(resp){var savedObjects=resp.savedObjects;if(savedObjects!==undefined){var dashboards=savedObjects.map(function(savedObj){return{id:savedObj.id,title:savedObj.attributes.title}});dashboards.sort(function(dash1,dash2){return dash1.title.localeCompare(dash2.title)});resolve(dashboards)}}).catch(function(resp){reject(resp)})})}function loadIndexPatterns(maxNumber){return new Promise(function(resolve,reject){var savedObjectsClient=_chrome.default.getSavedObjectsClient();savedObjectsClient.find({type:"index-pattern",fields:["title"],perPage:maxNumber}).then(function(resp){var savedObjects=resp.savedObjects;if(savedObjects!==undefined){var indexPatterns=savedObjects.map(function(savedObj){return{id:savedObj.id,title:savedObj.attributes.title}});indexPatterns.sort(function(dash1,dash2){return dash1.title.localeCompare(dash2.title)});resolve(indexPatterns)}}).catch(function(resp){reject(resp)})})}function extractDescription(job,newJobData){var description=newJobData.description;if(newJobData.description!==job.description){return{description:description}}return{}}function extractGroups(job,newJobData){var groups=newJobData.groups;if(newJobData.groups!==undefined){var diffCount=(0,_lodash.difference)(job.groups,groups).length+(0,_lodash.difference)(groups,job.groups).length;return diffCount===0?{}:{groups:groups}}return{}}function extractMML(job,newJobData){var jobLimits=(0,_new_job_defaults.newJobLimits)();var mmlData={};if(job.analysis_limits.model_memory_limit!==undefined){var mml=newJobData.mml;if(mml===""){mml=jobLimits.max_model_memory_limit}if(mml!==job.analysis_limits.model_memory_limit){mmlData.analysis_limits={model_memory_limit:mml}}}return mmlData}function extractDetectorDescriptions(job,newJobData){var detectors=[];var descriptions=newJobData.detectorDescriptions.map(function(d,i){return{detector_index:i,description:d}});var originalDetectors=job.analysis_config.detectors;originalDetectors.forEach(function(d){if(descriptions[d.detector_index].description!==d.detector_description){detectors.push(descriptions[d.detector_index])}});return detectors.length?{detectors:detectors}:{}}function extractCustomSettings(job,newJobData){var settingsData={};if(newJobData&&newJobData.customUrls){settingsData.custom_settings=job.custom_settings||{};settingsData.custom_settings.custom_urls=newJobData.customUrls}return settingsData}function extractDatafeed(job,newDatafeedData){var datafeedData={};if(job.datafeed_config!==undefined){var origQueryString=JSON.stringify(job.datafeed_config.query);var newQuery=JSON.parse(newDatafeedData.datafeedQuery);var newQueryString=JSON.stringify(newQuery);if(origQueryString!==newQueryString){datafeedData.query=newQuery}if(job.datafeed_config.query_delay!==newDatafeedData.datafeedQueryDelay){datafeedData.query_delay=newDatafeedData.datafeedQueryDelay}if(job.datafeed_config.frequency!==newDatafeedData.datafeedFrequency&&newDatafeedData.datafeedFrequency!==""){datafeedData.frequency=newDatafeedData.datafeedFrequency}if(job.datafeed_config.scroll_size!==newDatafeedData.datafeedScrollSize){datafeedData.scroll_size=newDatafeedData.datafeedScrollSize}}return datafeedData}function processCustomSettings(jobData,datafeedData){var customSettings={};if(jobData.custom_settings!==undefined){customSettings=_objectSpread({},jobData.custom_settings);if(jobData.custom_settings.created_by!==undefined){if(jobData.detectors!==undefined||Object.keys(datafeedData).length||jobData.custom_settings.custom_urls!==undefined&&jobData.custom_settings.custom_urls.length){delete customSettings.created_by}}}return customSettings}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateModelMemoryLimit=validateModelMemoryLimit;exports.validateGroupNames=validateGroupNames;exports.isValidCustomUrls=isValidCustomUrls;var _new_job_defaults=__webpack_require__(337);var _validate_job=__webpack_require__(678);var _job_utils=__webpack_require__(58);var _custom_url_utils=__webpack_require__(498);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function validateModelMemoryLimit(mml){var limits=(0,_new_job_defaults.newJobLimits)();var tempJob={analysis_limits:{model_memory_limit:mml}};var validationResults=(0,_job_utils.validateModelMemoryLimitUnits)(tempJob);var _validationResults=validationResults,valid=_validationResults.valid;if(valid){validationResults=(0,_job_utils.validateModelMemoryLimit)(tempJob,limits);valid=validationResults.valid}var modelMemoryLimit={valid:valid,message:""};(0,_validate_job.populateValidationMessages)(validationResults,{modelMemoryLimit:modelMemoryLimit});return modelMemoryLimit}function validateGroupNames(groups){var tempJob={groups:groups};var validationResults=(0,_job_utils.validateGroupNames)(tempJob);var valid=validationResults.valid;var groupIds={valid:valid,message:""};(0,_validate_job.populateValidationMessages)(validationResults,{groupIds:groupIds});return groupIds}function isValidCustomUrls(customUrls){if(customUrls===undefined||customUrls.length===0){return true}var isInvalidItem=customUrls.some(function(customUrl,index){var label=customUrl.url_name;var otherUrls=_toConsumableArray(customUrls);otherUrls.splice(index,1);var itemValid=(0,_custom_url_utils.isValidLabel)(label,otherUrls);if(itemValid===true){var timeRange=customUrl.time_range;itemValid=(0,_custom_url_utils.isValidTimeRange)(timeRange)}return!itemValid});return!isInvalidItem}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlCalendarService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _messagebar_service=__webpack_require__(268);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var msgs=_messagebar_service.mlMessageBarService;var CalendarService=function(){function CalendarService(){_classCallCheck(this,CalendarService);this.calendars=[];this.jobCalendars={};this.groupCalendars={}}_createClass(CalendarService,[{key:"loadCalendars",value:function loadCalendars(jobs){var _this=this;return new Promise(function(resolve,reject){var calendars=[];jobs.forEach(function(j){_this.jobCalendars[j.job_id]=[]});var groups={};_job_service.mlJobService.getJobGroups().forEach(function(g){groups[g.id]=g});_ml_api_service.ml.calendars().then(function(resp){calendars=resp;calendars.forEach(function(cal){cal.job_ids.forEach(function(id){var isGroup=false;if(_this.jobCalendars[id]!==undefined){_this.jobCalendars[id].push(cal.calendar_id)}else if(groups[id]!==undefined){isGroup=true;groups[id].jobs.forEach(function(j){_this.jobCalendars[j.job_id].push(cal.calendar_id)})}else{isGroup=true}if(isGroup){if(_this.groupCalendars[id]===undefined){_this.groupCalendars[id]=[cal.calendar_id]}else{_this.groupCalendars[id].push(cal.calendar_id)}}})});_lodash.default.each(_this.jobCalendars,function(cal,id){_this.jobCalendars[id]=_lodash.default.uniq(cal)});_this.calendars=calendars;resolve({calendars:calendars})}).catch(function(err){msgs.error(_i18n.i18n.translate("xpack.ml.calendarService.calendarsListCouldNotBeRetrievedErrorMessage",{defaultMessage:"Calendars list could not be retrieved"}));msgs.error("",err);reject({calendars:calendars,err:err})})})}},{key:"getCalendarGroups",value:function getCalendarGroups(){return Object.keys(this.groupCalendars).map(function(id){return{id:id}})}}]);return CalendarService}();var mlCalendarService=new CalendarService;exports.mlCalendarService=mlCalendarService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.changeJobIDCase=changeJobIDCase;function changeJobIDCase(config){if(config.jobId){config.jobId=config.jobId.toLowerCase()}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var moment_1=tslib_1.__importDefault(__webpack_require__(16));var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var timefilter_1=__webpack_require__(22);var ml_api_service_1=__webpack_require__(24);function setFullTimeRange(indexPattern,query){return ml_api_service_1.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:query}).then(function(resp){timefilter_1.timefilter.setTime({from:moment_1.default(resp.start.epoch).toISOString(),to:moment_1.default(resp.end.epoch).toISOString()})}).catch(function(resp){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."}))})}exports.setFullTimeRange=setFullTimeRange},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricJobServiceProvider=SingleMetricJobServiceProvider;var _lodash=_interopRequireDefault(__webpack_require__(3));var _parse_interval=__webpack_require__(275);var _job_utils=__webpack_require__(58);var _general=__webpack_require__(361);var _string_utils=__webpack_require__(67);var _field_format_service=__webpack_require__(296);var _job_service=__webpack_require__(36);var _results_service=__webpack_require__(436);var _new_job_utils=__webpack_require__(294);var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function SingleMetricJobServiceProvider(){var SingleMetricJobService=function(){function SingleMetricJobService(){_classCallCheck(this,SingleMetricJobService);this.chartData={line:[],model:[],swimlane:[],hasBounds:false,percentComplete:0,highestValue:0,chartTicksMargin:{width:30},totalResults:0};this.job={}}_createClass(SingleMetricJobService,[{key:"getLineChartResults",value:function getLineChartResults(formConfig){var _this=this;return new Promise(function(resolve,reject){_this.chartData.line=[];_this.chartData.model=[];_this.chartData.swimlane=[];_this.chartData.hasBounds=false;_this.chartData.percentComplete=0;_this.chartData.loadingDifference=0;_this.chartData.eventRateHighestValue=0;_this.chartData.totalResults=0;var aggType=formConfig.agg.type.dslName;if(formConfig.field&&formConfig.field.id){_this.chartData.fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(formConfig.indexPattern,formConfig.field.id,aggType)}else{delete _this.chartData.fieldFormat}var obj={success:true,results:{}};var searchJson=getSearchJsonFromConfig(formConfig);_ml_api_service.ml.esSearch(searchJson).then(function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);var highestValue;var lowestValue;_lodash.default.each(aggregationsByTime,function(dataForTime){var time=dataForTime.key;var value=_lodash.default.get(dataForTime,["field_value","value"]);if(value===undefined&&formConfig.field!==null){value=_lodash.default.get(dataForTime,["field_value","values",_job_utils.ML_MEDIAN_PERCENTS])}if(value===undefined&&formConfig.field===null){value=dataForTime.doc_count}if(!isFinite(value)||dataForTime.doc_count===0){value=null}if(value!==null){highestValue=highestValue===undefined?value:Math.max(value,highestValue);lowestValue=lowestValue===undefined?value:Math.min(value,lowestValue)}obj.results[time]={actual:value}});_this.chartData.totalResults=resp.hits.total;_this.chartData.line=processLineChartResults(obj.results);lowestValue=lowestValue===undefined?0:lowestValue;highestValue=highestValue===undefined?1:highestValue;var valueRange=highestValue-lowestValue;if(valueRange>1){lowestValue=Math.floor(lowestValue);_this.chartData.highestValue=Math.ceil(highestValue)}else{_this.chartData.highestValue=highestValue}var lowValueWidth=0;var highValueWidth=0;if(_this.chartData.fieldFormat!==undefined){var lowValueFormatted=_this.chartData.fieldFormat.convert(lowestValue,"text");var highValueFormatted=_this.chartData.fieldFormat.convert(_this.chartData.highestValue,"text");lowValueWidth=(0,_string_utils.calculateTextWidth)(lowValueFormatted,false);highValueWidth=(0,_string_utils.calculateTextWidth)(highValueFormatted,false)}else{lowValueWidth=(0,_string_utils.calculateTextWidth)(lowestValue,true);highValueWidth=(0,_string_utils.calculateTextWidth)(_this.chartData.highestValue,true)}_this.chartData.chartTicksMargin.width=Math.max(lowValueWidth,highValueWidth)+10;resolve(_this.chartData)}).catch(function(resp){reject(resp)})})}},{key:"getJobFromConfig",value:function getJobFromConfig(formConfig){var _aggregations2,_aggregations3;var job=_job_service.mlJobService.getBlankJob();job.data_description.time_field=formConfig.timeField;var func=formConfig.agg.type.mlName;if(formConfig.isSparseData){if(formConfig.agg.type.dslName==="count"){func=func.replace(/count/,"non_zero_count")}else if(formConfig.agg.type.dslName==="sum"){func=func.replace(/sum/,"non_null_sum")}}var dtr={function:func};var query=formConfig.combinedQuery;if(formConfig.field&&formConfig.field.id){dtr.field_name=formConfig.field.id}job.analysis_config.detectors.push(dtr);job.analysis_config.bucket_span=formConfig.bucketSpan;job.analysis_limits={model_memory_limit:formConfig.modelMemoryLimit};delete job.data_description.field_delimiter;delete job.data_description.quote_character;delete job.data_description.time_format;delete job.data_description.format;var bucketSpanSeconds=(0,_parse_interval.parseInterval)(formConfig.bucketSpan).asSeconds();var indices=formConfig.indexPattern.title.split(",").map(function(i){return i.trim()});job.datafeed_config={query:query,indices:indices};job.job_id=formConfig.jobId;job.description=formConfig.description;job.groups=formConfig.jobGroups;job.model_plot_config={enabled:true};if(formConfig.useDedicatedIndex){job.results_index_name=job.job_id}if(formConfig.usesSavedSearch===false){job.custom_settings={created_by:_general.WIZARD_TYPE.SINGLE_METRIC}}var aggType=formConfig.agg.type.dslName;var interval=bucketSpanSeconds*1e3;switch(aggType){case"count":job.analysis_config.summary_count_field_name="doc_count";job.datafeed_config.aggregations={buckets:{date_histogram:{field:formConfig.timeField,fixed_interval:"".concat(interval,"ms")},aggregations:_defineProperty({},formConfig.timeField,{max:{field:formConfig.timeField}})}};break;case"avg":case"median":case"sum":case"min":case"max":job.analysis_config.summary_count_field_name="doc_count";job.datafeed_config.aggregations={buckets:{date_histogram:{field:formConfig.timeField,fixed_interval:"".concat(interval/100*10,"ms")},aggregations:(_aggregations2={},_defineProperty(_aggregations2,dtr.field_name,_defineProperty({},aggType,{field:formConfig.field.name})),_defineProperty(_aggregations2,formConfig.timeField,{max:{field:formConfig.timeField}}),_aggregations2)}};break;case"cardinality":job.analysis_config.summary_count_field_name="dc_"+dtr.field_name;job.datafeed_config.aggregations={buckets:{date_histogram:{field:formConfig.timeField,fixed_interval:"".concat(interval,"ms")},aggregations:(_aggregations3={},_defineProperty(_aggregations3,formConfig.timeField,{max:{field:formConfig.timeField}}),_defineProperty(_aggregations3,job.analysis_config.summary_count_field_name,_defineProperty({},aggType,{field:formConfig.field.name})),_aggregations3)}};dtr.function="non_zero_count";dtr.detector_description="".concat(func," (").concat(dtr.field_name,")");delete dtr.field_name;break;default:break}return job}},{key:"createJob",value:function createJob(formConfig){var _this2=this;return new Promise(function(resolve,reject){_this2.job=_this2.getJobFromConfig(formConfig);var job=(0,_new_job_utils.createJobForSaving)(_this2.job);_job_service.mlJobService.saveNewJob(job).then(function(resp){if(resp.success){resolve(_this2.job)}else{reject(resp)}})})}},{key:"startDatafeed",value:function startDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.startDatafeed(datafeedId,formConfig.jobId,formConfig.start,formConfig.end)}},{key:"stopDatafeed",value:function stopDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.stopDatafeed(datafeedId,formConfig.jobId)}},{key:"checkDatafeedState",value:function checkDatafeedState(formConfig){return _job_service.mlJobService.updateSingleJobDatafeedState(formConfig.jobId)}},{key:"loadModelData",value:function loadModelData(formConfig){var _this3=this;return new Promise(function(resolve,reject){var start=formConfig.start;if(_this3.chartData.model.length>5){start=_this3.chartData.model[_this3.chartData.model.length-5].time;for(var i=0;i<5;i++){_this3.chartData.model.pop()}}_results_service.mlResultsService.getModelPlotOutput(formConfig.jobId,0,[],start,formConfig.end,formConfig.resultsIntervalSeconds+"s",formConfig.agg.type.mlModelPlotAgg).then(function(data){var scale=1;if(formConfig&&(formConfig.agg.type.mlName==="count"||formConfig.agg.type.mlName==="high_count"||formConfig.agg.type.mlName==="low_count"||formConfig.agg.type.mlName==="distinct_count")){var chartIntervalSeconds=formConfig.chartInterval.getInterval().asSeconds();var bucketSpan=(0,_parse_interval.parseInterval)(formConfig.bucketSpan);if(bucketSpan!==null){scale=chartIntervalSeconds/bucketSpan.asSeconds()}}_this3.chartData.model=_this3.chartData.model.concat(processLineChartResults(data.results,scale));var lastBucket=_this3.chartData.model[_this3.chartData.model.length-1];var time=lastBucket!==undefined?lastBucket.time:formConfig.start;var pcnt=(time-formConfig.start+formConfig.resultsIntervalSeconds)/(formConfig.end-formConfig.start)*100;_this3.chartData.percentComplete=Math.round(pcnt);resolve(_this3.chartData)}).catch(function(){reject(_this3.chartData)})})}},{key:"loadSwimlaneData",value:function loadSwimlaneData(formConfig){var _this4=this;return new Promise(function(resolve){_results_service.mlResultsService.getScoresByBucket([formConfig.jobId],formConfig.start,formConfig.end,formConfig.resultsIntervalSeconds+"s",1).then(function(data){var jobResults=data.results[formConfig.jobId];_this4.chartData.swimlane=processSwimlaneResults(jobResults);_this4.chartData.swimlaneInterval=formConfig.resultsIntervalSeconds*1e3;resolve(_this4.chartData)}).catch(function(){resolve(_this4.chartData)})})}}]);return SingleMetricJobService}();return new SingleMetricJobService}function processLineChartResults(data){var scale=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var lineData=[];_lodash.default.each(data,function(dataForTime,t){var time=+t;var date=new Date(time);lineData.push({date:date,time:time,lower:dataForTime.modelLower*scale,value:dataForTime.actual,upper:dataForTime.modelUpper*scale})});return _lodash.default.sortBy(lineData,"time")}function processSwimlaneResults(bucketScoreData,init){var swimlaneData=[];_lodash.default.each(bucketScoreData,function(value,t){var time=+t;var date=new Date(time);value=init?0:value;swimlaneData.push({date:date,time:time,value:value,color:""})});return swimlaneData}function getSearchJsonFromConfig(formConfig){var interval=formConfig.chartInterval.getInterval().asMilliseconds()+"ms";var query=_lodash.default.cloneDeep(formConfig.combinedQuery);var json={index:formConfig.indexPattern.title,size:0,rest_total_hits_as_int:true,body:{query:{},aggs:{times:{date_histogram:{field:formConfig.timeField,interval:interval,min_doc_count:0,extended_bounds:{min:formConfig.start,max:formConfig.end}}}}}};query.bool.must.push({range:_defineProperty({},formConfig.timeField,{gte:formConfig.start,lte:formConfig.end,format:formConfig.format})});json.body.query=query;if(formConfig.field!==null){json.body.aggs.times.aggs={field_value:_defineProperty({},formConfig.agg.type.dslName,{field:formConfig.field.name})}}return json}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldTypeIcon=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _field_types_utils=__webpack_require__(578);var _field_types=__webpack_require__(295);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var FieldTypeIcon=function FieldTypeIcon(_ref){var _ref$tooltipEnabled=_ref.tooltipEnabled,tooltipEnabled=_ref$tooltipEnabled===void 0?false:_ref$tooltipEnabled,type=_ref.type,_ref$needsAria=_ref.needsAria,needsAria=_ref$needsAria===void 0?true:_ref$needsAria;var ariaLabel=(0,_field_types_utils.getMLJobTypeAriaLabel)(type);if(ariaLabel===null){return null}var iconClass=["field-type-icon"];var iconChar="";switch(type){case _field_types.ML_JOB_FIELD_TYPES.BOOLEAN:iconClass.push("kuiIcon","fa-adjust");break;case _field_types.ML_JOB_FIELD_TYPES.DATE:iconClass.push("kuiIcon","fa-clock-o");break;case _field_types.ML_JOB_FIELD_TYPES.GEO_POINT:iconClass.push("kuiIcon","fa-globe");break;case _field_types.ML_JOB_FIELD_TYPES.TEXT:iconClass.push("kuiIcon","fa-file-text-o");break;case _field_types.ML_JOB_FIELD_TYPES.IP:iconClass.push("kuiIcon","fa-laptop");break;case _field_types.ML_JOB_FIELD_TYPES.KEYWORD:iconChar="t";break;case _field_types.ML_JOB_FIELD_TYPES.NUMBER:iconChar="#";break;case _field_types.ML_JOB_FIELD_TYPES.UNKNOWN:iconChar="?";break}var containerProps={ariaLabel:ariaLabel,className:iconClass.join(" "),iconChar:iconChar,needsAria:needsAria};if(tooltipEnabled===true){return _react.default.createElement(_eui.EuiToolTip,{position:"left",content:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.fieldTypeTooltip",{defaultMessage:"{type} type",values:{type:type}})},_react.default.createElement(FieldTypeIconContainer,containerProps))}return _react.default.createElement(FieldTypeIconContainer,containerProps)};exports.FieldTypeIcon=FieldTypeIcon;FieldTypeIcon.propTypes={tooltipEnabled:_propTypes.default.bool,type:_propTypes.default.string};function FieldTypeIconContainer(_ref2){var ariaLabel=_ref2.ariaLabel,className=_ref2.className,iconChar=_ref2.iconChar,needsAria=_ref2.needsAria,rest=_objectWithoutProperties(_ref2,["ariaLabel","className","iconChar","needsAria"]);var wrapperProps={className:className};if(needsAria&&ariaLabel){wrapperProps["aria-label"]=ariaLabel}return _react.default.createElement("span",_extends({className:"field-type-icon-container"},rest),iconChar===""?_react.default.createElement("span",wrapperProps):_react.default.createElement("span",wrapperProps,_react.default.createElement("strong",{"aria-hidden":"true"},iconChar)))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartDataUtilsProvider=ChartDataUtilsProvider;var _lodash=_interopRequireDefault(__webpack_require__(3));var _ml_time_buckets=__webpack_require__(338);var _string_utils=__webpack_require__(67);var _results_service=__webpack_require__(436);var _search_service=__webpack_require__(681);var _timefilter=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ChartDataUtilsProvider(Private){var TimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);function loadDocCountData(formConfig,chartData){return new Promise(function(resolve,reject){var BAR_TARGET=Math.ceil(formConfig.chartInterval.barTarget/10);var MAX_BARS=BAR_TARGET+BAR_TARGET/100*100;var query=formConfig.combinedQuery;var bounds=_timefilter.timefilter.getActiveBounds();var buckets=new TimeBuckets;buckets.setBarTarget(BAR_TARGET);buckets.setMaxBars(MAX_BARS);buckets.setInterval("auto");buckets.setBounds(bounds);var interval=buckets.getInterval().asMilliseconds();var end=formConfig.end;var start=formConfig.start;_results_service.mlResultsService.getEventRateData(formConfig.indexPattern.title,query,formConfig.timeField,start,end,interval+"ms").then(function(resp){var highestValue=0;chartData.job.bars=[];_lodash.default.each(resp.results,function(value,t){if(!isFinite(value)){value=0}if(value>highestValue){highestValue=value}var time=+t;var date=new Date(time);chartData.job.barsInterval=interval;chartData.job.bars.push({date:date,time:time,value:value})});chartData.totalResults=resp.total;chartData.eventRateHighestValue=Math.ceil(highestValue);resolve(chartData)}).catch(function(resp){console.log("getEventRate visualization - error getting event rate data from elasticsearch:",resp);reject(resp)})})}function loadJobSwimlaneData(formConfig,chartData){return new Promise(function(resolve){_results_service.mlResultsService.getScoresByBucket([formConfig.jobId],formConfig.start,formConfig.end,formConfig.resultsIntervalSeconds+"s",1).then(function(data){var time=formConfig.start;var jobResults=data.results[formConfig.jobId];chartData.job.swimlane=[];_lodash.default.each(jobResults,function(value,t){time=+t;var date=new Date(time);chartData.job.swimlane.push({date:date,time:time,value:value,color:""})});var pcnt=(time-formConfig.start+formConfig.resultsIntervalSeconds)/(formConfig.end-formConfig.start)*100;chartData.percentComplete=Math.round(pcnt);chartData.job.percentComplete=chartData.percentComplete;chartData.job.swimlaneInterval=formConfig.resultsIntervalSeconds*1e3;resolve(chartData)}).catch(function(){resolve(chartData)})})}function loadDetectorSwimlaneData(formConfig,chartData){return new Promise(function(resolve){_search_service.mlSimpleJobSearchService.getScoresByRecord(formConfig.jobId,formConfig.start,formConfig.end,formConfig.resultsIntervalSeconds+"s",{name:formConfig.splitField!==undefined?formConfig.splitField.name:undefined,value:formConfig.firstSplitFieldName}).then(function(data){var dtrIndex=0;_lodash.default.each(formConfig.fields,function(field,key){var dtr=chartData.detectors[key];var times=data.results[dtrIndex];dtr.swimlane=[];_lodash.default.each(times,function(timeObj,t){var time=+t;var date=new Date(time);dtr.swimlane.push({date:date,time:time,value:timeObj.recordScore,color:""})});dtr.percentComplete=chartData.percentComplete;dtr.swimlaneInterval=formConfig.resultsIntervalSeconds*1e3;dtrIndex++});resolve(chartData)}).catch(function(){resolve(chartData)})})}function getSplitFields(formConfig,splitFieldName,size){var query=formConfig.combinedQuery;return _search_service.mlSimpleJobSearchService.getCategoryFields(formConfig.indexPattern.title,splitFieldName,size,query)}function updateChartMargin(chartData){var longestTextWidth=(0,_string_utils.calculateTextWidth)(chartData.eventRateHighestValue,true);var textCheckMultiplier=1+Math.sqrt(2)/100;_lodash.default.each(chartData.detectors,function(detector){var longestWidthForDetector=0;if(detector.fieldFormat!==undefined){var longestTextForDetector=detector.fieldFormat.convert(detector.highestValue,"text");longestWidthForDetector=(0,_string_utils.calculateTextWidth)(longestTextForDetector,false);var longestTextCheck=detector.fieldFormat.convert(detector.highestValue*textCheckMultiplier,"text");var longestWidthCheck=(0,_string_utils.calculateTextWidth)(longestTextCheck,false);longestWidthForDetector=Math.max(longestWidthForDetector,longestWidthCheck)}else{longestWidthForDetector=(0,_string_utils.calculateTextWidth)(detector.highestValue,true)}longestTextWidth=Math.max(longestTextWidth,longestWidthForDetector)});chartData.chartTicksMargin.width=longestTextWidth+10}return{loadDocCountData:loadDocCountData,loadJobSwimlaneData:loadJobSwimlaneData,loadDetectorSwimlaneData:loadDetectorSwimlaneData,getSplitFields:getSplitFields,updateChartMargin:updateChartMargin}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricJobServiceProvider=MultiMetricJobServiceProvider;var _lodash=_interopRequireDefault(__webpack_require__(3));var _general=__webpack_require__(361);var _job_utils=__webpack_require__(58);var _field_format_service=__webpack_require__(296);var _job_service=__webpack_require__(36);var _new_job_utils=__webpack_require__(294);var _ml_api_service=__webpack_require__(24);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function MultiMetricJobServiceProvider(){var MultiMetricJobService=function(){function MultiMetricJobService(){_classCallCheck(this,MultiMetricJobService);this.chartData={job:{swimlane:[],line:[],bars:[],earliestTime:Number.MAX_SAFE_INTEGER},detectors:{},percentComplete:0,loadingDifference:0,lastLoadTimestamp:null,eventRateHighestValue:0,chartTicksMargin:{width:30},totalResults:0};this.job={}}_createClass(MultiMetricJobService,[{key:"clearChartData",value:function clearChartData(){this.chartData.job.swimlane=[];this.chartData.job.line=[];this.chartData.job.bars=[];this.chartData.detectors={};this.chartData.percentComplete=0;this.chartData.loadingDifference=0;this.chartData.eventRateHighestValue=0;this.chartData.totalResults=0;this.job={}}},{key:"getLineChartResults",value:function getLineChartResults(formConfig,thisLoadTimestamp){var _this=this;return new Promise(function(resolve,reject){var fieldIds=Object.keys(formConfig.fields).sort();_this.chartData.job.earliestTime=formConfig.start;var idx=_lodash.default.findIndex(fieldIds,function(id){return id===_general.EVENT_RATE_COUNT_FIELD});if(idx!==-1){fieldIds.splice(idx,1);fieldIds.splice(0,0,_general.EVENT_RATE_COUNT_FIELD)}_lodash.default.each(fieldIds,function(fieldId){_this.chartData.detectors[fieldId]={line:[],swimlane:[],highestValue:0}});var searchJson=getSearchJsonFromConfig(formConfig);_ml_api_service.ml.esSearch(searchJson).then(function(resp){if(thisLoadTimestamp===_this.chartData.lastLoadTimestamp){_lodash.default.each(fieldIds,function(fieldId){_this.chartData.detectors[fieldId]={line:[],swimlane:[],highestValue:0};if(fieldId!==_general.EVENT_RATE_COUNT_FIELD){var field=formConfig.fields[fieldId];var aggType=field.agg.type.dslName;_this.chartData.detectors[fieldId].fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(formConfig.indexPattern,fieldId,aggType)}})}else{resolve(_this.chartData)}var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,function(dataForTime){var time=+dataForTime.key;var date=new Date(time);var docCount=+dataForTime.doc_count;_this.chartData.job.swimlane.push({date:date,time:time,value:0,color:"",percentComplete:0});_this.chartData.job.earliestTime=time<_this.chartData.job.earliestTime?time:_this.chartData.job.earliestTime;_this.chartData.job.line.push({date:date,time:time,value:null});_lodash.default.each(fieldIds,function(fieldId){var value;if(fieldId===_general.EVENT_RATE_COUNT_FIELD){value=docCount}else if(typeof dataForTime[fieldId].value!=="undefined"){value=dataForTime[fieldId].value}else if(typeof dataForTime[fieldId].values!=="undefined"){value=dataForTime[fieldId].values[_job_utils.ML_MEDIAN_PERCENTS]}if(!isFinite(value)||docCount===0){value=null}if(_this.chartData.detectors[fieldId]){_this.chartData.detectors[fieldId].line.push({date:date,time:time,value:value});_this.chartData.detectors[fieldId].swimlane.push({date:date,time:time,value:0,color:"",percentComplete:0});if(value!==null){_this.chartData.detectors[fieldId].highestValue=Math.ceil(Math.max(_this.chartData.detectors[fieldId].highestValue,Math.abs(value)))}}})});resolve(_this.chartData)}).catch(function(resp){reject(resp)})})}},{key:"getJobFromConfig",value:function getJobFromConfig(formConfig){var job=_job_service.mlJobService.getBlankJob();job.data_description.time_field=formConfig.timeField;if(formConfig.enableModelPlot===true){job.model_plot_config={enabled:true}}else if(formConfig.enableModelPlot===false){delete job.model_plot_config}_lodash.default.each(formConfig.fields,function(field,key){var func=field.agg.type.mlName;if(formConfig.isSparseData){if(field.agg.type.dslName==="count"){func=func.replace(/count/,"non_zero_count")}else if(field.agg.type.dslName==="sum"){func=func.replace(/sum/,"non_null_sum")}}var dtr={function:func};dtr.detector_description=func;if(key!==_general.EVENT_RATE_COUNT_FIELD){dtr.field_name=field.name;dtr.detector_description+="(".concat(field.name,")")}if(formConfig.splitField!==undefined){dtr.partition_field_name=formConfig.splitField.name}job.analysis_config.detectors.push(dtr)});var influencerFields=formConfig.influencerFields.map(function(f){return f.name});if(influencerFields&&influencerFields.length){job.analysis_config.influencers=influencerFields}var query=formConfig.combinedQuery;job.analysis_config.bucket_span=formConfig.bucketSpan;job.analysis_limits={model_memory_limit:formConfig.modelMemoryLimit};delete job.data_description.field_delimiter;delete job.data_description.quote_character;delete job.data_description.time_format;delete job.data_description.format;var indices=formConfig.indexPattern.title.split(",").map(function(i){return i.trim()});job.datafeed_config={query:query,indices:indices};job.job_id=formConfig.jobId;job.description=formConfig.description;job.groups=formConfig.jobGroups;if(formConfig.useDedicatedIndex){job.results_index_name=job.job_id}if(formConfig.usesSavedSearch===false){job.custom_settings={created_by:_general.WIZARD_TYPE.MULTI_METRIC}}return job}},{key:"createJob",value:function createJob(formConfig){var _this2=this;return new Promise(function(resolve,reject){_this2.job=_this2.getJobFromConfig(formConfig);var job=(0,_new_job_utils.createJobForSaving)(_this2.job);_job_service.mlJobService.saveNewJob(job).then(function(resp){if(resp.success){resolve(_this2.job)}else{reject(resp)}})})}},{key:"startDatafeed",value:function startDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.startDatafeed(datafeedId,formConfig.jobId,formConfig.start,formConfig.end)}},{key:"stopDatafeed",value:function stopDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.stopDatafeed(datafeedId,formConfig.jobId)}}]);return MultiMetricJobService}();return new MultiMetricJobService}function getSearchJsonFromConfig(formConfig){var interval=formConfig.chartInterval.getInterval().asMilliseconds()+"ms";var query=_lodash.default.cloneDeep(formConfig.combinedQuery);var json={index:formConfig.indexPattern.title,size:0,body:{query:{},aggs:{times:{date_histogram:{field:formConfig.timeField,interval:interval,min_doc_count:0,extended_bounds:{min:formConfig.start,max:formConfig.end}}}}}};query.bool.must.push({range:_defineProperty({},formConfig.timeField,{gte:formConfig.start,lte:formConfig.end,format:formConfig.format})});if(formConfig.firstSplitFieldName!==undefined){query.bool.must.push({term:_defineProperty({},formConfig.splitField.name,formConfig.firstSplitFieldName)})}json.body.query=query;if(Object.keys(formConfig.fields).length){json.body.aggs.times.aggs={};_lodash.default.each(formConfig.fields,function(field){if(field.id!==_general.EVENT_RATE_COUNT_FIELD){json.body.aggs.times.aggs[field.id]=_defineProperty({},field.agg.type.dslName,{field:field.name});if(field.agg.type.dslName==="percentiles"){json.body.aggs.times.aggs[field.id][field.agg.type.dslName].percents=[_job_utils.ML_MEDIAN_PERCENTS]}}})}return json}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2894)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2898);__webpack_require__(402)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2900)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2902)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2904)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2907)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationJobServiceProvider=PopulationJobServiceProvider;var _lodash=_interopRequireDefault(__webpack_require__(3));var _general=__webpack_require__(361);var _job_utils=__webpack_require__(58);var _ml_time_buckets=__webpack_require__(338);var _field_format_service=__webpack_require__(296);var _job_service=__webpack_require__(36);var _new_job_utils=__webpack_require__(294);var _ml_api_service=__webpack_require__(24);var _timefilter=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function PopulationJobServiceProvider(Private){var TimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var OVER_FIELD_EXAMPLES_COUNT=40;var PopulationJobService=function(){function PopulationJobService(){_classCallCheck(this,PopulationJobService);this.chartData={job:{swimlane:[],line:[],bars:[],earliestTime:Number.MAX_SAFE_INTEGER},detectors:{},percentComplete:0,loadingDifference:0,lastLoadTimestamp:null,eventRateHighestValue:0,chartTicksMargin:{width:30},totalResults:0};this.job={}}_createClass(PopulationJobService,[{key:"clearChartData",value:function clearChartData(){this.chartData.job.swimlane=[];this.chartData.job.line=[];this.chartData.job.bars=[];this.chartData.detectors={};this.chartData.percentComplete=0;this.chartData.loadingDifference=0;this.chartData.eventRateHighestValue=0;this.chartData.totalResults=0;this.job={}}},{key:"getLineChartResults",value:function getLineChartResults(formConfig,thisLoadTimestamp){var _this=this;return new Promise(function(resolve,reject){var fieldIds=formConfig.fields.map(function(f){return f.id});_this.chartData.job.earliestTime=formConfig.start;var idx=_lodash.default.findIndex(fieldIds,function(id){return id===_general.EVENT_RATE_COUNT_FIELD});if(idx!==-1){fieldIds.splice(idx,1);fieldIds.splice(0,0,_general.EVENT_RATE_COUNT_FIELD)}fieldIds.forEach(function(fieldId,i){_this.chartData.detectors[i]={line:[],swimlane:[],highestValue:0}});var searchJson=getSearchJsonFromConfig(formConfig,_timefilter.timefilter,TimeBuckets);_ml_api_service.ml.esSearch(searchJson).then(function(resp){if(thisLoadTimestamp===_this.chartData.lastLoadTimestamp){fieldIds.forEach(function(fieldId,i){_this.chartData.detectors[i]={line:[],swimlane:[],highestValue:0};if(fieldId!==_general.EVENT_RATE_COUNT_FIELD){var field=formConfig.fields[i];var aggType=field.agg.type.dslName;_this.chartData.detectors[i].fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(formConfig.indexPattern,fieldId,aggType)}})}else{resolve(_this.chartData)}var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,function(dataForTime){var time=+dataForTime.key;var date=new Date(time);_this.chartData.job.swimlane.push({date:date,time:time,value:0,color:"",percentComplete:0});_this.chartData.job.earliestTime=time<_this.chartData.job.earliestTime?time:_this.chartData.job.earliestTime;_this.chartData.job.line.push({date:date,time:time,value:null});fieldIds.forEach(function(fieldId,i){var populationBuckets=_lodash.default.get(dataForTime,["population","buckets"],[]);var values=[];if(fieldId===_general.EVENT_RATE_COUNT_FIELD){populationBuckets.forEach(function(b){if(b[i]===undefined){values.push({label:b.key,value:b.doc_count})}else{values.push({label:b.key,value:b[i].doc_count})}})}else if(typeof dataForTime.population!=="undefined"){populationBuckets.forEach(function(b){var tempBucket=b[i];var value=null;var tempValue=tempBucket.value===undefined&&tempBucket.splitValue!==undefined?tempBucket.splitValue:tempBucket;if(tempValue.value===undefined&&tempValue.values!==undefined){value=tempValue.values[_job_utils.ML_MEDIAN_PERCENTS]}else{value=tempValue.value}values.push({label:b.key,value:isFinite(value)?value:null})})}var highestValueField=_lodash.default.reduce(values,function(p,c){return c.value>p.value?c:p},{value:0});if(_this.chartData.detectors[i]){_this.chartData.detectors[i].line.push({date:date,time:time,values:values});_this.chartData.detectors[i].swimlane.push({date:date,time:time,value:0,color:"",percentComplete:0});_this.chartData.detectors[i].highestValue=Math.ceil(Math.max(_this.chartData.detectors[i].highestValue,Math.abs(highestValueField.value)))}})});resolve(_this.chartData)}).catch(function(resp){reject(resp)})})}},{key:"getJobFromConfig",value:function getJobFromConfig(formConfig){var job=_job_service.mlJobService.getBlankJob();job.data_description.time_field=formConfig.timeField;if(formConfig.enableModelPlot===true){job.model_plot_config={enabled:true}}else if(formConfig.enableModelPlot===false){delete job.model_plot_config}formConfig.fields.forEach(function(field){var func=field.agg.type.mlName;if(formConfig.isSparseData){if(field.agg.type.dslName==="count"){func=func.replace(/count/,"non_zero_count")}else if(field.agg.type.dslName==="sum"){func=func.replace(/sum/,"non_null_sum")}}var dtr={function:func};dtr.detector_description=func;if(field.id!==_general.EVENT_RATE_COUNT_FIELD){dtr.field_name=field.name;dtr.detector_description+="(".concat(field.name,")")}if(field.splitField!==undefined){dtr.by_field_name=field.splitField.name;dtr.detector_description+=" by ".concat(dtr.by_field_name)}if(formConfig.overField!==undefined){dtr.over_field_name=formConfig.overField.name;dtr.detector_description+=" over ".concat(dtr.over_field_name)}job.analysis_config.detectors.push(dtr)});var influencerFields=formConfig.influencerFields.map(function(f){return f.name});if(influencerFields&&influencerFields.length){job.analysis_config.influencers=influencerFields}var query=formConfig.combinedQuery;job.analysis_config.bucket_span=formConfig.bucketSpan;job.analysis_limits={model_memory_limit:formConfig.modelMemoryLimit};delete job.data_description.field_delimiter;delete job.data_description.quote_character;delete job.data_description.time_format;delete job.data_description.format;var indices=formConfig.indexPattern.title.split(",").map(function(i){return i.trim()});job.datafeed_config={query:query,indices:indices};job.job_id=formConfig.jobId;job.description=formConfig.description;job.groups=formConfig.jobGroups;if(formConfig.useDedicatedIndex){job.results_index_name=job.job_id}if(formConfig.usesSavedSearch===false){job.custom_settings={created_by:_general.WIZARD_TYPE.POPULATION}}return job}},{key:"createJob",value:function createJob(formConfig){var _this2=this;return new Promise(function(resolve,reject){_this2.job=_this2.getJobFromConfig(formConfig);var job=(0,_new_job_utils.createJobForSaving)(_this2.job);_job_service.mlJobService.saveNewJob(job).then(function(resp){if(resp.success){resolve(_this2.job)}else{reject(resp)}})})}},{key:"startDatafeed",value:function startDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.startDatafeed(datafeedId,formConfig.jobId,formConfig.start,formConfig.end)}},{key:"stopDatafeed",value:function stopDatafeed(formConfig){var datafeedId=_job_service.mlJobService.getDatafeedId(formConfig.jobId);return _job_service.mlJobService.stopDatafeed(datafeedId,formConfig.jobId)}}]);return PopulationJobService}();function getSearchJsonFromConfig(formConfig){var bounds=_timefilter.timefilter.getActiveBounds();var buckets=new TimeBuckets;buckets.setInterval("auto");buckets.setBounds(bounds);var interval=buckets.getInterval().asMilliseconds();var query=_lodash.default.cloneDeep(formConfig.combinedQuery);var json={index:formConfig.indexPattern.title,size:0,body:{query:{},aggs:{times:{date_histogram:{field:formConfig.timeField,interval:interval,min_doc_count:0,extended_bounds:{min:formConfig.start,max:formConfig.end}}}}}};query.bool.must.push({range:_defineProperty({},formConfig.timeField,{gte:formConfig.start,lte:formConfig.end,format:formConfig.format})});json.body.query=query;if(formConfig.fields.length){var aggs={};formConfig.fields.forEach(function(field,i){if(field.id===_general.EVENT_RATE_COUNT_FIELD){if(field.splitField!==undefined&&field.firstSplitFieldName!==undefined){aggs[i]={filter:{term:_defineProperty({},field.splitField.name,field.firstSplitFieldName)}}}}else{if(field.splitField!==undefined&&field.firstSplitFieldName!==undefined){aggs[i]={filter:{term:_defineProperty({},field.splitField.name,field.firstSplitFieldName)},aggs:{splitValue:_defineProperty({},field.agg.type.dslName,{field:field.name})}};if(field.agg.type.dslName==="percentiles"){aggs[i].aggs.splitValue[field.agg.type.dslName].percents=[_job_utils.ML_MEDIAN_PERCENTS]}}else{aggs[i]=_defineProperty({},field.agg.type.dslName,{field:field.name});if(field.agg.type.dslName==="percentiles"){aggs[i][field.agg.type.dslName].percents=[_job_utils.ML_MEDIAN_PERCENTS]}}}});if(formConfig.overField!==undefined){json.body.aggs.times.aggs={population:{terms:{field:formConfig.overField.name,size:OVER_FIELD_EXAMPLES_COUNT},aggs:aggs}}}else{json.body.aggs.times.aggs=aggs}}return json}return new PopulationJobService}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CreateRecognizerJobsServiceProvider=CreateRecognizerJobsServiceProvider;var _saved_objects=__webpack_require__(79);var _job_service=__webpack_require__(36);var _ml_api_service=__webpack_require__(24);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function CreateRecognizerJobsServiceProvider(Private){var savedObjectsClient=Private(_saved_objects.SavedObjectsClientProvider);var CreateRecognizerJobsService=function(){function CreateRecognizerJobsService(){_classCallCheck(this,CreateRecognizerJobsService)}_createClass(CreateRecognizerJobsService,[{key:"createDatafeed",value:function createDatafeed(job,formConfig){return new Promise(function(resolve,reject){var jobId=formConfig.jobLabel+job.id;_job_service.mlJobService.saveNewDatafeed(job.datafeedConfig,jobId).then(function(resp){resolve(resp)}).catch(function(resp){reject(resp)})})}},{key:"startDatafeed",value:function startDatafeed(datafeedId,jobId,start,end){return _job_service.mlJobService.startDatafeed(datafeedId,jobId,start,end)}},{key:"loadExistingSavedObjects",value:function loadExistingSavedObjects(type){return savedObjectsClient.find({type:type,perPage:1e3})}},{key:"indexTimeRange",value:function indexTimeRange(indexPattern,formConfig){var query=formConfig.combinedQuery;return _ml_api_service.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:query})}}]);return CreateRecognizerJobsService}();return new CreateRecognizerJobsService}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2933);__webpack_require__(1373)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataRecognizer=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _recognized_result=__webpack_require__(2934);var _ml_api_service=__webpack_require__(24);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var DataRecognizer=function(_Component){_inherits(DataRecognizer,_Component);function DataRecognizer(props){var _this;_classCallCheck(this,DataRecognizer);_this=_possibleConstructorReturn(this,_getPrototypeOf(DataRecognizer).call(this,props));_this.state={results:[]};_this.indexPattern=props.indexPattern;_this.savedSearch=props.savedSearch;_this.className=props.className;_this.results=props.results;return _this}_createClass(DataRecognizer,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;_ml_api_service.ml.recognizeIndex({indexPatternTitle:this.indexPattern.title}).then(function(resp){var results=resp.map(function(r){return _react.default.createElement(_recognized_result.RecognizedResult,{key:r.id,config:r,indexPattern:_this2.indexPattern,savedSearch:_this2.savedSearch})});if(_typeof(_this2.results)==="object"){_this2.results.count=results.length;if(typeof _this2.results.onChange==="function"){_this2.results.onChange()}}_this2.setState({results:results})}).catch(function(e){console.error("Error attempting to recognize index",e)})}},{key:"render",value:function render(){return _react.default.createElement("div",{className:this.className},this.state.results)}}]);return DataRecognizer}(_react.Component);exports.DataRecognizer=DataRecognizer;DataRecognizer.propTypes={indexPattern:_propTypes.default.object,savedSearch:_propTypes.default.object,className:_propTypes.default.string,results:_propTypes.default.object}},function(module,exports,__webpack_require__){"use strict";var _exports$pivotGroupBy;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var field_types_1=__webpack_require__(295);var PIVOT_SUPPORTED_GROUP_BY_AGGS;(function(PIVOT_SUPPORTED_GROUP_BY_AGGS){PIVOT_SUPPORTED_GROUP_BY_AGGS["DATE_HISTOGRAM"]="date_histogram";PIVOT_SUPPORTED_GROUP_BY_AGGS["HISTOGRAM"]="histogram";PIVOT_SUPPORTED_GROUP_BY_AGGS["TERMS"]="terms"})(PIVOT_SUPPORTED_GROUP_BY_AGGS=exports.PIVOT_SUPPORTED_GROUP_BY_AGGS||(exports.PIVOT_SUPPORTED_GROUP_BY_AGGS={}));exports.pivotSupportedGroupByAggs=[PIVOT_SUPPORTED_GROUP_BY_AGGS.DATE_HISTOGRAM,PIVOT_SUPPORTED_GROUP_BY_AGGS.HISTOGRAM,PIVOT_SUPPORTED_GROUP_BY_AGGS.TERMS];exports.pivotGroupByFieldSupport=(_exports$pivotGroupBy={},_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.ATTACHMENT,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.BOOLEAN,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.DATE,[PIVOT_SUPPORTED_GROUP_BY_AGGS.DATE_HISTOGRAM]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.GEO_POINT,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.GEO_SHAPE,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.IP,[PIVOT_SUPPORTED_GROUP_BY_AGGS.TERMS]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.MURMUR3,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.NUMBER,[PIVOT_SUPPORTED_GROUP_BY_AGGS.HISTOGRAM]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.STRING,[PIVOT_SUPPORTED_GROUP_BY_AGGS.TERMS]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES._SOURCE,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.UNKNOWN,[]),_defineProperty(_exports$pivotGroupBy,field_types_1.KBN_FIELD_TYPES.CONFLICT,[]),_exports$pivotGroupBy);exports.histogramIntervalFormatRegex=/^([1-9][0-9]*((\.)([0-9]+))?|([0](\.)([0-9]+)))$/;exports.dateHistogramIntervalFormatRegex=/^[1-9][0-9]*(ms|s|m|h|d|w|M|q|y)$/;var DATE_HISTOGRAM_FORMAT;(function(DATE_HISTOGRAM_FORMAT){DATE_HISTOGRAM_FORMAT["ms"]="yyyy-MM-dd HH:mm:ss.SSS";DATE_HISTOGRAM_FORMAT["s"]="yyyy-MM-dd HH:mm:ss";DATE_HISTOGRAM_FORMAT["m"]="yyyy-MM-dd HH:mm";DATE_HISTOGRAM_FORMAT["h"]="yyyy-MM-dd HH:00";DATE_HISTOGRAM_FORMAT["d"]="yyyy-MM-dd";DATE_HISTOGRAM_FORMAT["M"]="yyyy-MM-01";DATE_HISTOGRAM_FORMAT["y"]="yyyy"})(DATE_HISTOGRAM_FORMAT=exports.DATE_HISTOGRAM_FORMAT||(exports.DATE_HISTOGRAM_FORMAT={}));function isGroupByDateHistogram(arg){return arg.hasOwnProperty("calendar_interval")}exports.isGroupByDateHistogram=isGroupByDateHistogram;function isGroupByHistogram(arg){return arg.hasOwnProperty("interval")}exports.isGroupByHistogram=isGroupByHistogram},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var get_jobs_1=__webpack_require__(2956);exports.getJobsFactory=get_jobs_1.getJobsFactory;var delete_job_1=__webpack_require__(2957);exports.deleteJobFactory=delete_job_1.deleteJobFactory;var start_job_1=__webpack_require__(2958);exports.startJobFactory=start_job_1.startJobFactory;var stop_job_1=__webpack_require__(2959);exports.stopJobFactory=stop_job_1.stopJobFactory},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);tslib_1.__exportStar(__webpack_require__(2977),exports);tslib_1.__exportStar(__webpack_require__(2980),exports)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);tslib_1.__exportStar(__webpack_require__(2981),exports);tslib_1.__exportStar(__webpack_require__(2984),exports)},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(501);var common_2=__webpack_require__(227);var common_3=__webpack_require__(685);var common_4=__webpack_require__(1379);var use_pivot_preview_data_1=__webpack_require__(2990);var CompressedTable=eui_1.EuiInMemoryTable;function sortColumns(groupByArr){return function(a,b){if(groupByArr.some(function(d){return d.aggName===a})&&groupByArr.some(function(d){return d.aggName===b})){return a.localeCompare(b)}if(groupByArr.some(function(d){return d.aggName===a})){return-1}if(groupByArr.some(function(d){return d.aggName===b})){return 1}return a.localeCompare(b)}}function usePrevious(value){var ref=react_1.useRef(null);react_1.useEffect(function(){ref.current=value});return ref.current}var PreviewTitle=function PreviewTitle(_ref){var previewRequest=_ref.previewRequest;var euiCopyText=i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.copyClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the pivot preview to the clipboard."});return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiTitle,{size:"xs"},react_1.default.createElement("span",null,i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.dataFramePivotPreviewTitle",{defaultMessage:"Data frame pivot preview"})))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiCopy,{beforeMessage:euiCopyText,textToCopy:common_4.getPivotPreviewDevConsoleStatement(previewRequest)},function(copy){return react_1.default.createElement(eui_1.EuiButtonIcon,{onClick:copy,iconType:"copyClipboard","aria-label":euiCopyText})})))};var ErrorMessage=function ErrorMessage(_ref2){var message=_ref2.message;var error=JSON.parse(message);var statusCodeLabel=i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.statusCodeLabel",{defaultMessage:"Status code"});return react_1.default.createElement(eui_1.EuiText,{size:"xs"},react_1.default.createElement("pre",null,error.message&&error.statusCode&&"".concat(statusCodeLabel,": ").concat(error.statusCode,"\n").concat(error.message)||message))};exports.PivotPreview=react_1.default.memo(function(_ref3){var aggs=_ref3.aggs,groupBy=_ref3.groupBy,query=_ref3.query;var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),clearTable=_react_1$useState2[0],setClearTable=_react_1$useState2[1];var kibanaContext=react_1.useContext(common_2.KibanaContext);if(!common_2.isKibanaContext(kibanaContext)){return null}var indexPattern=kibanaContext.currentIndexPattern;var _use_pivot_preview_da=use_pivot_preview_data_1.usePivotPreviewData(indexPattern,query,aggs,groupBy),dataFramePreviewData=_use_pivot_preview_da.dataFramePreviewData,errorMessage=_use_pivot_preview_da.errorMessage,previewRequest=_use_pivot_preview_da.previewRequest,status=_use_pivot_preview_da.status;var groupByArr=common_1.dictionaryToArray(groupBy);var firstColumnName=dataFramePreviewData.length>0?Object.keys(dataFramePreviewData[0]).sort(sortColumns(groupByArr))[0]:undefined;var firstColumnNameChanged=usePrevious(firstColumnName)!==firstColumnName;react_1.useEffect(function(){if(firstColumnNameChanged){setClearTable(true)}if(clearTable){setTimeout(function(){return setClearTable(false)},0)}});if(firstColumnNameChanged){return null}if(status===use_pivot_preview_data_1.PIVOT_PREVIEW_STATUS.ERROR){return react_1.default.createElement(eui_1.EuiPanel,{grow:false},react_1.default.createElement(PreviewTitle,{previewRequest:previewRequest}),react_1.default.createElement(eui_1.EuiCallOut,{title:i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.dataFramePivotPreviewError",{defaultMessage:"An error occurred loading the pivot preview."}),color:"danger",iconType:"cross"},react_1.default.createElement(ErrorMessage,{message:errorMessage})))}if(dataFramePreviewData.length===0){var noDataMessage=i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.dataFramePivotPreviewNoDataCalloutBody",{defaultMessage:"The preview request did not return any data. Please ensure the optional query returns data and that values exist for the field used by group-by and aggregation fields."});var aggsArr=common_1.dictionaryToArray(aggs);if(aggsArr.length===0||groupByArr.length===0){noDataMessage=i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.dataFramePivotPreviewIncompleteConfigCalloutBody",{defaultMessage:"Please choose at least one group-by field and aggregation."})}return react_1.default.createElement(eui_1.EuiPanel,{grow:false},react_1.default.createElement(PreviewTitle,{previewRequest:previewRequest}),react_1.default.createElement(eui_1.EuiCallOut,{title:i18n_1.i18n.translate("xpack.ml.dataframe.pivotPreview.dataFramePivotPreviewNoDataCalloutTitle",{defaultMessage:"Pivot preview not available"}),color:"primary"},react_1.default.createElement("p",null,noDataMessage)))}var columnKeys=common_3.getFlattenedFields(dataFramePreviewData[0]);columnKeys.sort(sortColumns(groupByArr));var columns=columnKeys.map(function(k){return{field:k,name:k,sortable:true,truncateText:true}});var sorting={sort:{field:columns[0].field,direction:eui_1.SortDirection.ASC}};return react_1.default.createElement(eui_1.EuiPanel,null,react_1.default.createElement(PreviewTitle,{previewRequest:previewRequest}),status===use_pivot_preview_data_1.PIVOT_PREVIEW_STATUS.LOADING&&react_1.default.createElement(eui_1.EuiProgress,{size:"xs",color:"accent"}),status!==use_pivot_preview_data_1.PIVOT_PREVIEW_STATUS.LOADING&&react_1.default.createElement(eui_1.EuiProgress,{size:"xs",color:"accent",max:1,value:0}),dataFramePreviewData.length>0&&clearTable===false&&react_1.default.createElement(CompressedTable,{compressed:true,items:dataFramePreviewData,columns:columns,pagination:{initialPageSize:5,pageSizeOptions:[5,10,25]},sorting:sorting}))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var common_1=__webpack_require__(227);function getDefaultGroupByConfig(aggName,dropDownName,fieldName,groupByAgg){switch(groupByAgg){case common_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.TERMS:return{agg:groupByAgg,aggName:aggName,dropDownName:dropDownName,field:fieldName};case common_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.HISTOGRAM:return{agg:groupByAgg,aggName:aggName,dropDownName:dropDownName,field:fieldName,interval:"10"};case common_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.DATE_HISTOGRAM:return{agg:groupByAgg,aggName:aggName,dropDownName:dropDownName,field:fieldName,calendar_interval:"1m"}}}var illegalEsAggNameChars=/[[\]>]/g;function getPivotDropdownOptions(indexPattern){var groupByOptions=[];var groupByOptionsData={};var aggOptions=[];var aggOptionsData={};var ignoreFieldNames=["_id","_index","_type"];var fields=indexPattern.fields.filter(function(field){return field.aggregatable===true&&!ignoreFieldNames.includes(field.name)}).map(function(field){return{name:field.name,type:field.type}});fields.forEach(function(field){var availableGroupByAggs=common_1.pivotGroupByFieldSupport[field.type];if(availableGroupByAggs!==undefined){availableGroupByAggs.forEach(function(groupByAgg){var aggName=field.name.replace(illegalEsAggNameChars,"").trim();var dropDownName="".concat(groupByAgg,"(").concat(field.name,")");var groupByOption={label:dropDownName};groupByOptions.push(groupByOption);groupByOptionsData[dropDownName]=getDefaultGroupByConfig(aggName,dropDownName,field.name,groupByAgg)})}var aggOption={label:field.name,options:[]};var availableAggs=common_1.pivotAggsFieldSupport[field.type];if(availableAggs!==undefined){availableAggs.forEach(function(agg){var aggName="".concat(field.name.replace(illegalEsAggNameChars,"").trim(),".").concat(agg);var dropDownName="".concat(agg,"(").concat(field.name,")");aggOption.options.push({label:dropDownName});aggOptionsData[dropDownName]={agg:agg,field:field.name,aggName:aggName,dropDownName:dropDownName}})}aggOptions.push(aggOption)});return{groupByOptions:groupByOptions,groupByOptionsData:groupByOptionsData,aggOptions:aggOptions,aggOptionsData:aggOptionsData}}exports.getPivotDropdownOptions=getPivotDropdownOptions;exports.getPivotPreviewDevConsoleStatement=function(request){return"POST _data_frame/transforms/_preview\n".concat(JSON.stringify(request,null,2),"\n")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDataVisualizerBreadcrumbs=getDataVisualizerBreadcrumbs;var _breadcrumbs=__webpack_require__(432);function getDataVisualizerBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DisplayValue",{enumerable:true,get:function get(){return _display_value.DisplayValue}});var _display_value=__webpack_require__(3011)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3022)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomaliesTable=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _lodash=_interopRequireDefault(__webpack_require__(3));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _anomalies_table_columns=__webpack_require__(3023);var _anomaly_details=__webpack_require__(3030);var _table_service=__webpack_require__(881);var _rule_editor=__webpack_require__(3031);var _ml_api_service=__webpack_require__(24);var _anomalies_table_constants=__webpack_require__(895);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var AnomaliesTable=function(_Component){_inherits(AnomaliesTable,_Component);function AnomaliesTable(props){var _this;_classCallCheck(this,AnomaliesTable);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnomaliesTable).call(this,props));_defineProperty(_assertThisInitialized(_this),"isShowingAggregatedData",function(){return _this.props.tableData.interval!=="second"});_defineProperty(_assertThisInitialized(_this),"toggleRow",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(item){var tab,itemIdToExpandedRowMap,examples,definition,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:tab=_args.length>1&&_args[1]!==undefined?_args[1]:_anomalies_table_constants.ANOMALIES_TABLE_TABS.DETAILS;itemIdToExpandedRowMap=_objectSpread({},_this.state.itemIdToExpandedRowMap);if(!itemIdToExpandedRowMap[item.rowId]){_context.next=6;break}delete itemIdToExpandedRowMap[item.rowId];_context.next=21;break;case 6:examples=item.entityName==="mlcategory"?_lodash.default.get(_this.props.tableData,["examplesByJobId",item.jobId,item.entityValue]):undefined;definition=undefined;if(!(examples!==undefined)){_context.next=20;break}_context.prev=9;_context.next=12;return _ml_api_service.ml.results.getCategoryDefinition(item.jobId,item.source.mlcategory[0]);case 12:definition=_context.sent;if(definition.terms&&definition.terms.length>_anomalies_table_constants.MAX_CHARS){definition.terms="".concat(definition.terms.substring(0,_anomalies_table_constants.MAX_CHARS),"...")}if(definition.regex&&definition.regex.length>_anomalies_table_constants.MAX_CHARS){definition.terms="".concat(definition.regex.substring(0,_anomalies_table_constants.MAX_CHARS),"...")}_context.next=20;break;case 17:_context.prev=17;_context.t0=_context["catch"](9);console.log("Error fetching category definition for row item.",_context.t0);case 20:itemIdToExpandedRowMap[item.rowId]=_react.default.createElement(_anomaly_details.AnomalyDetails,{tabIndex:tab,anomaly:item,examples:examples,definition:definition,isAggregatedData:_this.isShowingAggregatedData(),filter:_this.props.filter,influencerFilter:_this.props.influencerFilter,influencersLimit:_anomalies_table_constants.INFLUENCERS_LIMIT});case 21:_this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap});case 22:case"end":return _context.stop()}}},_callee,null,[[9,17]])}));return function(_x){return _ref.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"onMouseOverRow",function(record){if(_this.mouseOverRecord!==undefined){if(_this.mouseOverRecord.rowId!==record.rowId){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord});_table_service.mlTableService.rowMouseenter$.next({record:record})}}else{_table_service.mlTableService.rowMouseenter$.next({record:record})}_this.mouseOverRecord=record});_defineProperty(_assertThisInitialized(_this),"onMouseLeaveRow",function(){if(_this.mouseOverRecord!==undefined){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord});_this.mouseOverRecord=undefined}});_defineProperty(_assertThisInitialized(_this),"setShowRuleEditorFlyoutFunction",function(func){_this.setState({showRuleEditorFlyout:func})});_defineProperty(_assertThisInitialized(_this),"unsetShowRuleEditorFlyoutFunction",function(){var showRuleEditorFlyout=function showRuleEditorFlyout(){};_this.setState({showRuleEditorFlyout:showRuleEditorFlyout})});_this.state={itemIdToExpandedRowMap:{},showRuleEditorFlyout:function showRuleEditorFlyout(){}};return _this}_createClass(AnomaliesTable,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,timefilter=_this$props.timefilter,tableData=_this$props.tableData,filter=_this$props.filter,influencerFilter=_this$props.influencerFilter;if(tableData===undefined||tableData.anomalies===undefined||tableData.anomalies.length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.noMatchingAnomaliesFoundTitle",defaultMessage:"No matching anomalies found"})))))}var columns=(0,_anomalies_table_columns.getColumns)(tableData.anomalies,tableData.jobIds,tableData.examplesByJobId,this.isShowingAggregatedData(),tableData.interval,timefilter,tableData.showViewSeriesLink,this.state.showRuleEditorFlyout,this.state.itemIdToExpandedRowMap,this.toggleRow,filter,influencerFilter);var sorting={sort:{field:"severity",direction:"desc"}};var getRowProps=function getRowProps(item){return{onMouseOver:function onMouseOver(){return _this2.onMouseOverRow(item)},onMouseLeave:function onMouseLeave(){return _this2.onMouseLeaveRow()}}};return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_rule_editor.RuleEditorFlyout,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),_react.default.createElement(_eui.EuiInMemoryTable,{className:"ml-anomalies-table eui-textOverflowWrap",items:tableData.anomalies,columns:columns,pagination:{pageSizeOptions:[10,25,100],initialPageSize:25},sorting:sorting,itemId:"rowId",itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,compressed:true,rowProps:getRowProps}))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){var itemIdToExpandedRowMap=prevState.itemIdToExpandedRowMap;var prevExpandedNotInData=Object.keys(itemIdToExpandedRowMap).find(function(rowId){var matching=nextProps.tableData.anomalies.find(function(anomaly){return anomaly.rowId===rowId});return matching===undefined});if(prevExpandedNotInData!==undefined){return{itemIdToExpandedRowMap:{}}}return null}}]);return AnomaliesTable}(_react.Component);exports.AnomaliesTable=AnomaliesTable;AnomaliesTable.propTypes={timefilter:_propTypes.default.object.isRequired,tableData:_propTypes.default.object,filter:_propTypes.default.func,influencerFilter:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DetectorDescriptionList",{enumerable:true,get:function get(){return _detector_description_list.DetectorDescriptionList}});var _detector_description_list=__webpack_require__(3033)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3045);__webpack_require__(3048);__webpack_require__(3050)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CheckboxShowCharts=exports.showCharts$=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _rxjs=__webpack_require__(30);var _eui=__webpack_require__(1);var _make_id=_interopRequireDefault(__webpack_require__(3047));var _react2=__webpack_require__(5);var _observable_utils=__webpack_require__(434);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var showCharts$=new _rxjs.BehaviorSubject(true);exports.showCharts$=showCharts$;var CheckboxShowChartsUnwrapped=function(_Component){_inherits(CheckboxShowChartsUnwrapped,_Component);function CheckboxShowChartsUnwrapped(){var _getPrototypeOf2;var _this;_classCallCheck(this,CheckboxShowChartsUnwrapped);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(CheckboxShowChartsUnwrapped)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"onChange",function(e){var showCharts=e.target.checked;showCharts$.next(showCharts)});return _this}_createClass(CheckboxShowChartsUnwrapped,[{key:"render",value:function render(){return _react.default.createElement(_eui.EuiCheckbox,{id:(0,_make_id.default)(),label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:this.props.showCharts,onChange:this.onChange})}}]);return CheckboxShowChartsUnwrapped}(_react.Component);var CheckboxShowCharts=(0,_observable_utils.injectObservablesAsProps)({showCharts:showCharts$},CheckboxShowChartsUnwrapped);exports.CheckboxShowCharts=CheckboxShowCharts},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.refreshIntervalWatcher=refreshIntervalWatcher;var _timefilter=__webpack_require__(22);function refreshIntervalWatcher($timeout){var refresher;var listener;var onRefreshIntervalChange=function onRefreshIntervalChange(){if(refresher){$timeout.cancel(refresher)}var interval=_timefilter.timefilter.getRefreshInterval();if(interval.value>0&&!interval.pause){var startRefresh=function startRefresh(){refresher=$timeout(function(){startRefresh();listener()},interval.value)};startRefresh()}};function init(listenerCallback){listener=listenerCallback;_timefilter.timefilter.on("refreshIntervalUpdate",onRefreshIntervalChange)}function cancel(){$timeout.cancel(refresher);_timefilter.timefilter.off("refreshIntervalUpdate",onRefreshIntervalChange)}return{init:init,cancel:cancel}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSuggestions=getSuggestions;exports.escapeRegExp=escapeRegExp;exports.escapeParens=escapeParens;exports.escapeDoubleQuotes=escapeDoubleQuotes;exports.getKqlQueryValues=getKqlQueryValues;exports.getQueryPattern=getQueryPattern;exports.removeFilterFromQueryString=removeFilterFromQueryString;var _autocomplete_providers=__webpack_require__(430);var _esQuery=__webpack_require__(38);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function getSuggestions(_x,_x2,_x3,_x4){return _getSuggestions.apply(this,arguments)}function _getSuggestions(){_getSuggestions=_asyncToGenerator(regeneratorRuntime.mark(function _callee(query,selectionStart,indexPattern,boolFilter){var autocompleteProvider,config,getAutocompleteSuggestions;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:autocompleteProvider=(0,_autocomplete_providers.getAutocompleteProvider)("kuery");if(autocompleteProvider){_context.next=3;break}return _context.abrupt("return",[]);case 3:config={get:function get(){return true}};getAutocompleteSuggestions=autocompleteProvider({config:config,indexPatterns:[indexPattern],boolFilter:boolFilter});return _context.abrupt("return",getAutocompleteSuggestions({query:query,selectionStart:selectionStart,selectionEnd:selectionStart}));case 6:case"end":return _context.stop()}}},_callee)}));return _getSuggestions.apply(this,arguments)}function convertKueryToEsQuery(kuery,indexPattern){var ast=(0,_esQuery.fromKueryExpression)(kuery);return(0,_esQuery.toElasticsearchQuery)(ast,indexPattern)}function escapeRegExp(string){return string.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function escapeParens(string){return string.replace(/[()]/g,"\\$&")}function escapeDoubleQuotes(string){return string.replace(/\"/g,"\\$&")}function getKqlQueryValues(inputValue,indexPattern){var ast=(0,_esQuery.fromKueryExpression)(inputValue);var isAndOperator=ast.function==="and";var query=convertKueryToEsQuery(inputValue,indexPattern);var filteredFields=[];if(!query){return}if(ast&&Array.isArray(ast.arguments)){ast.arguments.forEach(function(arg){if(arg.arguments!==undefined){arg.arguments.forEach(function(nestedArg){if(typeof nestedArg.value==="string"){filteredFields.push(nestedArg.value)}})}else if(typeof arg.value==="string"){filteredFields.push(arg.value)}})}return{influencersFilterQuery:query,filteredFields:filteredFields,queryString:inputValue,isAndOperator:isAndOperator,tableQueryString:inputValue}}function getQueryPattern(fieldName,fieldValue){var sanitizedFieldName=escapeRegExp(fieldName);var sanitizedFieldValue=escapeRegExp(fieldValue);return new RegExp("(".concat(sanitizedFieldName,')\\s?:\\s?(")?(').concat(sanitizedFieldValue,')(")?'),"i")}function removeFilterFromQueryString(currentQueryString,fieldName,fieldValue){var newQueryString="";var queryPattern=getQueryPattern(fieldName,fieldValue);newQueryString=currentQueryString.replace(queryPattern,"");var endPattern=/\s(and|or)\s*$/gi;var startPattern=/^\s*(and|or)\s/gi;var invalidOperatorPattern=/\s+(and|or)\s+(and|or)\s+/gi;newQueryString=newQueryString.replace(invalidOperatorPattern," $1 ");newQueryString=newQueryString.replace(endPattern,"");newQueryString=newQueryString.replace(startPattern,"");return newQueryString}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectLimit=exports.limit$=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _rxjs=__webpack_require__(30);var _eui=__webpack_require__(1);var _observable_utils=__webpack_require__(434);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var optionsMap={5:5,10:10,25:25,50:50};var LIMIT_OPTIONS=[{val:5,display:"5"},{val:10,display:"10"},{val:25,display:"25"},{val:50,display:"50"}];function optionValueToLimit(value){var limit=LIMIT_OPTIONS.find(function(opt){return opt.val===value});if(limit===undefined){limit=LIMIT_OPTIONS[1]}return limit}var EUI_OPTIONS=LIMIT_OPTIONS.map(function(_ref){var display=_ref.display,val=_ref.val;return{value:display,text:val}});var limit$=new _rxjs.BehaviorSubject(LIMIT_OPTIONS[1]);exports.limit$=limit$;var SelectLimitUnwrapped=function(_Component){_inherits(SelectLimitUnwrapped,_Component);function SelectLimitUnwrapped(){var _getPrototypeOf2;var _this;_classCallCheck(this,SelectLimitUnwrapped);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(SelectLimitUnwrapped)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"onChange",function(e){var valueDisplay=e.target.value;var limit=optionValueToLimit(optionsMap[valueDisplay]);limit$.next(limit)});return _this}_createClass(SelectLimitUnwrapped,[{key:"render",value:function render(){return _react.default.createElement(_eui.EuiSelect,{options:EUI_OPTIONS,onChange:this.onChange,value:this.props.limit.display})}}]);return SelectLimitUnwrapped}(_react.Component);SelectLimitUnwrapped.propTypes={limit:_propTypes.default.object};SelectLimitUnwrapped.defaultProps={limit:LIMIT_OPTIONS[1]};var SelectLimit=(0,_observable_utils.injectObservablesAsProps)({limit:limit$},SelectLimitUnwrapped);exports.SelectLimit=SelectLimit},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildConfigFromDetector=buildConfigFromDetector;var _lodash=_interopRequireDefault(__webpack_require__(3));var _job_utils=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildConfigFromDetector(job,detectorIndex){var analysisConfig=job.analysis_config;var detector=analysisConfig.detectors[detectorIndex];var config={jobId:job.job_id,detectorIndex:detectorIndex,metricFunction:(0,_job_utils.mlFunctionToESAggregation)(detector.function),timeField:job.data_description.time_field,interval:job.analysis_config.bucket_span,datafeedConfig:job.datafeed_config};if(detector.field_name!==undefined){config.metricFieldName=detector.field_name}var summaryCountFieldName=analysisConfig.summary_count_field_name;if(config.metricFunction==="count"&&summaryCountFieldName!==undefined&&summaryCountFieldName!=="doc_count"){var cardinalityField=undefined;var topAgg=_lodash.default.get(job.datafeed_config,"aggregations")||_lodash.default.get(job.datafeed_config,"aggs");if(topAgg!==undefined&&_lodash.default.values(topAgg).length>0){cardinalityField=_lodash.default.get(_lodash.default.values(topAgg)[0],["aggregations",summaryCountFieldName,"cardinality","field"])||_lodash.default.get(_lodash.default.values(topAgg)[0],["aggs",summaryCountFieldName,"cardinality","field"])}if(detector.function==="non_zero_count"&&cardinalityField!==undefined){config.metricFunction="cardinality";config.metricFieldName=cardinalityField}else{config.metricFunction="sum";config.metricFieldName=summaryCountFieldName}}return config}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getChartContainerWidth=getChartContainerWidth;exports.getSwimlaneContainerWidth=getSwimlaneContainerWidth;function getChartContainerWidth(){var chartContainer=document.querySelector(".explorer-charts");return Math.floor(chartContainer&&chartContainer.clientWidth||0)}function getSwimlaneContainerWidth(){var noInfluencersConfigured=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var explorerContainer=document.querySelector(".ml-explorer");var explorerContainerWidth=explorerContainer&&explorerContainer.clientWidth||0;if(noInfluencersConfigured===true){return explorerContainerWidth-250}else{return explorerContainerWidth/6*5-220}}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3090)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastingModal=exports.FORECAST_DURATION_MAX_DAYS=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _lodash=_interopRequireDefault(__webpack_require__(3));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _states=__webpack_require__(573);var _message_levels=__webpack_require__(1394);var _job_utils=__webpack_require__(58);var _parse_interval=__webpack_require__(313);var _modal=__webpack_require__(3106);var _progress_states=__webpack_require__(901);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _forecast_service=__webpack_require__(884);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FORECAST_DURATION_MAX_DAYS=3650;exports.FORECAST_DURATION_MAX_DAYS=FORECAST_DURATION_MAX_DAYS;var FORECAST_JOB_MIN_VERSION="6.1.0";var FORECASTS_VIEW_MAX=5;var FORECAST_DURATION_MAX_MS=FORECAST_DURATION_MAX_DAYS*864e5;var WARN_NUM_PARTITIONS=100;var FORECAST_STATS_POLL_FREQUENCY=250;var WARN_NO_PROGRESS_MS=12e4;function getDefaultState(){return{isModalVisible:false,previousForecasts:[],isForecastRequested:false,forecastProgress:_progress_states.PROGRESS_STATES.UNSET,jobOpeningState:_progress_states.PROGRESS_STATES.UNSET,jobClosingState:_progress_states.PROGRESS_STATES.UNSET,newForecastDuration:"1d",isNewForecastDurationValid:true,newForecastDurationErrors:[],messages:[]}}var ForecastingModal=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(ForecastingModal,_Component);function ForecastingModal(props){var _this;_classCallCheck(this,ForecastingModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(ForecastingModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"addMessage",function(message,status){var clearFirst=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var msg={message:message,status:status};_this.setState(function(prevState){return{messages:clearFirst?[msg]:[].concat(_toConsumableArray(prevState.messages),[msg])}})});_defineProperty(_assertThisInitialized(_this),"viewForecast",function(forecastId){_this.props.loadForForecastId(forecastId);_this.closeModal()});_defineProperty(_assertThisInitialized(_this),"onNewForecastDurationChange",function(event){var intl=_this.props.intl;var newForecastDurationErrors=[];var isNewForecastDurationValid=true;var duration=(0,_parse_interval.parseInterval)(event.target.value);if(duration===null){isNewForecastDurationValid=false;newForecastDurationErrors.push(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.invalidDurationFormatErrorMessage",defaultMessage:"Invalid duration format"}))}else if(duration.asMilliseconds()>FORECAST_DURATION_MAX_MS){isNewForecastDurationValid=false;newForecastDurationErrors.push(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeGreaterThanMaximumErrorMessage",defaultMessage:"Forecast duration must not be greater than {maximumForecastDurationDays} days"},{maximumForecastDurationDays:FORECAST_DURATION_MAX_DAYS}))}else if(duration.asMilliseconds()===0){isNewForecastDurationValid=false;newForecastDurationErrors.push(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeZeroErrorMessage",defaultMessage:"Forecast duration must not be zero"}))}_this.setState({newForecastDuration:event.target.value,isNewForecastDurationValid:isNewForecastDurationValid,newForecastDurationErrors:newForecastDurationErrors})});_defineProperty(_assertThisInitialized(_this),"checkJobStateAndRunForecast",function(){_this.setState({isForecastRequested:true,messages:[]});if(_this.props.job.state===_states.JOB_STATE.CLOSED){_this.openJobAndRunForecast()}else{_this.runForecast(false)}});_defineProperty(_assertThisInitialized(_this),"openJobAndRunForecast",function(){_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.openJob(_this.props.job.job_id).then(function(){_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.DONE});_this.runForecast(true)}).catch(function(resp){console.log("Time series forecast modal - could not open job:",resp);_this.addMessage(_this.props.intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.errorWithOpeningJobBeforeRunningForecastErrorMessage",defaultMessage:"Error opening job before running forecast"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.ERROR})})});_defineProperty(_assertThisInitialized(_this),"runForecastErrorHandler",function(resp,closeJob){var intl=_this.props.intl;_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});console.log("Time series forecast modal - error running forecast:",resp);if(resp&&resp.message){_this.addMessage(resp.message,_message_levels.MESSAGE_LEVEL.ERROR,true)}else{_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.unexpectedResponseFromRunningForecastErrorMessage",defaultMessage:"Unexpected response from running forecast. The request may have failed."}),_message_levels.MESSAGE_LEVEL.ERROR,true)}if(closeJob===true){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.closeJob(_this.props.job.job_id).then(function(){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.DONE})}).catch(function(response){console.log("Time series forecast modal - could not close job:",response);_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobErrorMessage",defaultMessage:"Error closing job"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.ERROR})})}});_defineProperty(_assertThisInitialized(_this),"runForecast",function(closeJobAfterRunning){_this.setState({forecastProgress:0});var durationInSeconds=(0,_parse_interval.parseInterval)(_this.state.newForecastDuration).asSeconds();_forecast_service.mlForecastService.runForecast(_this.props.job.job_id,"".concat(durationInSeconds,"s")).then(function(resp){if(resp.forecast_id!==undefined){_this.waitForForecastResults(resp.forecast_id,closeJobAfterRunning)}else{_this.runForecastErrorHandler(resp,closeJobAfterRunning)}}).catch(function(resp){return _this.runForecastErrorHandler(resp,closeJobAfterRunning)})});_defineProperty(_assertThisInitialized(_this),"waitForForecastResults",function(forecastId,closeJobAfterRunning){var intl=_this.props.intl;var previousProgress=0;var noProgressMs=0;_this.forecastChecker=setInterval(function(){_forecast_service.mlForecastService.getForecastRequestStats(_this.props.job,forecastId).then(function(resp){var progress=_lodash.default.get(resp,["stats","forecast_progress"],previousProgress);var status=_lodash.default.get(resp,["stats","forecast_status"]);if(progress>previousProgress){_this.setState({forecastProgress:Math.round(100*progress)})}var messages=_lodash.default.get(resp,["stats","forecast_messages"],[]);messages=messages.map(function(message){return{message:message,status:_message_levels.MESSAGE_LEVEL.WARNING}});_this.setState({messages:messages});if(status===_states.FORECAST_REQUEST_STATE.FINISHED){clearInterval(_this.forecastChecker);if(closeJobAfterRunning===true){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.closeJob(_this.props.job.job_id).then(function(){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.DONE});_this.props.loadForForecastId(forecastId);_this.closeAfterRunningForecast()}).catch(function(response){console.log("Time series forecast modal - could not close job:",response);_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobAfterRunningForecastErrorMessage",defaultMessage:"Error closing job after running forecast"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.ERROR});_this.props.loadForForecastId(forecastId)})}else{_this.props.loadForForecastId(forecastId);_this.closeAfterRunningForecast()}}else{if(progress===previousProgress){noProgressMs+=FORECAST_STATS_POLL_FREQUENCY;if(noProgressMs>WARN_NO_PROGRESS_MS){console.log("Forecast request has not progressed for ".concat(WARN_NO_PROGRESS_MS,"ms. Cancelling check."));_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.noProgressReportedForNewForecastErrorMessage",defaultMessage:"No progress reported for the new forecast for {WarnNoProgressMs}ms."+"An error may have occurred whilst running the forecast."},{WarnNoProgressMs:WARN_NO_PROGRESS_MS}),_message_levels.MESSAGE_LEVEL.ERROR);_this.props.loadForForecastId(forecastId);_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});clearInterval(_this.forecastChecker)}}else{if(progress>previousProgress){previousProgress=progress}noProgressMs=0}}}).catch(function(resp){console.log("Time series forecast modal - error loading stats of forecast from elasticsearch:",resp);_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.errorWithLoadingStatsOfRunningForecastErrorMessage",defaultMessage:"Error loading stats of running forecast."}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});clearInterval(_this.forecastChecker)})},FORECAST_STATS_POLL_FREQUENCY)});_defineProperty(_assertThisInitialized(_this),"openModal",function(){var intl=_this.props.intl;var job=_this.props.job;if(_typeof(job)==="object"){var bounds=_this.props.timefilter.getActiveBounds();var statusFinishedQuery={term:{forecast_status:_states.FORECAST_REQUEST_STATE.FINISHED}};_forecast_service.mlForecastService.getForecastsSummary(job,statusFinishedQuery,bounds.min.valueOf(),FORECASTS_VIEW_MAX).then(function(resp){_this.setState({previousForecasts:resp.forecasts})}).catch(function(resp){console.log("Time series forecast modal - error obtaining forecasts summary:",resp);_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.errorWithObtainingListOfPreviousForecastsErrorMessage",defaultMessage:"Error obtaining list of previous forecasts"}),_message_levels.MESSAGE_LEVEL.ERROR)});var entityFieldNames=_this.props.entities.map(function(entity){return entity.fieldName});if(entityFieldNames.length>0){_ml_api_service.ml.getCardinalityOfFields({index:job.datafeed_config.indices,fieldNames:entityFieldNames,query:job.datafeed_config.query,timeFieldName:job.data_description.time_field,earliestMs:job.data_counts.earliest_record_timestamp,latestMs:job.data_counts.latest_record_timestamp}).then(function(results){var numPartitions=1;Object.values(results).forEach(function(cardinality){numPartitions=numPartitions*cardinality});if(numPartitions>WARN_NUM_PARTITIONS){_this.addMessage(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.dataContainsMorePartitionsMessage",defaultMessage:"Note that this data contains more than {warnNumPartitions} "+"partitions so running a forecast may take a long time and consume a high amount of resource"},{warnNumPartitions:WARN_NUM_PARTITIONS}),_message_levels.MESSAGE_LEVEL.WARNING)}}).catch(function(resp){console.log("Time series forecast modal - error obtaining cardinality of fields:",resp)})}_this.setState({isModalVisible:true})}});_defineProperty(_assertThisInitialized(_this),"closeAfterRunningForecast",function(){if(_this.state.messages.length===0){setTimeout(function(){_this.closeModal()},1e3)}});_defineProperty(_assertThisInitialized(_this),"closeModal",function(){if(_this.forecastChecker!==null){clearInterval(_this.forecastChecker)}_this.setState(getDefaultState())});_this.state=getDefaultState();_this.forecastChecker=null;return _this}_createClass(ForecastingModal,[{key:"render",value:function render(){var isForecastingDisabled=false;var forecastingDisabledMessage=null;var _this$props=this.props,intl=_this$props.intl,job=_this$props.job;if(job!==undefined){var detector=job.analysis_config.detectors[this.props.detectorIndex];var overFieldName=detector.over_field_name;if(overFieldName!==undefined){isForecastingDisabled=true;forecastingDisabledMessage=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingNotAvailableForPopulationDetectorsMessage",defaultMessage:"Forecasting is not available for population detectors with an over field"})}else if((0,_job_utils.isJobVersionGte)(job,FORECAST_JOB_MIN_VERSION)===false){isForecastingDisabled=true;forecastingDisabledMessage=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingOnlyAvailableForJobsCreatedInSpecifiedVersionMessage",defaultMessage:"Forecasting is only available for jobs created in version {minVersion} or later"},{minVersion:FORECAST_JOB_MIN_VERSION})}}var forecastButton=_react.default.createElement(_eui.EuiButton,{onClick:this.openModal,size:"s",isDisabled:isForecastingDisabled,fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastButtonLabel",defaultMessage:"Forecast"}));return _react.default.createElement("div",null,isForecastingDisabled?_react.default.createElement(_eui.EuiToolTip,{position:"left",content:forecastingDisabledMessage},forecastButton):forecastButton,this.state.isModalVisible&&_react.default.createElement(_modal.Modal,{job:this.props.job,forecasts:this.state.previousForecasts,close:this.closeModal,viewForecast:this.viewForecast,runForecast:this.checkJobStateAndRunForecast,newForecastDuration:this.state.newForecastDuration,onNewForecastDurationChange:this.onNewForecastDurationChange,isNewForecastDurationValid:this.state.isNewForecastDurationValid,newForecastDurationErrors:this.state.newForecastDurationErrors,isForecastRequested:this.state.isForecastRequested,forecastProgress:this.state.forecastProgress,jobOpeningState:this.state.jobOpeningState,jobClosingState:this.state.jobClosingState,messages:this.state.messages}))}}]);return ForecastingModal}(_react.Component),_defineProperty(_class,"propTypes",{isDisabled:_propTypes.default.bool,job:_propTypes.default.object,detectorIndex:_propTypes.default.number,entities:_propTypes.default.array,loadForForecastId:_propTypes.default.func,timefilter:_propTypes.default.object}),_temp));exports.ForecastingModal=ForecastingModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MESSAGE_LEVEL=void 0;var MESSAGE_LEVEL={ERROR:"error",INFO:"info",SUCCESS:"success",WARNING:"warning"};exports.MESSAGE_LEVEL=MESSAGE_LEVEL},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createTimeSeriesJobData=createTimeSeriesJobData;exports.processMetricPlotResults=processMetricPlotResults;exports.processForecastResults=processForecastResults;exports.processRecordScoreResults=processRecordScoreResults;exports.processDataForFocusAnomalies=processDataForFocusAnomalies;exports.processScheduledEventsForChart=processScheduledEventsForChart;exports.findNearestChartPointToTime=findNearestChartPointToTime;exports.findChartPointForAnomalyTime=findChartPointForAnomalyTime;var _lodash=_interopRequireDefault(__webpack_require__(3));var _parse_interval=__webpack_require__(275);var _job_utils=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function createTimeSeriesJobData(jobs){var singleTimeSeriesJobs=jobs.filter(_job_utils.isTimeSeriesViewJob);return singleTimeSeriesJobs.map(function(job){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);return{id:job.job_id,selected:false,bucketSpanSeconds:bucketSpan.asSeconds()}})}function processMetricPlotResults(metricPlotData,modelPlotEnabled){var metricPlotChartData=[];if(modelPlotEnabled===true){_lodash.default.each(metricPlotData,function(dataForTime,time){metricPlotChartData.push({date:new Date(+time),lower:dataForTime.modelLower,value:dataForTime.actual,upper:dataForTime.modelUpper})})}else{_lodash.default.each(metricPlotData,function(dataForTime,time){metricPlotChartData.push({date:new Date(+time),value:dataForTime.actual})})}return metricPlotChartData}function processForecastResults(forecastData){var forecastPlotChartData=[];_lodash.default.each(forecastData,function(dataForTime,time){forecastPlotChartData.push({date:new Date(+time),isForecast:true,lower:dataForTime.forecastLower,value:dataForTime.prediction,upper:dataForTime.forecastUpper})});return forecastPlotChartData}function processRecordScoreResults(scoreData){var bucketScoreData=[];_lodash.default.each(scoreData,function(dataForTime,time){bucketScoreData.push({date:new Date(+time),score:dataForTime.score})});return bucketScoreData}function processDataForFocusAnomalies(chartData,anomalyRecords,timeFieldName,aggregationInterval,modelPlotEnabled){var timesToAddPointsFor=[];var intervalMs=aggregationInterval.asMilliseconds();var lastChartDataPointTime=undefined;if(chartData!==undefined&&chartData.length>0){lastChartDataPointTime=chartData[chartData.length-1].date.getTime()}anomalyRecords.forEach(function(record){var recordTime=record[timeFieldName];var chartPoint=findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval);if(chartPoint===undefined){var timeToAdd=Math.floor(recordTime/intervalMs)*intervalMs;if(timesToAddPointsFor.indexOf(timeToAdd)===-1&&timeToAdd!==lastChartDataPointTime){timesToAddPointsFor.push(timeToAdd)}}});timesToAddPointsFor.sort(function(a,b){return a-b});timesToAddPointsFor.forEach(function(time){var pointToAdd={date:new Date(time),value:null};if(modelPlotEnabled===true){pointToAdd.upper=null;pointToAdd.lower=null}chartData.push(pointToAdd)});anomalyRecords.forEach(function(record){var recordTime=record[timeFieldName];var chartPoint=findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval);if(chartPoint!==undefined){var recordScore=record.record_score;var pointScore=chartPoint.anomalyScore;if(pointScore===undefined||pointScore<recordScore){chartPoint.anomalyScore=recordScore;chartPoint.function=record.function;if(_lodash.default.has(record,"actual")){chartPoint.actual=record.actual;chartPoint.typical=record.typical}else{var causes=_lodash.default.get(record,"causes",[]);if(causes.length>0){chartPoint.byFieldName=record.by_field_name;chartPoint.numberOfCauses=causes.length;if(causes.length===1){var cause=_lodash.default.first(record.causes);chartPoint.actual=cause.actual;chartPoint.typical=cause.typical}}}if(_lodash.default.has(record,"multi_bucket_impact")){chartPoint.multiBucketImpact=record.multi_bucket_impact}}}});return chartData}function processScheduledEventsForChart(chartData,scheduledEvents){if(scheduledEvents!==undefined){_lodash.default.each(scheduledEvents,function(events,time){var chartPoint=findNearestChartPointToTime(chartData,time);if(chartPoint!==undefined){chartPoint.scheduledEvents=events}})}return chartData}function findNearestChartPointToTime(chartData,time){var chartPoint;if(chartData===undefined){return chartPoint}for(var i=0;i<chartData.length;i++){if(chartData[i].date.getTime()===time){chartPoint=chartData[i];break}}if(chartPoint===undefined){var foundItem;for(var _i=0;_i<chartData.length;_i++){var itemTime=chartData[_i].date.getTime();if(itemTime>time){var item=chartData[_i];var previousItem=chartData[_i-1];var diff1=Math.abs(time-previousItem.date.getTime());var diff2=Math.abs(time-itemTime);if(previousItem===undefined||diff1>diff2){foundItem=item}else{foundItem=previousItem}break}}chartPoint=foundItem}return chartPoint}function findChartPointForAnomalyTime(chartData,anomalyTime,aggregationInterval){var chartPoint;if(chartData===undefined){return chartPoint}for(var i=0;i<chartData.length;i++){if(chartData[i].date.getTime()===anomalyTime){chartPoint=chartData[i];break}}if(chartPoint===undefined){var foundItem;var intervalMs=aggregationInterval.asMilliseconds();for(var _i2=0;_i2<chartData.length;_i2++){var itemTime=chartData[_i2].date.getTime();if(anomalyTime-itemTime<intervalMs){foundItem=chartData[_i2];break}}chartPoint=foundItem}return chartPoint}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlTimeSeriesSearchService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _ml_api_service=__webpack_require__(24);var _job_utils=__webpack_require__(58);var _chart_config_builder=__webpack_require__(1390);var _results_service=__webpack_require__(436);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getMetricData(job,detectorIndex,entityFields,earliestMs,latestMs,interval){if((0,_job_utils.isModelPlotEnabled)(job,detectorIndex,entityFields)){var criteriaFields=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});if(partitionEntity!==undefined){criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}}if(_lodash.default.has(detector,"over_field_name")){var overEntity=_lodash.default.find(entityFields,{fieldName:detector.over_field_name});if(overEntity!==undefined){criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}}if(_lodash.default.has(detector,"by_field_name")){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});if(byEntity!==undefined){criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}}return _results_service.mlResultsService.getModelPlotOutput(job.job_id,detectorIndex,criteriaFields,earliestMs,latestMs,interval)}else{return new Promise(function(resolve,reject){var obj={success:true,results:{}};var chartConfig=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);_results_service.mlResultsService.getMetricData(chartConfig.datafeedConfig.indices,entityFields,chartConfig.datafeedConfig.query,chartConfig.metricFunction,chartConfig.metricFieldName,chartConfig.timeField,earliestMs,latestMs,interval).then(function(resp){_lodash.default.each(resp.results,function(value,time){obj.results[time]={actual:value}});resolve(obj)}).catch(function(resp){reject(resp)})})}}function getChartDetails(job,detectorIndex,entityFields,earliestMs,latestMs){return new Promise(function(resolve,reject){var obj={success:true,results:{functionLabel:"",entityData:{entities:[]}}};var chartConfig=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);var functionLabel=chartConfig.metricFunction;if(chartConfig.metricFieldName!==undefined){functionLabel+=" ";functionLabel+=chartConfig.metricFieldName}obj.results.functionLabel=functionLabel;var blankEntityFields=_lodash.default.filter(entityFields,function(entity){return entity.fieldValue.length===0});if(blankEntityFields.length===0){obj.results.entityData.count=1;obj.results.entityData.entities=entityFields;resolve(obj)}else{var entityFieldNames=_lodash.default.map(blankEntityFields,"fieldName");_ml_api_service.ml.getCardinalityOfFields({index:chartConfig.datafeedConfig.indices,fieldNames:entityFieldNames,query:chartConfig.datafeedConfig.query,timeFieldName:chartConfig.timeField,earliestMs:earliestMs,latestMs:latestMs}).then(function(results){_lodash.default.each(blankEntityFields,function(field){obj.results.entityData.entities.push({fieldName:field.fieldName,cardinality:_lodash.default.get(results,field.fieldName,0)})});resolve(obj)}).catch(function(resp){reject(resp)})}})}var mlTimeSeriesSearchService={getMetricData:getMetricData,getChartDetails:getChartDetails};exports.mlTimeSeriesSearchService=mlTimeSeriesSearchService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FileDataVisualizerView",{enumerable:true,get:function get(){return _file_datavisualizer_view.FileDataVisualizerView}});Object.defineProperty(exports,"MODE",{enumerable:true,get:function get(){return _file_datavisualizer_view.MODE}});var _file_datavisualizer_view=__webpack_require__(3194)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExperimentalBadge",{enumerable:true,get:function get(){return _experimental_badge.ExperimentalBadge}});var _experimental_badge=__webpack_require__(3198)},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportProgress",{enumerable:true,get:function get(){return _import_progress.ImportProgress}});Object.defineProperty(exports,"IMPORT_STATUS",{enumerable:true,get:function get(){return _import_progress.IMPORT_STATUS}});var _import_progress=__webpack_require__(3228)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _utils=__webpack_require__(3237);Object.keys(_utils).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _utils[key]}})})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";__webpack_require__(86);__webpack_require__(87);__webpack_require__(88);__webpack_require__(89);__webpack_require__(90);__webpack_require__(91);__webpack_require__(92);__webpack_require__(93);__webpack_require__(94);__webpack_require__(95);__webpack_require__(96);__webpack_require__(97);__webpack_require__(98);__webpack_require__(99);__webpack_require__(100);__webpack_require__(101);__webpack_require__(102);__webpack_require__(103);__webpack_require__(104);__webpack_require__(105);__webpack_require__(106);__webpack_require__(107);__webpack_require__(108);__webpack_require__(109);__webpack_require__(110);__webpack_require__(111);__webpack_require__(112);__webpack_require__(113);__webpack_require__(114);__webpack_require__(115);__webpack_require__(116);__webpack_require__(117);__webpack_require__(118);__webpack_require__(119);__webpack_require__(120);__webpack_require__(121);__webpack_require__(122);__webpack_require__(123);__webpack_require__(124);__webpack_require__(125);__webpack_require__(126);__webpack_require__(127);__webpack_require__(128);__webpack_require__(129);__webpack_require__(130);__webpack_require__(131);__webpack_require__(132);__webpack_require__(133);__webpack_require__(134);__webpack_require__(135);__webpack_require__(136);__webpack_require__(137);__webpack_require__(138);__webpack_require__(139);__webpack_require__(140);__webpack_require__(141);__webpack_require__(142);__webpack_require__(143);__webpack_require__(144);__webpack_require__(145);__webpack_require__(146);__webpack_require__(147);__webpack_require__(148);__webpack_require__(149);__webpack_require__(150);__webpack_require__(151);__webpack_require__(152);__webpack_require__(153);__webpack_require__(154);__webpack_require__(155);__webpack_require__(156);__webpack_require__(157);__webpack_require__(158);__webpack_require__(159);__webpack_require__(160);__webpack_require__(161);__webpack_require__(162);__webpack_require__(163);__webpack_require__(164);__webpack_require__(165);__webpack_require__(166);__webpack_require__(167);__webpack_require__(168);__webpack_require__(169);__webpack_require__(170);__webpack_require__(171);__webpack_require__(172);__webpack_require__(173);__webpack_require__(174);__webpack_require__(175);__webpack_require__(176);__webpack_require__(177);__webpack_require__(178);__webpack_require__(179);__webpack_require__(180);__webpack_require__(181);__webpack_require__(182);__webpack_require__(183);__webpack_require__(184);__webpack_require__(185);__webpack_require__(186);__webpack_require__(187);__webpack_require__(188);__webpack_require__(189);__webpack_require__(190);__webpack_require__(191);__webpack_require__(192);__webpack_require__(193);__webpack_require__(194);__webpack_require__(195);__webpack_require__(196);__webpack_require__(197);__webpack_require__(198);__webpack_require__(199);__webpack_require__(200);__webpack_require__(201);__webpack_require__(202);__webpack_require__(203);__webpack_require__(204);__webpack_require__(205);__webpack_require__(206);__webpack_require__(207);__webpack_require__(208);__webpack_require__(209);__webpack_require__(210);__webpack_require__(211);__webpack_require__(212);__webpack_require__(213);__webpack_require__(214);__webpack_require__(215);__webpack_require__(216);var _i18n=__webpack_require__(4);var _kibanaCore__=__webpack_require__(73);__webpack_require__.nc=window.__kbnNonce__;var injectedMetadata=JSON.parse(document.querySelector("kbn-injected-metadata").getAttribute("data"));_i18n.i18n.load(injectedMetadata.i18n.translationsUrl).catch(function(e){return e}).then(function(i18nError){var coreSystem=new _kibanaCore__.CoreSystem({injectedMetadata:injectedMetadata,rootDomElement:document.body,browserSupportsCsp:!window.__kbnCspNotEnforced__,requireLegacyFiles:function requireLegacyFiles(){__webpack_require__(2748)}});coreSystem.setup().then(function(coreSetup){if(i18nError){coreSetup.fatalErrors.add(i18nError)}return coreSystem.start()})})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(428);__webpack_require__(487);__webpack_require__(335);__webpack_require__(879);__webpack_require__(254);__webpack_require__(255);__webpack_require__(431);__webpack_require__(2758);__webpack_require__(2760);__webpack_require__(1357);__webpack_require__(2938);__webpack_require__(2941);__webpack_require__(2999);__webpack_require__(3020);__webpack_require__(3103);__webpack_require__(3123);__webpack_require__(3126);__webpack_require__(3128);__webpack_require__(3131);__webpack_require__(3135);__webpack_require__(3138);__webpack_require__(3141);__webpack_require__(3190);__webpack_require__(403);var _routes=_interopRequireDefault(__webpack_require__(19));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}if(typeof _routes.default.enable==="function"){_routes.default.enable()}_routes.default.otherwise({redirectTo:"/jobs"})},,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var _routes=_interopRequireDefault(__webpack_require__(19));var _chrome=_interopRequireDefault(__webpack_require__(9));var _index=_interopRequireDefault(__webpack_require__(2759));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/access-denied",{template:_index.default,controllerAs:"accessDenied",controller:function controller($window,kbnUrl,kbnBaseUrl){this.goToKibana=function(){$window.location.href=_chrome.default.getBasePath()+kbnBaseUrl};this.retry=function(){return kbnUrl.redirect("/jobs")}}})},function(module,exports){module.exports='<ml-nav-menu name="access-denied"></ml-nav-menu>\n<div class="col-md-12">\n  <div class="euiSpacer euiSpacer--m"></div>\n  <div class="euiCallOut euiCallOut--danger">\n    <div class="euiCallOutHeader">\n      <svg class="euiIcon euiIcon--medium euiCallOutHeader__icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n        width="16" height="16" viewBox="0 0 16 16">\n        <defs>\n          <path id="cross-a" d="M7.293 8l-4.147 4.146a.5.5 0 0 0 .708.708L8 8.707l4.146 4.147a.5.5 0 0 0 .708-.708L8.707 8l4.147-4.146a.5.5 0 0 0-.708-.708L8 7.293 3.854 3.146a.5.5 0 1 0-.708.708L7.293 8z"></path>\n        </defs>\n        <use fill-rule="nonzero" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cross-a"></use>\n      </svg>\n      <span\n        class="euiCallOutHeader__title"\n        i18n-id="xpack.ml.accessDenied.noPermissionToAccessMLLabel"\n        i18n-default-message="You need permission to access Machine Learning"\n      ></span>\n    </div>\n    <div class="euiText euiText--small">\n      <p\n        i18n-id="xpack.ml.accessDenied.noGrantedPrivilegesDescription"\n        i18n-default-message="You must have the privileges granted in the {kibanaUserParam} and {machineLearningUserParam} roles.{br}Your system admin can set these roles on the Management User page."\n        i18n-values="{\n          html_kibanaUserParam: \'<span class=\\\'text-monospace\\\'>kibana_user</span>\',\n          html_machineLearningUserParam: \'<span class=\\\'text-monospace\\\'>machine_learning_user</span>\',\n          html_br: \'<br />\',\n        }"\n      ></p>\n    </div>\n  </div>\n\n  <div style=\'margin-top:20px;\'>\n    <button\n      ng-click="accessDenied.goToKibana();"\n      class="kuiButton kuiButton--primary"\n      i18n-id="xpack.ml.accessDenied.backToKibanaHomeButtonLabel"\n      i18n-default-message="Back to Kibana home"\n    ></button>\n    <button\n      ng-click="accessDenied.retry();"\n      class="kuiButton kuiButton--basic"\n      i18n-id="xpack.ml.accessDenied.retryButtonLabel"\n      i18n-default-message="Retry"\n    ></button>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2761);__webpack_require__(2840);__webpack_require__(2868);__webpack_require__(2889);__webpack_require__(2908);__webpack_require__(2918);__webpack_require__(2923);__webpack_require__(2935)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2762)},function(module,exports,__webpack_require__){"use strict";var _reactDom=_interopRequireDefault(__webpack_require__(17));var _react=_interopRequireDefault(__webpack_require__(0));var _modules=__webpack_require__(8);var _index_utils=__webpack_require__(226);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _breadcrumbs=__webpack_require__(400);var _new_job_defaults=__webpack_require__(337);var _routes=_interopRequireDefault(__webpack_require__(19));var _jobs=__webpack_require__(2771);var _i18n=__webpack_require__(15);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='<ml-nav-menu name="jobs" /><jobs-page />';_routes.default.when("/jobs/?",{template:template,k7Breadcrumbs:_breadcrumbs.getJobManagementBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,indexPatterns:_index_utils.loadIndexPatterns,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});_module.directive("jobsPage",function(){return{scope:{},restrict:"E",link:function link(scope,element){_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_jobs.JobsPage,{angularWrapperScope:scope})),element[0]);element.on("$destroy",function(){_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LICENSE_TYPE=void 0;var LICENSE_TYPE={BASIC:0,FULL:1};exports.LICENSE_TYPE=LICENSE_TYPE},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ml_api_service_1=__webpack_require__(24);var upgrade_service_1=__webpack_require__(1349);function getPrivileges(){var privileges={canGetJobs:false,canCreateJob:false,canDeleteJob:false,canOpenJob:false,canCloseJob:false,canForecastJob:false,canGetDatafeeds:false,canStartStopDatafeed:false,canUpdateJob:false,canUpdateDatafeed:false,canPreviewDatafeed:false,canGetCalendars:false,canCreateCalendar:false,canDeleteCalendar:false,canGetFilters:false,canCreateFilter:false,canDeleteFilter:false,canFindFileStructure:false,canGetDataFrameJobs:false,canDeleteDataFrameJob:false,canPreviewDataFrameJob:false,canCreateDataFrameJob:false,canStartStopDataFrameJob:false};return new Promise(function(resolve,reject){var priv={cluster:["cluster:monitor/data_frame/get","cluster:monitor/data_frame/stats/get","cluster:monitor/xpack/ml/job/get","cluster:monitor/xpack/ml/job/stats/get","cluster:monitor/xpack/ml/datafeeds/get","cluster:monitor/xpack/ml/datafeeds/stats/get","cluster:monitor/xpack/ml/calendars/get","cluster:admin/data_frame/delete","cluster:admin/data_frame/preview","cluster:admin/data_frame/put","cluster:admin/data_frame/start","cluster:admin/data_frame/start_task","cluster:admin/data_frame/stop","cluster:admin/xpack/ml/job/put","cluster:admin/xpack/ml/job/delete","cluster:admin/xpack/ml/job/update","cluster:admin/xpack/ml/job/open","cluster:admin/xpack/ml/job/close","cluster:admin/xpack/ml/job/forecast","cluster:admin/xpack/ml/datafeeds/put","cluster:admin/xpack/ml/datafeeds/delete","cluster:admin/xpack/ml/datafeeds/start","cluster:admin/xpack/ml/datafeeds/stop","cluster:admin/xpack/ml/datafeeds/update","cluster:admin/xpack/ml/datafeeds/preview","cluster:admin/xpack/ml/calendars/put","cluster:admin/xpack/ml/calendars/delete","cluster:admin/xpack/ml/calendars/jobs/update","cluster:admin/xpack/ml/calendars/events/post","cluster:admin/xpack/ml/calendars/events/delete","cluster:admin/xpack/ml/filters/put","cluster:admin/xpack/ml/filters/get","cluster:admin/xpack/ml/filters/update","cluster:admin/xpack/ml/filters/delete","cluster:monitor/xpack/ml/findfilestructure"]};ml_api_service_1.ml.checkPrivilege(priv).then(function(resp){if(resp.upgradeInProgress===true){upgrade_service_1.setUpgradeInProgress(true);setGettingPrivileges(resp.cluster,privileges,resp.securityDisabled===true)}else if(resp.securityDisabled){Object.keys(privileges).forEach(function(k){return privileges[k]=true})}else{setGettingPrivileges(resp.cluster,privileges);setActionPrivileges(resp.cluster,privileges)}resolve(privileges)}).catch(function(){reject(privileges)})})}exports.getPrivileges=getPrivileges;function setGettingPrivileges(){var cluster=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var privileges=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var forceTrue=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(forceTrue||cluster["cluster:monitor/xpack/ml/job/get"]&&cluster["cluster:monitor/xpack/ml/job/stats/get"]){privileges.canGetJobs=true}if(forceTrue||cluster["cluster:monitor/xpack/ml/datafeeds/get"]&&cluster["cluster:monitor/xpack/ml/datafeeds/stats/get"]){privileges.canGetDatafeeds=true}if(forceTrue||cluster["cluster:monitor/xpack/ml/calendars/get"]){privileges.canGetCalendars=true}if(forceTrue||cluster["cluster:admin/xpack/ml/filters/get"]){privileges.canGetFilters=true}if(forceTrue||cluster["cluster:monitor/xpack/ml/findfilestructure"]){privileges.canFindFileStructure=true}if(forceTrue||cluster["cluster:monitor/data_frame/get"]&&cluster["cluster:monitor/data_frame/stats/get"]){privileges.canGetDataFrameJobs=true}}function setActionPrivileges(){var cluster=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var privileges=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(cluster["cluster:admin/xpack/ml/job/put"]&&cluster["cluster:admin/xpack/ml/job/open"]&&cluster["cluster:admin/xpack/ml/datafeeds/put"]){privileges.canCreateJob=true}if(cluster["cluster:admin/xpack/ml/job/update"]){privileges.canUpdateJob=true}if(cluster["cluster:admin/xpack/ml/job/open"]){privileges.canOpenJob=true}if(cluster["cluster:admin/xpack/ml/job/close"]){privileges.canCloseJob=true}if(cluster["cluster:admin/xpack/ml/job/forecast"]){privileges.canForecastJob=true}if(cluster["cluster:admin/xpack/ml/job/delete"]&&cluster["cluster:admin/xpack/ml/datafeeds/delete"]){privileges.canDeleteJob=true}if(cluster["cluster:admin/xpack/ml/job/open"]&&cluster["cluster:admin/xpack/ml/datafeeds/start"]&&cluster["cluster:admin/xpack/ml/datafeeds/stop"]){privileges.canStartStopDatafeed=true}if(cluster["cluster:admin/xpack/ml/datafeeds/update"]){privileges.canUpdateDatafeed=true}if(cluster["cluster:admin/xpack/ml/datafeeds/preview"]){privileges.canPreviewDatafeed=true}if(cluster["cluster:admin/xpack/ml/calendars/put"]&&cluster["cluster:admin/xpack/ml/calendars/jobs/update"]&&cluster["cluster:admin/xpack/ml/calendars/events/post"]){privileges.canCreateCalendar=true}if(cluster["cluster:admin/xpack/ml/calendars/delete"]&&cluster["cluster:admin/xpack/ml/calendars/events/delete"]){privileges.canDeleteCalendar=true}if(cluster["cluster:admin/xpack/ml/filters/put"]&&cluster["cluster:admin/xpack/ml/filters/update"]){privileges.canCreateFilter=true}if(cluster["cluster:admin/xpack/ml/filters/delete"]){privileges.canDeleteFilter=true}if(cluster["cluster:admin/data_frame/put"]){privileges.canCreateDataFrameJob=true}if(cluster["cluster:admin/data_frame/delete"]){privileges.canDeleteDataFrameJob=true}if(cluster["cluster:admin/data_frame/preview"]){privileges.canPreviewDataFrameJob=true}if(cluster["cluster:admin/data_frame/start"]&&cluster["cluster:admin/data_frame/start_task"]&&cluster["cluster:admin/data_frame/stop"]){privileges.canStartStopDataFrameJob=true}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.annotations=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var annotations={getAnnotations:function getAnnotations(obj){return(0,_http_service.http)({url:"".concat(basePath,"/annotations"),method:"POST",data:obj})},indexAnnotation:function indexAnnotation(obj){return(0,_http_service.http)({url:"".concat(basePath,"/annotations/index"),method:"PUT",data:obj})},deleteAnnotation:function deleteAnnotation(id){return(0,_http_service.http)({url:"".concat(basePath,"/annotations/delete/").concat(id),method:"DELETE"})}};exports.annotations=annotations},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.dataFrame=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var dataFrame={getDataFrameTransforms:function getDataFrameTransforms(){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms"),method:"GET"})},getDataFrameTransformsStats:function getDataFrameTransformsStats(jobId){if(jobId!==undefined){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/").concat(jobId,"/_stats"),method:"GET"})}return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/_stats"),method:"GET"})},createDataFrameTransformsJob:function createDataFrameTransformsJob(jobId,jobConfig){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/").concat(jobId),method:"PUT",data:jobConfig})},deleteDataFrameTransformsJob:function deleteDataFrameTransformsJob(jobId){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/").concat(jobId),method:"DELETE"})},getDataFrameTransformsPreview:function getDataFrameTransformsPreview(obj){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/_preview"),method:"POST",data:obj})},startDataFrameTransformsJob:function startDataFrameTransformsJob(jobId){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/").concat(jobId,"/_start"),method:"POST"})},stopDataFrameTransformsJob:function stopDataFrameTransformsJob(jobId){return(0,_http_service.http)({url:"".concat(basePath,"/_data_frame/transforms/").concat(jobId,"/_stop?force=true"),method:"POST"})}};exports.dataFrame=dataFrame},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filters=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var filters={filters:function filters(obj){var filterId=obj&&obj.filterId?"/".concat(obj.filterId):"";return(0,_http_service.http)({url:"".concat(basePath,"/filters").concat(filterId),method:"GET"})},filtersStats:function filtersStats(){return(0,_http_service.http)({url:"".concat(basePath,"/filters/_stats"),method:"GET"})},addFilter:function addFilter(filterId,description,items){return(0,_http_service.http)({url:"".concat(basePath,"/filters"),method:"PUT",data:{filterId:filterId,description:description,items:items}})},updateFilter:function updateFilter(filterId,description,addItems,removeItems){var data={};if(description!==undefined){data.description=description}if(addItems!==undefined){data.addItems=addItems}if(removeItems!==undefined){data.removeItems=removeItems}return(0,_http_service.http)({url:"".concat(basePath,"/filters/").concat(filterId),method:"PUT",data:data})},deleteFilter:function deleteFilter(filterId){return(0,_http_service.http)({url:"".concat(basePath,"/filters/").concat(filterId),method:"DELETE"})}};exports.filters=filters},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.results=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var results={getAnomaliesTableData:function getAnomaliesTableData(jobIds,criteriaFields,influencers,aggregationInterval,threshold,earliestMs,latestMs,dateFormatTz,maxRecords,maxExamples,influencersFilterQuery){return(0,_http_service.http)({url:"".concat(basePath,"/results/anomalies_table_data"),method:"POST",data:{jobIds:jobIds,criteriaFields:criteriaFields,influencers:influencers,aggregationInterval:aggregationInterval,threshold:threshold,earliestMs:earliestMs,latestMs:latestMs,dateFormatTz:dateFormatTz,maxRecords:maxRecords,maxExamples:maxExamples,influencersFilterQuery:influencersFilterQuery}})},getCategoryDefinition:function getCategoryDefinition(jobId,categoryId){return(0,_http_service.http)({url:"".concat(basePath,"/results/category_definition"),method:"POST",data:{jobId:jobId,categoryId:categoryId}})},getCategoryExamples:function getCategoryExamples(jobId,categoryIds,maxExamples){return(0,_http_service.http)({url:"".concat(basePath,"/results/category_examples"),method:"POST",data:{jobId:jobId,categoryIds:categoryIds,maxExamples:maxExamples}})}};exports.results=results},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobs=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var jobs={jobsSummary:function jobsSummary(jobIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/jobs_summary"),method:"POST",data:{jobIds:jobIds}})},jobsWithTimerange:function jobsWithTimerange(dateFormatTz){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/jobs_with_timerange"),method:"POST",data:{dateFormatTz:dateFormatTz}})},jobs:function jobs(jobIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/jobs"),method:"POST",data:{jobIds:jobIds}})},groups:function groups(){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/groups"),method:"GET"})},updateGroups:function updateGroups(updatedJobs){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/update_groups"),method:"POST",data:{jobs:updatedJobs}})},forceStartDatafeeds:function forceStartDatafeeds(datafeedIds,start,end){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/force_start_datafeeds"),method:"POST",data:{datafeedIds:datafeedIds,start:start,end:end}})},stopDatafeeds:function stopDatafeeds(datafeedIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/stop_datafeeds"),method:"POST",data:{datafeedIds:datafeedIds}})},deleteJobs:function deleteJobs(jobIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/delete_jobs"),method:"POST",data:{jobIds:jobIds}})},closeJobs:function closeJobs(jobIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/close_jobs"),method:"POST",data:{jobIds:jobIds}})},jobAuditMessages:function jobAuditMessages(jobId,from){var jobIdString=jobId!==undefined?"/".concat(jobId):"";var fromString=from!==undefined?"?from=".concat(from):"";return(0,_http_service.http)({url:"".concat(basePath,"/job_audit_messages/messages").concat(jobIdString).concat(fromString),method:"GET"})},deletingJobTasks:function deletingJobTasks(){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/deleting_jobs_tasks"),method:"GET"})},jobsExist:function jobsExist(jobIds){return(0,_http_service.http)({url:"".concat(basePath,"/jobs/jobs_exist"),method:"POST",data:{jobIds:jobIds}})}};exports.jobs=jobs},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fileDatavisualizer=void 0;var _chrome=_interopRequireDefault(__webpack_require__(9));var _http_service=__webpack_require__(399);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome.default.addBasePath("/api/ml");var fileDatavisualizer={analyzeFile:function analyzeFile(obj){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var paramString="";if(Object.keys(params).length){paramString="?";for(var p in params){if(params.hasOwnProperty(p)){paramString+="&".concat(p,"=").concat(params[p])}}}return(0,_http_service.http)({url:"".concat(basePath,"/file_data_visualizer/analyze_file").concat(paramString),method:"POST",data:obj})},import:function _import(obj){var paramString=obj.id!==undefined?"?id=".concat(obj.id):"";var index=obj.index,data=obj.data,settings=obj.settings,mappings=obj.mappings,ingestPipeline=obj.ingestPipeline;return(0,_http_service.http)({url:"".concat(basePath,"/file_data_visualizer/import").concat(paramString),method:"POST",data:{index:index,data:data,settings:settings,mappings:mappings,ingestPipeline:ingestPipeline}})}};exports.fileDatavisualizer=fileDatavisualizer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsPage=void 0;var _jobs_list_view=__webpack_require__(2772);var _react=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var JobsPage=function JobsPage(props){return _react.default.createElement(_jobs_list_view.JobsListView,props)};exports.JobsPage=JobsPage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobsListView",{enumerable:true,get:function get(){return _jobs_list_view.JobsListView}});var _jobs_list_view=__webpack_require__(2773)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsListView=void 0;var _timefilter=__webpack_require__(22);var _ml_api_service=__webpack_require__(24);var _utils=__webpack_require__(433);var _jobs_list=__webpack_require__(2775);var _job_details=__webpack_require__(2783);var _job_filter_bar=__webpack_require__(2797);var _edit_job_flyout=__webpack_require__(2799);var _delete_job_modal=__webpack_require__(2809);var _start_datafeed_modal=__webpack_require__(2811);var _create_watch_flyout=__webpack_require__(2815);var _multi_job_actions=__webpack_require__(2821);var _new_job_button=__webpack_require__(2830);var _jobs_stats_bar=__webpack_require__(2832);var _node_available_warning=__webpack_require__(2834);var _upgrade=__webpack_require__(2836);var _refresh_jobs_list_button=__webpack_require__(2838);var _lodash=__webpack_require__(3);var _jobs_list2=__webpack_require__(679);var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var jobsRefreshInterval=null;var deletingJobsRefreshTimeout=null;var JobsListView=function(_Component){_inherits(JobsListView,_Component);function JobsListView(props){var _this;_classCallCheck(this,JobsListView);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobsListView).call(this,props));_defineProperty(_assertThisInitialized(_this),"toggleRow",function(jobId){if(_this.state.itemIdToExpandedRowMap[jobId]){var itemIdToExpandedRowMap=_objectSpread({},_this.state.itemIdToExpandedRowMap);delete itemIdToExpandedRowMap[jobId];_this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap})}else{var _itemIdToExpandedRowMap=_objectSpread({},_this.state.itemIdToExpandedRowMap);if(_this.state.fullJobsList[jobId]!==undefined){_itemIdToExpandedRowMap[jobId]=_react.default.createElement(_job_details.JobDetails,{jobId:jobId,job:_this.state.fullJobsList[jobId],addYourself:_this.addUpdateFunction,removeYourself:_this.removeUpdateFunction})}else{_itemIdToExpandedRowMap[jobId]=_react.default.createElement(_job_details.JobDetails,{jobId:jobId,addYourself:_this.addUpdateFunction,removeYourself:_this.removeUpdateFunction})}_this.setState({itemIdToExpandedRowMap:_itemIdToExpandedRowMap},function(){(0,_utils.loadFullJob)(jobId).then(function(job){var fullJobsList=_objectSpread({},_this.state.fullJobsList);fullJobsList[jobId]=job;_this.setState({fullJobsList:fullJobsList},function(){_itemIdToExpandedRowMap=_objectSpread({},_this.state.itemIdToExpandedRowMap);if(_itemIdToExpandedRowMap[jobId]!==undefined){_itemIdToExpandedRowMap[jobId]=_react.default.createElement(_job_details.JobDetails,{jobId:jobId,job:job,addYourself:_this.addUpdateFunction,removeYourself:_this.removeUpdateFunction})}_this.setState({itemIdToExpandedRowMap:_itemIdToExpandedRowMap})})}).catch(function(error){console.error(error)})})}});_defineProperty(_assertThisInitialized(_this),"addUpdateFunction",function(id,f){_this.updateFunctions[id]=f});_defineProperty(_assertThisInitialized(_this),"removeUpdateFunction",function(id){delete _this.updateFunctions[id]});_defineProperty(_assertThisInitialized(_this),"setShowEditJobFlyoutFunction",function(func){_this.showEditJobFlyout=func});_defineProperty(_assertThisInitialized(_this),"unsetShowEditJobFlyoutFunction",function(){_this.showEditJobFlyout=function(){}});_defineProperty(_assertThisInitialized(_this),"setShowDeleteJobModalFunction",function(func){_this.showDeleteJobModal=func});_defineProperty(_assertThisInitialized(_this),"unsetShowDeleteJobModalFunction",function(){_this.showDeleteJobModal=function(){}});_defineProperty(_assertThisInitialized(_this),"setShowStartDatafeedModalFunction",function(func){_this.showStartDatafeedModal=func});_defineProperty(_assertThisInitialized(_this),"unsetShowStartDatafeedModalFunction",function(){_this.showStartDatafeedModal=function(){}});_defineProperty(_assertThisInitialized(_this),"setShowCreateWatchFlyoutFunction",function(func){_this.showCreateWatchFlyout=func});_defineProperty(_assertThisInitialized(_this),"unsetShowCreateWatchFlyoutFunction",function(){_this.showCreateWatchFlyout=function(){}});_defineProperty(_assertThisInitialized(_this),"getShowCreateWatchFlyoutFunction",function(){return _this.showCreateWatchFlyout});_defineProperty(_assertThisInitialized(_this),"selectJobChange",function(selectedJobs){_this.setState({selectedJobs:selectedJobs})});_defineProperty(_assertThisInitialized(_this),"setFilters",function(filterClauses){var filteredJobsSummaryList=(0,_utils.filterJobs)(_this.state.jobsSummaryList,filterClauses);_this.setState({filteredJobsSummaryList:filteredJobsSummaryList,filterClauses:filterClauses},function(){_this.refreshSelectedJobs()})});_defineProperty(_assertThisInitialized(_this),"onRefreshClick",function(){_this.setState({isRefreshing:true});_this.refreshJobSummaryList(true)});_defineProperty(_assertThisInitialized(_this),"isDoneRefreshing",function(){_this.setState({isRefreshing:false})});_this.state={isRefreshing:false,loading:null,jobsSummaryList:[],filteredJobsSummaryList:[],fullJobsList:{},selectedJobs:[],itemIdToExpandedRowMap:{},filterClauses:[],deletingJobIds:[]};_this.updateFunctions={};_this.showEditJobFlyout=function(){};_this.showDeleteJobModal=function(){};_this.showStartDatafeedModal=function(){};_this.showCreateWatchFlyout=function(){};_this.blockRefresh=false;return _this}_createClass(JobsListView,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this.props.angularWrapperScope.$on("jobsUpdated",function(){_this2.refreshJobSummaryList(true)});this.props.angularWrapperScope.$on("openCreateWatchWindow",function(e,job){_this2.showCreateWatchFlyout(job.job_id)});_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.enableAutoRefreshSelector();this.initAutoRefresh();this.initAutoRefreshUpdate();this.openAutoStartDatafeedModal()}},{key:"componentWillUnmount",value:function componentWillUnmount(){_timefilter.timefilter.off("refreshIntervalUpdate");deletingJobsRefreshTimeout=null;this.clearRefreshInterval()}},{key:"initAutoRefresh",value:function initAutoRefresh(){var _timefilter$getRefres=_timefilter.timefilter.getRefreshInterval(),value=_timefilter$getRefres.value;if(value===0){_timefilter.timefilter.setRefreshInterval({pause:false,value:_jobs_list2.DEFAULT_REFRESH_INTERVAL_MS})}this.setAutoRefresh()}},{key:"initAutoRefreshUpdate",value:function initAutoRefreshUpdate(){var _this3=this;_timefilter.timefilter.on("refreshIntervalUpdate",function(){_this3.setAutoRefresh()})}},{key:"setAutoRefresh",value:function setAutoRefresh(){var _timefilter$getRefres2=_timefilter.timefilter.getRefreshInterval(),value=_timefilter$getRefres2.value,pause=_timefilter$getRefres2.pause;if(pause){this.clearRefreshInterval()}else{this.setRefreshInterval(value)}this.refreshJobSummaryList()}},{key:"setRefreshInterval",value:function setRefreshInterval(interval){var _this4=this;this.clearRefreshInterval();if(interval>=_jobs_list2.MINIMUM_REFRESH_INTERVAL_MS){this.blockRefresh=false;jobsRefreshInterval=setInterval(function(){return _this4.refreshJobSummaryList()},interval)}}},{key:"clearRefreshInterval",value:function clearRefreshInterval(){this.blockRefresh=true;clearInterval(jobsRefreshInterval)}},{key:"openAutoStartDatafeedModal",value:function openAutoStartDatafeedModal(){var job=(0,_utils.checkForAutoStartDatafeed)();if(job!==undefined){this.showStartDatafeedModal([job])}}},{key:"refreshSelectedJobs",value:function refreshSelectedJobs(){var selectedJobsIds=this.state.selectedJobs.map(function(j){return j.id});var filteredJobIds=this.state.filteredJobsSummaryList.map(function(j){return j.id});var selectedJobs=this.state.jobsSummaryList.filter(function(j){return selectedJobsIds.find(function(id){return id===j.id})}).filter(function(j){return filteredJobIds.find(function(id){return id===j.id})});this.setState({selectedJobs:selectedJobs})}},{key:"refreshJobSummaryList",value:function(){var _refreshJobSummaryList=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this5=this;var forceRefresh,expandedJobsIds,jobs,fullJobsList,jobsSummaryList,filteredJobsSummaryList,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:forceRefresh=_args.length>0&&_args[0]!==undefined?_args[0]:false;if(!(forceRefresh===true||this.blockRefresh===false)){_context.next=22;break}if(this.state.loading===null){this.setState({loading:true})}expandedJobsIds=Object.keys(this.state.itemIdToExpandedRowMap);_context.prev=4;_context.next=7;return _ml_api_service.ml.jobs.jobsSummary(expandedJobsIds);case 7:jobs=_context.sent;fullJobsList={};jobsSummaryList=jobs.map(function(job){if(job.fullJob!==undefined){fullJobsList[job.id]=job.fullJob;delete job.fullJob}job.latestTimestampSortValue=job.latestTimestampMs||0;return job});filteredJobsSummaryList=(0,_utils.filterJobs)(jobsSummaryList,this.state.filterClauses);this.setState({jobsSummaryList:jobsSummaryList,filteredJobsSummaryList:filteredJobsSummaryList,fullJobsList:fullJobsList,loading:false},function(){_this5.refreshSelectedJobs()});Object.keys(this.updateFunctions).forEach(function(j){_this5.updateFunctions[j].setState({job:fullJobsList[j]})});jobs.forEach(function(job){if(job.deleting&&_this5.state.itemIdToExpandedRowMap[job.id]){_this5.toggleRow(job.id)}});this.isDoneRefreshing();if(jobsSummaryList.some(function(j){return j.deleting===true})){this.checkDeletingJobTasks(forceRefresh)}_context.next=22;break;case 18:_context.prev=18;_context.t0=_context["catch"](4);console.error(_context.t0);this.setState({loading:false});case 22:case"end":return _context.stop()}}},_callee,this,[[4,18]])}));function refreshJobSummaryList(){return _refreshJobSummaryList.apply(this,arguments)}return refreshJobSummaryList}()},{key:"checkDeletingJobTasks",value:function(){var _checkDeletingJobTasks=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var _this6=this;var forceRefresh,_ref,taskJobIds,taskListHasChanged,_args2=arguments;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:forceRefresh=_args2.length>0&&_args2[0]!==undefined?_args2[0]:false;_context2.next=3;return _ml_api_service.ml.jobs.deletingJobTasks();case 3:_ref=_context2.sent;taskJobIds=_ref.jobIds;taskListHasChanged=(0,_lodash.isEqual)(taskJobIds.sort(),this.state.deletingJobIds.sort())===false;this.setState({deletingJobIds:taskJobIds});if(taskListHasChanged||forceRefresh){this.refreshJobSummaryList()}if(taskJobIds.length>0&&deletingJobsRefreshTimeout===null){deletingJobsRefreshTimeout=setTimeout(function(){deletingJobsRefreshTimeout=null;_this6.checkDeletingJobTasks()},_jobs_list2.DELETING_JOBS_REFRESH_INTERVAL_MS)}case 9:case"end":return _context2.stop()}}},_callee2,this)}));function checkDeletingJobTasks(){return _checkDeletingJobTasks.apply(this,arguments)}return checkDeletingJobTasks}()},{key:"renderJobsListComponents",value:function renderJobsListComponents(){var _this7=this;var _this$state=this.state,loading=_this$state.loading,jobsSummaryList=_this$state.jobsSummaryList;var jobIds=jobsSummaryList.map(function(j){return j.id});return _react.default.createElement("div",null,_react.default.createElement("div",{className:"actions-bar"},_react.default.createElement(_multi_job_actions.MultiJobActions,{selectedJobs:this.state.selectedJobs,allJobIds:jobIds,showStartDatafeedModal:this.showStartDatafeedModal,showDeleteJobModal:this.showDeleteJobModal,refreshJobs:function refreshJobs(){return _this7.refreshJobSummaryList(true)}}),_react.default.createElement(_job_filter_bar.JobFilterBar,{setFilters:this.setFilters})),_react.default.createElement(_jobs_list.JobsList,{jobsSummaryList:this.state.filteredJobsSummaryList,fullJobsList:this.state.fullJobsList,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,showEditJobFlyout:this.showEditJobFlyout,showDeleteJobModal:this.showDeleteJobModal,showStartDatafeedModal:this.showStartDatafeedModal,refreshJobs:function refreshJobs(){return _this7.refreshJobSummaryList(true)},selectedJobsCount:this.state.selectedJobs.length,loading:loading}),_react.default.createElement(_edit_job_flyout.EditJobFlyout,{setShowFunction:this.setShowEditJobFlyoutFunction,unsetShowFunction:this.unsetShowEditJobFlyoutFunction,refreshJobs:function refreshJobs(){return _this7.refreshJobSummaryList(true)},allJobIds:jobIds}),_react.default.createElement(_delete_job_modal.DeleteJobModal,{setShowFunction:this.setShowDeleteJobModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,refreshJobs:function refreshJobs(){return _this7.refreshJobSummaryList(true)}}),_react.default.createElement(_start_datafeed_modal.StartDatafeedModal,{setShowFunction:this.setShowStartDatafeedModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,getShowCreateWatchFlyoutFunction:this.getShowCreateWatchFlyoutFunction,refreshJobs:function refreshJobs(){return _this7.refreshJobSummaryList(true)}}),_react.default.createElement(_create_watch_flyout.CreateWatchFlyout,{setShowFunction:this.setShowCreateWatchFlyoutFunction,unsetShowFunction:this.unsetShowCreateWatchFlyoutFunction,compile:this.props.compile}))}},{key:"render",value:function render(){var _this$state2=this.state,isRefreshing=_this$state2.isRefreshing,jobsSummaryList=_this$state2.jobsSummaryList;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_jobs_stats_bar.JobStatsBar,{jobsSummaryList:jobsSummaryList}),_react.default.createElement("div",{className:"job-management","data-test-subj":"ml-jobs-list"},_react.default.createElement(_node_available_warning.NodeAvailableWarning,null),_react.default.createElement(_upgrade.UpgradeWarning,null),_react.default.createElement("header",null,_react.default.createElement("div",{className:"job-buttons-container"},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_refresh_jobs_list_button.RefreshJobsListButton,{onRefreshClick:this.onRefreshClick,isRefreshing:isRefreshing})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_new_job_button.NewJobButton,null))))),_react.default.createElement("div",{className:"clear"}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),this.renderJobsListComponents()))}}]);return JobsListView}(_react.Component);exports.JobsListView=JobsListView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MLRequestFailure=void 0;var _errors=__webpack_require__(75);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var MLRequestFailure=function(_KbnError){_inherits(MLRequestFailure,_KbnError);function MLRequestFailure(error,resp){var _this;_classCallCheck(this,MLRequestFailure);error=error||{};_this=_possibleConstructorReturn(this,_getPrototypeOf(MLRequestFailure).call(this,error.message||JSON.stringify(resp),MLRequestFailure));_this.origError=error;_this.resp=typeof resp==="string"?JSON.parse(resp):resp;return _this}return MLRequestFailure}(_errors.KbnError);exports.MLRequestFailure=MLRequestFailure},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobsList",{enumerable:true,get:function get(){return _jobs_list.JobsList}});var _jobs_list=__webpack_require__(2776)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsList=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _lodash=__webpack_require__(3);var _moment=_interopRequireDefault(__webpack_require__(16));var _string_utils=__webpack_require__(67);var _job_actions=__webpack_require__(1350);var _job_description=__webpack_require__(2779);var _job_message_icon=__webpack_require__(1352);var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var PAGE_SIZE=10;var PAGE_SIZE_OPTIONS=[10,25,50];var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var JobsListUI=function(_Component){_inherits(JobsListUI,_Component);function JobsListUI(props){var _this;_classCallCheck(this,JobsListUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobsListUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"onTableChange",function(_ref){var _ref$page=_ref.page,page=_ref$page===void 0?{}:_ref$page,_ref$sort=_ref.sort,sort=_ref$sort===void 0?{}:_ref$sort;var pageIndex=page.index,pageSize=page.size;var sortField=sort.field,sortDirection=sort.direction;_this.setState({pageIndex:pageIndex,pageSize:pageSize,sortField:sortField,sortDirection:sortDirection})});_defineProperty(_assertThisInitialized(_this),"toggleRow",function(item){_this.props.toggleRow(item.id)});_this.state={jobsSummaryList:props.jobsSummaryList,pageIndex:0,pageSize:PAGE_SIZE,itemIdToExpandedRowMap:{},sortField:"id",sortDirection:"asc"};return _this}_createClass(JobsListUI,[{key:"getPageOfJobs",value:function getPageOfJobs(index,size,sortField,sortDirection){var _this2=this;var list=this.state.jobsSummaryList;list=(0,_lodash.sortBy)(this.state.jobsSummaryList,function(item){return item[sortField]});list=sortDirection==="asc"?list:list.reverse();var listLength=list.length;var pageStart=index*size;if(pageStart>=listLength&&listLength!==0){pageStart=Math.floor((listLength-1)/size)*size;setTimeout(function(){_this2.setState({pageIndex:pageStart/size})},0)}return{pageOfItems:list.slice(pageStart,pageStart+size),totalItemCount:listLength}}},{key:"render",value:function render(){var _this3=this;var _this$props=this.props,intl=_this$props.intl,loading=_this$props.loading;var selectionControls={selectable:function selectable(job){return job.deleting!==true},selectableMessage:function selectableMessage(selectable){return!selectable?intl.formatMessage({id:"xpack.ml.jobsList.cannotSelectJobTooltip",defaultMessage:"Cannot select job"}):undefined},onSelectionChange:this.props.selectJobChange};var columns=[{name:"",render:function render(item){return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return _this3.toggleRow(item)},isDisabled:item.deleting===true,iconType:_this3.state.itemIdToExpandedRowMap[item.id]?"arrowDown":"arrowRight","aria-label":_this3.state.itemIdToExpandedRowMap[item.id]?intl.formatMessage({id:"xpack.ml.jobsList.collapseJobDetailsAriaLabel",defaultMessage:"Hide details for {itemId}"},{itemId:item.id}):intl.formatMessage({id:"xpack.ml.jobsList.expandJobDetailsAriaLabel",defaultMessage:"Show details for {itemId}"},{itemId:item.id}),"data-row-id":item.id})}},{field:"id",name:intl.formatMessage({id:"xpack.ml.jobsList.idLabel",defaultMessage:"ID"}),sortable:true,truncateText:false},{field:"auditMessage",name:"",render:function render(item){return _react.default.createElement(_job_message_icon.JobIcon,{message:item,showTooltip:true})}},{name:intl.formatMessage({id:"xpack.ml.jobsList.descriptionLabel",defaultMessage:"Description"}),sortable:true,field:"description",render:function render(description,item){return _react.default.createElement(_job_description.JobDescription,{job:item})},textOnly:true},{field:"processed_record_count",name:intl.formatMessage({id:"xpack.ml.jobsList.processedRecordsLabel",defaultMessage:"Processed records"}),sortable:true,truncateText:false,dataType:"number",render:function render(count){return(0,_string_utils.toLocaleString)(count)}},{field:"memory_status",name:intl.formatMessage({id:"xpack.ml.jobsList.memoryStatusLabel",defaultMessage:"Memory status"}),sortable:true,truncateText:false},{field:"jobState",name:intl.formatMessage({id:"xpack.ml.jobsList.jobStateLabel",defaultMessage:"Job state"}),sortable:true,truncateText:false},{field:"datafeedState",name:intl.formatMessage({id:"xpack.ml.jobsList.datafeedStateLabel",defaultMessage:"Datafeed state"}),sortable:true,truncateText:false},{name:intl.formatMessage({id:"xpack.ml.jobsList.latestTimestampLabel",defaultMessage:"Latest timestamp"}),truncateText:false,field:"latestTimestampSortValue",sortable:true,render:function render(time,item){return _react.default.createElement("span",{className:"euiTableCellContent__text"},item.latestTimestampMs===undefined?"":(0,_moment.default)(item.latestTimestampMs).format(TIME_FORMAT))},textOnly:true},{name:intl.formatMessage({id:"xpack.ml.jobsList.actionsLabel",defaultMessage:"Actions"}),render:function render(item){return _react.default.createElement(_job_actions.ResultLinks,{jobs:[item]})}},{name:"",actions:(0,_job_actions.actionsMenuContent)(this.props.showEditJobFlyout,this.props.showDeleteJobModal,this.props.showStartDatafeedModal,this.props.refreshJobs)}];var _this$state=this.state,pageIndex=_this$state.pageIndex,pageSize=_this$state.pageSize,sortField=_this$state.sortField,sortDirection=_this$state.sortDirection;var _this$getPageOfJobs=this.getPageOfJobs(pageIndex,pageSize,sortField,sortDirection),pageOfItems=_this$getPageOfJobs.pageOfItems,totalItemCount=_this$getPageOfJobs.totalItemCount;var pagination={pageIndex:pageIndex,pageSize:pageSize,totalItemCount:totalItemCount,pageSizeOptions:PAGE_SIZE_OPTIONS};var sorting={sort:{field:sortField,direction:sortDirection}};var selectedJobsClass=this.props.selectedJobsCount?"jobs-selected":"";return _react.default.createElement(_eui.EuiBasicTable,{"data-test-subj":"mlJobListTable",loading:loading===true,noItemsMessage:loading?intl.formatMessage({id:"xpack.ml.jobsList.loadingJobsLabel",defaultMessage:"Loading jobs…"}):intl.formatMessage({id:"xpack.ml.jobsList.noJobsFoundLabel",defaultMessage:"No jobs found"}),itemId:"id",className:"jobs-list-table ".concat(selectedJobsClass),items:pageOfItems,columns:columns,pagination:pagination,onChange:this.onTableChange,selection:selectionControls,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,isExpandable:true,sorting:sorting,hasActions:true})}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){var itemIdToExpandedRowMap=props.itemIdToExpandedRowMap;var jobsSummaryList=props.jobsSummaryList;return{itemIdToExpandedRowMap:itemIdToExpandedRowMap,jobsSummaryList:jobsSummaryList}}}]);return JobsListUI}(_react.Component);JobsListUI.propTypes={jobsSummaryList:_propTypes.default.array.isRequired,fullJobsList:_propTypes.default.object.isRequired,itemIdToExpandedRowMap:_propTypes.default.object.isRequired,toggleRow:_propTypes.default.func.isRequired,selectJobChange:_propTypes.default.func.isRequired,showEditJobFlyout:_propTypes.default.func.isRequired,showDeleteJobModal:_propTypes.default.func.isRequired,showStartDatafeedModal:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired,selectedJobsCount:_propTypes.default.number.isRequired,loading:_propTypes.default.bool};JobsListUI.defaultProps={loading:false};var JobsList=(0,_react2.injectI18n)(JobsListUI);exports.JobsList=JobsList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.actionsMenuContent=actionsMenuContent;var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _index_utils=__webpack_require__(226);var _utils=__webpack_require__(433);var _i18n=__webpack_require__(4);function actionsMenuContent(showEditJobFlyout,showDeleteJobModal,showStartDatafeedModal,refreshJobs){var canCreateJob=(0,_check_privilege.checkPermission)("canCreateJob")&&(0,_check_ml_nodes.mlNodesAvailable)();var canUpdateJob=(0,_check_privilege.checkPermission)("canUpdateJob");var canDeleteJob=(0,_check_privilege.checkPermission)("canDeleteJob");var canUpdateDatafeed=(0,_check_privilege.checkPermission)("canUpdateDatafeed");var canStartStopDatafeed=(0,_check_privilege.checkPermission)("canStartStopDatafeed")&&(0,_check_ml_nodes.mlNodesAvailable)();var canCloseJob=(0,_check_privilege.checkPermission)("canCloseJob")&&(0,_check_ml_nodes.mlNodesAvailable)();return[{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedLabel",{defaultMessage:"Start datafeed"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedDescription",{defaultMessage:"Start datafeed"}),icon:"play",enabled:function enabled(item){return item.deleting!==true&&canStartStopDatafeed},available:function available(item){return(0,_utils.isStartable)([item])},onClick:function onClick(item){showStartDatafeedModal([item]);closeMenu()}},{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedLabel",{defaultMessage:"Stop datafeed"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedDescription",{defaultMessage:"Stop datafeed"}),icon:"stop",enabled:function enabled(item){return item.deleting!==true&&canStartStopDatafeed},available:function available(item){return(0,_utils.isStoppable)([item])},onClick:function onClick(item){(0,_utils.stopDatafeeds)([item],refreshJobs);closeMenu(true)}},{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.closeJobLabel",{defaultMessage:"Close job"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.closeJobDescription",{defaultMessage:"Close job"}),icon:"cross",enabled:function enabled(item){return item.deleting!==true&&canCloseJob},available:function available(item){return(0,_utils.isClosable)([item])},onClick:function onClick(item){(0,_utils.closeJobs)([item],refreshJobs);closeMenu(true)}},{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobLabel",{defaultMessage:"Clone job"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobDescription",{defaultMessage:"Clone job"}),icon:"copy",enabled:function enabled(item){var indexPatternNames=(0,_index_utils.getIndexPatternNames)();var jobIndicesAvailable=item.datafeedIndices.every(function(dfiName){return indexPatternNames.some(function(ipName){return ipName===dfiName})});return item.deleting!==true&&canCreateJob&&jobIndicesAvailable},onClick:function onClick(item){(0,_utils.cloneJob)(item.id);closeMenu(true)}},{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.editJobLabel",{defaultMessage:"Edit job"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.editJobDescription",{defaultMessage:"Edit job"}),icon:"pencil",enabled:function enabled(item){return item.deleting!==true&&canUpdateJob&&canUpdateDatafeed},onClick:function onClick(item){showEditJobFlyout(item);closeMenu()}},{name:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobLabel",{defaultMessage:"Delete job"}),description:_i18n.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobDescription",{defaultMessage:"Delete job"}),icon:"trash",color:"danger",enabled:function enabled(){return canDeleteJob},onClick:function onClick(item){showDeleteJobModal([item]);closeMenu()}}]}function closeMenu(){var now=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(now){document.querySelector(".euiTable").click()}else{window.setTimeout(function(){var modalBody=document.querySelector(".euiModalBody");if(modalBody){modalBody.click()}else{document.querySelector(".euiTable").click()}},500)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultLinks=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _chrome=_interopRequireDefault(__webpack_require__(9));var _job_service=__webpack_require__(36);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getLink(location,jobs){var resultsPageUrl=_job_service.mlJobService.createResultsUrlForJobs(jobs,location);return"".concat(_chrome.default.getBasePath(),"/app/").concat(resultsPageUrl)}function ResultLinksUI(_ref){var jobs=_ref.jobs,intl=_ref.intl;var openJobsInSingleMetricViewerText=intl.formatMessage({id:"xpack.ml.jobsList.resultActions.openJobsInSingleMetricViewerText",defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Single Metric Viewer"},{jobsCount:jobs.length,jobId:jobs[0].id});var openJobsInAnomalyExplorerText=intl.formatMessage({id:"xpack.ml.jobsList.resultActions.openJobsInAnomalyExplorerText",defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer"},{jobsCount:jobs.length,jobId:jobs[0].id});var singleMetricVisible=jobs.length<2;var singleMetricEnabled=jobs.length===1&&jobs[0].isSingleMetricViewerJob;var jobActionsDisabled=jobs.length===1&&jobs[0].deleting===true;return _react.default.createElement(_react.default.Fragment,null,singleMetricVisible&&_react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:openJobsInSingleMetricViewerText},_react.default.createElement(_eui.EuiButtonIcon,{href:getLink("timeseriesexplorer",jobs),iconType:"stats","aria-label":openJobsInSingleMetricViewerText,className:"results-button",isDisabled:singleMetricEnabled===false||jobActionsDisabled===true})),_react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:openJobsInAnomalyExplorerText},_react.default.createElement(_eui.EuiButtonIcon,{href:getLink("explorer",jobs),iconType:"tableOfContents","aria-label":openJobsInAnomalyExplorerText,className:"results-button",isDisabled:jobActionsDisabled===true})),_react.default.createElement("div",{className:"actions-border"}))}ResultLinksUI.propTypes={jobs:_propTypes.default.array.isRequired};var ResultLinks=(0,_react2.injectI18n)(ResultLinksUI);exports.ResultLinks=ResultLinks},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDescription=JobDescription;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _job_group=__webpack_require__(880);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function JobDescription(_ref){var job=_ref.job;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"job-description"},job.description,"  ",job.groups.map(function(group){return _react.default.createElement(_job_group.JobGroup,{key:group,name:group})})))}JobDescription.propTypes={job:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobGroup=JobGroup;var _group_color_utils=__webpack_require__(1351);var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function JobGroup(_ref){var name=_ref.name;return _react.default.createElement("div",{className:"inline-group",style:{backgroundColor:(0,_group_color_utils.tabColor)(name)}},name)}JobGroup.propTypes={name:_propTypes.default.string.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderTemplate=renderTemplate;exports.stringHash=stringHash;function renderTemplate(str,data){var matches=str.match(/{{(.*?)}}/g);if(Array.isArray(matches)){matches.forEach(function(v){str=str.replace(v,data[v.replace(/{{|}}/g,"")])})}return str}function stringHash(str){var hash=0;var chr="";if(str.length===0){return hash}for(var i=0;i<str.length;i++){chr=str.charCodeAt(i);hash=(hash<<5)-hash+chr;hash|=0}return hash<0?hash*-2:hash}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobIcon=JobIcon;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var INFO="info",WARNING="warning",ERROR="error";function JobIcon(_ref){var message=_ref.message,_ref$showTooltip=_ref.showTooltip,showTooltip=_ref$showTooltip===void 0?false:_ref$showTooltip;if(message!==undefined){var color="primary";var icon="alert";if(message.level===INFO){color="primary"}else if(message.level===WARNING){color="warning"}else if(message.level===ERROR){color="danger"}if(showTooltip){return _react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:message.text},_react.default.createElement(_eui.EuiIcon,{type:icon,color:color}))}else{return _react.default.createElement(_eui.EuiIcon,{type:icon,color:color})}}else{return _react.default.createElement("span",null)}}JobIcon.propTypes={message:_propTypes.default.object,showTooltip:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobDetails",{enumerable:true,get:function get(){return _job_details.JobDetails}});var _job_details=__webpack_require__(2784)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDetails=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _extract_job_details=__webpack_require__(2785);var _json_tab=__webpack_require__(2787);var _datafeed_preview_tab=__webpack_require__(2789);var _annotations_table=__webpack_require__(676);var _annotation_flyout=__webpack_require__(883);var _forecasts_table=__webpack_require__(2793);var _job_details_pane=__webpack_require__(2795);var _job_messages_pane=__webpack_require__(2796);var _react2=__webpack_require__(5);var _chrome=_interopRequireDefault(__webpack_require__(9));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var mlAnnotationsEnabled=_chrome.default.getInjected("mlAnnotationsEnabled",false);var JobDetailsUI=function(_Component){_inherits(JobDetailsUI,_Component);function JobDetailsUI(props){var _this;_classCallCheck(this,JobDetailsUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobDetailsUI).call(this,props));_this.state={};if(_this.props.addYourself){_this.props.addYourself(props.jobId,_assertThisInitialized(_this))}return _this}_createClass(JobDetailsUI,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.removeYourself(this.props.jobId)}},{key:"render",value:function render(){var job=this.state.job;if(job===undefined){return _react.default.createElement("div",{className:"job-loading-spinner"},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}))}else{var _extractJobDetails=(0,_extract_job_details.extractJobDetails)(job),general=_extractJobDetails.general,customUrl=_extractJobDetails.customUrl,node=_extractJobDetails.node,calendars=_extractJobDetails.calendars,detectors=_extractJobDetails.detectors,influencers=_extractJobDetails.influencers,analysisConfig=_extractJobDetails.analysisConfig,analysisLimits=_extractJobDetails.analysisLimits,dataDescription=_extractJobDetails.dataDescription,datafeed=_extractJobDetails.datafeed,counts=_extractJobDetails.counts,modelSizeStats=_extractJobDetails.modelSizeStats;var intl=this.props.intl;var tabs=[{id:"job-settings",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.jobSettingsLabel",defaultMessage:"Job settings"}),content:_react.default.createElement(_job_details_pane.JobDetailsPane,{sections:[general,customUrl,node,calendars]}),time:job.open_time},{id:"job-config",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.jobConfigLabel",defaultMessage:"Job config"}),content:_react.default.createElement(_job_details_pane.JobDetailsPane,{sections:[detectors,influencers,analysisConfig,analysisLimits,dataDescription]})},{id:"datafeed",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.datafeedLabel",defaultMessage:"Datafeed"}),content:_react.default.createElement(_job_details_pane.JobDetailsPane,{sections:[datafeed]})},{id:"counts",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.countsLabel",defaultMessage:"Counts"}),content:_react.default.createElement(_job_details_pane.JobDetailsPane,{sections:[counts,modelSizeStats]})},{id:"json",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.jsonLabel",defaultMessage:"JSON"}),content:_react.default.createElement(_json_tab.JsonPane,{job:job})},{id:"job-messages",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.jobMessagesLabel",defaultMessage:"Job messages"}),content:_react.default.createElement(_job_messages_pane.JobMessagesPane,{job:job})},{id:"datafeed-preview",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.datafeedPreviewLabel",defaultMessage:"Datafeed preview"}),content:_react.default.createElement(_datafeed_preview_tab.DatafeedPreviewPane,{job:job})},{id:"forecasts",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.forecastsLabel",defaultMessage:"Forecasts"}),content:_react.default.createElement(_forecasts_table.ForecastsTable,{job:job})}];if(mlAnnotationsEnabled){tabs.push({id:"annotations",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.tabs.annotationsLabel",defaultMessage:"Annotations"}),content:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_annotations_table.AnnotationsTable,{jobs:[job],drillDown:true}),_react.default.createElement(_annotation_flyout.AnnotationFlyout,null))})}return _react.default.createElement("div",{className:"tab-contents"},_react.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}}))}}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){var job=props.job,loading=props.loading;return{job:job,loading:loading}}}]);return JobDetailsUI}(_react.Component);JobDetailsUI.propTypes={jobId:_propTypes.default.string.isRequired,job:_propTypes.default.object,addYourself:_propTypes.default.func.isRequired,removeYourself:_propTypes.default.func.isRequired};var JobDetails=(0,_react2.injectI18n)(JobDetailsUI);exports.JobDetails=JobDetails},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.extractJobDetails=extractJobDetails;var _string_utils=__webpack_require__(67);var _format_values=__webpack_require__(2786);var _i18n=__webpack_require__(4);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function extractJobDetails(job){if(Object.keys(job).length===0){return{}}var general={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.generalTitle",{defaultMessage:"General"}),position:"left",items:(0,_format_values.filterObjects)(job,true).map(_format_values.formatValues)};var customUrl={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.customUrlsTitle",{defaultMessage:"Custom URLs"}),position:"right",items:[]};if(job.custom_settings&&job.custom_settings.custom_urls){var _customUrl$items;(_customUrl$items=customUrl.items).push.apply(_customUrl$items,_toConsumableArray(job.custom_settings.custom_urls.map(function(cu){return[cu.url_name,cu.url_value,cu.time_range]})))}var node={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.nodeTitle",{defaultMessage:"Node"}),position:"right",items:[]};if(job.node){node.items.push(["name",job.node.name])}var calendars={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.calendarsTitle",{defaultMessage:"Calendars"}),position:"right",items:[]};if(job.calendars){calendars.items=job.calendars.map(function(c){return["",c]});var i=general.items.findIndex(function(item){return item[0]==="calendars"});if(i>=0){general.items.splice(i,1)}}var detectors={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.detectorsTitle",{defaultMessage:"Detectors"}),position:"left",items:[]};if(job.analysis_config&&job.analysis_config.detectors){var _detectors$items;(_detectors$items=detectors.items).push.apply(_detectors$items,_toConsumableArray(job.analysis_config.detectors.map(function(d){var stringifiedDtr=(0,_string_utils.detectorToString)(d);return[stringifiedDtr,stringifiedDtr!==d.detector_description?d.detector_description:""]})))}var influencers={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.influencersTitle",{defaultMessage:"Influencers"}),position:"left",items:job.analysis_config.influencers.map(function(i){return["",i]})};var analysisConfig={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.analysisConfigTitle",{defaultMessage:"Analysis config"}),position:"left",items:(0,_format_values.filterObjects)(job.analysis_config)};var analysisLimits={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.analysisLimitsTitle",{defaultMessage:"Analysis limits"}),position:"left",items:(0,_format_values.filterObjects)(job.analysis_limits)};var dataDescription={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.dataDescriptionTitle",{defaultMessage:"Data description"}),position:"right",items:(0,_format_values.filterObjects)(job.data_description)};var datafeed={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTitle",{defaultMessage:"Datafeed"}),position:"left",items:(0,_format_values.filterObjects)(job.datafeed_config,true,true)};if(job.node){datafeed.items.push(["node",JSON.stringify(job.node)])}var counts={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.countsTitle",{defaultMessage:"Counts"}),position:"left",items:(0,_format_values.filterObjects)(job.data_counts).map(_format_values.formatValues)};var modelSizeStats={title:_i18n.i18n.translate("xpack.ml.jobsList.jobDetails.modelSizeStatsTitle",{defaultMessage:"Model size stats"}),position:"right",items:(0,_format_values.filterObjects)(job.model_size_stats).map(_format_values.formatValues)};return{general:general,customUrl:customUrl,node:node,calendars:calendars,detectors:detectors,influencers:influencers,analysisConfig:analysisConfig,analysisLimits:analysisLimits,dataDescription:dataDescription,datafeed:datafeed,counts:counts,modelSizeStats:modelSizeStats}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatValues=formatValues;exports.filterObjects=filterObjects;var _numeral=_interopRequireDefault(__webpack_require__(217));var _format=__webpack_require__(495);var _string_utils=__webpack_require__(67);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var DATA_FORMAT="0.0 b";function formatData(txt){return(0,_numeral.default)(txt).format(DATA_FORMAT)}function formatValues(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];switch(key){case"finished_time":case"create_time":case"log_time":case"timestamp":case"earliest_record_timestamp":case"latest_record_timestamp":case"last_data_time":case"latest_empty_bucket_timestamp":case"latest_sparse_bucket_timestamp":value=(0,_format.formatDate)(value,TIME_FORMAT);break;case"established_model_memory":case"input_bytes":case"model_bytes":value=formatData(value);break;case"processed_record_count":case"processed_field_count":case"input_field_count":case"invalid_date_count":case"missing_field_count":case"out_of_order_timestamp_count":case"empty_bucket_count":case"sparse_bucket_count":case"bucket_count":case"input_record_count":case"total_by_field_count":case"total_over_field_count":case"total_partition_field_count":case"bucket_allocation_failures_count":value=(0,_string_utils.toLocaleString)(value);break;default:break}return[key,value]}function filterObjects(obj,allowArrays,allowObjects){return Object.keys(obj).filter(function(k){return allowObjects||_typeof(obj[k])!=="object"||allowArrays&&Array.isArray(obj[k])}).map(function(k){var item=obj[k];if(Array.isArray(item)){item=item.join(", ")}else if(_typeof(obj[k])==="object"){item=JSON.stringify(item)}return[k,item]})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JsonPane=JsonPane;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _ml_job_editor=__webpack_require__(575);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function JsonPane(_ref){var job=_ref.job;var json=JSON.stringify(job,null,2);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_ml_job_editor.MLJobEditor,{value:json,readOnly:true}))}JsonPane.propTypes={job:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MLJobEditor=MLJobEditor;exports.EDITOR_MODE=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EDITOR_MODE={TEXT:"text",JSON:"json"};exports.EDITOR_MODE=EDITOR_MODE;function MLJobEditor(_ref){var value=_ref.value,_ref$height=_ref.height,height=_ref$height===void 0?"500px":_ref$height,_ref$width=_ref.width,width=_ref$width===void 0?"100%":_ref$width,_ref$mode=_ref.mode,mode=_ref$mode===void 0?EDITOR_MODE.JSON:_ref$mode,_ref$readOnly=_ref.readOnly,readOnly=_ref$readOnly===void 0?false:_ref$readOnly,_ref$syntaxChecking=_ref.syntaxChecking,syntaxChecking=_ref$syntaxChecking===void 0?true:_ref$syntaxChecking,_ref$onChange=_ref.onChange,onChange=_ref$onChange===void 0?function(){}:_ref$onChange;return _react.default.createElement(_eui.EuiCodeEditor,{value:value,width:width,height:height,mode:mode,readOnly:readOnly,wrapEnabled:true,showPrintMargin:false,editorProps:{$blockScrolling:true},setOptions:{useWorker:syntaxChecking},onChange:onChange})}MLJobEditor.propTypes={value:_propTypes.default.string.isRequired,height:_propTypes.default.string,width:_propTypes.default.string,mode:_propTypes.default.string,readOnly:_propTypes.default.bool,onChange:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatafeedPreviewPane=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _job_service=__webpack_require__(36);var _check_privilege=__webpack_require__(39);var _job_utils=__webpack_require__(58);var _ml_job_editor=__webpack_require__(575);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var DatafeedPreviewPane=function(_Component){_inherits(DatafeedPreviewPane,_Component);function DatafeedPreviewPane(props){var _this;_classCallCheck(this,DatafeedPreviewPane);_this=_possibleConstructorReturn(this,_getPrototypeOf(DatafeedPreviewPane).call(this,props));_this.state={previewJson:"",loading:true,canPreviewDatafeed:true};return _this}_createClass(DatafeedPreviewPane,[{key:"renderContent",value:function renderContent(){var _this$state=this.state,previewJson=_this$state.previewJson,loading=_this$state.loading,canPreviewDatafeed=_this$state.canPreviewDatafeed;if(canPreviewDatafeed===false){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.noPermissionToViewDatafeedPreviewTitle",defaultMessage:"You do not have permission to view the datafeed preview"}),color:"warning",iconType:"alert"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.pleaseContactYourAdministratorLabel",defaultMessage:"Please contact your administrator"})))}else if(loading===true){return _react.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"})}else{return _react.default.createElement(_ml_job_editor.MLJobEditor,{value:previewJson,readOnly:true})}}},{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var canPreviewDatafeed=(0,_check_privilege.checkPermission)("canPreviewDatafeed");this.setState({canPreviewDatafeed:canPreviewDatafeed});updateDatafeedPreview(this.props.job,canPreviewDatafeed).then(function(previewJson){_this2.setState({previewJson:previewJson,loading:false})}).catch(function(error){console.log("Datafeed preview could not be loaded",error);_this2.setState({loading:false})})}},{key:"render",value:function render(){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),this.renderContent())}}]);return DatafeedPreviewPane}(_react.Component);exports.DatafeedPreviewPane=DatafeedPreviewPane;DatafeedPreviewPane.propTypes={job:_propTypes.default.object.isRequired};function updateDatafeedPreview(job,canPreviewDatafeed){return new Promise(function(resolve,reject){if(canPreviewDatafeed){_job_service.mlJobService.getDatafeedPreview(job.job_id).then(function(resp){if(Array.isArray(resp)){resolve(JSON.stringify(resp.slice(0,_job_utils.ML_DATA_PREVIEW_COUNT),null,2))}else{resolve("");console.log("Datafeed preview could not be loaded",resp)}}).catch(function(error){reject(error)})}})}},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _annotations_table=__webpack_require__(1353);__webpack_require__(26);var _modules=__webpack_require__(8);var _chrome=_interopRequireDefault(__webpack_require__(9));var _i18n=__webpack_require__(15);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");var mlAnnotationsEnabled=_chrome.default.getInjected("mlAnnotationsEnabled",false);_module.directive("mlAnnotationTable",function(){function link(scope,element){function renderReactComponent(){if(typeof scope.jobs==="undefined"&&typeof scope.annotations==="undefined"){return}var props={annotations:scope.annotations,jobs:scope.jobs,isSingleMetricViewerLinkVisible:scope.drillDown,isNumberBadgeVisible:scope.numberBadge};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_annotations_table.AnnotationsTable,props)),element[0])}renderReactComponent();scope.$on("render",function(){renderReactComponent()});function renderFocusChart(){renderReactComponent()}if(mlAnnotationsEnabled){scope.$watchCollection("annotations",renderFocusChart)}element.on("$destroy",function(){_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}return{scope:{annotations:"=",drillDown:"=",jobs:"=",numberBadge:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);var react_2=__webpack_require__(5);var date_utils_1=__webpack_require__(279);exports.AnnotationDescriptionList=react_2.injectI18n(function(_ref){var annotation=_ref.annotation,intl=_ref.intl;var listItems=[{title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:annotation.job_id},{title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.startTitle",defaultMessage:"Start"}),description:date_utils_1.formatHumanReadableDateTimeSeconds(annotation.timestamp)}];if(annotation.end_timestamp!==undefined){listItems.push({title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.endTitle",defaultMessage:"End"}),description:date_utils_1.formatHumanReadableDateTimeSeconds(annotation.end_timestamp)})}if(annotation.create_time!==undefined&&annotation.modified_time!==undefined){listItems.push({title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdTitle",defaultMessage:"Created"}),description:date_utils_1.formatHumanReadableDateTimeSeconds(annotation.create_time)});listItems.push({title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdByTitle",defaultMessage:"Created by"}),description:annotation.create_username});listItems.push({title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.lastModifiedTitle",defaultMessage:"Last modified"}),description:date_utils_1.formatHumanReadableDateTimeSeconds(annotation.modified_time)});listItems.push({title:intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.annotationDescriptionList.modifiedByTitle",defaultMessage:"Modified by"}),description:annotation.modified_username})}return react_1.default.createElement(eui_1.EuiDescriptionList,{className:"ml-annotation-description-list",type:"column",listItems:listItems})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var prop_types_1=tslib_1.__importDefault(__webpack_require__(6));var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var react_2=__webpack_require__(5);exports.DeleteAnnotationModal=function(_ref){var cancelAction=_ref.cancelAction,deleteAction=_ref.deleteAction,isVisible=_ref.isVisible;return react_1.default.createElement(react_1.Fragment,null,isVisible===true&&react_1.default.createElement(eui_1.EuiOverlayMask,null,react_1.default.createElement(eui_1.EuiConfirmModal,{title:react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteAnnotationTitle",defaultMessage:"Delete this annotation?"}),onCancel:cancelAction,onConfirm:deleteAction,cancelButtonText:react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:eui_1.EUI_MODAL_CONFIRM_BUTTON,className:"eui-textBreakWord"})))};exports.DeleteAnnotationModal.propTypes={cancelAction:prop_types_1.default.func.isRequired,deleteAction:prop_types_1.default.func.isRequired,isVisible:prop_types_1.default.bool.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ForecastsTable",{enumerable:true,get:function get(){return _forecasts_table.ForecastsTable}});var _forecasts_table=__webpack_require__(2794)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastsTable=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _risonNode=_interopRequireDefault(__webpack_require__(239));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _format=__webpack_require__(495);var _chrome=_interopRequireDefault(__webpack_require__(9));var _states=__webpack_require__(573);var _recently_accessed=__webpack_require__(677);var _forecast_service=__webpack_require__(884);var _react2=__webpack_require__(5);var _job_utils=__webpack_require__(58);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var MAX_FORECASTS=500;var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var ForecastsTableUI=function(_Component){_inherits(ForecastsTableUI,_Component);function ForecastsTableUI(props){var _this;_classCallCheck(this,ForecastsTableUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(ForecastsTableUI).call(this,props));_this.state={isLoading:props.job.data_counts.processed_record_count!==0,forecasts:[]};return _this}_createClass(ForecastsTableUI,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var dataCounts=this.props.job.data_counts;if(dataCounts.processed_record_count>0){_forecast_service.mlForecastService.getForecastsSummary(this.props.job,null,dataCounts.earliest_record_timestamp,MAX_FORECASTS).then(function(resp){_this2.setState({isLoading:false,forecasts:resp.forecasts})}).catch(function(resp){console.log("Error loading list of forecasts for jobs list:",resp);_this2.setState({isLoading:false,errorMessage:_this2.props.intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.loadingErrorMessage",defaultMessage:"Error loading the list of forecasts run on this job"}),forecasts:[]})})}}},{key:"openSingleMetricView",value:function openSingleMetricView(forecast){var dataCounts=this.props.job.data_counts;var jobEarliest=dataCounts.earliest_record_timestamp;var from=new Date(dataCounts.earliest_record_timestamp).toISOString();var to=forecast!==undefined?new Date(forecast.forecast_end_timestamp).toISOString():new Date(dataCounts.latest_record_timestamp).toISOString();var _g=_risonNode.default.encode({ml:{jobIds:[this.props.job.job_id]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var appState={query:{query_string:{analyze_wildcard:true,query:"*"}}};if(forecast!==undefined){var forecastDurationMs=forecast.forecast_end_timestamp-forecast.forecast_start_timestamp;var zoomFrom=Math.max(forecast.forecast_start_timestamp-forecastDurationMs,jobEarliest);appState.mlTimeSeriesExplorer={forecastId:forecast.forecast_id,zoom:{from:new Date(zoomFrom).toISOString(),to:new Date(forecast.forecast_end_timestamp).toISOString()}}}var _a=_risonNode.default.encode(appState);var url="?_g=".concat(_g,"&_a=").concat(_a);(0,_recently_accessed.addItemToRecentlyAccessed)("timeseriesexplorer",this.props.job.job_id,url);window.open("".concat(_chrome.default.getBasePath(),"/app/ml#/timeseriesexplorer").concat(url),"_self")}},{key:"render",value:function render(){var _this3=this;if(this.state.isLoading===true){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"})))}if(this.state.errorMessage!==undefined){return _react.default.createElement(_eui.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"})}var forecasts=this.state.forecasts;if(forecasts.length===0){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsTitle",defaultMessage:"No forecasts have been run for this job"}),iconType:"iInCircle",role:"alert"},(0,_job_utils.isTimeSeriesViewJob)(this.props.job)&&_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription",defaultMessage:"To run a forecast, open the {singleMetricViewerLink}",values:{singleMetricViewerLink:_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this3.openSingleMetricView()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription.linkText",defaultMessage:"Single Metric Viewer"}))}})))}var intl=this.props.intl;var columns=[{field:"forecast_create_timestamp",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.createdLabel",defaultMessage:"Created"}),dataType:"date",render:function render(date){return(0,_format.formatDate)(date,TIME_FORMAT)},textOnly:true,sortable:true},{field:"forecast_start_timestamp",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.fromLabel",defaultMessage:"From"}),dataType:"date",render:function render(date){return(0,_format.formatDate)(date,TIME_FORMAT)},textOnly:true,sortable:true},{field:"forecast_end_timestamp",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.toLabel",defaultMessage:"To"}),dataType:"date",render:function render(date){return(0,_format.formatDate)(date,TIME_FORMAT)},textOnly:true,sortable:true},{field:"forecast_status",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.statusLabel",defaultMessage:"Status"}),sortable:true},{field:"forecast_memory_bytes",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.memorySizeLabel",defaultMessage:"Memory size"}),render:function render(bytes){return(0,_format.formatNumber)(bytes,"0b")},sortable:true},{field:"processing_time_ms",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.processingTimeLabel",defaultMessage:"Processing time"}),render:function render(ms){return intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.msTimeUnitLabel",defaultMessage:"{ms} ms"},{ms:ms})},sortable:true},{field:"forecast_expiry_timestamp",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.expiresLabel",defaultMessage:"Expires"}),render:function render(date){return(0,_format.formatDate)(date,TIME_FORMAT)},textOnly:true,sortable:true},{field:"forecast_messages",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.messagesLabel",defaultMessage:"Messages"}),sortable:false,render:function render(messages){return _react.default.createElement("div",null,messages.map(function(message,index){return _react.default.createElement("p",{key:index},message)}))},textOnly:true},{name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.viewLabel",defaultMessage:"View"}),width:"60px",render:function render(forecast){var viewForecastAriaLabel=intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.forecastsTable.viewAriaLabel",defaultMessage:"View forecast created at {createdDate}"},{createdDate:(0,_format.formatDate)(forecast.forecast_create_timestamp,TIME_FORMAT)});return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return _this3.openSingleMetricView(forecast)},isDisabled:forecast.forecast_status!==_states.FORECAST_REQUEST_STATE.FINISHED,iconType:"stats","aria-label":viewForecastAriaLabel})}}];return _react.default.createElement(_eui.EuiInMemoryTable,{compressed:true,items:forecasts,columns:columns,pagination:{pageSizeOptions:[5,10,25]},sorting:true})}}]);return ForecastsTableUI}(_react.Component);ForecastsTableUI.propTypes={job:_propTypes.default.object.isRequired};var ForecastsTable=(0,_react2.injectI18n)(ForecastsTableUI);exports.ForecastsTable=ForecastsTable},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDetailsPane=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function SectionItem(_ref){var item=_ref.item;return _react.default.createElement(_eui.EuiTableRow,null,item[0]!==""&&_react.default.createElement(_eui.EuiTableRowCell,null,_react.default.createElement("span",{className:"job-item header"},item[0])),_react.default.createElement(_eui.EuiTableRowCell,null,_react.default.createElement("span",{className:"job-item"},item[1])))}SectionItem.propTypes={item:_propTypes.default.array.isRequired};function Section(_ref2){var section=_ref2.section;if(section.items.length===0){return _react.default.createElement("div",null)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("h4",null,section.title)),_react.default.createElement("div",{className:"job-section"},_react.default.createElement(_eui.EuiTable,{compressed:true},_react.default.createElement(_eui.EuiTableBody,null,section.items.map(function(item,i){return _react.default.createElement(SectionItem,{item:item,key:i})})))))}Section.propTypes={section:_propTypes.default.object.isRequired};var JobDetailsPane=function(_Component){_inherits(JobDetailsPane,_Component);function JobDetailsPane(props){var _this;_classCallCheck(this,JobDetailsPane);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobDetailsPane).call(this,props));_this.state={};return _this}_createClass(JobDetailsPane,[{key:"render",value:function render(){var _this$state=this.state,sections=_this$state.sections,time=_this$state.time;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"row",time:time},_react.default.createElement("div",{className:"col-md-6"},sections.filter(function(s){return s.position==="left"}).map(function(s,i){return _react.default.createElement(Section,{section:s,key:i})})),_react.default.createElement("div",{className:"col-md-6"},sections.filter(function(s){return s.position==="right"}).map(function(s,i){return _react.default.createElement(Section,{section:s,key:i})}))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){var sections=props.sections,time=props.time;return{sections:sections,time:time}}}]);return JobDetailsPane}(_react.Component);exports.JobDetailsPane=JobDetailsPane;JobDetailsPane.propTypes={sections:_propTypes.default.array.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobMessagesPane=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _format=__webpack_require__(495);var _ml_api_service=__webpack_require__(24);var _job_message_icon=__webpack_require__(1352);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var JobMessagesPaneUI=function(_Component){_inherits(JobMessagesPaneUI,_Component);function JobMessagesPaneUI(props){var _this;_classCallCheck(this,JobMessagesPaneUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobMessagesPaneUI).call(this,props));_this.state={messages:[]};_this.jobId=props.job.job_id;return _this}_createClass(JobMessagesPaneUI,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;_ml_api_service.ml.jobs.jobAuditMessages(this.jobId).then(function(messages){_this2.setState({messages:messages})}).catch(function(error){console.log("Job messages could not be loaded",error)})}},{key:"render",value:function render(){var messages=this.state.messages;var intl=this.props.intl;var columns=[{name:"",render:function render(item){return _react.default.createElement(_job_message_icon.JobIcon,{message:item})}},{name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.messagesPane.timeLabel",defaultMessage:"Time"}),render:function render(item){return(0,_format.formatDate)(item.timestamp,TIME_FORMAT)}},{field:"node_name",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.messagesPane.nodeLabel",defaultMessage:"Node"})},{field:"message",name:intl.formatMessage({id:"xpack.ml.jobsList.jobDetails.messagesPane.messageLabel",defaultMessage:"Message"})}];return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"job-messages-table"},_react.default.createElement(_eui.EuiBasicTable,{items:messages,columns:columns})))}}]);return JobMessagesPaneUI}(_react.Component);JobMessagesPaneUI.propTypes={job:_propTypes.default.object.isRequired};var JobMessagesPane=(0,_react2.injectI18n)(JobMessagesPaneUI);exports.JobMessagesPane=JobMessagesPane},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobFilterBar",{enumerable:true,get:function get(){return _job_filter_bar.JobFilterBar}});var _job_filter_bar=__webpack_require__(2798)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFilterBar=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _ml_api_service=__webpack_require__(24);var _job_group=__webpack_require__(880);var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _i18n=__webpack_require__(4);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function loadGroups(){return _ml_api_service.ml.jobs.groups().then(function(groups){return groups.map(function(g){return{value:g.id,view:_react.default.createElement("div",{className:"group-item"},_react.default.createElement(_job_group.JobGroup,{name:g.id})," ",_react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.jobFilterBar.jobGroupTitle",defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:g.jobIds.length}})))}})}).catch(function(error){console.log(error);return[]})}var JobFilterBarUI=function(_Component){_inherits(JobFilterBarUI,_Component);function JobFilterBarUI(props){var _this;_classCallCheck(this,JobFilterBarUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobFilterBarUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"onChange",function(_ref){var query=_ref.query,error=_ref.error;if(error){_this.setState({error:error})}else{var clauses=[];if(query&&query.ast!==undefined&&query.ast.clauses!==undefined){clauses=query.ast.clauses}_this.setFilters(clauses);_this.setState({error:null})}});_this.state={error:null};_this.setFilters=props.setFilters;return _this}_createClass(JobFilterBarUI,[{key:"render",value:function render(){var intl=this.props.intl;var error=this.state.error;var filters=[{type:"field_value_toggle_group",field:"job_state",items:[{value:"opened",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.openedLabel",defaultMessage:"Opened"})},{value:"closed",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.closedLabel",defaultMessage:"Closed"})},{value:"failed",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.failedLabel",defaultMessage:"Failed"})}]},{type:"field_value_toggle_group",field:"datafeed_state",items:[{value:"started",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.startedLabel",defaultMessage:"Started"})},{value:"stopped",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.stoppedLabel",defaultMessage:"Stopped"})}]},{type:"field_value_selection",field:"groups",name:intl.formatMessage({id:"xpack.ml.jobsList.jobFilterBar.groupLabel",defaultMessage:"Group"}),multiSelect:"or",cache:1e4,options:function options(){return loadGroups()}}];return _react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlJobListSearchBar",grow:false},_react.default.createElement(_eui.EuiSearchBar,{box:{incremental:true},filters:filters,onChange:this.onChange,className:"mlJobFilterBar"}),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,isInvalid:error!==null,error:getError(error),style:{maxHeight:"0px"}},_react.default.createElement(_react.Fragment,null))))}}]);return JobFilterBarUI}(_react.Component);JobFilterBarUI.propTypes={setFilters:_propTypes.default.func.isRequired};function getError(error){if(error){return _i18n.i18n.translate("xpack.ml.jobsList.jobFilterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:error.message}})}return""}var JobFilterBar=(0,_react2.injectI18n)(JobFilterBarUI);exports.JobFilterBar=JobFilterBar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditJobFlyout",{enumerable:true,get:function get(){return _edit_job_flyout.EditJobFlyout}});var _edit_job_flyout=__webpack_require__(2800)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditJobFlyout=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _tabs=__webpack_require__(2801);var _edit_utils=__webpack_require__(1355);var _utils=__webpack_require__(433);var _validate_job=__webpack_require__(1356);var _messagebar_service=__webpack_require__(268);var _notify=__webpack_require__(14);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditJobFlyoutUI=function(_Component){_inherits(EditJobFlyoutUI,_Component);function EditJobFlyoutUI(props){var _this;_classCallCheck(this,EditJobFlyoutUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditJobFlyoutUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeFlyout",function(){_this.setState({isFlyoutVisible:false})});_defineProperty(_assertThisInitialized(_this),"showFlyout",function(jobLite){var hasDatafeed=jobLite.hasDatafeed;(0,_utils.loadFullJob)(jobLite.id).then(function(job){_this.extractJob(job,hasDatafeed);_this.setState({job:job,isFlyoutVisible:true})}).catch(function(error){console.error(error)})});_defineProperty(_assertThisInitialized(_this),"setJobDetails",function(jobDetails){var _this$state=_this.state,jobModelMemoryLimitValidationError=_this$state.jobModelMemoryLimitValidationError,jobGroupsValidationError=_this$state.jobGroupsValidationError;if(jobDetails.jobModelMemoryLimit!==undefined){jobModelMemoryLimitValidationError=(0,_validate_job.validateModelMemoryLimit)(jobDetails.jobModelMemoryLimit).message}if(jobDetails.jobGroups!==undefined){if(jobDetails.jobGroups.some(function(j){return _this.props.allJobIds.includes(j)})){jobGroupsValidationError=_this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.groupsAndJobsHasSameIdErrorMessage",defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."})}else{jobGroupsValidationError=(0,_validate_job.validateGroupNames)(jobDetails.jobGroups).message}}var isValidJobDetails=jobModelMemoryLimitValidationError===""&&jobGroupsValidationError==="";_this.setState(_objectSpread({},jobDetails,{jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError,jobGroupsValidationError:jobGroupsValidationError,isValidJobDetails:isValidJobDetails}))});_defineProperty(_assertThisInitialized(_this),"setDetectorDescriptions",function(jobDetectorDescriptions){_this.setState(_objectSpread({},jobDetectorDescriptions))});_defineProperty(_assertThisInitialized(_this),"setDatafeed",function(datafeed){_this.setState(_objectSpread({},datafeed))});_defineProperty(_assertThisInitialized(_this),"setCustomUrls",function(jobCustomUrls){var isValidJobCustomUrls=(0,_validate_job.isValidCustomUrls)(jobCustomUrls);_this.setState({jobCustomUrls:jobCustomUrls,isValidJobCustomUrls:isValidJobCustomUrls})});_defineProperty(_assertThisInitialized(_this),"save",function(){var newJobData={description:_this.state.jobDescription,groups:_this.state.jobGroups,mml:_this.state.jobModelMemoryLimit,detectorDescriptions:_this.state.jobDetectorDescriptions,datafeedQuery:_this.state.datafeedQuery,datafeedQueryDelay:_this.state.datafeedQueryDelay,datafeedFrequency:_this.state.datafeedFrequency,datafeedScrollSize:_this.state.datafeedScrollSize,customUrls:_this.state.jobCustomUrls};(0,_edit_utils.saveJob)(_this.state.job,newJobData).then(function(){_notify.toastNotifications.addSuccess(_this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.changesSavedNotificationMessage",defaultMessage:"Changes to {jobId} saved"},{jobId:_this.state.job.job_id}));_this.refreshJobs();_this.closeFlyout()}).catch(function(error){console.error(error);_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.changesNotSavedNotificationMessage",defaultMessage:"Could not save changes to {jobId}"},{jobId:_this.state.job.job_id}));_messagebar_service.mlMessageBarService.notify.error(error)})});_this.state={job:{},hasDatafeed:false,isFlyoutVisible:false,jobDescription:"",jobGroups:[],jobModelMemoryLimit:"",jobDetectors:[],jobDetectorDescriptions:[],jobCustomUrls:[],datafeedQuery:"",datafeedQueryDelay:"",datafeedFrequency:"",datafeedScrollSize:"",jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",isValidJobDetails:true,isValidJobCustomUrls:true};_this.refreshJobs=_this.props.refreshJobs;return _this}_createClass(EditJobFlyoutUI,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showFlyout)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"extractJob",value:function extractJob(job,hasDatafeed){var mml=job.analysis_limits&&job.analysis_limits.model_memory_limit?job.analysis_limits.model_memory_limit:"";var detectors=job.analysis_config&&job.analysis_config.detectors?job.analysis_config.detectors:"";var bucketSpan=job.analysis_config?job.analysis_config.bucket_span:"";var datafeedConfig=job.datafeed_config;var frequency=datafeedConfig.frequency!==undefined?datafeedConfig.frequency:"";var customUrls=job.custom_settings&&job.custom_settings.custom_urls?job.custom_settings.custom_urls:[];this.setState({job:job,hasDatafeed:hasDatafeed,jobDescription:job.description,jobGroups:job.groups!==undefined?job.groups:[],jobModelMemoryLimit:mml,jobDetectors:detectors,jobDetectorDescriptions:detectors.map(function(d){return d.detector_description}),jobBucketSpan:bucketSpan,jobCustomUrls:customUrls,datafeedQuery:hasDatafeed?JSON.stringify(datafeedConfig.query,null,2):"",datafeedQueryDelay:hasDatafeed?datafeedConfig.query_delay:"",datafeedFrequency:hasDatafeed?frequency:"",datafeedScrollSize:hasDatafeed?+datafeedConfig.scroll_size:"",jobModelMemoryLimitValidationError:"",jobGroupsValidationError:""})}},{key:"render",value:function render(){var flyout;if(this.state.isFlyoutVisible){var _this$state2=this.state,job=_this$state2.job,jobDescription=_this$state2.jobDescription,jobGroups=_this$state2.jobGroups,jobModelMemoryLimit=_this$state2.jobModelMemoryLimit,jobDetectors=_this$state2.jobDetectors,jobDetectorDescriptions=_this$state2.jobDetectorDescriptions,jobBucketSpan=_this$state2.jobBucketSpan,jobCustomUrls=_this$state2.jobCustomUrls,datafeedQuery=_this$state2.datafeedQuery,datafeedQueryDelay=_this$state2.datafeedQueryDelay,datafeedFrequency=_this$state2.datafeedFrequency,datafeedScrollSize=_this$state2.datafeedScrollSize,jobGroupsValidationError=_this$state2.jobGroupsValidationError,jobModelMemoryLimitValidationError=_this$state2.jobModelMemoryLimitValidationError,isValidJobDetails=_this$state2.isValidJobDetails,isValidJobCustomUrls=_this$state2.isValidJobCustomUrls;var intl=this.props.intl;var tabs=[{id:"job-details",name:intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.jobDetailsTitle",defaultMessage:"Job details"}),content:_react.default.createElement(_tabs.JobDetails,{jobDescription:jobDescription,jobGroups:jobGroups,jobModelMemoryLimit:jobModelMemoryLimit,setJobDetails:this.setJobDetails,jobGroupsValidationError:jobGroupsValidationError,jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError})},{id:"detectors",name:intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.detectorsTitle",defaultMessage:"Detectors"}),content:_react.default.createElement(_tabs.Detectors,{jobDetectors:jobDetectors,jobDetectorDescriptions:jobDetectorDescriptions,setDetectorDescriptions:this.setDetectorDescriptions})},{id:"datafeed",name:intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.datafeedTitle",defaultMessage:"Datafeed"}),content:_react.default.createElement(_tabs.Datafeed,{datafeedQuery:datafeedQuery,datafeedQueryDelay:datafeedQueryDelay,datafeedFrequency:datafeedFrequency,datafeedScrollSize:datafeedScrollSize,jobBucketSpan:jobBucketSpan,setDatafeed:this.setDatafeed})},{id:"custom-urls",name:intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrlsTitle",defaultMessage:"Custom URLs"}),content:_react.default.createElement(_tabs.CustomUrls,{job:job,jobCustomUrls:jobCustomUrls,setCustomUrls:this.setCustomUrls})}];flyout=_react.default.createElement(_eui.EuiFlyout,{onClose:this.closeFlyout,size:"m"},_react.default.createElement(_eui.EuiFlyoutHeader,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.pageTitle",defaultMessage:"Edit {jobId}",values:{jobId:job.id}})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.closeButtonLabel",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.save,fill:true,isDisabled:isValidJobDetails===false||isValidJobCustomUrls===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return _react.default.createElement("div",null,flyout)}}]);return EditJobFlyoutUI}(_react.Component);EditJobFlyoutUI.propTypes={setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired,allJobIds:_propTypes.default.array.isRequired};var EditJobFlyout=(0,_react2.injectI18n)(EditJobFlyoutUI);exports.EditJobFlyout=EditJobFlyout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobDetails",{enumerable:true,get:function get(){return _job_details.JobDetails}});Object.defineProperty(exports,"Detectors",{enumerable:true,get:function get(){return _detectors.Detectors}});Object.defineProperty(exports,"Datafeed",{enumerable:true,get:function get(){return _datafeed.Datafeed}});Object.defineProperty(exports,"CustomUrls",{enumerable:true,get:function get(){return _custom_urls.CustomUrls}});var _job_details=__webpack_require__(2802);var _detectors=__webpack_require__(2803);var _datafeed=__webpack_require__(2804);var _custom_urls=__webpack_require__(2805)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDetails=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _ml_api_service=__webpack_require__(24);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var JobDetailsUI=function(_Component){_inherits(JobDetailsUI,_Component);function JobDetailsUI(props){var _this;_classCallCheck(this,JobDetailsUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(JobDetailsUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",function(e){_this.setJobDetails({jobDescription:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onMmlChange",function(e){_this.setJobDetails({jobModelMemoryLimit:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onGroupsChange",function(selectedGroups){_this.setJobDetails({jobGroups:selectedGroups.map(function(g){return g.label})})});_defineProperty(_assertThisInitialized(_this),"onCreateGroup",function(input,flattenedOptions){var normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue){return}var newGroup={label:input};var groups=_this.state.groups;if(flattenedOptions.findIndex(function(option){return option.label.trim().toLowerCase()===normalizedSearchValue})===-1){groups.push(newGroup)}var selectedGroups=_this.state.selectedGroups.concat(newGroup);_this.setState({groups:groups},function(){return _this.onGroupsChange(selectedGroups)})});_this.state={description:"",groups:[],selectedGroups:[],mml:"",mmlValidationError:"",groupsValidationError:""};_this.setJobDetails=props.setJobDetails;return _this}_createClass(JobDetailsUI,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;_ml_api_service.ml.jobs.groups().then(function(resp){var groups=resp.map(function(g){return{label:g.id}});_this2.setState({groups:groups})}).catch(function(error){console.error("Could not load groups",error)})}},{key:"render",value:function render(){var _this$state=this.state,description=_this$state.description,selectedGroups=_this$state.selectedGroups,mml=_this$state.mml,groups=_this$state.groups,mmlValidationError=_this$state.mmlValidationError,groupsValidationError=_this$state.groupsValidationError;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobDescriptionLabel",defaultMessage:"Job description"})},_react.default.createElement(_eui.EuiFieldText,{value:description,onChange:this.onDescriptionChange})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsLabel",defaultMessage:"Job groups"}),isInvalid:groupsValidationError!=="",error:groupsValidationError},_react.default.createElement(_eui.EuiComboBox,{placeholder:this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsPlaceholder",defaultMessage:"Select or create groups"}),options:groups,selectedOptions:selectedGroups,onChange:this.onGroupsChange,onCreateOption:this.onCreateGroup,isClearable:true,isInvalid:groupsValidationError!=="",error:groupsValidationError})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabel",defaultMessage:"Model memory limit"}),isInvalid:mmlValidationError!=="",error:mmlValidationError},_react.default.createElement(_eui.EuiFieldText,{value:mml,onChange:this.onMmlChange,isInvalid:mmlValidationError!=="",error:mmlValidationError}))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){var selectedGroups=props.jobGroups!==undefined?props.jobGroups.map(function(g){return{label:g}}):[];return{description:props.jobDescription,selectedGroups:selectedGroups,mml:props.jobModelMemoryLimit,mmlValidationError:props.jobModelMemoryLimitValidationError,groupsValidationError:props.jobGroupsValidationError}}}]);return JobDetailsUI}(_react.Component);JobDetailsUI.propTypes={jobDescription:_propTypes.default.string.isRequired,jobGroups:_propTypes.default.array.isRequired,jobModelMemoryLimit:_propTypes.default.string.isRequired,setJobDetails:_propTypes.default.func.isRequired};var JobDetails=(0,_react2.injectI18n)(JobDetailsUI);exports.JobDetails=JobDetails},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Detectors=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _job_service=__webpack_require__(36);var _string_utils=__webpack_require__(67);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var Detectors=function(_Component){_inherits(Detectors,_Component);function Detectors(props){var _this;_classCallCheck(this,Detectors);_this=_possibleConstructorReturn(this,_getPrototypeOf(Detectors).call(this,props));_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",function(e,i){var jobDetectorDescriptions=_this.state.detectorDescriptions;jobDetectorDescriptions[i]=e.target.value;_this.setDetectorDescriptions({jobDetectorDescriptions:jobDetectorDescriptions})});_this.detectors=_job_service.mlJobService.getJobGroups().map(function(g){return{label:g.id}});_this.state={detectors:[],detectorDescriptions:[]};_this.setDetectorDescriptions=props.setDetectorDescriptions;return _this}_createClass(Detectors,[{key:"render",value:function render(){var _this2=this;var _this$state=this.state,detectors=_this$state.detectors,detectorDescriptions=_this$state.detectorDescriptions;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiForm,null,detectorDescriptions.map(function(d,i){return _react.default.createElement(_eui.EuiFormRow,{label:(0,_string_utils.detectorToString)(detectors[i]),key:i},_react.default.createElement(_eui.EuiFieldText,{value:d,onChange:function onChange(e){return _this2.onDescriptionChange(e,i)}}))})))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){return{detectors:props.jobDetectors,detectorDescriptions:props.jobDetectorDescriptions}}}]);return Detectors}(_react.Component);exports.Detectors=Detectors;Detectors.propTypes={jobDetectors:_propTypes.default.array.isRequired,jobDetectorDescriptions:_propTypes.default.array.isRequired,setDetectorDescriptions:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Datafeed=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _job_utils=__webpack_require__(58);var _new_job_defaults=__webpack_require__(337);var _parse_interval=__webpack_require__(313);var _ml_job_editor=__webpack_require__(575);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getDefaults(bucketSpan,jobDefaults){var bucketSpanSeconds=bucketSpan!==undefined?(0,_parse_interval.parseInterval)(bucketSpan).asSeconds():"";return{queryDelay:"60s",frequency:(0,_job_utils.calculateDatafeedFrequencyDefaultSeconds)(bucketSpanSeconds)+"s",scrollSize:jobDefaults.datafeeds.scroll_size}}var Datafeed=function(_Component){_inherits(Datafeed,_Component);function Datafeed(props){var _this;_classCallCheck(this,Datafeed);_this=_possibleConstructorReturn(this,_getPrototypeOf(Datafeed).call(this,props));_defineProperty(_assertThisInitialized(_this),"onQueryChange",function(query){_this.setDatafeed({datafeedQuery:query})});_defineProperty(_assertThisInitialized(_this),"onQueryDelayChange",function(e){_this.setDatafeed({datafeedQueryDelay:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onFrequencyChange",function(e){_this.setDatafeed({datafeedFrequency:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onScrollSizeChange",function(e){_this.setDatafeed({datafeedScrollSize:+e.target.value})});_this.state={query:"",queryDelay:"",frequency:"",scrollSize:"",defaults:{queryDelay:"",frequency:"",scrollSize:0},jobDefaults:(0,_new_job_defaults.newJobDefaults)()};_this.setDatafeed=props.setDatafeed;return _this}_createClass(Datafeed,[{key:"render",value:function render(){var _this$state=this.state,query=_this$state.query,queryDelay=_this$state.queryDelay,frequency=_this$state.frequency,scrollSize=_this$state.scrollSize,defaults=_this$state.defaults;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryLabel",defaultMessage:"Query"}),style:{maxWidth:"inherit"}},_react.default.createElement(_ml_job_editor.MLJobEditor,{value:query,onChange:this.onQueryChange,height:"200px"})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryDelayLabel",defaultMessage:"Query delay"})},_react.default.createElement(_eui.EuiFieldText,{value:queryDelay,placeholder:defaults.queryDelay,onChange:this.onQueryDelayChange})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.frequencyLabel",defaultMessage:"Frequency"})},_react.default.createElement(_eui.EuiFieldText,{value:frequency,placeholder:defaults.frequency,onChange:this.onFrequencyChange})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.scrollSizeLabel",defaultMessage:"Scroll size"})},_react.default.createElement(_eui.EuiFieldNumber,{value:scrollSize,placeholder:defaults.scrollSize,onChange:this.onScrollSizeChange}))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){return{query:props.datafeedQuery,queryDelay:props.datafeedQueryDelay,frequency:props.datafeedFrequency,scrollSize:props.datafeedScrollSize,defaults:getDefaults(props.jobBucketSpan,state.jobDefaults)}}}]);return Datafeed}(_react.Component);exports.Datafeed=Datafeed;Datafeed.propTypes={datafeedQuery:_propTypes.default.string.isRequired,datafeedQueryDelay:_propTypes.default.string.isRequired,datafeedFrequency:_propTypes.default.string.isRequired,datafeedScrollSize:_propTypes.default.number.isRequired,jobBucketSpan:_propTypes.default.string.isRequired,setDatafeed:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomUrls=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _notify=__webpack_require__(14);var _custom_url_editor=__webpack_require__(2806);var _utils=__webpack_require__(885);var _edit_utils=__webpack_require__(1355);var _custom_url_utils=__webpack_require__(498);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MAX_NUMBER_DASHBOARDS=1e3;var MAX_NUMBER_INDEX_PATTERNS=1e3;var CustomUrlsUI=function(_Component){_inherits(CustomUrlsUI,_Component);function CustomUrlsUI(props){var _this;_classCallCheck(this,CustomUrlsUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(CustomUrlsUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"editNewCustomUrl",function(){_this.setState(function(prevState){var dashboards=prevState.dashboards,indexPatterns=prevState.indexPatterns;return{editorOpen:true,editorSettings:(0,_utils.getNewCustomUrlDefaults)(_this.props.job,dashboards,indexPatterns)}})});_defineProperty(_assertThisInitialized(_this),"setEditCustomUrl",function(customUrl){_this.setState({editorSettings:customUrl})});_defineProperty(_assertThisInitialized(_this),"addNewCustomUrl",function(){(0,_utils.buildCustomUrlFromSettings)(_this.state.editorSettings).then(function(customUrl){var customUrls=[].concat(_toConsumableArray(_this.state.customUrls),[customUrl]);_this.setCustomUrls(customUrls);_this.setState({editorOpen:false})}).catch(function(resp){console.log("Error building custom URL from settings:",resp);_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.addNewUrlErrorNotificationMessage",defaultMessage:"An error occurred building the new custom URL from the supplied settings"}))})});_defineProperty(_assertThisInitialized(_this),"onTestButtonClick",function(){var job=_this.props.job;var intl=_this.props.intl;(0,_utils.buildCustomUrlFromSettings)(_this.state.editorSettings).then(function(customUrl){(0,_utils.getTestUrl)(job,customUrl).then(function(testUrl){(0,_custom_url_utils.openCustomUrlWindow)(testUrl,customUrl)}).catch(function(resp){console.log("Error obtaining URL for test:",resp);_notify.toastNotifications.addWarning(intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.getTestUrlErrorNotificationMessage",defaultMessage:"An error occurred obtaining the URL to test the configuration"}))})}).catch(function(resp){console.log("Error building custom URL from settings:",resp);_notify.toastNotifications.addWarning(intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.buildUrlErrorNotificationMessage",defaultMessage:"An error occurred building the custom URL for testing from the supplied settings"}))})});_defineProperty(_assertThisInitialized(_this),"closeEditor",function(){_this.setState({editorOpen:false})});_this.state={customUrls:[],dashboards:[],indexPatterns:[],queryEntityFieldNames:[],editorOpen:false};_this.setCustomUrls=props.setCustomUrls;_this.angularApply=props.angularApply;return _this}_createClass(CustomUrlsUI,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var intl=this.props.intl;(0,_edit_utils.loadSavedDashboards)(MAX_NUMBER_DASHBOARDS).then(function(dashboards){_this2.setState({dashboards:dashboards})}).catch(function(resp){console.log("Error loading list of dashboards:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.loadSavedDashboardsErrorNotificationMessage",defaultMessage:"An error occurred loading the list of saved Kibana dashboards"}))});(0,_edit_utils.loadIndexPatterns)(MAX_NUMBER_INDEX_PATTERNS).then(function(indexPatterns){_this2.setState({indexPatterns:indexPatterns})}).catch(function(resp){console.log("Error loading list of dashboards:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.loadIndexPatternsErrorNotificationMessage",defaultMessage:"An error occurred loading the list of saved index patterns"}))})}},{key:"render",value:function render(){var _this3=this;var _this$state=this.state,customUrls=_this$state.customUrls,editorOpen=_this$state.editorOpen,editorSettings=_this$state.editorSettings,dashboards=_this$state.dashboards,indexPatterns=_this$state.indexPatterns,queryEntityFieldNames=_this$state.queryEntityFieldNames;var isValidEditorSettings=editorOpen===true?(0,_utils.isValidCustomUrlSettings)(editorSettings,customUrls):true;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),editorOpen===false?_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiButton,{size:"s",onClick:function onClick(){return _this3.editNewCustomUrl()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"}))):_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiPanel,{className:"edit-custom-url-panel"},_react.default.createElement(_eui.EuiButtonIcon,{color:"text",onClick:function onClick(){return _this3.closeEditor()},iconType:"cross","aria-label":this.props.intl.formatMessage({id:"xpack.ml.jobsList.editJobFlyout.customUrls.closeEditorAriaLabel",defaultMessage:"Close custom URL editor"}),className:"close-editor-button"}),_react.default.createElement(_custom_url_editor.CustomUrlEditor,{customUrl:editorSettings,setEditCustomUrl:this.setEditCustomUrl,savedCustomUrls:customUrls,dashboards:dashboards,indexPatterns:indexPatterns,queryEntityFieldNames:queryEntityFieldNames}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:function onClick(){return _this3.addNewCustomUrl()},isDisabled:!isValidEditorSettings},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addButtonLabel",defaultMessage:"Add"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"popout",iconSide:"right",onClick:function onClick(){return _this3.onTestButtonClick()},isDisabled:!isValidEditorSettings},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.testButtonLabel",defaultMessage:"Test"})))))),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_custom_url_editor.CustomUrlList,{job:this.props.job,customUrls:customUrls,setCustomUrls:this.setCustomUrls}))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props){return{job:props.job,customUrls:props.jobCustomUrls,queryEntityFieldNames:(0,_utils.getQueryEntityFieldNames)(props.job)}}}]);return CustomUrlsUI}(_react.Component);CustomUrlsUI.propTypes={job:_propTypes.default.object.isRequired,jobCustomUrls:_propTypes.default.array.isRequired,setCustomUrls:_propTypes.default.func.isRequired};var CustomUrls=(0,_react2.injectI18n)(CustomUrlsUI);exports.CustomUrls=CustomUrls},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CustomUrlList",{enumerable:true,get:function get(){return _list.CustomUrlList}});Object.defineProperty(exports,"CustomUrlEditor",{enumerable:true,get:function get(){return _editor.CustomUrlEditor}});var _list=__webpack_require__(2807);var _editor=__webpack_require__(2808)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomUrlList=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _notify=__webpack_require__(14);var _custom_url_utils=__webpack_require__(498);var _utils=__webpack_require__(885);var _parse_interval=__webpack_require__(313);var _constants=__webpack_require__(886);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function isValidTimeRange(timeRange){if(timeRange===undefined||timeRange.length===0||timeRange===_constants.TIME_RANGE_TYPE.AUTO){return true}var interval=(0,_parse_interval.parseInterval)(timeRange);return interval!==null}var CustomUrlList=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(CustomUrlList,_Component);function CustomUrlList(props){var _this;_classCallCheck(this,CustomUrlList);_this=_possibleConstructorReturn(this,_getPrototypeOf(CustomUrlList).call(this,props));_defineProperty(_assertThisInitialized(_this),"onLabelChange",function(e,index){var _this$props=_this.props,customUrls=_this$props.customUrls,setCustomUrls=_this$props.setCustomUrls;if(index<customUrls.length){customUrls[index]=_objectSpread({},customUrls[index],{url_name:e.target.value});setCustomUrls(customUrls)}});_defineProperty(_assertThisInitialized(_this),"onUrlValueChange",function(e,index){var _this$props2=_this.props,customUrls=_this$props2.customUrls,setCustomUrls=_this$props2.setCustomUrls;if(index<customUrls.length){customUrls[index]=_objectSpread({},customUrls[index],{url_value:e.target.value});setCustomUrls(customUrls)}});_defineProperty(_assertThisInitialized(_this),"onTimeRangeChange",function(e,index){var _this$props3=_this.props,customUrls=_this$props3.customUrls,setCustomUrls=_this$props3.setCustomUrls;if(index<customUrls.length){customUrls[index]=_objectSpread({},customUrls[index]);var timeRange=e.target.value;if(timeRange!==undefined&&timeRange.length>0){customUrls[index].time_range=timeRange}else{delete customUrls[index].time_range}setCustomUrls(customUrls)}});_defineProperty(_assertThisInitialized(_this),"onDeleteButtonClick",function(index){var _this$props4=_this.props,customUrls=_this$props4.customUrls,setCustomUrls=_this$props4.setCustomUrls;if(index<customUrls.length){customUrls.splice(index,1);setCustomUrls(customUrls)}});_defineProperty(_assertThisInitialized(_this),"onTestButtonClick",function(index){var _this$props5=_this.props,customUrls=_this$props5.customUrls,job=_this$props5.job;if(index<customUrls.length){(0,_utils.getTestUrl)(job,customUrls[index]).then(function(testUrl){(0,_custom_url_utils.openCustomUrlWindow)(testUrl,customUrls[index])}).catch(function(resp){console.log("Error obtaining URL for test:",resp);_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.customUrlEditorList.obtainingUrlToTestConfigurationErrorMessage",defaultMessage:"An error occurred obtaining the URL to test the configuration"}))})}});return _this}_createClass(CustomUrlList,[{key:"render",value:function render(){var _this2=this;var customUrls=this.props.customUrls;var intl=this.props.intl;var customUrlRows=customUrls.map(function(customUrl,index){var label=customUrl.url_name;var otherUrls=_toConsumableArray(customUrls);otherUrls.splice(index,1);var isInvalidLabel=!(0,_custom_url_utils.isValidLabel)(label,otherUrls);var invalidLabelError=isInvalidLabel===true?[intl.formatMessage({id:"xpack.ml.customUrlEditorList.labelIsNotUniqueErrorMessage",defaultMessage:"A unique label must be supplied"})]:[];var timeRange=customUrl.time_range;var isInvalidTimeRange=!isValidTimeRange(timeRange);var invalidIntervalError=isInvalidTimeRange===true?[intl.formatMessage({id:"xpack.ml.customUrlEditorList.invalidTimeRangeFormatErrorMessage",defaultMessage:"Invalid format"})]:[];return _react.default.createElement(_eui.EuiFlexGroup,{key:"url_".concat(index)},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlEditorList.labelLabel",defaultMessage:"Label"}),isInvalid:isInvalidLabel,error:invalidLabelError},_react.default.createElement(_eui.EuiFieldText,{value:label,isInvalid:isInvalidLabel,onChange:function onChange(e){return _this2.onLabelChange(e,index)}}))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlEditorList.urlLabel",defaultMessage:"URL"})},_react.default.createElement(_eui.EuiFieldText,{value:customUrl.url_value,onChange:function onChange(e){return _this2.onUrlValueChange(e,index)}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlEditorList.timeRangeLabel",defaultMessage:"Time range"}),error:invalidIntervalError,isInvalid:isInvalidTimeRange},_react.default.createElement(_eui.EuiFieldText,{value:customUrl.time_range||"",isInvalid:isInvalidTimeRange,placeholder:_constants.TIME_RANGE_TYPE.AUTO,onChange:function onChange(e){return _this2.onTimeRangeChange(e,index)}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true},_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlEditorList.testCustomUrlTooltip",defaultMessage:"Test custom URL"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"primary",onClick:function onClick(){return _this2.onTestButtonClick(index)},iconType:"popout","aria-label":intl.formatMessage({id:"xpack.ml.customUrlEditorList.testCustomUrlAriaLabel",defaultMessage:"Test custom URL"})})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true},_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlEditorList.deleteCustomUrlTooltip",defaultMessage:"Delete custom URL"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"danger",onClick:function onClick(){return _this2.onDeleteButtonClick(index)},iconType:"trash","aria-label":intl.formatMessage({id:"xpack.ml.customUrlEditorList.deleteCustomUrlAriaLabel",defaultMessage:"Delete custom URL"})})))))});return _react.default.createElement(_react.default.Fragment,null,customUrlRows)}}]);return CustomUrlList}(_react.Component),_defineProperty(_class,"propTypes",{job:_propTypes.default.object.isRequired,customUrls:_propTypes.default.array.isRequired,setCustomUrls:_propTypes.default.func.isRequired}),_temp));exports.CustomUrlList=CustomUrlList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomUrlEditor=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _utils=__webpack_require__(885);var _custom_url_utils=__webpack_require__(498);var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);var _constants=__webpack_require__(886);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getLinkToOptions(){return[{id:_constants.URL_TYPE.KIBANA_DASHBOARD,label:_i18n.i18n.translate("xpack.ml.customUrlEditor.kibanaDashboardLabel",{defaultMessage:"Kibana dashboard"})},{id:_constants.URL_TYPE.KIBANA_DISCOVER,label:_i18n.i18n.translate("xpack.ml.customUrlEditor.discoverLabel",{defaultMessage:"Discover"})},{id:_constants.URL_TYPE.OTHER,label:_i18n.i18n.translate("xpack.ml.customUrlEditor.otherLabel",{defaultMessage:"Other"})}]}var CustomUrlEditor=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(CustomUrlEditor,_Component);function CustomUrlEditor(props){var _this;_classCallCheck(this,CustomUrlEditor);_this=_possibleConstructorReturn(this,_getPrototypeOf(CustomUrlEditor).call(this,props));_defineProperty(_assertThisInitialized(_this),"onLabelChange",function(e){var _this$props=_this.props,customUrl=_this$props.customUrl,setEditCustomUrl=_this$props.setEditCustomUrl;setEditCustomUrl(_objectSpread({},customUrl,{label:e.target.value}))});_defineProperty(_assertThisInitialized(_this),"onTypeChange",function(linkType){var _this$props2=_this.props,customUrl=_this$props2.customUrl,setEditCustomUrl=_this$props2.setEditCustomUrl;setEditCustomUrl(_objectSpread({},customUrl,{type:linkType}))});_defineProperty(_assertThisInitialized(_this),"onDashboardChange",function(e){var _this$props3=_this.props,customUrl=_this$props3.customUrl,setEditCustomUrl=_this$props3.setEditCustomUrl;var kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl(_objectSpread({},customUrl,{kibanaSettings:_objectSpread({},kibanaSettings,{dashboardId:e.target.value})}))});_defineProperty(_assertThisInitialized(_this),"onDiscoverIndexPatternChange",function(e){var _this$props4=_this.props,customUrl=_this$props4.customUrl,setEditCustomUrl=_this$props4.setEditCustomUrl;var kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl(_objectSpread({},customUrl,{kibanaSettings:_objectSpread({},kibanaSettings,{discoverIndexPatternId:e.target.value})}))});_defineProperty(_assertThisInitialized(_this),"onQueryEntitiesChange",function(selectedOptions){var _this$props5=_this.props,customUrl=_this$props5.customUrl,setEditCustomUrl=_this$props5.setEditCustomUrl;var selectedFieldNames=selectedOptions.map(function(option){return option.label});var kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl(_objectSpread({},customUrl,{kibanaSettings:_objectSpread({},kibanaSettings,{queryFieldNames:selectedFieldNames})}))});_defineProperty(_assertThisInitialized(_this),"onOtherUrlValueChange",function(e){var _this$props6=_this.props,customUrl=_this$props6.customUrl,setEditCustomUrl=_this$props6.setEditCustomUrl;setEditCustomUrl(_objectSpread({},customUrl,{otherUrlSettings:{urlValue:e.target.value}}))});_defineProperty(_assertThisInitialized(_this),"onTimeRangeTypeChange",function(e){var _this$props7=_this.props,customUrl=_this$props7.customUrl,setEditCustomUrl=_this$props7.setEditCustomUrl;var timeRange=customUrl.timeRange;setEditCustomUrl(_objectSpread({},customUrl,{timeRange:_objectSpread({},timeRange,{type:e.target.value})}))});_defineProperty(_assertThisInitialized(_this),"onTimeRangeIntervalChange",function(e){var _this$props8=_this.props,customUrl=_this$props8.customUrl,setEditCustomUrl=_this$props8.setEditCustomUrl;var timeRange=customUrl.timeRange;setEditCustomUrl(_objectSpread({},customUrl,{timeRange:_objectSpread({},timeRange,{interval:e.target.value})}))});return _this}_createClass(CustomUrlEditor,[{key:"render",value:function render(){var _this$props9=this.props,customUrl=_this$props9.customUrl,savedCustomUrls=_this$props9.savedCustomUrls,dashboards=_this$props9.dashboards,indexPatterns=_this$props9.indexPatterns,queryEntityFieldNames=_this$props9.queryEntityFieldNames,intl=_this$props9.intl;if(customUrl===undefined){return}var label=customUrl.label,type=customUrl.type,timeRange=customUrl.timeRange,kibanaSettings=customUrl.kibanaSettings,otherUrlSettings=customUrl.otherUrlSettings;var dashboardOptions=dashboards.map(function(dashboard){return{value:dashboard.id,text:dashboard.title}});var indexPatternOptions=indexPatterns.map(function(indexPattern){return{value:indexPattern.id,text:indexPattern.title}});var entityOptions=queryEntityFieldNames.map(function(fieldName){return{label:fieldName}});var selectedEntityOptions=[];if(kibanaSettings!==undefined&&kibanaSettings.queryFieldNames!==undefined){var queryFieldNames=kibanaSettings.queryFieldNames;selectedEntityOptions=queryFieldNames.map(function(fieldName){return{label:fieldName}})}var timeRangeOptions=Object.keys(_constants.TIME_RANGE_TYPE).map(function(timeRangeType){return{value:_constants.TIME_RANGE_TYPE[timeRangeType],text:_constants.TIME_RANGE_TYPE[timeRangeType]}});var isInvalidLabel=!(0,_custom_url_utils.isValidLabel)(label,savedCustomUrls);var invalidLabelError=isInvalidLabel===true?[intl.formatMessage({id:"xpack.ml.customUrlsEditor.invalidLabelErrorMessage",defaultMessage:"A unique label must be supplied"})]:[];var isInvalidTimeRange=!(0,_utils.isValidCustomUrlSettingsTimeRange)(timeRange);var invalidIntervalError=isInvalidTimeRange===true?[intl.formatMessage({id:"xpack.ml.customUrlsList.invalidIntervalFormatErrorMessage",defaultMessage:"Invalid interval format"})]:[];return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.createNewCustomUrlTitle",defaultMessage:"Create new custom URL"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiForm,{className:"ml-edit-url-form"},_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.labelLabel",defaultMessage:"Label"}),className:"url-label",error:invalidLabelError,isInvalid:isInvalidLabel,compressed:true},_react.default.createElement(_eui.EuiFieldText,{value:label,onChange:this.onLabelChange,isInvalid:isInvalidLabel,compressed:true})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.linkToLabel",defaultMessage:"Link to"}),compressed:true},_react.default.createElement(_eui.EuiRadioGroup,{options:getLinkToOptions(),idSelected:type,onChange:this.onTypeChange,className:"url-link-to-radio"})),type===_constants.URL_TYPE.KIBANA_DASHBOARD&&_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.dashboardNameLabel",defaultMessage:"Dashboard name"}),compressed:true},_react.default.createElement(_eui.EuiSelect,{options:dashboardOptions,value:kibanaSettings.dashboardId,onChange:this.onDashboardChange,compressed:true})),type===_constants.URL_TYPE.KIBANA_DISCOVER&&_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.indexPatternLabel",defaultMessage:"Index pattern"}),compressed:true},_react.default.createElement(_eui.EuiSelect,{options:indexPatternOptions,value:kibanaSettings.discoverIndexPatternId,onChange:this.onDiscoverIndexPatternChange,compressed:true})),(type===_constants.URL_TYPE.KIBANA_DASHBOARD||type===_constants.URL_TYPE.KIBANA_DISCOVER)&&entityOptions.length>0&&_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.queryEntitiesLabel",defaultMessage:"Query entities"})},_react.default.createElement(_eui.EuiComboBox,{placeholder:intl.formatMessage({id:"xpack.ml.customUrlsEditor.selectEntitiesPlaceholder",defaultMessage:"Select entities"}),options:entityOptions,selectedOptions:selectedEntityOptions,onChange:this.onQueryEntitiesChange,isClearable:true})),(type===_constants.URL_TYPE.KIBANA_DASHBOARD||type===_constants.URL_TYPE.KIBANA_DISCOVER)&&_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.timeRangeLabel",defaultMessage:"Time range"}),className:"url-time-range",compressed:true},_react.default.createElement(_eui.EuiSelect,{options:timeRangeOptions,value:timeRange.type,onChange:this.onTimeRangeTypeChange,compressed:true}))),timeRange.type===_constants.TIME_RANGE_TYPE.INTERVAL&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.intervalLabel",defaultMessage:"Interval"}),className:"url-time-range",error:invalidIntervalError,isInvalid:isInvalidTimeRange,compressed:true},_react.default.createElement(_eui.EuiFieldText,{value:timeRange.interval,onChange:this.onTimeRangeIntervalChange,isInvalid:isInvalidTimeRange,compressed:true})))),type===_constants.URL_TYPE.OTHER&&_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.customUrlsEditor.urlLabel",defaultMessage:"URL"}),compressed:true,fullWidth:true},_react.default.createElement(_eui.EuiTextArea,{fullWidth:true,rows:2,value:otherUrlSettings.urlValue,onChange:this.onOtherUrlValueChange,compressed:true}))))}}]);return CustomUrlEditor}(_react.Component),_defineProperty(_class,"propTypes",{customUrl:_propTypes.default.object,setEditCustomUrl:_propTypes.default.func.isRequired,savedCustomUrls:_propTypes.default.array.isRequired,dashboards:_propTypes.default.array.isRequired,indexPatterns:_propTypes.default.array.isRequired,queryEntityFieldNames:_propTypes.default.array.isRequired}),_temp));exports.CustomUrlEditor=CustomUrlEditor},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DeleteJobModal",{enumerable:true,get:function get(){return _delete_job_modal.DeleteJobModal}});var _delete_job_modal=__webpack_require__(2810)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DeleteJobModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _utils=__webpack_require__(433);var _jobs_list=__webpack_require__(679);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DeleteJobModal=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(_class,_Component);function _class(props){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeModal",function(){_this.setState({isModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"showModal",function(jobs){_this.setState({jobs:jobs,isModalVisible:true,deleting:false})});_defineProperty(_assertThisInitialized(_this),"deleteJob",function(){_this.setState({deleting:true});(0,_utils.deleteJobs)(_this.state.jobs);setTimeout(function(){_this.closeModal();_this.refreshJobs()},_jobs_list.DELETING_JOBS_REFRESH_INTERVAL_MS)});_defineProperty(_assertThisInitialized(_this),"setEL",function(el){if(el){_this.el=el}});_this.state={jobs:[],isModalVisible:false,deleting:false};_this.refreshJobs=_this.props.refreshJobs;return _this}_createClass(_class,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showModal)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"render",value:function render(){var intl=this.props.intl;var modal;if(this.state.isModalVisible){if(this.el&&this.state.deleting===true){this.el.confirmButton.style.display="none";this.el.cancelButton.textContent=intl.formatMessage({id:"xpack.ml.jobsList.deleteJobModal.closeButtonLabel",defaultMessage:"Close"})}var title=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteJobsTitle",defaultMessage:"Delete {jobsCount, plural, one {{jobId}} other {# jobs}}",values:{jobsCount:this.state.jobs.length,jobId:this.state.jobs[0].id}});modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{"data-test-subj":"mlDeleteJobConfirmModal",ref:this.setEL,title:title,onCancel:this.closeModal,onConfirm:this.deleteJob,cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON,className:"eui-textBreakWord"},this.state.deleting===true&&_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deletingJobsStatusLabel",defaultMessage:"Deleting jobs"}),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement("div",{style:{textAlign:"center"}},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}))),this.state.deleting===false&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteJobsDescription",defaultMessage:"Are you sure you want to delete {jobsCount, plural, one {this job} other {these jobs}}?",values:{jobsCount:this.state.jobs.length}})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteMultipleJobsDescription",defaultMessage:"Deleting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be deleted in the background and may not disappear from the jobs list instantly",values:{jobsCount:this.state.jobs.length}})))))}return _react.default.createElement("div",null,modal)}}]);return _class}(_react.Component),_defineProperty(_class,"displayName","DeleteJobModal"),_defineProperty(_class,"propTypes",{setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired}),_temp));exports.DeleteJobModal=DeleteJobModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"StartDatafeedModal",{enumerable:true,get:function get(){return _start_datafeed_modal.StartDatafeedModal}});var _start_datafeed_modal=__webpack_require__(2812)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StartDatafeedModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(16));var _utils=__webpack_require__(433);var _time_range_selector=__webpack_require__(2813);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var StartDatafeedModal=function(_Component){_inherits(StartDatafeedModal,_Component);function StartDatafeedModal(props){var _this;_classCallCheck(this,StartDatafeedModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(StartDatafeedModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"setStartTime",function(time){_this.setState({startTime:time})});_defineProperty(_assertThisInitialized(_this),"setEndTime",function(time){_this.setState({endTime:time})});_defineProperty(_assertThisInitialized(_this),"setCreateWatch",function(e){_this.setState({createWatch:e.target.checked})});_defineProperty(_assertThisInitialized(_this),"closeModal",function(){_this.setState({isModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"showModal",function(jobs,showCreateWatchFlyout){var startTime=undefined;var now=(0,_moment.default)();var endTime=now;var initialSpecifiedStartTime=getLowestLatestTime(jobs);var allowCreateWatch=jobs.length===1;_this.setState({jobs:jobs,isModalVisible:true,startTime:startTime,endTime:endTime,initialSpecifiedStartTime:initialSpecifiedStartTime,showCreateWatchFlyout:showCreateWatchFlyout,allowCreateWatch:allowCreateWatch,createWatch:false,now:now})});_defineProperty(_assertThisInitialized(_this),"save",function(){var jobs=_this.state.jobs;var start=_moment.default.isMoment(_this.state.startTime)?_this.state.startTime.valueOf():_this.state.startTime;var end=_moment.default.isMoment(_this.state.endTime)?_this.state.endTime.valueOf():_this.state.endTime;(0,_utils.forceStartDatafeeds)(jobs,start,end,function(){if(_this.state.createWatch&&jobs.length===1){var jobId=jobs[0].id;_this.getShowCreateWatchFlyoutFunction()(jobId)}_this.refreshJobs()});_this.closeModal()});var _now=(0,_moment.default)();_this.state={jobs:_this.props.jobs,isModalVisible:false,startTime:_now,endTime:_now,createWatch:false,allowCreateWatch:false,initialSpecifiedStartTime:_now,now:_now};_this.initialSpecifiedStartTime=_now;_this.refreshJobs=_this.props.refreshJobs;_this.getShowCreateWatchFlyoutFunction=_this.props.getShowCreateWatchFlyoutFunction;return _this}_createClass(StartDatafeedModal,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showModal)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"render",value:function render(){var _this$state=this.state,jobs=_this$state.jobs,initialSpecifiedStartTime=_this$state.initialSpecifiedStartTime,startTime=_this$state.startTime,endTime=_this$state.endTime,createWatch=_this$state.createWatch,now=_this$state.now;var startableJobs=jobs!==undefined?jobs.filter(function(j){return j.hasDatafeed}):[];var startDisabled=startTime!==undefined&&startTime===endTime;var modal;if(this.state.isModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:this.closeModal,style:{width:"850px"},maxWidth:false},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startJobsTitle",defaultMessage:"Start {jobsCount, plural, one {{jobId}} other {# jobs}}",values:{jobsCount:startableJobs.length,jobId:startableJobs[0].id}}))),_react.default.createElement(_eui.EuiModalBody,null,_react.default.createElement(_time_range_selector.TimeRangeSelector,{startTime:startTime===undefined?initialSpecifiedStartTime:startTime,endTime:endTime,setStartTime:this.setStartTime,setEndTime:this.setEndTime,now:now}),this.state.endTime===undefined&&_react.default.createElement("div",{className:"create-watch"},_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_eui.EuiCheckbox,{id:"createWatch",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.createWatchDescription",defaultMessage:"Create watch after datafeed has started"}),checked:createWatch,onChange:this.setCreateWatch}))),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:this.closeModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.cancelButtonLabel",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:this.save,isDisabled:startDisabled,fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startButtonLabel",defaultMessage:"Start"})))))}return _react.default.createElement("div",null,modal)}}]);return StartDatafeedModal}(_react.Component);exports.StartDatafeedModal=StartDatafeedModal;StartDatafeedModal.propTypes={setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired};function getLowestLatestTime(jobs){var times=jobs.map(function(j){return j.latestTimestampSortValue});return(0,_moment.default)(Math.min.apply(Math,_toConsumableArray(times)))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeRangeSelector",{enumerable:true,get:function get(){return _time_range_selector.TimeRangeSelector}});var _time_range_selector=__webpack_require__(2814)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeRangeSelector=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(16));var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";var TimeRangeSelector=function(_Component){_inherits(TimeRangeSelector,_Component);function TimeRangeSelector(props){var _this;_classCallCheck(this,TimeRangeSelector);_this=_possibleConstructorReturn(this,_getPrototypeOf(TimeRangeSelector).call(this,props));_defineProperty(_assertThisInitialized(_this),"setStartTab",function(tab){_this.setState({startTab:tab});switch(tab){case 0:_this.setStartTime(undefined);break;case 1:_this.setStartTime(_this.now);break;default:break}});_defineProperty(_assertThisInitialized(_this),"setEndTab",function(tab){_this.setState({endTab:tab});switch(tab){case 0:_this.setEndTime(undefined);break;case 1:_this.setEndTime(_this.now);break;default:break}});_defineProperty(_assertThisInitialized(_this),"setStartTime",function(time){_this.props.setStartTime(time)});_defineProperty(_assertThisInitialized(_this),"setEndTime",function(time){_this.props.setEndTime(time)});_this.state={startTab:0,endTab:1};_this.latestTimestamp=_this.props.startTime;_this.now=_this.props.now;return _this}_createClass(TimeRangeSelector,[{key:"getTabItems",value:function getTabItems(){var datePickerTimes={start:_moment.default.isMoment(this.props.startTime)?this.props.startTime:this.latestTimestamp,end:_moment.default.isMoment(this.props.endTime)?this.props.endTime:this.now};var formattedStartTime=this.latestTimestamp.format(TIME_FORMAT);var showContinueLabels=this.latestTimestamp.valueOf()>0;var startLabels=showContinueLabels===true?[_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromStartTimeLabel",defaultMessage:"Continue from {formattedStartTime}",values:{formattedStartTime:formattedStartTime}}),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromNowLabel",defaultMessage:"Continue from now"}),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromSpecifiedTimeLabel",defaultMessage:"Continue from specified time"})]:[_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startAtBeginningOfDataLabel",defaultMessage:"Start at beginning of data"}),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startFromNowLabel",defaultMessage:"Start from now"}),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyStartTimeLabel",defaultMessage:"Specify start time"})];var startItems=[{index:0,label:startLabels[0]},{index:1,label:startLabels[1]},{index:2,label:startLabels[2],body:_react.default.createElement(_eui.EuiDatePicker,{selected:datePickerTimes.start,onChange:this.setStartTime,maxDate:datePickerTimes.end,inline:true,showTimeSelect:true})}];var endItems=[{index:0,label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.noEndTimeLabel",defaultMessage:"No end time (Real-time search)"})},{index:1,label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyEndTimeLabel",defaultMessage:"Specify end time"}),body:_react.default.createElement(_eui.EuiDatePicker,{selected:datePickerTimes.end,onChange:this.setEndTime,minDate:datePickerTimes.start,inline:true,showTimeSelect:true})}];return{startItems:startItems,endItems:endItems}}},{key:"render",value:function render(){var _this$getTabItems=this.getTabItems(),startItems=_this$getTabItems.startItems,endItems=_this$getTabItems.endItems;return _react.default.createElement("div",{className:"time-range-selector"},_react.default.createElement("div",{className:"time-range-section-container"},_react.default.createElement(TabStack,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchStartTimeTitle",defaultMessage:"Search start time"}),items:startItems,switchState:this.state.startTab,switchFunc:this.setStartTab}),_react.default.createElement(TabStack,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchEndTimeTitle",defaultMessage:"Search end time"}),items:endItems,switchState:this.state.endTab,switchFunc:this.setEndTab})))}}]);return TimeRangeSelector}(_react.Component);exports.TimeRangeSelector=TimeRangeSelector;function TabStack(_ref){var title=_ref.title,items=_ref.items,switchState=_ref.switchState,switchFunc=_ref.switchFunc;return _react.default.createElement("div",{className:"time-range-section"},_react.default.createElement("div",{className:"time-range-section-title"},title),_react.default.createElement("ul",{className:"tab-stack"},items.map(function(item,i){var className="";if(switchState===item.index){className+="active "}if(item.body!==undefined){className+="has-body "}return _react.default.createElement("li",{key:i,className:className},_react.default.createElement("a",{onClick:function onClick(){return switchFunc(item.index)}},item.label),item.body!==undefined&&_react.default.createElement("div",{className:"body"},item.body))})))}TimeRangeSelector.propTypes={startTime:_propTypes.default.object.isRequired,endTime:_propTypes.default.object,setStartTime:_propTypes.default.func.isRequired,setEndTime:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CreateWatchFlyout",{enumerable:true,get:function get(){return _create_watch_flyout.CreateWatchFlyout}});var _create_watch_flyout=__webpack_require__(2816)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CreateWatchFlyout=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _notify=__webpack_require__(14);var _utils=__webpack_require__(433);var _create_watch_service=__webpack_require__(499);var _create_watch_view=__webpack_require__(2820);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getSuccessToast(id,url,intl){return{title:intl.formatMessage({id:"xpack.ml.jobsList.createWatchFlyout.watchCreatedSuccessfullyNotificationMessage",defaultMessage:"Watch {id} created successfully"},{id:id}),text:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{size:"s",href:url,target:"_blank",iconType:"link"},intl.formatMessage({id:"xpack.ml.jobsList.createWatchFlyout.editWatchButtonLabel",defaultMessage:"Edit watch"})))))}}var CreateWatchFlyoutUI=function(_Component){_inherits(CreateWatchFlyoutUI,_Component);function CreateWatchFlyoutUI(props){var _this;_classCallCheck(this,CreateWatchFlyoutUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(CreateWatchFlyoutUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeFlyout",function(){_this.setState({isFlyoutVisible:false})});_defineProperty(_assertThisInitialized(_this),"showFlyout",function(jobId){(0,_utils.loadFullJob)(jobId).then(function(job){var bucketSpan=job.analysis_config.bucket_span;_create_watch_service.mlCreateWatchService.config.includeInfluencers=job.analysis_config.influencers.length>0;_this.setState({job:job,jobId:jobId,bucketSpan:bucketSpan,isFlyoutVisible:true})}).catch(function(error){console.error(error)})});_defineProperty(_assertThisInitialized(_this),"save",function(){var intl=_this.props.intl;_create_watch_service.mlCreateWatchService.createNewWatch(_this.state.jobId).then(function(resp){_notify.toastNotifications.addSuccess(getSuccessToast(resp.id,resp.url,intl));_this.closeFlyout()}).catch(function(error){_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.jobsList.createWatchFlyout.watchNotSavedErrorNotificationMessage",defaultMessage:"Could not save watch"}));console.error(error)})});_this.state={jobId:null,bucketSpan:null};return _this}_createClass(CreateWatchFlyoutUI,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showFlyout)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"render",value:function render(){var _this$state=this.state,jobId=_this$state.jobId,bucketSpan=_this$state.bucketSpan;var flyout;if(this.state.isFlyoutVisible){flyout=_react.default.createElement(_eui.EuiFlyout,{onClose:this.closeFlyout,size:"s"},_react.default.createElement(_eui.EuiFlyoutHeader,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.createWatchFlyout.pageTitle",defaultMessage:"Create watch for {jobId}",values:{jobId:jobId}})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_create_watch_view.CreateWatch,{jobId:jobId,bucketSpan:bucketSpan})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.createWatchFlyout.closeButtonLabel",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.save,fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.createWatchFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return _react.default.createElement("div",null,flyout)}}]);return CreateWatchFlyoutUI}(_react.Component);CreateWatchFlyoutUI.propTypes={setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired};var CreateWatchFlyout=(0,_react2.injectI18n)(CreateWatchFlyoutUI);exports.CreateWatchFlyout=CreateWatchFlyout},function(module,exports){module.exports="<html>\n  <body>\n    <strong>\n      <%= elasticStackMachineLearningAlertLabel %>\n    </strong>\n    <br />\n    <br />\n\n    <strong>\n      <%= jobLabel %>\n    </strong>: {{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0._source.job_id}}\n    <br />\n\n    <strong>\n      <%= timeLabel %>\n    </strong>: {{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.timestamp_iso8601.0}}\n    <br />\n\n    <strong>\n      <%= anomalyScoreLabel %>\n    </strong>: {{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.score.0}}\n    <br />\n    <br />\n\n    <a href=\"<%= serverAddress %>#/explorer/?_g=(ml:(jobIds:!('{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0._source.job_id}}')),refreshInterval:(display:Off,pause:!f,value:0),time:(from:'{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.start.0}}',mode:absolute,to:'{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.end.0}}'))&_a=(filters:!(),mlAnomaliesTable:(intervalValue:auto,thresholdValue:0),mlExplorerSwimlane:(selectedLane:Overall,selectedTime:{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.timestamp_epoch.0}},selectedType:overall),query:(query_string:(analyze_wildcard:!t,query:'*')))\">\n      <%= openInAnomalyExplorerLinkText %>\n    </a>\n    <br />\n    <br />\n\n    <%= influencersSection %>\n\n    <strong>\n      <%= topRecordsLabel %>\n    </strong>\n    <br />\n    {{#ctx.payload.aggregations.record_results.top_record_hits.hits.hits}}\n      {{_source.function}}({{_source.field_name}}) {{_source.by_field_value}} {{_source.over_field_value}} {{_source.partition_field_value}} [{{fields.score.0}}]\n      <br />\n    {{/ctx.payload.aggregations.record_results.top_record_hits.hits.hits}}\n\n  </body>\n</html>\n"},function(module,exports){module.exports="<strong>\n  <%= topInfluencersLabel %>\n</strong>\n<br />\n  {{#ctx.payload.aggregations.influencer_results.top_influencer_hits.hits.hits}}\n    {{_source.influencer_field_name}} = {{_source.influencer_field_value}} [{{fields.score.0}}]\n    <br />\n  {{/ctx.payload.aggregations.influencer_results.top_influencer_hits.hits.hits}}\n<br />\n"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.watch=void 0;var _index_patterns=__webpack_require__(497);var watch={trigger:{schedule:{interval:"60s"}},input:{search:{request:{search_type:"query_then_fetch",indices:[_index_patterns.ML_RESULTS_INDEX_PATTERN],body:{size:0,query:{bool:{filter:[{term:{job_id:null}},{range:{timestamp:{gte:null}}},{terms:{result_type:["bucket","record","influencer"]}}]}},aggs:{bucket_results:{filter:{range:{anomaly_score:{gte:null}}},aggs:{top_bucket_hits:{top_hits:{sort:[{anomaly_score:{order:"desc"}}],_source:{includes:["job_id","result_type","timestamp","anomaly_score","is_interim"]},size:1,script_fields:{start:{script:{lang:"painless",source:'LocalDateTime.ofEpochSecond((doc["timestamp"].value.getMillis()-((doc["bucket_span"].value * 1000)\n * params.padding)) / 1000, 0, ZoneOffset.UTC).toString()+":00.000Z"',params:{padding:10}}},end:{script:{lang:"painless",source:'LocalDateTime.ofEpochSecond((doc["timestamp"].value.getMillis()+((doc["bucket_span"].value * 1000)\n * params.padding)) / 1000, 0, ZoneOffset.UTC).toString()+":00.000Z"',params:{padding:10}}},timestamp_epoch:{script:{lang:"painless",source:'doc["timestamp"].value.getMillis()/1000'}},timestamp_iso8601:{script:{lang:"painless",source:'doc["timestamp"].value'}},score:{script:{lang:"painless",source:'Math.round(doc["anomaly_score"].value)'}}}}}}},influencer_results:{filter:{range:{influencer_score:{gte:3}}},aggs:{top_influencer_hits:{top_hits:{sort:[{influencer_score:{order:"desc"}}],_source:{includes:["result_type","timestamp","influencer_field_name","influencer_field_value","influencer_score","isInterim"]},size:3,script_fields:{score:{script:{lang:"painless",source:'Math.round(doc["influencer_score"].value)'}}}}}}},record_results:{filter:{range:{record_score:{gte:3}}},aggs:{top_record_hits:{top_hits:{sort:[{record_score:{order:"desc"}}],_source:{includes:["result_type","timestamp","record_score","is_interim","function","field_name","by_field_value","over_field_value","partition_field_value"]},size:3,script_fields:{score:{script:{lang:"painless",source:'Math.round(doc["record_score"].value)'}}}}}}}}}}}},condition:{compare:{"ctx.payload.aggregations.bucket_results.doc_count":{gt:0}}},actions:{log:{logging:{level:"info",text:""}}}};exports.watch=watch;var txt="Alert for job [{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0._source.job_id}}] at ";txt+="[{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.timestamp_iso8601.0}}] score ";txt+="[{{ctx.payload.aggregations.bucket_results.top_bucket_hits.hits.hits.0.fields.score.0}}]";watch.actions.log.logging.text=txt},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CreateWatch=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _lodash=__webpack_require__(3);var _parse_interval=__webpack_require__(275);var _react2=__webpack_require__(5);var _ml_api_service=__webpack_require__(24);var _select_severity=__webpack_require__(401);var _create_watch_service=__webpack_require__(499);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var STATUS=_create_watch_service.mlCreateWatchService.STATUS;var CreateWatch=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(CreateWatch,_Component);function CreateWatch(props){var _this;_classCallCheck(this,CreateWatch);_this=_possibleConstructorReturn(this,_getPrototypeOf(CreateWatch).call(this,props));_defineProperty(_assertThisInitialized(_this),"onThresholdChange",function(threshold){_this.setState({threshold:threshold},function(){_this.config.threshold=threshold})});_defineProperty(_assertThisInitialized(_this),"onIntervalChange",function(e){var interval=e.target.value;_this.setState({interval:interval},function(){_this.config.interval=interval})});_defineProperty(_assertThisInitialized(_this),"onIncludeEmailChanged",function(e){var includeEmail=e.target.checked;_this.setState({includeEmail:includeEmail},function(){_this.config.includeEmail=includeEmail})});_defineProperty(_assertThisInitialized(_this),"onEmailChange",function(e){var email=e.target.value;_this.setState({email:email},function(){_this.config.email=email})});_create_watch_service.mlCreateWatchService.reset();_this.config=_create_watch_service.mlCreateWatchService.config;_this.state={jobId:_this.props.jobId,bucketSpan:_this.props.bucketSpan,interval:_this.config.interval,threshold:_this.config.threshold,includeEmail:_this.config.emailIncluded,email:_this.config.email,emailEnabled:false,status:null,watchAlreadyExists:false};return _this}_createClass(CreateWatch,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;if(this.state.bucketSpan){var intervalObject=(0,_parse_interval.parseInterval)(this.state.bucketSpan);var bs=intervalObject.asMinutes()*2;if(bs<1){bs=1}var interval="".concat(bs,"m");this.setState({interval:interval},function(){_this2.config.interval=interval})}_ml_api_service.ml.getNotificationSettings().then(function(resp){if((0,_lodash.has)(resp,"defaults.xpack.notification.email")){_this2.setState({emailEnabled:true})}});_create_watch_service.mlCreateWatchService.loadWatch(this.state.jobId).then(function(){_this2.setState({watchAlreadyExists:true})}).catch(function(){_this2.setState({watchAlreadyExists:false})})}},{key:"render",value:function render(){var _this3=this;var intl=this.props.intl;var mlSelectSeverityService={state:{set:function set(name,threshold){_this3.onThresholdChange(threshold);return{changed:function changed(){}}},get:function get(){return _this3.config.threshold}}};var status=this.state.status;if(status===null||status===STATUS.SAVING||status===STATUS.SAVE_FAILED){return _react.default.createElement("div",{className:"create-watch"},_react.default.createElement("div",{className:"form-group form-group-flex"},_react.default.createElement("div",{className:"sub-form-group"},_react.default.createElement("div",null,_react.default.createElement("label",{htmlFor:"selectInterval",className:"euiFormLabel"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.timeRangeLabel",defaultMessage:"Time range"}))),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.nowLabel",defaultMessage:"Now - {selectInterval}",values:{selectInterval:_react.default.createElement(_eui.EuiFieldText,{id:"selectInterval",value:this.state.interval,onChange:this.onIntervalChange})}})),_react.default.createElement("div",{className:"sub-form-group"},_react.default.createElement("div",null,_react.default.createElement("label",{htmlFor:"selectSeverity",className:"euiFormLabel"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.severityThresholdLabel",defaultMessage:"Severity threshold"}))),_react.default.createElement("div",{className:"dropdown-group"},_react.default.createElement(_select_severity.SelectSeverity,{id:"selectSeverity",mlSelectSeverityService:mlSelectSeverityService})))),this.state.emailEnabled&&_react.default.createElement("div",{className:"form-group"},_react.default.createElement(_eui.EuiCheckbox,{id:"includeEmail",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.sendEmailLabel",defaultMessage:"Send email"}),checked:this.state.includeEmail,onChange:this.onIncludeEmailChanged}),this.state.includeEmail&&_react.default.createElement("div",{className:"email-section"},_react.default.createElement(_eui.EuiFieldText,{value:this.state.email,onChange:this.onEmailChange,placeholder:intl.formatMessage({id:"xpack.ml.newJob.simple.createWatchView.emailAddressPlaceholder",defaultMessage:"email address"}),"aria-label":intl.formatMessage({id:"xpack.ml.newJob.simple.createWatchView.watchEmailAddressAriaLabel",defaultMessage:"Watch email address"})}))),this.state.watchAlreadyExists&&_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.watchAlreadyExistsWarningMessage",defaultMessage:"Warning, watch ml-{jobId} already exists, clicking apply will overwrite the original.",values:{jobId:this.state.jobId}})}))}else if(status===STATUS.SAVED){return _react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.createWatchView.successLabel",defaultMessage:"Success"}))}else{return _react.default.createElement("div",null)}}}]);return CreateWatch}(_react.Component),_defineProperty(_class,"propTypes",{jobId:_propTypes.default.string.isRequired,bucketSpan:_propTypes.default.string.isRequired}),_temp));exports.CreateWatch=CreateWatch},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MultiJobActions",{enumerable:true,get:function get(){return _multi_job_actions.MultiJobActions}});var _multi_job_actions=__webpack_require__(2822)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiJobActions=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _job_actions=__webpack_require__(1350);var _actions_menu=__webpack_require__(2823);var _group_selector=__webpack_require__(2824);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var MultiJobActions=function(_Component){_inherits(MultiJobActions,_Component);function MultiJobActions(props){var _this;_classCallCheck(this,MultiJobActions);_this=_possibleConstructorReturn(this,_getPrototypeOf(MultiJobActions).call(this,props));_this.state={};return _this}_createClass(MultiJobActions,[{key:"render",value:function render(){var jobsSelected=this.props.selectedJobs.length>0;return _react.default.createElement("div",{className:"multi-select-actions".concat(jobsSelected?"":"-no-display")},jobsSelected&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"s",style:{display:"inline"}},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.jobsSelectedLabel",defaultMessage:"{selectedJobsCount, plural, one {# job} other {# jobs}}   selected",values:{selectedJobsCount:this.props.selectedJobs.length}}))),_react.default.createElement("div",{className:"actions-border-large"}),_react.default.createElement(_job_actions.ResultLinks,{jobs:this.props.selectedJobs}),_react.default.createElement(_group_selector.GroupSelector,{jobs:this.props.selectedJobs,allJobIds:this.props.allJobIds,refreshJobs:this.props.refreshJobs}),_react.default.createElement(_actions_menu.MultiJobActionsMenu,{jobs:this.props.selectedJobs,showStartDatafeedModal:this.props.showStartDatafeedModal,showDeleteJobModal:this.props.showDeleteJobModal,refreshJobs:this.props.refreshJobs})))}}]);return MultiJobActions}(_react.Component);exports.MultiJobActions=MultiJobActions;MultiJobActions.propTypes={selectedJobs:_propTypes.default.array.isRequired,allJobIds:_propTypes.default.array.isRequired,showStartDatafeedModal:_propTypes.default.func.isRequired,showDeleteJobModal:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiJobActionsMenu=void 0;var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _utils=__webpack_require__(433);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MultiJobActionsMenuUI=function(_Component){_inherits(MultiJobActionsMenuUI,_Component);function MultiJobActionsMenuUI(props){var _this;_classCallCheck(this,MultiJobActionsMenuUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(MultiJobActionsMenuUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){_this.setState(function(prevState){return{isOpen:!prevState.isOpen}})});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({isOpen:false})});_this.state={isOpen:false};_this.canDeleteJob=(0,_check_privilege.checkPermission)("canDeleteJob");_this.canStartStopDatafeed=(0,_check_privilege.checkPermission)("canStartStopDatafeed")&&(0,_check_ml_nodes.mlNodesAvailable)();_this.canCloseJob=(0,_check_privilege.checkPermission)("canCloseJob")&&(0,_check_ml_nodes.mlNodesAvailable)();return _this}_createClass(MultiJobActionsMenuUI,[{key:"render",value:function render(){var _this2=this;var button=_react.default.createElement(_eui.EuiButtonIcon,{size:"s",onClick:this.onButtonClick,iconType:"gear","aria-label":this.props.intl.formatMessage({id:"xpack.ml.jobsList.multiJobActionsMenu.managementActionsAriaLabel",defaultMessage:"Management actions"}),color:"text",disabled:this.canDeleteJob===false&&this.canStartStopDatafeed===false});var items=[_react.default.createElement(_eui.EuiContextMenuItem,{key:"delete",icon:"trash",disabled:this.canDeleteJob===false,onClick:function onClick(){_this2.props.showDeleteJobModal(_this2.props.jobs);_this2.closePopover()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.deleteJobsLabel",defaultMessage:"Delete {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))];if((0,_utils.isClosable)(this.props.jobs)){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"close job",icon:"cross",disabled:this.canCloseJob===false,onClick:function onClick(){(0,_utils.closeJobs)(_this2.props.jobs);_this2.closePopover()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.closeJobsLabel",defaultMessage:"Close {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}})))}if((0,_utils.isStoppable)(this.props.jobs)){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"stop datafeed",icon:"stop",disabled:this.canStartStopDatafeed===false,onClick:function onClick(){(0,_utils.stopDatafeeds)(_this2.props.jobs,_this2.props.refreshJobs);_this2.closePopover()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.stopDatafeedsLabel",defaultMessage:"Stop {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}})))}if((0,_utils.isStartable)(this.props.jobs)){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"start datafeed",icon:"play",disabled:this.canStartStopDatafeed===false,onClick:function onClick(){_this2.props.showStartDatafeedModal(_this2.props.jobs);_this2.closePopover()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.startDatafeedsLabel",defaultMessage:"Start {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}})))}return _react.default.createElement(_eui.EuiPopover,{button:button,isOpen:this.state.isOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downCenter"},_react.default.createElement(_eui.EuiContextMenuPanel,{items:items.reverse()}))}}]);return MultiJobActionsMenuUI}(_react.Component);MultiJobActionsMenuUI.propTypes={jobs:_propTypes.default.array.isRequired,showStartDatafeedModal:_propTypes.default.func.isRequired,showDeleteJobModal:_propTypes.default.func.isRequired,refreshJobs:_propTypes.default.func.isRequired};var MultiJobActionsMenu=(0,_react2.injectI18n)(MultiJobActionsMenuUI);exports.MultiJobActionsMenu=MultiJobActionsMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"GroupSelector",{enumerable:true,get:function get(){return _group_selector.GroupSelector}});var _group_selector=__webpack_require__(2825)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GroupSelector=void 0;var _check_privilege=__webpack_require__(39);var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _lodash=__webpack_require__(3);var _ml_api_service=__webpack_require__(24);var _group_list=__webpack_require__(2826);var _new_group_input=__webpack_require__(2828);var _messagebar_service=__webpack_require__(268);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function createSelectedGroups(jobs,groups){var jobIds=jobs.map(function(j){return j.id});var groupCounts={};jobs.forEach(function(j){j.groups.forEach(function(g){if(groupCounts[g]===undefined){groupCounts[g]=0}groupCounts[g]++})});var selectedGroups=groups.reduce(function(p,c){if(c.jobIds.some(function(j){return jobIds.includes(j)})){p[c.id]={partial:groupCounts[c.id]!==jobIds.length}}return p},{});return selectedGroups}var GroupSelector=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(GroupSelector,_Component);function GroupSelector(props){var _this;_classCallCheck(this,GroupSelector);_this=_possibleConstructorReturn(this,_getPrototypeOf(GroupSelector).call(this,props));_defineProperty(_assertThisInitialized(_this),"togglePopover",function(){if(_this.state.isPopoverOpen){_this.closePopover()}else{_ml_api_service.ml.jobs.groups().then(function(groups){var selectedGroups=createSelectedGroups(_this.props.jobs,groups);_this.setState({isPopoverOpen:true,edited:false,selectedGroups:selectedGroups,groups:groups})}).catch(function(error){console.error(error)})}});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({edited:false,isPopoverOpen:false})});_defineProperty(_assertThisInitialized(_this),"selectGroup",function(group){var newSelectedGroups=(0,_lodash.cloneDeep)(_this.state.selectedGroups);if(newSelectedGroups[group.id]===undefined){newSelectedGroups[group.id]={partial:false}}else if(newSelectedGroups[group.id].partial===true){newSelectedGroups[group.id].partial=false}else{delete newSelectedGroups[group.id]}_this.setState({selectedGroups:newSelectedGroups,edited:true})});_defineProperty(_assertThisInitialized(_this),"applyChanges",function(){var selectedGroups=_this.state.selectedGroups;var jobs=_this.props.jobs;var newJobs=jobs.map(function(j){return{id:j.id,oldGroups:j.groups,newGroups:[]}});var _loop=function _loop(gId){if(selectedGroups.hasOwnProperty(gId)){var group=selectedGroups[gId];newJobs.forEach(function(j){if(group.partial===false||group.partial===true&&j.oldGroups.includes(gId)){j.newGroups.push(gId)}})}};for(var gId in selectedGroups){_loop(gId)}var tempJobs=newJobs.map(function(j){return{job_id:j.id,groups:j.newGroups}});_ml_api_service.ml.jobs.updateGroups(tempJobs).then(function(resp){var success=true;for(var jobId in resp){if(resp.hasOwnProperty(jobId)){if(resp[jobId].success===false){_messagebar_service.mlMessageBarService.notify.error(resp[jobId].error);success=false}}}if(success){_this.refreshJobs();_this.closePopover()}else{console.error(resp)}}).catch(function(error){_messagebar_service.mlMessageBarService.notify.error(error);console.error(error)})});_defineProperty(_assertThisInitialized(_this),"addNewGroup",function(id){var newGroup={id:id,calendarIds:[],jobIds:[]};var groups=_this.state.groups;if(groups.some(function(g){return g.id===newGroup.id})===false){groups.push(newGroup)}_this.setState({groups:groups})});_this.state={isPopoverOpen:false,groups:[],selectedGroups:{},edited:false};_this.refreshJobs=_this.props.refreshJobs;_this.canUpdateJob=(0,_check_privilege.checkPermission)("canUpdateJob");return _this}_createClass(GroupSelector,[{key:"render",value:function render(){var _this2=this;var intl=this.props.intl;var _this$state=this.state,groups=_this$state.groups,selectedGroups=_this$state.selectedGroups,edited=_this$state.edited;var button=_react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonTooltip",defaultMessage:"Edit job groups"})},_react.default.createElement(_eui.EuiButtonIcon,{iconType:"indexEdit","aria-label":intl.formatMessage({id:"xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonAriaLabel",defaultMessage:"Edit job groups"}),onClick:function onClick(){return _this2.togglePopover()},disabled:this.canUpdateJob===false}));return _react.default.createElement(_eui.EuiPopover,{id:"trapFocus",ownFocus:true,button:button,isOpen:this.state.isPopoverOpen,closePopover:function closePopover(){return _this2.closePopover()}},_react.default.createElement("div",{className:"group-selector"},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyGroupsToJobTitle",defaultMessage:"Apply groups to {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}})),_react.default.createElement(_group_list.GroupList,{groups:groups,selectedGroups:selectedGroups,selectGroup:this.selectGroup}),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"xs"}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_new_group_input.NewGroupInput,{addNewGroup:this.addNewGroup,allJobIds:this.props.allJobIds}),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"m"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{size:"s",onClick:this.applyChanges,isDisabled:edited===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyButtonLabel",defaultMessage:"Apply"})))))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){if(state.edited===false){var selectedGroups=createSelectedGroups(props.jobs,state.groups);return{selectedGroups:selectedGroups}}else{return{}}}}]);return GroupSelector}(_react.Component),_defineProperty(_class,"propTypes",{jobs:_propTypes.default.array.isRequired,allJobIds:_propTypes.default.array.isRequired,refreshJobs:_propTypes.default.func.isRequired}),_temp));exports.GroupSelector=GroupSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"GroupList",{enumerable:true,get:function get(){return _group_list.GroupList}});var _group_list=__webpack_require__(2827)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GroupList=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _job_group=__webpack_require__(880);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function Check(_ref){var group=_ref.group,selectedGroups=_ref.selectedGroups;if(selectedGroups[group.id]!==undefined){if(selectedGroups[group.id].partial){return _react.default.createElement("div",{className:"check selected"},_react.default.createElement("span",null,"—"))}else{return _react.default.createElement("div",{className:"check selected"},_react.default.createElement(_eui.EuiIcon,{type:"check"}))}}else{return _react.default.createElement("div",{className:"check"})}}var GroupList=function(_Component){_inherits(GroupList,_Component);function GroupList(props){var _this;_classCallCheck(this,GroupList);_this=_possibleConstructorReturn(this,_getPrototypeOf(GroupList).call(this,props));_defineProperty(_assertThisInitialized(_this),"selectGroup",function(group){_this.props.selectGroup(group)});_defineProperty(_assertThisInitialized(_this),"moveUp",function(event,index){event.preventDefault();if(index<0){return}else if(index>0){_this.selectItems[index-1].focus()}});_defineProperty(_assertThisInitialized(_this),"moveDown",function(event,index){event.preventDefault();if(index<_this.selectItems.length-1){_this.selectItems[index+1].focus()}});_defineProperty(_assertThisInitialized(_this),"handleKeyDown",function(event,group,index){switch(event.keyCode){case _eui.keyCodes.ENTER:_this.selectGroup(group);break;case _eui.keyCodes.SPACE:_this.selectGroup(group);break;case _eui.keyCodes.DOWN:_this.moveDown(event,index);break;case _eui.keyCodes.UP:_this.moveUp(event,index);break}});_defineProperty(_assertThisInitialized(_this),"setRef",function(ref,index){_this.selectItems[index]=ref});_this.state={groups:[]};_this.selectItems=[];return _this}_createClass(GroupList,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,selectedGroups=_this$props.selectedGroups,groups=_this$props.groups;return _react.default.createElement("div",{className:"group-list"},groups.map(function(g,index){return _react.default.createElement("div",{tabIndex:"0",onKeyDown:function onKeyDown(event){return _this2.handleKeyDown(event,g,index)},key:g.id,className:"group-item",onClick:function onClick(){return _this2.selectGroup(g)},ref:function ref(_ref2){return _this2.setRef(_ref2,index)}},_react.default.createElement(Check,{group:g,selectedGroups:selectedGroups}),_react.default.createElement(_job_group.JobGroup,{name:g.id}))}))}}]);return GroupList}(_react.Component);exports.GroupList=GroupList;GroupList.propTypes={selectedGroups:_propTypes.default.object.isRequired,groups:_propTypes.default.array.isRequired,selectGroup:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewGroupInput",{enumerable:true,get:function get(){return _new_group_input.NewGroupInput}});var _new_group_input=__webpack_require__(2829)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewGroupInput=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _validate_job=__webpack_require__(1356);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var NewGroupInput=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(NewGroupInput,_Component);function NewGroupInput(props){var _this;_classCallCheck(this,NewGroupInput);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewGroupInput).call(this,props));_defineProperty(_assertThisInitialized(_this),"changeTempNewGroup",function(e){var tempNewGroupName=e.target.value;var groupsValidationError="";if(tempNewGroupName===""){groupsValidationError=""}else if(_this.props.allJobIds.includes(tempNewGroupName)){groupsValidationError=_this.props.intl.formatMessage({id:"xpack.ml.jobsList.multiJobActions.groupSelector.groupsAndJobsCanNotUseSameIdErrorMessage",defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."})}else{groupsValidationError=(0,_validate_job.validateGroupNames)([tempNewGroupName]).message}_this.setState({tempNewGroupName:tempNewGroupName,groupsValidationError:groupsValidationError})});_defineProperty(_assertThisInitialized(_this),"newGroupKeyPress",function(e){if(e.keyCode===_eui.keyCodes.ENTER&&_this.state.groupsValidationError===""&&_this.state.tempNewGroupName!==""){_this.addNewGroup()}});_defineProperty(_assertThisInitialized(_this),"addNewGroup",function(){_this.props.addNewGroup(_this.state.tempNewGroupName);_this.setState({tempNewGroupName:""})});_this.state={tempNewGroupName:"",groupsValidationError:""};return _this}_createClass(NewGroupInput,[{key:"render",value:function render(){var intl=this.props.intl;var _this$state=this.state,tempNewGroupName=_this$state.tempNewGroupName,groupsValidationError=_this$state.groupsValidationError;return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{compressed:true,isInvalid:groupsValidationError!=="",error:groupsValidationError,className:"new-group-input"},_react.default.createElement(_eui.EuiFieldText,{compressed:true,placeholder:intl.formatMessage({id:"xpack.ml.jobsList.multiJobActions.groupSelector.addNewGroupPlaceholder",defaultMessage:"Add new group"}),value:tempNewGroupName,onChange:this.changeTempNewGroup,onKeyDown:this.newGroupKeyPress,isInvalid:groupsValidationError!=="",error:groupsValidationError}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{className:"new-group-input"},_react.default.createElement(_eui.EuiButtonIcon,{onClick:this.addNewGroup,iconType:"plusInCircle","aria-label":intl.formatMessage({id:"xpack.ml.jobsList.multiJobActions.groupSelector.addButtonAriaLabel",defaultMessage:"Add"}),disabled:tempNewGroupName===""||groupsValidationError!==""})))))}}]);return NewGroupInput}(_react.Component),_defineProperty(_class,"propTypes",{addNewGroup:_propTypes.default.func.isRequired,allJobIds:_propTypes.default.array.isRequired}),_temp));exports.NewGroupInput=NewGroupInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewJobButton",{enumerable:true,get:function get(){return _new_job_button.NewJobButton}});var _new_job_button=__webpack_require__(2831)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewJobButton=NewJobButton;var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function newJob(){window.location.href="#/jobs/new_job"}function NewJobButton(){var buttonEnabled=(0,_check_privilege.checkPermission)("canCreateJob")&&(0,_check_ml_nodes.mlNodesAvailable)();return _react.default.createElement(_eui.EuiButton,{"data-test-subj":"mlCreateNewJobButton",onClick:newJob,size:"s",disabled:buttonEnabled===false,fill:true,iconType:"plusInCircle"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.createNewJobButtonLabel",defaultMessage:"Create new job"}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobStatsBar",{enumerable:true,get:function get(){return _jobs_stats_bar.JobStatsBar}});var _jobs_stats_bar=__webpack_require__(2833)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobStatsBar=void 0;var _states=__webpack_require__(573);var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function createJobStats(jobsSummaryList){var jobStats={activeNodes:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML Nodes"}),value:0,show:true},total:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:true},open:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:true},closed:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:true},failed:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:false},activeDatafeeds:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:true}};if(jobsSummaryList===undefined){return jobStats}var mlNodes={};var failedJobs=0;jobsSummaryList.forEach(function(job){if(job.jobState===_states.JOB_STATE.OPENED){jobStats.open.value++}else if(job.jobState===_states.JOB_STATE.CLOSED){jobStats.closed.value++}else if(job.jobState===_states.JOB_STATE.FAILED){failedJobs++}if(job.hasDatafeed&&job.datafeedState===_states.DATAFEED_STATE.STARTED){jobStats.activeDatafeeds.value++}if(job.nodeName!==undefined){mlNodes[job.nodeName]={}}});jobStats.total.value=jobsSummaryList.length;if(failedJobs){jobStats.failed.value=failedJobs;jobStats.failed.show=true}else{jobStats.failed.show=false}jobStats.activeNodes.value=Object.keys(mlNodes).length;return jobStats}function Stat(_ref){var stat=_ref.stat;return _react.default.createElement("span",{className:"stat"},_react.default.createElement("span",{className:"stat-label"},stat.label),": ",_react.default.createElement("span",{className:"stat-value"},stat.value))}Stat.propTypes={stat:_propTypes.default.object.isRequired};var JobStatsBar=function JobStatsBar(_ref2){var jobsSummaryList=_ref2.jobsSummaryList;var jobStats=createJobStats(jobsSummaryList);var stats=Object.keys(jobStats).map(function(k){return jobStats[k]});return _react.default.createElement("div",{className:"jobs-stats-bar"},stats.filter(function(s){return s.show}).map(function(s){return _react.default.createElement(Stat,{key:s.label,stat:s})}))};exports.JobStatsBar=JobStatsBar;JobStatsBar.propTypes={jobsSummaryList:_propTypes.default.array.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NodeAvailableWarning",{enumerable:true,get:function get(){return _node_available_warning.NodeAvailableWarning}});var _node_available_warning=__webpack_require__(2835)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NodeAvailableWarning=NodeAvailableWarning;var _check_ml_nodes=__webpack_require__(71);var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NodeAvailableWarning(){var isCloud=false;if((0,_check_ml_nodes.mlNodesAvailable)()===true||(0,_check_ml_nodes.permissionToViewMlNodeCount)()===false){return _react.default.createElement("span",null)}else{return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableTitle",defaultMessage:"No ML nodes available"}),color:"warning",iconType:"alert"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableDescription",defaultMessage:"There are no ML nodes available."}),_react.default.createElement("br",null),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.unavailableCreateOrRunJobsDescription",defaultMessage:"You will not be able to create or run jobs. {cloudConfigLink}",values:{cloudConfigLink:isCloud?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloudDescription",defaultMessage:"This can be configured in Cloud {hereCloudLink}.",values:{hereCloudLink:_react.default.createElement(_eui.EuiLink,{href:"#"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloud.hereLinkText",defaultMessage:"here"}))}}):""}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"UpgradeWarning",{enumerable:true,get:function get(){return _upgrade_warning.UpgradeWarning}});var _upgrade_warning=__webpack_require__(2837)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UpgradeWarning=UpgradeWarning;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _upgrade_service=__webpack_require__(1349);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function UpgradeWarning(){if((0,_upgrade_service.isUpgradeInProgress)()===true){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningTitle",defaultMessage:"Index migration in progress"}),color:"warning",iconType:"alert"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescription",defaultMessage:"Indices related to Machine Learning are currently being upgraded."}),_react.default.createElement("br",null),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescriptionExtra",defaultMessage:"Some actions will not be available during this time."}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}return null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"RefreshJobsListButton",{enumerable:true,get:function get(){return _refresh_jobs_list_button.RefreshJobsListButton}});var _refresh_jobs_list_button=__webpack_require__(2839)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RefreshJobsListButton=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RefreshJobsListButton=function RefreshJobsListButton(_ref){var onRefreshClick=_ref.onRefreshClick,isRefreshing=_ref.isRefreshing;return _react.default.createElement(_eui.EuiButtonEmpty,{"data-test-subj":"mlRefreshJobListButton",onClick:onRefreshClick,isLoading:isRefreshing},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.jobsList.refreshButtonLabel",defaultMessage:"Refresh"}))};exports.RefreshJobsListButton=RefreshJobsListButton;RefreshJobsListButton.propTypes={onRefreshClick:_propTypes.default.func.isRequired,isRefreshing:_propTypes.default.bool.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2841);__webpack_require__(2845);__webpack_require__(2856);__webpack_require__(2858);__webpack_require__(577);__webpack_require__(2865)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _angular=_interopRequireDefault(__webpack_require__(26));__webpack_require__(291);__webpack_require__(360);__webpack_require__(334);var _parse_interval=__webpack_require__(275);var _timefilter=__webpack_require__(22);var _routes=_interopRequireDefault(__webpack_require__(19));var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _new_job=_interopRequireDefault(__webpack_require__(2843));var _save_status_modal=_interopRequireDefault(__webpack_require__(2844));var _breadcrumbs=__webpack_require__(400);var _new_job_utils=__webpack_require__(294);var _index_utils=__webpack_require__(226);var _field_types=__webpack_require__(295);var _validation=__webpack_require__(572);var _check_ml_nodes=__webpack_require__(71);var _new_job_defaults=__webpack_require__(337);var _job_utils=__webpack_require__(58);var _job_service=__webpack_require__(36);var _messagebar_service=__webpack_require__(268);var _ml_api_service=__webpack_require__(24);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_routes.default.when("/jobs/new_job/advanced",{template:_new_job.default,k7Breadcrumbs:_breadcrumbs.getAdvancedJobConfigurationBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,indexPatterns:_index_utils.loadIndexPatterns,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}}).when("/jobs/new_job/advanced/:jobId",{template:_new_job.default,k7Breadcrumbs:_breadcrumbs.getAdvancedJobConfigurationBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,indexPatterns:_index_utils.loadIndexPatterns,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlNewJob",function($scope,$route,$location,$modal,Private,mlConfirmModalService){_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var MODE={NEW:0,EDIT:1,CLONE:2};var INDEX_INPUT_TYPE={TEXT:"TEXT",LIST:"LIST"};$scope.INDEX_INPUT_TYPE=INDEX_INPUT_TYPE;var fieldsToIgnore=["_id","_field_names","_index","_parent","_routing","_seq_no","_source","_type","_uid","_version","_feature","_ignored"];var allowedInfluencerTypes=[_field_types.ES_FIELD_TYPES.TEXT,_field_types.ES_FIELD_TYPES.KEYWORD,_field_types.ES_FIELD_TYPES.IP];var msgs=_messagebar_service.mlMessageBarService;var mlConfirm=mlConfirmModalService;msgs.clear();var jobDefaults=(0,_new_job_defaults.newJobDefaults)();var currentConfigs={detectors:[],model_plot_config:{enabled:false}};$scope.job={};$scope.mode=MODE.NEW;$scope.saveLock=false;$scope.indices={};$scope.fields={};$scope.dateFields={};$scope.catFields={};$scope.maximumFileSize;$scope.mlElasticDataDescriptionExposedFunctions={};$scope.elasticServerInfo={};$scope.jobGroupsUpdateFunction={};$scope.enterJobNameLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.jobDetails.enterJobNameLabel",{defaultMessage:"Enter a name for the job"});$scope.bucketSpanNotValidFormatLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.bucketSpanNotValidFormatLabel",{defaultMessage:"{bucketSpan} is not a valid time interval format",values:{bucketSpan:"bucket_span"}});$scope.categorizationFiltersNotValidLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.categorizationFiltersNotValidLabel",{defaultMessage:"Categorization filters must all be valid regular expressions"});$scope.detectorNotConfiguredLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.detectorNotConfiguredLabel",{defaultMessage:"At least one detector should be configured"});$scope.influencerNotSelectedLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.influencerNotSelectedLabel",{defaultMessage:"At least one influencer should be selected"});$scope.validatingCardinalityLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.validatingCardinalityLabel",{defaultMessage:"Validating cardinality…"});$scope.enableModelPlotLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.analysisConfiguration.enableModelPlotLabel",{defaultMessage:"Enable model plot"});$scope.specifyTimeFieldLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.dataDescription.specifyTimeFieldLabel",{defaultMessage:"Time field should be specified"});$scope.specifyTimeFormatLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.dataDescription.specifyTimeFormatLabel",{defaultMessage:"Time format should be specified"});$scope.ui={pageTitle:_i18n.i18n.translate("xpack.ml.newJob.advanced.createNewJobTitle",{defaultMessage:"Create a new job"}),dataLocation:"ES",dataPreview:"",currentTab:0,tabs:[{index:0,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.jobDetailsLabel",{defaultMessage:"Job Details"})},{index:1,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.analysisConfigurationLabel",{defaultMessage:"Analysis Configuration"})},{index:2,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.dataDescriptionLabel",{defaultMessage:"Data Description"}),hidden:true},{index:3,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.datafeedLabel",{defaultMessage:"Datafeed"})},{index:4,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.editJsonLabel",{defaultMessage:"Edit JSON"})},{index:5,title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabs.dataPreviewLabel",{defaultMessage:"Data Preview"}),hidden:true}],validation:{tabs:[{index:0,valid:true,checks:{jobId:{valid:true},groupIds:{valid:true},modelMemoryLimit:{valid:true}}},{index:1,valid:true,checks:{detectors:{valid:true},influencers:{valid:true},categorizationFilters:{valid:true},bucketSpan:{valid:true}}},{index:2,valid:true,checks:{timeField:{valid:true},timeFormat:{valid:true}}},{index:3,valid:true,checks:{isDatafeed:{valid:true},hasAccessToIndex:{valid:true}}},{index:4,valid:true,checks:{}},{index:5,valid:true,checks:{}}],setTabValid:function setTabValid(tab,valid){$scope.ui.validation.tabs[tab].valid=valid}},cardinalityValidator:{status:0,message:"",STATUS:{FAILED:-1,NOT_RUNNING:0,RUNNING:1,FINISHED:2,WARNING:3}},jsonText:"",changeTab:changeTab,influencers:[],allInfluencers:allInfluencers,customInfluencers:[],tempCustomInfluencer:"",inputDataFormat:[{value:"delimited",title:_i18n.i18n.translate("xpack.ml.newJob.advanced.delimitedLabel",{defaultMessage:"Delimited"})},{value:"json",title:"JSON"}],fieldDelimiterOptions:[{value:"\t",title:_i18n.i18n.translate("xpack.ml.newJob.advanced.tabLabel",{defaultMessage:"tab"})},{value:" ",title:_i18n.i18n.translate("xpack.ml.newJob.advanced.spaceLabel",{defaultMessage:"space"})},{value:",",title:","},{value:";",title:";"},{value:"custom",title:_i18n.i18n.translate("xpack.ml.newJob.advanced.customLabel",{defaultMessage:"custom"})}],selectedFieldDelimiter:",",customFieldDelimiter:"",indexTextOk:false,fieldsUpToDate:false,indices:{},isDatafeed:true,useDedicatedIndex:false,enableModelPlot:false,modelMemoryLimit:"",modelMemoryLimitDefault:jobDefaults.anomaly_detectors.model_memory_limit,datafeed:{queryText:'{"match_all":{}}',queryDelayText:"",queryDelayDefault:"60s",frequencyText:"",frequencyDefault:"",scrollSizeText:"",scrollSizeDefault:1e3,indicesText:"",scriptFields:[]},saveStatus:{job:0}};function init(){_job_service.mlJobService.loadJobs();if(_job_service.mlJobService.currentJob){var jobId=$route.current.params.jobId;$scope.job=_job_service.mlJobService.cloneJob(_job_service.mlJobService.currentJob);if(jobId){$scope.mode=MODE.EDIT;console.log("Editing job",_job_service.mlJobService.currentJob);$scope.ui.pageTitle=_i18n.i18n.translate("xpack.ml.newJob.advanced.editingJobPageTitle",{defaultMessage:"Editing Job {jobId}",values:{jobId:$scope.job.job_id}})}else{if(_job_service.mlJobService.currentJob.job_version===undefined){$scope.mode=MODE.NEW;if($scope.job.results_index_name!==undefined){$scope.ui.useDedicatedIndex=true}}else{$scope.mode=MODE.CLONE;console.log("Cloning job",_job_service.mlJobService.currentJob);$scope.ui.pageTitle=_i18n.i18n.translate("xpack.ml.newJob.advanced.cloneJobFromPageTitle",{defaultMessage:"Clone Job from {jobId}",values:{jobId:$scope.job.job_id}});$scope.job.job_id="";if($scope.job.results_index_name==="shared"){delete $scope.job.results_index_name}else{$scope.ui.useDedicatedIndex=true;$scope.job.results_index_name=""}}setDatafeedUIText();setFieldDelimiterControlsFromText();if(!$scope.job.datafeed_config){$scope.ui.dataLocation="NONE";$scope.ui.influencers=_angular.default.copy($scope.job.analysis_config.influencers)}if($scope.job.analysis_limits&&$scope.job.analysis_limits.model_memory_limit){$scope.ui.modelMemoryLimitText=$scope.job.analysis_limits.model_memory_limit}}_job_service.mlJobService.currentJob=undefined}else{$scope.mode=MODE.NEW;console.log("Creating new job");$scope.job=_job_service.mlJobService.getBlankJob();$scope.job.data_description.format="json";delete $scope.job.data_description.time_format;delete $scope.job.data_description.format;populateFormFromUrl()}loadFields().then(function(){calculateDatafeedFrequencyDefaultSeconds();showDataPreviewTab()}).catch(function(){calculateDatafeedFrequencyDefaultSeconds()})}function checkForConfigUpdates(){var STATUS=$scope.ui.cardinalityValidator.STATUS;var jobModelPlotValue=$scope.job.model_plot_config?$scope.job.model_plot_config:{enabled:false};var modelPlotSettingsEqual=_lodash.default.isEqual(currentConfigs.model_plot_config,jobModelPlotValue);if(!modelPlotSettingsEqual){currentConfigs.model_plot_config.enabled=jobModelPlotValue.enabled;$scope.ui.enableModelPlot=jobModelPlotValue.enabled}if($scope.ui.enableModelPlot===true){var unchanged=_lodash.default.isEqual(currentConfigs.detectors,$scope.job.analysis_config.detectors);if(!unchanged||!modelPlotSettingsEqual){runValidateCardinality()}}else{$scope.ui.cardinalityValidator.status=STATUS.FINISHED;$scope.ui.cardinalityValidator.message=""}}function changeTab(tab){$scope.ui.currentTab=tab.index;if(tab.index===1){checkForConfigUpdates()}else if(tab.index===4){createJSONText()}else if(tab.index===5){if($scope.ui.dataLocation==="ES"){loadDataPreview()}}}$scope.indexChanged=function(){$scope.ui.fieldsUpToDate=false};$scope.loadFields=function(){loadFields().catch(function(){}).then(function(){$scope.$applyAsync()})};function loadFields(){return new Promise(function(resolve,reject){clear($scope.fields);clear($scope.dateFields);clear($scope.catFields);clear($scope.ui.influencers);var index=$scope.ui.datafeed.indicesText;if(index!==""){_ml_api_service.ml.getFieldCaps({index:index}).then(function(resp){$scope.ui.fieldsUpToDate=true;if(resp.fields!==undefined){_lodash.default.each(resp.fields,function(field,fieldName){_lodash.default.each(field,function(type){if(fieldsToIgnore.indexOf(fieldName)===-1){var addField=true;if(fieldName.match(/\.keyword$/)){var keywordLess=fieldName.replace(".keyword");if($scope.fields[keywordLess]!==undefined){delete $scope.fields[keywordLess]}}else if($scope.fields["".concat(fieldName,".keyword")]!==undefined){addField=false}if(addField){$scope.fields[fieldName]=type;if(type.type===_field_types.ML_JOB_FIELD_TYPES.DATE){$scope.dateFields[fieldName]=type}if(type.type===_field_types.ML_JOB_FIELD_TYPES.TEXT||type.type===_field_types.ML_JOB_FIELD_TYPES.KEYWORD){$scope.catFields[fieldName]=type}if(allowedInfluencerTypes.indexOf(type.type)!==-1){$scope.ui.influencers.push(fieldName)}}}})})}var scriptFields=Object.keys(_lodash.default.get($scope.job,"datafeed_config.script_fields",{}));var scriptType={type:"script_fields",searchable:false,aggregatable:true};scriptFields.forEach(function(fieldName){$scope.fields[fieldName]=scriptType});if(Object.keys($scope.fields).length){$scope.ui.indexTextOk=true}validateIndex($scope.ui.validation.tabs);guessTimeField();resolve()}).catch(function(error){$scope.ui.indexTextOk=false;validateIndex($scope.ui.validation.tabs);reject(error)})}else{reject()}})}function guessTimeField(){var currentTimeField=$scope.job.data_description.time_field;if($scope.dateFields[currentTimeField]===undefined){currentTimeField="";$scope.job.data_description.time_field=""}if(currentTimeField===""&&Object.keys($scope.dateFields).length){$scope.job.data_description.time_field=Object.keys($scope.dateFields)[0];console.log("guessTimeField: guessed time fields: ",$scope.job.data_description.time_field)}}$scope.isCurrentJobConfig=false;$scope.$watch("job",function(){$scope.isCurrentJobConfig=false},true);$scope.getJobConfig=function(){getDelimiterSelection();getDatafeedSelection();getAnalysisLimitsSelection();$scope.isCurrentJobConfig=true;return $scope.job};$scope.save=function(){console.log("save() job: ",$scope.job);msgs.clear();getDelimiterSelection();getDatafeedSelection();getAnalysisLimitsSelection();var jobValid=validateJob();if(jobValid.valid){_job_service.mlJobService.loadJobs().then(function(){var tempJob=_job_service.mlJobService.getJob($scope.job.job_id);if(tempJob){var tab=$scope.ui.validation.tabs[0];tab.valid=false;tab.checks.jobId.valid=false;tab.checks.jobId.message=_i18n.i18n.translate("xpack.ml.newJob.advanced.jobAlreadyExistsLabel",{defaultMessage:"'{jobId}' already exists, please choose a different name",values:{jobId:$scope.job.job_id}});changeTab({index:0});$scope.$applyAsync()}else{checkInfluencers()}function checkInfluencers(){if($scope.job.analysis_config.influencers&&$scope.job.analysis_config.influencers.length){saveFunc()}else{mlConfirm.open({message:_i18n.i18n.translate("xpack.ml.newJob.advanced.noInfluencersChosenConfirmModalDescription",{defaultMessage:"You have not chosen any influencers, do you want to continue?"}),title:_i18n.i18n.translate("xpack.ml.newJob.advanced.noInfluencersChosenConfirmModalTitle",{defaultMessage:"No Influencers"})}).then(saveFunc).catch(function(){changeTab({index:1})})}}function saveFunc(){if($scope.ui.useDedicatedIndex){if($scope.job.results_index_name===""){$scope.job.results_index_name=$scope.job.job_id}}else{delete $scope.job.results_index_name}$scope.saveLock=true;$scope.ui.saveStatus.job=1;openSaveStatusWindow();var job=(0,_new_job_utils.createJobForSaving)($scope.job);_job_service.mlJobService.saveNewJob(job).then(function(result){if(result.success){var saveNewDatafeed=function saveNewDatafeed(datafeedConfig,jobId){if(datafeedConfig){_job_service.mlJobService.saveNewDatafeed(datafeedConfig,jobId).then(function(resp){datafeedConfig.datafeed_id=resp.datafeed_id;$scope.saveLock=false}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.couldNotCreateDatafeedErrorMessage",{defaultMessage:"Could not create datafeed:"}),resp);$scope.saveLock=false}).then(function(){$scope.$applyAsync()})}else{$scope.saveLock=false;$scope.$applyAsync()}};msgs.info(_i18n.i18n.translate("xpack.ml.newJob.advanced.newJobAddedNotificationMessage",{defaultMessage:"New Job '{jobId}' added",values:{jobId:result.resp.job_id}}));$scope.ui.saveStatus.job=2;$scope.$applyAsync();_job_service.mlJobService.openJob($scope.job.job_id).then(function(){saveNewDatafeed($scope.job.datafeed_config,$scope.job.job_id)}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.couldNotOpenJobErrorMessage",{defaultMessage:"Could not open job:"}),resp);msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.jobCreatedAndCreatingDatafeedAnywayErrorMessage",{defaultMessage:"Job created, creating datafeed anyway"}));saveNewDatafeed($scope.job.datafeed_config,$scope.job.job_id)})}else{$scope.ui.saveStatus.job=-1;$scope.saveLock=false;msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.unsuccessfulSavingResultErrorMessage",{defaultMessage:"Save failed: {message}",values:{message:result.resp.message}}));$scope.$applyAsync()}}).catch(function(result){$scope.ui.saveStatus.job=-1;$scope.saveLock=false;msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.saveFailedWithMessageErrorMessage",{defaultMessage:"Save failed: {message}",values:{message:result.resp.message}}));$scope.$applyAsync()})}}).catch(function(){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.advanced.saveFailedErrorMessage",{defaultMessage:"Save failed"}));console.log("save(): job validation failed. Jobs list could not be loaded.");$scope.$applyAsync()})}else{msgs.error(jobValid.message);console.log("save(): job validation failed");$scope.$applyAsync()}};$scope.cancel=function(){mlConfirm.open({message:_i18n.i18n.translate("xpack.ml.newJob.advanced.cancelJobCreationConfirmModalDescription",{defaultMessage:"Are you sure you want to cancel job creation?"}),title:_i18n.i18n.translate("xpack.ml.newJob.advanced.cancelJobCreationConfirmModalTitle",{defaultMessage:"Are you sure?"})}).then(function(){msgs.clear();$scope.$applyAsync();$location.path("jobs")})};$scope.cloneJobDataDescriptionCallback=function(){extractCustomInfluencers()};function populateFormFromUrl(){var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;if(indexPattern.id!==undefined){(0,_index_utils.timeBasedIndexCheck)(indexPattern,true);$scope.ui.datafeed.indicesText=indexPattern.title;$scope.job.data_description.time_field=indexPattern.timeFieldName;if(savedSearch.id!==undefined){$scope.ui.datafeed.queryText=JSON.stringify(combinedQuery)}}}$scope.timeFieldSelected=function(){return $scope.job.data_description.time_field===""?false:true};$scope.jsonTextChange=function(){try{$scope.job=JSON.parse($scope.ui.jsonText);$scope.changeJobIDCase();if($scope.jobGroupsUpdateFunction.update!==undefined){$scope.jobGroupsUpdateFunction.update($scope.job.groups)}extractCustomInfluencers();setFieldDelimiterControlsFromText();setDatafeedUIText();setAnalysisLimitsUIText();if($scope.job.results_index_name!==undefined){$scope.ui.useDedicatedIndex=true}else{$scope.ui.useDedicatedIndex=false}}catch(e){console.log("JSON could not be parsed")}};$scope.changeJobIDCase=function(){if($scope.job.job_id){$scope.job.job_id=$scope.job.job_id.toLowerCase()}};$scope.datafeedChange=function(){if($scope.ui.isDatafeed){$scope.job.datafeed_config={};$scope.ui.tabs[2].hidden=true;calculateDatafeedFrequencyDefaultSeconds()}else{delete $scope.job.datafeed_config;$scope.ui.tabs[2].hidden=false;$scope.job.data_description.format="json"}showDataPreviewTab()};$scope.setDedicatedIndex=function(){if($scope.ui.useDedicatedIndex){$scope.job.results_index_name=""}else{delete $scope.job.results_index_name}};function runValidateCardinality(){var STATUS=$scope.ui.cardinalityValidator.STATUS;$scope.ui.cardinalityValidator.status=$scope.ui.cardinalityValidator.STATUS.RUNNING;var tempJob=_job_service.mlJobService.cloneJob($scope.job);_lodash.default.merge(tempJob,(0,_new_job_utils.getMinimalValidJob)());_ml_api_service.ml.validateCardinality(tempJob).then(function(response){var validationResult=(0,_new_job_utils.checkCardinalitySuccess)(response);if(validationResult.success===true){$scope.ui.cardinalityValidator.status=STATUS.FINISHED;$scope.ui.cardinalityValidator.message=""}else{$scope.ui.cardinalityValidator.message=_i18n.i18n.translate("xpack.ml.newJob.advanced.recommendationForUsingModelPlotWithCardinalityDescription",{defaultMessage:"Creating model plots is resource intensive and not recommended "+"where the cardinality of the selected fields is greater than 100. Estimated cardinality "+"for this job is {highCardinality}. "+"If you enable model plot with this configuration "+"we recommend you select a dedicated results index on the Job Details tab.",values:{highCardinality:validationResult.highCardinality}});$scope.ui.cardinalityValidator.status=STATUS.WARNING}}).catch(function(error){console.log("Cardinality check error:",error);$scope.ui.cardinalityValidator.message=_i18n.i18n.translate("xpack.ml.newJob.advanced.cardinalityNotValidErrorMessage",{defaultMessage:"An error occurred validating the configuration "+"for running the job with model plot enabled. "+"Creating model plots can be resource intensive and not recommended "+"where the cardinality of the selected fields is high. "+"You may want to select a dedicated results index on the Job Details tab."});$scope.ui.cardinalityValidator.status=STATUS.FAILED}).then(function(){$scope.$applyAsync()})}$scope.onDetectorsUpdate=function(){var STATUS=$scope.ui.cardinalityValidator.STATUS;if($scope.ui.enableModelPlot===true){currentConfigs.detectors=_lodash.default.cloneDeep($scope.job.analysis_config.detectors);if($scope.job.analysis_config.detectors.length===0){$scope.ui.cardinalityValidator.status=STATUS.FINISHED;$scope.ui.cardinalityValidator.message=""}else{runValidateCardinality()}}};$scope.setModelPlotEnabled=function(){var STATUS=$scope.ui.cardinalityValidator.STATUS;if($scope.ui.enableModelPlot===true){currentConfigs.detectors=_lodash.default.cloneDeep($scope.job.analysis_config.detectors);$scope.job.model_plot_config={enabled:true};currentConfigs.model_plot_config.enabled=true;if($scope.job.analysis_config.detectors.length===0){return}runValidateCardinality()}else{currentConfigs.model_plot_config.enabled=false;$scope.ui.cardinalityValidator.status=STATUS.FINISHED;$scope.ui.cardinalityValidator.message="";delete $scope.job.model_plot_config}};$scope.setAnalysisConfigProperty=function(value,field){if(value===""){delete $scope.job.analysis_config[field]}else{$scope.job.analysis_config[field]=value}};function clear(obj){Object.keys(obj).forEach(function(key){delete obj[key]});if(Array.isArray(obj)){obj.length=0}}function setDatafeedUIText(){if($scope.job.datafeed_config&&Object.keys($scope.job.datafeed_config).length){var datafeedConfig=$scope.job.datafeed_config;$scope.ui.isDatafeed=true;$scope.ui.tabs[2].hidden=true;$scope.ui.dataLocation="ES";showDataPreviewTab();var queryDelayDefault=$scope.ui.datafeed.queryDelayDefault;var queryDelay=datafeedConfig.query_delay;if(datafeedConfig.query_delay===undefined||$scope.ui.datafeed.queryDelayDefault===datafeedConfig.query_delay){queryDelay=""}var frequencyDefault=$scope.ui.datafeed.frequencyDefault;var freq=datafeedConfig.frequency;if(datafeedConfig.frequency===undefined||$scope.ui.datafeed.frequencyDefault===datafeedConfig.frequency){freq=""}var scrollSizeDefault=$scope.ui.datafeed.scrollSizeDefault;var scrollSize=datafeedConfig.scroll_size;if(datafeedConfig.scroll_size===undefined||$scope.ui.datafeed.scrollSizeDefault===datafeedConfig.scroll_size){scrollSize=""}clear($scope.indices);_lodash.default.each(datafeedConfig.indices,function(index){$scope.indices[index]=$scope.ui.indices[index]});var indicesText=datafeedConfig.indices.join(",");var scriptFields=datafeedConfig.script_fields!==undefined?Object.keys(datafeedConfig.script_fields):[];var fieldsUpToDate=true;if(indicesText!==$scope.ui.datafeed.indicesText||_lodash.default.isEqual(scriptFields,$scope.ui.datafeed.scriptFields)===false){fieldsUpToDate=false}$scope.ui.fieldsUpToDate=fieldsUpToDate;$scope.ui.datafeed={queryText:_angular.default.toJson(datafeedConfig.query,true),queryDelayText:queryDelay,queryDelayDefault:queryDelayDefault,frequencyText:freq,frequencyDefault:frequencyDefault,scrollSizeText:scrollSize,scrollSizeDefault:scrollSizeDefault,indicesText:indicesText,scriptFields:scriptFields};if($scope.ui.fieldsUpToDate===false){$scope.loadFields()}}else{$scope.ui.isDatafeed=false;$scope.ui.tabs[2].hidden=false}}function setAnalysisLimitsUIText(){if($scope.job.analysis_limits!==undefined){if($scope.job.analysis_limits.model_memory_limit!==undefined){$scope.ui.modelMemoryLimitText=$scope.job.analysis_limits.model_memory_limit}}}function calculateDatafeedFrequencyDefaultSeconds(){var bucketSpan=(0,_parse_interval.parseInterval)($scope.job.analysis_config.bucket_span);if(bucketSpan!==null){$scope.ui.datafeed.frequencyDefault=(0,_job_utils.calculateDatafeedFrequencyDefaultSeconds)(bucketSpan.asSeconds())+"s"}}$scope.calculateDatafeedFrequencyDefaultSeconds=calculateDatafeedFrequencyDefaultSeconds;function setFieldDelimiterControlsFromText(){if($scope.job.data_description&&$scope.job.data_description.field_delimiter){if($scope.job.data_description.format===undefined){$scope.job.data_description.format="delimited"}var fieldDelimiter=$scope.job.data_description.field_delimiter;$scope.ui.selectedFieldDelimiter="custom";$scope.ui.customFieldDelimiter="";var isCustom=true;for(var i=0;i<$scope.ui.fieldDelimiterOptions.length-1;i++){if($scope.ui.fieldDelimiterOptions[i].value===fieldDelimiter){isCustom=false;$scope.ui.selectedFieldDelimiter=$scope.ui.fieldDelimiterOptions[i].value}}if(isCustom){$scope.ui.customFieldDelimiter=fieldDelimiter}}}function getDelimiterSelection(){if($scope.job.data_description.format==="delimited"){var selectedFieldDelimiter=$scope.ui.selectedFieldDelimiter;if(selectedFieldDelimiter==="custom"){$scope.job.data_description.field_delimiter=$scope.ui.customFieldDelimiter}else{$scope.job.data_description.field_delimiter=selectedFieldDelimiter}}else{delete $scope.job.data_description.field_delimiter;delete $scope.job.data_description.quote_character}}function getAnalysisLimitsSelection(){var ui=$scope.ui;var job=$scope.job;if(ui.modelMemoryLimitText===""||ui.modelMemoryLimitText===null||ui.modelMemoryLimitText===undefined){if(job.analysis_limits!==undefined){delete job.analysis_limits.model_memory_limit;if(Object.keys(job.analysis_limits).length===0){delete job.analysis_limits}}}else{if(job.analysis_limits===undefined){job.analysis_limits={}}job.analysis_limits.model_memory_limit=ui.modelMemoryLimitText}}function getDatafeedSelection(){if($scope.ui.isDatafeed){var df=$scope.ui.datafeed;if(df.queryText===""){df.queryText='{"match_all":{}}'}var query=df.queryText;try{query=JSON.parse(query)}catch(e){console.log("getDatafeedSelection(): could not parse query JSON")}var indices=[];if(df.indicesText){indices=df.indicesText.split(",").map(function(i){return i.trim()})}if(!$scope.job.datafeed_config){$scope.job.datafeed_config={}}var config=$scope.job.datafeed_config;config.query=query;if(df.queryDelayText===""||df.queryDelayText===null||df.queryDelayText===undefined){delete config.query_delay}else{config.query_delay=df.queryDelayText}if(df.frequencyText===""||df.frequencyText===null||df.frequencyText===undefined){delete config.frequency}else{config.frequency=df.frequencyText}if(df.scrollSizeText===""||df.scrollSizeText===null||df.scrollSizeText===undefined){delete config.scroll_size}else{config.scroll_size=df.scrollSizeText}config.indices=indices}}function getCustomUrlSelection(){if($scope.job.custom_settings&&$scope.job.custom_settings.custom_urls){if($scope.job.custom_settings.custom_urls.length===0){delete $scope.job.custom_settings}}}function getCategorizationFilterSelection(){if($scope.job.analysis_config&&$scope.job.analysis_config.categorization_filters){if($scope.job.analysis_config.categorization_filters.length===0){delete $scope.job.analysis_config.categorization_filters}}}function createJSONText(){getDelimiterSelection();getAnalysisLimitsSelection();getDatafeedSelection();getCustomUrlSelection();getCategorizationFilterSelection();$scope.ui.jsonText=_angular.default.toJson($scope.job,true);setTimeout(function(){$scope.$applyAsync()},0)}$scope.addCustomUrl=function(){if(!$scope.job.custom_settings){$scope.job.custom_settings={}}if(!$scope.job.custom_settings.custom_urls){$scope.job.custom_settings.custom_urls=[]}$scope.job.custom_settings.custom_urls.push({url_name:"",url_value:""})};$scope.removeCustomUrl=function(index){$scope.job.custom_settings.custom_urls.splice(index,1)};$scope.addCategorizationFilter=function(){if($scope.job.analysis_config){if(!$scope.job.analysis_config.categorization_filters){$scope.job.analysis_config.categorization_filters=[]}$scope.job.analysis_config.categorization_filters.push("")}};$scope.removeCategorizationFilter=function(index){if($scope.job.analysis_config&&$scope.job.analysis_config.categorization_filters){$scope.job.analysis_config.categorization_filters.splice(index,1)}};$scope.influencerChecked=function(inf){return _lodash.default.contains($scope.job.analysis_config.influencers,inf)};$scope.toggleInfluencer=function(inf){var influencers=$scope.job.analysis_config.influencers;if($scope.influencerChecked(inf)){for(var i=0;i<influencers.length;i++){if(influencers[i]===inf){$scope.job.analysis_config.influencers.splice(i,1)}}}else{$scope.job.analysis_config.influencers.push(inf)}};$scope.addCustomInfluencer=function(){if($scope.ui.tempCustomInfluencer!==""){$scope.ui.customInfluencers.push($scope.ui.tempCustomInfluencer);$scope.ui.tempCustomInfluencer=""}};function extractCustomInfluencers(){var allInfluencersList=$scope.ui.influencers;$scope.ui.customInfluencers=_lodash.default.difference($scope.job.analysis_config.influencers,allInfluencersList);console.log("extractCustomInfluencers: ",$scope.ui.customInfluencers)}function validateJob(){var limits=(0,_new_job_defaults.newJobLimits)();var validationResults=(0,_job_utils.basicJobValidation)($scope.job,$scope.fields,limits);var valid=validationResults.valid;var message=_i18n.i18n.translate("xpack.ml.newJob.advanced.fillInAllrequiredFieldsValidationMessage",{defaultMessage:"Fill in all required fields"});var tabs=$scope.ui.validation.tabs;_lodash.default.each(tabs,function(tab){tab.valid=true;for(var check in tab.checks){if(tab.checks.hasOwnProperty(check)){tab.checks[check].valid=true;tab.checks[check].message=""}}});var job=$scope.job;if(job){if(validationResults.contains("job_id_empty")){tabs[0].checks.jobId.valid=false}else if(validationResults.contains("job_id_invalid")){tabs[0].checks.jobId.valid=false;var msg=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.jobNameAllowedCharactersDescription",{defaultMessage:"Job name can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});tabs[0].checks.jobId.message=msg}if(validationResults.contains("job_group_id_invalid")){tabs[0].checks.groupIds.valid=false;var _msg=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.jobGroupNamesAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});tabs[0].checks.groupIds.message=_msg}if(validationResults.contains("model_memory_limit_units_invalid")){tabs[0].checks.modelMemoryLimit.valid=false;var _msg2=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.modelMemoryLimitUnrecognizedUnitsErrorMessage",{defaultMessage:"Model memory limit data unit unrecognized. It must be {allowedDataUnits} or {allowedDataUnit}",values:{allowedDataUnits:_validation.ALLOWED_DATA_UNITS.slice(0,_validation.ALLOWED_DATA_UNITS.length-1).join(", "),allowedDataUnit:_toConsumableArray(_validation.ALLOWED_DATA_UNITS).pop()}});tabs[0].checks.modelMemoryLimit.message=_msg2}if(validationResults.contains("model_memory_limit_invalid")){tabs[0].checks.modelMemoryLimit.valid=false;var _msg3=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.modelMemoryLimitInvalidRangeErrorMessage",{defaultMessage:"Model memory limit cannot be higher than the maximum value of {maxModelMemoryLimit}",values:{maxModelMemoryLimit:limits.max_model_memory_limit.toUpperCase()}});tabs[0].checks.modelMemoryLimit.message=_msg3}if(validationResults.contains("categorization_filter_invalid")){tabs[1].checks.categorizationFilters.message=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.howToAllowFiltersDescription",{defaultMessage:"{categorizationFieldName} must be set to allow filters",values:{categorizationFieldName:"categorizationFieldName"}});tabs[1].checks.categorizationFilters.valid=false}if(validationResults.contains("detectors_empty")){tabs[1].checks.detectors.valid=false}if(validationResults.contains("detectors_duplicates")){var _msg4=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.duplicateDetectorsFoundErrorMessage",{defaultMessage:"Duplicate detectors were found. Detectors having the same combined configuration for "+"'{function}', '{fieldName}', '{byFieldName}', '{overFieldName}' and '{partitionFieldName}' "+"are not allowed within the same job.",values:{function:"function",fieldName:"field_name",byFieldName:"by_field_name",overFieldName:"over_field_name",partitionFieldName:"partition_field_name"}});tabs[1].checks.detectors.message=_msg4;tabs[1].checks.detectors.valid=false}if(validationResults.contains("influencers_empty")){}if(validationResults.contains("bucket_span_empty")){tabs[1].checks.bucketSpan.message=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.bucketSpanMustBeSetErrorMessage",{defaultMessage:"{bucketSpan} must be set",values:{bucketSpan:"bucket_span"}});tabs[1].checks.bucketSpan.valid=false}else if(validationResults.contains("bucket_span_invalid")){var _msg5=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.bucketSpanInvalidTimeIntervalFormatErrorMessage",{defaultMessage:"{bucketSpan} is not a valid time interval format e.g. {tenMinutes}, {oneHour}. It also needs to be higher than zero.",values:{bucketSpan:job.analysis_config.bucket_span,tenMinutes:"10m",oneHour:"1h"}});tabs[1].checks.bucketSpan.message=_msg5;tabs[1].checks.bucketSpan.valid=false}validateIndex(tabs,function(){return validationResults.contains("index_fields_invalid")})}_lodash.default.each(tabs,function(tab){_lodash.default.each(tab.checks,function(item){if(item.valid===false){tab.valid=false}})});return{valid:valid,message:message}}function validateIndex(tabs){var dataFeedTest=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){return Object.keys($scope.fields).length===0};if(dataFeedTest()){var msg=_i18n.i18n.translate("xpack.ml.newJob.advanced.validateJob.couldNotLoadFieldsFromIndexErrorMessage",{defaultMessage:"Could not load fields from index"});tabs[3].checks.hasAccessToIndex.valid=false;tabs[3].checks.hasAccessToIndex.message=msg;tabs[3].valid=false}else{tabs[3].checks.hasAccessToIndex.valid=true;tabs[3].valid=true}}function openSaveStatusWindow(){$modal.open({template:_save_status_modal.default,controller:"MlSaveStatusModal",backdrop:"static",keyboard:false,size:"sm",resolve:{params:function params(){return{pscope:$scope,openDatafeed:function openDatafeed(){_job_service.mlJobService.currentJob=$scope.job}}}}})}function loadDataPreview(){createJSONText();$scope.ui.dataPreview="";var job=$scope.job;if(job.datafeed_config&&job.datafeed_config.indices.length){_job_service.mlJobService.searchPreview(job).then(function(resp){var data;if(resp.aggregations){data=resp.aggregations.buckets.buckets.slice(0,_job_utils.ML_DATA_PREVIEW_COUNT)}else{data=resp.hits.hits}$scope.ui.dataPreview=_angular.default.toJson(data,true)}).catch(function(resp){$scope.ui.dataPreview=_angular.default.toJson(resp,true)}).then(function(){$scope.$applyAsync()})}else{$scope.ui.dataPreview=_i18n.i18n.translate("xpack.ml.newJob.advanced.dataPreview.datafeedDoesNotExistLabel",{defaultMessage:"Datafeed does not exist"});$scope.$applyAsync()}}function showDataPreviewTab(){var hidden=true;if($scope.ui.isDatafeed){hidden=false}if($scope.ui.dataLocation==="NONE"&&$scope.mode===MODE.CLONE){hidden=true}$scope.ui.tabs[5].hidden=hidden;$scope.$applyAsync()}function allInfluencers(){var influencers=$scope.ui.influencers.concat($scope.ui.customInfluencers);influencers=_lodash.default.uniq(influencers);return _lodash.default.sortBy(influencers,function(inf){return inf})}$scope.aceLoaded=function(editor){$scope.$applyAsync();if(editor.container.id==="datafeed-preview"){editor.setReadOnly(true)}};init()})},,function(module,exports){module.exports='<ml-nav-menu name="new_job_advanced"></ml-nav-menu>\n<ml-new-job class="ml-new-job euiPage euiPage--widthIsNotRestricted">\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlNewJob" class="euiPageBody">\n    <div class="euiPanel euiPanel--paddingLarge euiPageContent">\n      <div class="euiPageContentHeader">\n        <div class="euiPageContentHeaderSection">\n          <h3 class="euiTitle euiTitle--large">{{ui.pageTitle}}</h3>\n        </div>\n      </div>\n      <div class="euiPageContentBody">\n        <ul class="nav nav-tabs">\n          <li\n            class="kbn-settings-tab"\n            ng-class="{ active: ui.currentTab === tab.index }"\n            ng-repeat="tab in ui.tabs"\n            ng-hide="ui.tabs[{{tab.index}}].hidden">\n\n            <a ng-click="ui.changeTab(tab)">\n              {{ tab.title }}\n              <i ng-hide=\'ui.validation.tabs[tab.index].valid\' class=\'validation-error fa fa-exclamation-circle\' />\n            </a>\n          </li>\n        </ul>\n\n        \x3c!-- tab 0 Job Details --\x3e\n        <ml-job-tab-0 class="tab" ng-show="ui.currentTab === 0">\n          <div class="tab_contents">\n            \x3c!-- ID --\x3e\n            <div class="form-group">\n              <ml-form-label label-id="new_job_id" tooltip-append-to-body="true">\n                {{ ::\'xpack.ml.newJob.advanced.jobDetails.nameLabel\' | i18n: {defaultMessage: \'Name\'} }}\n              </ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_id"\n                aria-describedby="ml_aria_description_new_job_id"\n                ng-model="job.job_id"\n                required\n                placeholder="{{ ::\'xpack.ml.newJob.advanced.jobDetails.jobIdPlaceholder\' | i18n: {defaultMessage: \'Job ID\'} }}"\n                ng-change="changeJobIDCase()"\n                input-focus\n                class="form-control lowercase" />\n              <div\n                ng-hide="ui.validation.tabs[0].checks.jobId.valid"\n                class="validation-error"\n                >{{ ( ui.validation.tabs[0].checks.jobId.message || enterJobNameLabel ) }}</div>\n            </div>\n            \x3c!-- description --\x3e\n            <div class="form-group">\n              <ml-form-label label-id="new_job_description">\n                  {{ ::\'xpack.ml.newJob.advanced.jobDetails.descriptionLabel\' | i18n: {defaultMessage: \'Description\'} }}\n              </ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_description"\n                aria-describedby="ml_aria_description_new_job_description"\n                ng-model="job.description"\n                placeholder="{{ ::\'xpack.ml.newJob.advanced.jobDetails.jobDescriptionPlaceholder\' | i18n: {defaultMessage: \'Job description\'} }}"\n                class="form-control" />\n            </div>\n\n            <div class="form-group">\n              <ml-form-label label-id="new_job_group">\n                {{ ::\'xpack.ml.newJob.advanced.jobDetails.jobGroupsLabel\' | i18n: {defaultMessage: \'Job Groups\'} }}\n              </ml-form-label>\n              <ml-job-group-select\n                aria-labelledby="ml_aria_label_new_job_group"\n                aria-describedby="ml_aria_description_new_job_group"\n                job-groups=\'job.groups\'\n                external-update-function=\'jobGroupsUpdateFunction\' />\n              <div ng-hide="ui.validation.checks.groupIds.valid" class="validation-error">{{ ui.validation.tabs[0].checks.groupIds.message }}</div>\n            </div>\n\n            <div class="form-group">\n              <label\n                class="kuiFormLabel"\n                i18n-id="xpack.ml.newJob.advanced.jobDetails.customUrlsLabel"\n                i18n-default-message="Custom URLs"\n              ></label><i ml-info-icon="new_job_custom_urls" />\n              <div class="euiSpacer euiSpacer--s"></div>\n              <div ng-if="job.custom_settings && job.custom_settings.custom_urls">\n                <div ng-repeat="item in job.custom_settings.custom_urls track by $index" class="custom-url">\n                  <div class="field-cols">\n\n                    <div class="form-group">\n                      <label\n                        class="kuiFormLabel"\n                        id="ml_aria_label_custom_url_label_{{$index}}"\n                        i18n-id="xpack.ml.newJob.advanced.jobDetails.labelLabel"\n                        i18n-default-message="Label"\n                      ></label>\n                      <input\n                        aria-labelledby="ml_aria_label_custom_url_label_{{$index}}"\n                        ng-model="item.url_name"\n                        type="text"\n                        class="form-control" />\n                    </div>\n                  </div>\n\n                  <div class="field-cols">\n                    <div class="form-group">\n                      <label\n                        class="kuiFormLabel"\n                        id="ml_aria_label_custom_url_{{$index}}"\n                        i18n-id="xpack.ml.newJob.advanced.jobDetails.urlLabel"\n                        i18n-default-message="URL"\n                      ></label>\n                      <textarea\n                        aria-labelledby="ml_aria_label_custom_url_{{$index}}"\n                        ng-model="item.url_value"\n                        type="text"\n                        class="form-control" ></textarea>\n                    </div>\n                  </div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.advanced.jobDetails.removeCustomUrlButtonAriaLabel\' | i18n: {defaultMessage: \'Remove Custom URL\'} }}"\n                    ng-click="removeCustomUrl($index)"\n                    tooltip-append-to-body="true"\n                    type="button"\n                    class="kuiButton kuiButton--danger kuiButton--small remove-button">\n                      <i aria-hidden="true" class="fa fa-times" />\n                  </button>\n                </div>\n              </div>\n              <div>\n                <button\n                  aria-labelledby="ml_aria_label_new_job_custom_urls"\n                  aria-describedby="ml_aria_description_new_job_custom_urls"\n                  ng-click="addCustomUrl()"\n                  type="button"\n                  class="kuiButton kuiButton--primary kuiButton--small">\n                  <i aria-hidden="true" class="fa fa-plus" />\n                  <span\n                    id="ml_aria_label_new_job_custom_urls"\n                    i18n-id="xpack.ml.newJob.advanced.jobDetails.addCustomUrlButtonLabel"\n                    i18n-default-message="Add Custom URL"\n                  ></span>\n                </button>\n              </div>\n\n            </div>\n\n            <div class="form-group">\n              <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                <input type="checkbox"\n                  aria-labelledby="ml_aria_label_new_job_dedicated_index"\n                  aria-describedby="ml_aria_description_new_job_dedicated_index"\n                  class=\'kuiCheckBox\'\n                  ng-change="setDedicatedIndex()"\n                  ng-model ="ui.useDedicatedIndex" />\n                <span class=\'kuiCheckBoxLabel__text\'>\n                  <span\n                    id="ml_aria_label_new_job_dedicated_index"\n                    i18n-id="xpack.ml.newJob.advanced.jobDetails.useDedicatedIndexLabel"\n                    i18n-default-message="Use dedicated index"\n                  ></span>\n                  <i ml-info-icon="new_job_dedicated_index" />\n                </span>\n              </label>\n            </div>\n\n            <div class="form-group">\n              <ml-form-label label-id="new_job_model_memory_limit">\n                {{ ::\'xpack.ml.newJob.advanced.jobDetails.modelMemoryLimitLabel\' | i18n: {defaultMessage: \'Model memory limit\'} }}\n              </ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_model_memory_limit"\n                aria-describedby="ml_aria_description_new_job_model_memory_limit"\n                ng-model="ui.modelMemoryLimitText"\n                placeholder="{{ui.modelMemoryLimitDefault}}"\n                class="form-control" />\n              <div ng-hide="ui.validation.tabs[0].checks.modelMemoryLimit.valid" class="validation-error">{{ ui.validation.tabs[0].checks.modelMemoryLimit.message }}</div>\n            </div>\n\n          </div>\n        </ml-job-tab-0>\n\n        \x3c!-- tab2 1 Analysis Configuration --\x3e\n        <ml-job-tab-1 ng-show="ui.currentTab === 1">\n          <div class="tab_contents">\n            <div class="form-group">\n              <ml-form-label label-id="new_job_bucketspan">bucket_span</ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_bucketspan"\n                aria-describedby="ml_aria_description_new_job_bucketspan"\n                type="text"\n                ng-model="job.analysis_config.bucket_span"\n                placeholder=""\n                ng-change="calculateDatafeedFrequencyDefaultSeconds()"\n                class="form-control" />\n              <div ng-hide="ui.validation.tabs[1].checks.bucketSpan.valid" class="validation-error">\n                {{ ( ui.validation.tabs[1].checks.bucketSpan.message || bucketSpanNotValidFormatLabel ) }}\n              </div>\n            </div>\n            <div class="form-group">\n              <ml-form-label label-id="new_job_summarycountfieldname">summary_count_field_name</ml-form-label>\n              <field-select\n                label-id=\'"new_job_summarycountfieldname"\'\n                on-change=\'setAnalysisConfigProperty\'\n                value=\'job.analysis_config.summary_count_field_name\'\n                field=\'"summary_count_field_name"\'\n                options=\'fields\'>\n              </field-select>\n            </div>\n            <div class="form-group">\n              <ml-form-label label-id="new_job_categorizationfieldname">categorization_field_name</ml-form-label>\n              <field-select\n                label-id=\'"new_job_categorizationfieldname"\'\n                on-change=\'setAnalysisConfigProperty\'\n                value=\'job.analysis_config.categorization_field_name\'\n                field=\'"categorization_field_name"\'\n                options=\'catFields\'>\n              </field-select>\n            </div>\n\n            <div class="form-group"\n              ng-show="(job.analysis_config.categorization_field_name !== undefined && job.analysis_config.categorization_field_name !== \'\') ||\n                       (job.analysis_config.categorization_filters && job.analysis_config.categorization_filters.length)">\n\n              <label\n                class="kuiFormLabel"\n                aria-describedby="ml_aria_description_new_job_categorizationfilters"\n                i18n-id="xpack.ml.newJob.advanced.analysisConfiguration.categorizationFiltersLabel"\n                i18n-default-message="Categorization Filters"\n              ></label>\n              <i ml-info-icon="new_job_categorizationfilters" />\n              <div class="euiSpacer euiSpacer--s"></div>\n              <div ng-if="job.analysis_config && job.analysis_config.categorization_filters">\n                <div ng-repeat="item in job.analysis_config.categorization_filters track by $index" class="categorization-filter">\n                  <div class="field-cols">\n\n                    <div class="form-group">\n                      <input\n                        aria-label="{{ ::\'xpack.ml.newJob.advanced.analysisConfiguration.categorizationFilterRegularExpressionAriaLabel\' | i18n: {defaultMessage: \'Categorization filter regular expression\'} }}"\n                        ng-model="job.analysis_config.categorization_filters[$index]"\n                        type="text"\n                        class="form-control" />\n                    </div>\n                  </div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.advanced.analysisConfiguration.removeCategorizationFilterButtonAriaLabel\' | i18n: {defaultMessage: \'Remove categorization filter\'} }}"\n                    ng-click="removeCategorizationFilter($index)"\n                    tooltip-append-to-body="true"\n                    type="button"\n                    class="kuiButton kuiButton--danger kuiButton--small remove-button">\n                      <i aria-hidden="true" class="fa fa-times" />\n                  </button>\n                </div>\n              </div>\n              <div>\n                <button\n                  aria-labelledby="ml_aria_label_add_categorization_filter"\n                  ng-click="addCategorizationFilter()"\n                  type="button"\n                  ng-disabled="job.analysis_config.categorization_field_name === undefined || job.analysis_config.categorization_field_name === \'\'"\n                  class="kuiButton kuiButton--primary kuiButton--small">\n                  <i aria-hidden="true" class="fa fa-plus" />\n                  <span\n                    id="ml_aria_label_add_categorization_filter"\n                    i18n-id="xpack.ml.newJob.advanced.analysisConfiguration.addCategorizationFilterButtonLabel"\n                    i18n-default-message="Add Categorization Filter"\n                  ></span>\n                </button>\n              </div>\n            </div>\n            <div ng-hide="ui.validation.tabs[1].checks.categorizationFilters.valid" class="validation-error">\n              {{ ( ui.validation.tabs[1].checks.categorizationFilters.message || categorizationFiltersNotValidLabel ) }}\n            </div>\n\n            <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n            <label\n              class="kuiFormLabel"\n              aria-describedby="ml_aria_description_new_job_detectors"\n              i18n-id="xpack.ml.newJob.advanced.analysisConfiguration.detectorsLabel"\n              i18n-default-message="Detectors"\n            ></label>\n            <i ml-info-icon="new_job_detectors" />\n\n            <div class="euiSpacer euiSpacer--s"></div>\n\n            <div ml-job-detectors-list\n              ml-detectors="job.analysis_config.detectors"\n              ml-indices="indices"\n              ml-fields="fields"\n              ml-cat-field-name-selected="(job.analysis_config.categorization_field_name?true:false)"\n              ml-edit-mode="\'NEW\'"\n              ml-on-detectors-update="onDetectorsUpdate"\n              ></div>\n            <div ng-hide="ui.validation.tabs[1].checks.detectors.valid" class="validation-error">\n              {{ ( ui.validation.tabs[1].checks.detectors.message || detectorNotConfiguredLabel ) }}\n            </div>\n\n            <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n            <label\n              class="kuiFormLabel"\n              aria-describedby="ml_aria_description_new_job_influencers"\n              i18n-id="xpack.ml.newJob.advanced.analysisConfiguration.influencersLabel"\n              i18n-default-message="Influencers"\n            ></label>\n            <i ml-info-icon="new_job_influencers" />\n            <div class="influencer-list-container">\n\n              <div ng-repeat="inf in ui.allInfluencers()" >\n                <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                  <input class=\'kuiCheckBox\' type="checkbox" ng-checked="influencerChecked(inf)" ng-click="toggleInfluencer(inf)" />\n                  <span class=\'kuiCheckBoxLabel__text\'>{{inf}}</span>\n                </label>\n              </div>\n\n              <div class="custom-influencer">\n                <input\n                  type="text"\n                  ng-model="ui.tempCustomInfluencer"\n                  placeholder="{{ ::\'xpack.ml.newJob.advanced.analysisConfiguration.customInfluencerPlaceholder\' | i18n: {defaultMessage: \'Custom influencer\'} }}"\n                  class="form-control"  />\n                <button\n                  aria-label="{{ ::\'xpack.ml.newJob.advanced.analysisConfiguration.addCustomInfluencerButtonAriaLabel\' | i18n: {defaultMessage: \'Add Custom Influencer\'} }}"\n                  ng-click="addCustomInfluencer()"\n                  ng-disabled="ui.tempCustomInfluencer===\'\'"\n                  type="button"\n                  class="kuiButton kuiButton--primary kuiButton--small"\n                  i18n-id="xpack.ml.newJob.advanced.analysisConfiguration.addLabel"\n                  i18n-default-message="{icon} Add"\n                  i18n-values="{ html_icon: \'<i aria-hidden=\\\'true\\\' class=\\\'fa fa-plus\\\' />\' }"\n                ></button>\n              </div>\n            </div>\n            <div ng-hide="ui.validation.tabs[1].checks.influencers.valid" class="validation-error">\n              {{ ( ui.validation.tabs[1].checks.influencers.message || influencerNotSelectedLabel ) }}\n            </div>\n\n            <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n            <div class="form-group">\n              <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                <input\n                  type="checkbox"\n                  aria-labelledby="ml_aria_label_new_job_enable_model_plot"\n                  aria-describedby="ml_aria_description_new_job_enable_model_plot"\n                  class=\'kuiCheckBox\'\n                  ng-change="setModelPlotEnabled()"\n                  ng-model="ui.enableModelPlot" />\n                <span class=\'kuiCheckBoxLabel__text\'>\n                  <span id="ml_aria_label_new_job_enable_model_plot">\n                    {{ ui.cardinalityValidator.status === ui.cardinalityValidator.STATUS.RUNNING ? validatingCardinalityLabel : enableModelPlotLabel }}\n                  </span>\n                  <i ml-info-icon="new_job_enable_model_plot" />\n                </span>\n              </label>\n              <div class=\'ml-new-job-callout kuiVerticalRhythm\'>\n                <ml-enable-model-plot-callout\n                  message=\'ui.cardinalityValidator.message\'\n                  ng-show="ui.cardinalityValidator.status === ui.cardinalityValidator.STATUS.WARNING ||\n                    ui.cardinalityValidator.status === ui.cardinalityValidator.STATUS.FAILED">\n                </ml-enable-model-plot-callout>\n              </div>\n            </div>\n          </div>\n        </ml-job-tab-1>\n\n\n        \x3c!-- tab 2 Data Description --\x3e\n        <ml-job-tab-2 ng-show="ui.currentTab === 2">\n          <div class="tab_contents">\n            <div class="form-group">\n              <ml-form-label label-id="new_job_data_format">\n                {{ ::\'xpack.ml.newJob.advanced.dataDescription.dataFormatLabel\' | i18n: {defaultMessage: \'Data format\'} }}\n              </ml-form-label>\n              <select\n                aria-labelledby="ml_aria_label_new_job_data_format"\n                aria-describedby="ml_aria_description_new_job_data_format"\n                ng-model="job.data_description.format"\n                ng-disabled="ui.isDatafeed"\n                ng-options="item.value as item.title for item in ui.inputDataFormat"\n                class="form-control">\n              </select>\n            </div>\n            <ml-job-delimited-options ng-show="job.data_description.format===\'delimited\'">\n              <div class="form-group">\n                <ml-form-label label-id="new_job_delimiter">\n                  {{ ::\'xpack.ml.newJob.advanced.dataDescription.delimiterLabel\' | i18n: {defaultMessage: \'Delimiter\'} }}\n                </ml-form-label>\n                <select\n                  aria-labelledby="ml_aria_label_new_job_delimiter"\n                  aria-describedby="ml_aria_description_new_job_delimiter"\n                  ng-model="ui.selectedFieldDelimiter"\n                  ng-options="item.value as item.title for item in ui.fieldDelimiterOptions"\n                  class="form-control" />\n              </div>\n              <div class="form-group">\n                <input\n                  ng-model="ui.customFieldDelimiter"\n                  ng-show="ui.selectedFieldDelimiter===\'custom\'"\n                  ng-required="job.data_description.format===\'delimited\' && ui.selectedFieldDelimiter===\'custom\'"\n                  class="form-control" />\n              </div>\n              <div class="form-group">\n                <ml-form-label label-id="new_job_quote_character">\n                  {{ ::\'xpack.ml.newJob.advanced.dataDescription.quoteCharacterLabel\' | i18n: {defaultMessage: \'Quote character\'} }}\n                </ml-form-label>\n                <input\n                  aria-labelledby="ml_aria_label_new_job_quote_character"\n                  aria-describedby="ml_aria_description_new_job_quote_character"\n                  ng-model="job.data_description.quote_character"\n                  ng-required="job.data_description.format===\'delimited\'"\n                  placeholder=""\n                  class="form-control" />\n              </div>\n            </ml-job-delimited-options>\n\n            <div class="form-group">\n              <ml-form-label label-id="new_job_time_field">\n                {{ ::\'xpack.ml.newJob.advanced.dataDescription.timeFieldLabel\' | i18n: {defaultMessage: \'Time field\'} }}\n              </ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_time_field"\n                aria-describedby="ml_aria_description_new_job_time_field"\n                ng-model="job.data_description.time_field"\n                required\n                placeholder=""\n                class="form-control" />\n              <div ng-hide="ui.validation.tabs[2].checks.timeField.valid" class="validation-error">\n                {{ ( ui.validation.tabs[2].checks.timeField.message || specifyTimeFieldLabel ) }}\n              </div>\n            </div>\n\n            <div class="form-group">\n              <ml-form-label label-id="new_job_time_format">\n                {{ ::\'xpack.ml.newJob.advanced.dataDescription.timeFormatLabel\' | i18n: {defaultMessage: \'Time format\'} }}\n              </ml-form-label>\n              <input\n                aria-labelledby="ml_aria_label_new_job_time_format"\n                aria-describedby="ml_aria_description_new_job_time_format"\n                ng-model="job.data_description.time_format"\n                required\n                placeholder=""\n                class="form-control" />\n              <div ng-hide="ui.validation.tabs[2].checks.timeFormat.valid" class="validation-error">\n                {{ ( ui.validation.tabs[2].checks.timeFormat.message || specifyTimeFormatLabel ) }}\n              </div>\n              <div\n                ng-if="exampleTime"\n                class="time-example"\n                i18n-id="xpack.ml.newJob.advanced.dataDescription.exampleTimeDescription"\n                i18n-default-message="e.g. {exampleTime}"\n                i18n-values="{ exampleTime }"\n              ></div>\n            </div>\n          </div>\n        </ml-job-tab-2>\n\n        \x3c!-- tab 3 Datafeed --\x3e\n        <ml-job-tab-3 ng-show="ui.currentTab === 3">\n          <div class="tab_contents">\n            <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n              <input\n                aria-labelledby="ml_aria_label_new_job_enable_datafeed_job"\n                aria-describedby="ml_aria_description_new_job_enable_datafeed_job"\n                class=\'kuiCheckBox\'\n                ng-model="ui.isDatafeed"\n                ng-change="datafeedChange()"\n                ng-disabled="job.data_description.format!==\'json\'"\n                type="checkbox" />\n              <span class=\'kuiCheckBoxLabel__text\'>\n                <span\n                  id="ml_aria_label_new_job_enable_datafeed_job"\n                  i18n-id="xpack.ml.newJob.advanced.datafeed.datafeedJobLabel"\n                  i18n-default-message="Datafeed job"\n                ></span>\n                <i ml-info-icon="new_job_enable_datafeed_job" />\n              </span>\n            </label>\n            <div class="euiSpacer euiSpacer--s"></div>\n            <div class="form-group help-pane" ng-show="job.data_description.format!==\'json\' && job.data_description.format!==undefined">\n              <small\n                class="info"\n                i18n-id="xpack.ml.newJob.advanced.datafeed.enableDatafeedDescription"\n                i18n-default-message="Data format must be set to \'JSON\' to enable the datafeed."\n              ></small>\n            </div>\n\n            <div ng-if="ui.isDatafeed">\n              <div class="form-group">\n                <ml-form-label label-id="new_job_datafeed_query" tooltip-append-to-body="true">\n                  {{ ::\'xpack.ml.newJob.advanced.datafeed.queryLabel\' | i18n: {defaultMessage: \'Query\'} }}\n                </ml-form-label>\n                <input\n                  aria-labelledby="ml_aria_label_new_job_datafeed_query"\n                  aria-describedby="ml_aria_description_new_job_datafeed_query"\n                  ng-model="ui.datafeed.queryText"\n                  placeholder=\'{ "match_all": {}}\'\n                  class="form-control" />\n\n              </div>\n              <div class="form-group" >\n                <ml-form-label label-id="new_job_datafeed_query_delay">\n                  {{ ::\'xpack.ml.newJob.advanced.datafeed.queryDelayLabel\' | i18n: {defaultMessage: \'Query delay\'} }}\n                </ml-form-label>\n                <input\n                  aria-labelledby="ml_aria_label_new_job_datafeed_query_delay"\n                  aria-describedby="ml_aria_description_new_job_datafeed_query_delay"\n                  ng-model="ui.datafeed.queryDelayText"\n                  placeholder="{{ui.datafeed.queryDelayDefault}}"\n                  min="0"\n                  class="form-control" />\n\n              </div>\n              <div class="form-group" >\n                <ml-form-label label-id="new_job_datafeed_frequency">\n                  {{ ::\'xpack.ml.newJob.advanced.datafeed.frequencyLabel\' | i18n: {defaultMessage: \'Frequency\'} }}\n                </ml-form-label>\n                <input\n                  aria-labelledby="ml_aria_label_new_job_datafeed_frequency"\n                  aria-describedby="ml_aria_description_new_job_datafeed_frequency"\n                  ng-model="ui.datafeed.frequencyText"\n                  placeholder="{{ui.datafeed.frequencyDefault}}"\n                  min="0"\n                  class="form-control" />\n\n              </div>\n              <div class="form-group" >\n                <ml-form-label label-id="new_job_datafeed_scrollsize" tooltip-append-to-body="true">scroll_size</ml-form-label>\n                <input\n                  aria-labelledby="ml_aria_label_new_job_datafeed_scrollsize"\n                  aria-describedby="ml_aria_description_new_job_datafeed_scrollsize"\n                  ng-model="ui.datafeed.scrollSizeText"\n                  placeholder="{{ui.datafeed.scrollSizeDefault}}"\n                  type="number"\n                  min="0"\n                  class="form-control" />\n\n              </div>\n              <div class="form-group" >\n                <div class="form-group">\n                  <label\n                    class="kuiFormLabel"\n                    i18n-id="xpack.ml.newJob.advanced.datafeed.indexLabel"\n                    i18n-default-message="Index"\n                  ></label>\n                  <div class="input-group">\n                  <input\n                    ng-model="ui.datafeed.indicesText"\n                    placeholder=""\n                    class="form-control"\n                    aria-describedby="index-text-status"\n                    ng-change="indexChanged()"\n                    list=\'index_datalist\' />\n                    <span class="input-group-addon" id="index-text-status">\n                      <i ng-show="ui.indexTextOk === true && ui.fieldsUpToDate === true" aria-hidden="true" style=\'color:green;\' class="fa fa-check"></i>\n                      <i ng-show="ui.indexTextOk === false || ui.fieldsUpToDate === false" aria-hidden="true" style=\'color:red;\' class="fa fa-remove"></i>\n                    </span>\n                  </div>\n                  <div ng-hide="ui.validation.tabs[3].checks.hasAccessToIndex.valid"  class="validation-error">{{ ( ui.validation.tabs[3].checks.hasAccessToIndex.message) }}</div>\n                </div>\n                <div class="form-group" ng-show="ui.fieldsUpToData === false || ui.fieldsUpToDate === false">\n                  <button\n                    ng-click="loadFields()"\n                    type="button"\n                    class="kuiButton kuiButton--primary kuiButton--small">\n                    <i aria-hidden="true" class="fa fa-refresh"></i>\n                    <span\n                      i18n-id="xpack.ml.newJob.advanced.datafeed.reloadIndexButtonLabel"\n                      i18n-default-message="Reload index"\n                    ></span>\n                  </button>\n                </div>\n\n                <div ng-show="ui.indexTextOk && ui.fieldsUpToDate === true" class="form-group">\n                  <label\n                    class="kuiFormLabel"\n                    i18n-id="xpack.ml.newJob.advanced.datafeed.timeFieldNameLabel"\n                    i18n-default-message="Time-field name"\n                  ></label>\n                  <select\n                    ng-model="job.data_description.time_field"\n                    class="form-control">\n                    <option ng-repeat="(key, value) in dateFields">{{key}}</option>\n                  </select>\n                </div>\n\n                <div class="clearfix"></div>\n\n              </div>\n            </div>\n          </div>\n        </ml-job-tab-3>\n\n        \x3c!-- tab 4 Edit JSON --\x3e\n        <ml-job-tab-4 ng-show="ui.currentTab === 4" class="ml_json_tab">\n          <div class="tab_contents">\n            <label\n              class="kuiFormLabel"\n              id="ml_aria_label_new_job_json"\n              i18n-id="xpack.ml.newJob.advanced.json.jsonLabel"\n              i18n-default-message="JSON"\n            ></label>\n            <div\n              class="form-control json-textarea"\n              ui-ace="{\n                mode: \'json\',\n                onChange: jsonTextChange\n              }"\n              ng-model="ui.jsonText"\n              ></div>\n          </div>\n        </ml-job-tab-4>\n\n        \x3c!-- tab 5 Data preview --\x3e\n        <ml-job-tab-5 ng-show="ui.currentTab === 5" class="ml_data_preview_tab">\n          <div class="tab_contents">\n            <ml-form-label label-id="new_job_data_preview">\n              {{ ::\'xpack.ml.newJob.advanced.dataPreview.dataPreviewLabel\' | i18n: {defaultMessage: \'Data preview\'} }}\n            </ml-form-label>\n            <ml-loading-indicator\n              label="{{ ::\'xpack.ml.newJob.advanced.dataPreview.loadingDataPreviewLabel\' | i18n: {defaultMessage: \'Loading data preview\'} }}"\n              is-loading="(ui.dataPreview === \'\')"\n            />\n            <div ng-hide="(ui.dataPreview === \'\')">\n              <div\n                id="datafeed-preview"\n                class="form-control json-textarea"\n                ui-ace="{\n                  mode: \'json\',\n                  onLoad: aceLoaded\n                }"\n                ng-model="ui.dataPreview"\n                ></div>\n                <div\n                  class="note"\n                  i18n-id="xpack.ml.newJob.advanced.dataPreview.previewContentReturnedDescription"\n                  i18n-default-message="Preview returns the content of the {source} field only."\n                  i18n-values="{ source: \'_source\' }"\n                ></div>\n            </div>\n          </div>\n        </ml-job-tab-5>\n\n        <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n        <div class="euiFlexGroup euiFlexGroup--gutterSmall euiFlexGroup--alignItemsCenter euiFlexGroup--responsive">\n          <div class="euiFlexItem euiFlexItem--flexGrowZero">\n            <ml-validate-job\n              fields="fields"\n              fill="false"\n              get-job-config="getJobConfig"\n              is-current-job-config="isCurrentJobConfig"\n              is-disabled="(saveLock === true)"\n              ng-show="jobState === JOB_STATE.NOT_STARTED"\n            />\n          </div>\n          <div class="euiFlexItem euiFlexItem--flexGrowZero">\n            <button\n              ng-click="save()"\n              ng-disabled="(saveLock === true)"\n              class="euiButton euiButton--primary euiButton--small euiButton--fill"\n              aria-label="{{ ::\'xpack.ml.newJob.advanced.saveButtonAriaLabel\' | i18n: {defaultMessage: \'Save\'} }}">\n              <span class="euiButton__content">\n                <span\n                  i18n-id="xpack.ml.newJob.advanced.saveButtonLabel"\n                  i18n-default-message="Save"\n                ></span>\n              </span>\n            </button>\n          </div>\n          <div class="euiFlexItem euiFlexItem--flexGrowZero">\n            <button\n              ng-click="cancel()"\n              ng-disabled="(saveLock === true)"\n              class="euiButton euiButton--primary euiButton--small euiButton--fill"\n              aria-label="{{ ::\'xpack.ml.newJob.advanced.cancelButtonAriaLabel\' | i18n: {defaultMessage: \'Cancel\'} }}">\n              <span class="euiButton__content">\n                <span\n                  i18n-id="xpack.ml.newJob.advanced.cancelButtonLabel"\n                  i18n-default-message="Cancel"\n                ></span>\n              </span>\n            </button>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n</ml-new-job>\n'},function(module,exports){module.exports='<div class="save-status-modal">\n  \x3c!-- <ml-message-bar ></ml-message-bar> --\x3e\n  <h3\n    class="euiTitle euiTitle--small"\n    i18n-id="xpack.ml.newJob.advanced.saveStatusModal.savingNewJobTitle"\n    i18n-default-message="Saving new job"\n  ></h3>\n  <div class="status-item">\n    <span\n      i18n-id="xpack.ml.newJob.advanced.saveStatusModal.savingJobLabel"\n      i18n-default-message="Saving job…"\n    ></span>\n    <i ng-show="pscope.ui.saveStatus.job === -1" aria-hidden="true" style="color:red;" class="fa fa-remove"></i>\n    <i ng-show="pscope.ui.saveStatus.job === 1" aria-hidden="true" class="fa fa-spinner fa-spin"></i>\n    <i ng-show="pscope.ui.saveStatus.job === 2" aria-hidden="true" style="color:green;" class="fa fa-check"></i>\n  </div>\n\n  <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n  <button\n    ng-show="(pscope.ui.saveStatus.job === 2 && pscope.ui.isDatafeed)"\n    ng-disabled="pscope.saveLock"\n    ng-click="openDatafeed();"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.saveStatusModal.startDatafeedButtonAriaLabel\' | i18n: {defaultMessage: \'Back\'} }}"\n    i18n-id="xpack.ml.newJob.advanced.saveStatusModal.startDatafeedButtonLabel"\n    i18n-default-message="Start datafeed"\n  ></button>\n\n  <button\n    ng-disabled="pscope.saveLock"\n    ng-click="close();"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.saveStatusModal.closeButtonAriaLabel\' | i18n: {defaultMessage: \'Back\'} }}"\n    i18n-id="xpack.ml.newJob.advanced.saveStatusModal.closeButtonLabel"\n    i18n-default-message="Close"\n  ></button>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _angular=_interopRequireDefault(__webpack_require__(26));var _i18n=__webpack_require__(4);var _lodash=_interopRequireDefault(__webpack_require__(3));__webpack_require__(2846);__webpack_require__(2851);var _string_utils=__webpack_require__(67);var _detectors_list=_interopRequireDefault(__webpack_require__(2853));var _detector_modal2=_interopRequireDefault(__webpack_require__(2854));var _detector_filter_modal2=_interopRequireDefault(__webpack_require__(2855));var _job_service=__webpack_require__(36);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlJobDetectorsList",function($modal){return{restrict:"AE",replace:true,scope:{detectors:"=mlDetectors",indices:"=mlIndices",fields:"=mlFields",catFieldNameSelected:"=mlCatFieldNameSelected",editMode:"=mlEditMode",onUpdate:"=mlOnDetectorsUpdate"},template:_detectors_list.default,controller:function controller($scope){$scope.addDetector=function(dtr,index){if(dtr!==undefined){if(index>=0){$scope.detectors[index]=dtr}else{$scope.detectors.push(dtr)}$scope.onUpdate()}};$scope.removeDetector=function(index){$scope.detectors.splice(index,1);$scope.onUpdate()};$scope.editDetector=function(index){$scope.openNewWindow(index)};$scope.info=function(){};$scope.addFilter=function(dtr,filter,filterIndex){if(dtr.rules===undefined){dtr.rules=[]}if(filterIndex>=0){dtr.rules[filterIndex]=filter}else{dtr.rules.push(filter)}};$scope.removeFilter=function(detector,filterIndex){detector.rules.splice(filterIndex,1)};$scope.editFilter=function(detector,index){$scope.openFilterWindow(detector,index)};$scope.detectorToString=_string_utils.detectorToString;function validateDetector(dtr){if(dtr.exclude_frequent!==undefined&&dtr.exclude_frequent!==""){var exFrqs=["all","none","by","over"];if(_lodash.default.indexOf(exFrqs,dtr.exclude_frequent.trim())===-1){return{then:function then(callback){callback({success:false,message:_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorsList.invalidExcludeFrequentParameterErrorMessage",{defaultMessage:"{excludeFrequentParam} value must be: {allValue}, {noneValue}, {byValue} or {overValue}",values:{excludeFrequentParam:"exclude_frequent",allValue:'"all"',noneValue:'"none"',byValue:'"by"',overValue:'"over"'}})})}}}}return _job_service.mlJobService.validateDetector(dtr).then(function(resp){return{success:resp.acknowledged||false}}).catch(function(resp){return{success:false,message:resp.message||_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorsList.validationFailedErrorMessage",{defaultMessage:"Validation failed"})}})}$scope.openNewWindow=function(index){index=index!==undefined?index:-1;var dtr;if(index>=0){dtr=_angular.default.copy($scope.detectors[index])}$modal.open({template:_detector_modal2.default,controller:"MlDetectorModal",backdrop:"static",keyboard:false,size:"lg",resolve:{params:function params(){return{fields:$scope.fields,validate:validateDetector,detector:dtr,index:index,add:$scope.addDetector,catFieldNameSelected:$scope.catFieldNameSelected}}}})};$scope.openFilterWindow=function(dtr,filterIndex){filterIndex=filterIndex!==undefined?filterIndex:-1;var filter;if(filterIndex>=0){filter=_angular.default.copy(dtr.rules[filterIndex])}$modal.open({template:_detector_filter_modal2.default,controller:"MlDetectorFilterModal",backdrop:"static",keyboard:false,size:"lg",resolve:{params:function params(){return{fields:$scope.fields,validate:validateDetector,detector:dtr,filter:filter,index:filterIndex,add:$scope.addFilter}}}})}}}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2847);__webpack_require__(2848)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _angular=_interopRequireDefault(__webpack_require__(26));var _string_utils=__webpack_require__(67);var _messagebar_service=__webpack_require__(268);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.controller("MlDetectorModal",function($scope,$modalInstance,params){var msgs=_messagebar_service.mlMessageBarService;msgs.clear();$scope.title=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.addNewDetectorTitle",{defaultMessage:"Add new detector"});$scope.detector={function:""};$scope.saveLock=false;$scope.editMode=false;var index=-1;$scope.updateButtonLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.updateButtonLabel",{defaultMessage:"Update"});$scope.addButtonLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.addButtonLabel",{defaultMessage:"Add"});$scope.functions=[{id:"count",uri:"ml-count-functions.html#ml-count"},{id:"low_count",uri:"ml-count-functions.html#ml-count"},{id:"high_count",uri:"ml-count-functions.html#ml-count"},{id:"non_zero_count",uri:"ml-count-functions.html#ml-nonzero-count"},{id:"low_non_zero_count",uri:"ml-count-functions.html#ml-nonzero-count"},{id:"high_non_zero_count",uri:"ml-count-functions.html#ml-nonzero-count"},{id:"distinct_count",uri:"ml-count-functions.html#ml-distinct-count"},{id:"low_distinct_count",uri:"ml-count-functions.html#ml-distinct-count"},{id:"high_distinct_count",uri:"ml-count-functions.html#ml-distinct-count"},{id:"rare",uri:"ml-rare-functions.html#ml-rare"},{id:"freq_rare",uri:"ml-rare-functions.html#ml-freq-rare"},{id:"info_content",uri:"ml-info-functions.html#ml-info-content"},{id:"low_info_content",uri:"ml-info-functions.html#ml-info-content"},{id:"high_info_content",uri:"ml-info-functions.html#ml-info-content"},{id:"metric",uri:"ml-metric-functions.html#ml-metric-metric"},{id:"median",uri:"ml-metric-functions.html#ml-metric-median"},{id:"low_median",uri:"ml-metric-functions.html#ml-metric-median"},{id:"high_median",uri:"ml-metric-functions.html#ml-metric-median"},{id:"mean",uri:"ml-metric-functions.html#ml-metric-mean"},{id:"low_mean",uri:"ml-metric-functions.html#ml-metric-mean"},{id:"high_mean",uri:"ml-metric-functions.html#ml-metric-mean"},{id:"min",uri:"ml-metric-functions.html#ml-metric-min"},{id:"max",uri:"ml-metric-functions.html#ml-metric-max"},{id:"varp",uri:"ml-metric-functions.html#ml-metric-varp"},{id:"low_varp",uri:"ml-metric-functions.html#ml-metric-varp"},{id:"high_varp",uri:"ml-metric-functions.html#ml-metric-varp"},{id:"sum",uri:"ml-sum-functions.html#ml-sum"},{id:"low_sum",uri:"ml-sum-functions.html#ml-sum"},{id:"high_sum",uri:"ml-sum-functions.html#ml-sum"},{id:"non_null_sum",uri:"ml-sum-functions.html#ml-nonnull-sum"},{id:"low_non_null_sum",uri:"ml-sum-functions.html#ml-nonnull-sum"},{id:"high_non_null_sum",uri:"ml-sum-functions.html#ml-nonnull-sum"},{id:"time_of_day",uri:"ml-time-functions.html#ml-time-of-day"},{id:"time_of_week",uri:"ml-time-functions.html#ml-time-of-week"},{id:"lat_long",uri:"ml-geo-functions.html#ml-lat-long"}];$scope.functionIds={};_lodash.default.each($scope.functions,function(f){$scope.functionIds[f.id]=""});$scope.fields=params.fields;$scope.fields_byFieldName=_angular.default.copy($scope.fields);if(params.catFieldNameSelected){$scope.fields_byFieldName.mlcategory="mlcategory"}var validate=params.validate;var add=params.add;if(params.detector){$scope.detector=params.detector;index=params.index;$scope.title=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.editDetectorTitle",{defaultMessage:"Edit detector"});$scope.editMode=true}$scope.detectorToString=_string_utils.detectorToString;$scope.helpLink={};$scope.functionChange=function(){var func=_lodash.default.findWhere($scope.functions,{id:$scope.detector.function});$scope.helpLink.label=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.helpForAnalyticalFunctionsLabel",{defaultMessage:"Help for analytical functions"});$scope.helpLink.uri="ml-functions.html";if(func){$scope.helpLink.uri=func.uri;$scope.helpLink.label=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorModal.helpForAnalyticalFunctionLabel",{defaultMessage:"Help for {funcId}",values:{funcId:func.id}})}};$scope.functionChange();$scope.setDetectorProperty=function(value,field){if(value===""||value===undefined){delete $scope.detector[field]}else{$scope.detector[field]=value}if(field==="function"){$scope.functionChange()}};$scope.save=function(){$scope.saveLock=true;validate($scope.detector).then(function(resp){$scope.saveLock=false;if(resp.success){if($scope.detector.detector_description===""){delete $scope.detector.detector_description}add($scope.detector,index);$modalInstance.close($scope.detector);msgs.clear()}else{msgs.error(resp.message)}})};$scope.cancel=function(){msgs.clear();$modalInstance.close()}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2849)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _metadata=__webpack_require__(241);var _modules=__webpack_require__(8);var _documentation_help_link_view=__webpack_require__(2850);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlDocumentationHelpLink",function(){return{scope:{uri:"@mlUri",label:"@mlLabel"},restrict:"AE",replace:true,link:function link(scope,element){var baseUrl="https://www.elastic.co";var version=_metadata.metadata.branch;function renderReactComponent(){var props={fullUrl:"".concat(baseUrl,"/guide/en/elastic-stack-overview/").concat(version,"/").concat(scope.uri),label:scope.label};_reactDom.default.render(_react.default.createElement(_documentation_help_link_view.DocumentationHelpLink,props),element[0])}scope.$watch("uri",renderReactComponent)}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentationHelpLink=DocumentationHelpLink;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DocumentationHelpLink(_ref){var fullUrl=_ref.fullUrl,label=_ref.label;return _react.default.createElement("a",{href:fullUrl,rel:"noopener noreferrer",target:"_blank",className:"documentation-help-link"},label," ",_react.default.createElement(_eui.EuiIcon,{type:"popout"}))}DocumentationHelpLink.propTypes={fullUrl:_propTypes.default.string.isRequired,label:_propTypes.default.string.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2852)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _angular=_interopRequireDefault(__webpack_require__(26));var _messagebar_service=__webpack_require__(268);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.controller("MlDetectorFilterModal",function($scope,$modalInstance,params){var msgs=_messagebar_service.mlMessageBarService;msgs.clear();$scope.title=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorFilterModal.addNewFilterTitle",{defaultMessage:"Add new filter"});$scope.detector=params.detector;$scope.saveLock=false;$scope.editMode=false;var index=-1;var add=params.add;var validate=params.validate;$scope.updateButtonLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorFilterModal.updateButtonLabel",{defaultMessage:"Update"});$scope.addButtonLabel=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorFilterModal.addButtonLabel",{defaultMessage:"Add"});$scope.fields=[];if($scope.detector.field_name){$scope.fields.push($scope.detector.field_name)}if($scope.detector.by_field_name){$scope.fields.push($scope.detector.by_field_name)}if($scope.detector.over_field_name){$scope.fields.push($scope.detector.over_field_name)}if($scope.detector.partition_field_name){$scope.fields.push($scope.detector.partition_field_name)}if(params.filter===undefined){$scope.filter={ruleAction:"filter_results",target_field_name:"",target_field_value:"",conditions_connective:"or",conditions:[],value_list:[]}}else{$scope.editMode=true;$scope.filter=params.filter;$scope.title=_i18n.i18n.translate("xpack.ml.newJob.advanced.detectorFilterModal.editFilterTitle",{defaultMessage:"Edit filter"});index=params.index}$scope.ui={ruleAction:["filter_results"],target_field_name:"",target_field_value:"",conditions_connective:["or","and"],ruleCondition:{condition_type:[{label:"actual",value:"numerical_actual"},{label:"typical",value:"numerical_typical"},{label:"|actual - typical|",value:"numerical_diff_abs"}],field_name:"",field_value:"",condition:{operator:[{label:"<",value:"lt"},{label:">",value:"gt"},{label:"<=",value:"lte"},{label:">=",value:"gte"}]},value_list:[]}};$scope.addNewCondition=function(){$scope.filter.conditions.push({condition_type:"numerical_actual",field_name:"",field_value:"",condition:{operator:"lt",value:""}})};$scope.removeCondition=function(idx){$scope.filter.conditions.splice(idx,1)};$scope.helpLink={};$scope.save=function(){var filter=_angular.default.copy($scope.filter);if(!filter.conditions.length){return}$scope.saveLock=true;if(filter.target_field_name===""){delete filter.target_field_name}if(filter.target_field_value===""){delete filter.target_field_value}_lodash.default.each(filter.conditions,function(cond){delete cond.$$hashKey;if(cond.field_name===""){delete cond.field_vname}if(cond.fieldValue===""){delete cond.fieldValue}});if(filter.value_list&&filter.value_list.length===0){delete filter.value_list}var dtr=_angular.default.copy($scope.detector);if(dtr.rules===undefined){dtr.rules=[]}if(index>=0){dtr.rules[index]=filter}else{dtr.rules.push(filter)}validate(dtr).then(function(resp){msgs.clear();$scope.saveLock=false;if(resp.success){add($scope.detector,filter,index);$modalInstance.close()}else{msgs.error(resp.message)}})};$scope.cancel=function(){msgs.clear();$modalInstance.close()}})},function(module,exports){module.exports='<div>\n  <div class="form-group">\n    <div ng-repeat="detector in detectors track by $index">\n      <div class="detector" ng-class="{\'detector-edit-mode\':(editMode===\'EDIT\')}">\n        <div class="detector-fields">\n          <label\n            ng-show="editMode===\'EDIT\'"\n            i18n-id="xpack.ml.newJob.advanced.detectorsList.detectorLabel"\n            i18n-default-message="Detector:"\n          ></label>\n          <div\n            aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorsList.customisedDescriptionAriaLabel\' | i18n: {defaultMessage: \'Customised description\'} }}"\n            ng-hide="editMode===\'EDIT\' || detector.detector_description === \'\' || detector.detector_description === detectorToString(detector) "\n          >\n            {{ detector.detector_description }}\n          </div>\n          <div\n            aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorsList.defaultDescriptionAriaLabel\' | i18n: {defaultMessage: \'Default description\'} }}"\n            style="font-style:italic;"\n          >\n            {{ detectorToString(detector) }}\n          </div>\n\n          <div ng-show="editMode===\'EDIT\'">\n            <label\n              class="kuiFormLabel"\n              i18n-id="xpack.ml.newJob.advanced.detectorsList.descriptionLabel"\n              i18n-default-message="Description:"\n            ></label>\n            <input\n              ng-model="detector.detector_description"\n              class="form-control" />\n          </div>\n\n        </div>\n\n        <div class="button-container" ng-show="editMode===\'NEW\'">\n          <button\n            ng-click="editDetector($index)"\n            aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorsList.editButtonAriaLabel\' | i18n: {defaultMessage: \'Edit\'} }}"\n            class="kuiButton kuiButton--basic kuiButton--small"\n            data-toggle="tooltip"\n            tooltip="{{ ::\'xpack.ml.newJob.advanced.detectorsList.editButtonTooltip\' | i18n: {defaultMessage: \'Edit Detector\'} }}">\n              <i aria-hidden="true" class="fa fa-pencil"></i>\n          </button>\n\n          <button\n            aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorsList.removeDetectorButtonAriaLabel\' | i18n: {defaultMessage: \'Remove Detector\'} }}"\n            ng-click="removeDetector($index)"\n            tooltip-append-to-body="true"\n            type="button"\n            class="kuiButton kuiButton--danger kuiButton--small remove-button">\n              <i aria-hidden="true" class="fa fa-trash"></i>\n          </button>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="editMode===\'NEW\'">\n      <button\n        aria-labelledby="ml_aria_description_new_job_detectors"\n        aria-describedby="ml_aria_label_new_job_add_detector"\n        ng-click="openNewWindow()"\n        type="button"\n        class="kuiButton kuiButton--primary kuiButton--small">\n          <i aria-hidden="true" class="fa fa-plus"></i>\n          <span\n            id="ml_aria_label_new_job_add_detector"\n            i18n-id="xpack.ml.newJob.advanced.detectorsList.addDetectorButtonLabel"\n            i18n-default-message="Add Detector"\n          ></span>\n      </button>\n    </div>\n  </div>\n\n</div>\n'},function(module,exports){module.exports='<div class="detector-modal">\n  <ml-message-bar ></ml-message-bar>\n  <h1 class="euiTitle">{{title}}</h1>\n  <div class="euiSpacer euiSpacer--m"></div>\n\n  <div class="form-group">\n    <ml-form-label label-id="new_job_detector_description">\n      {{ ::\'xpack.ml.newJob.advanced.detectorModal.descriptionLabel\' | i18n: {defaultMessage: \'Description\'} }}\n    </ml-form-label>\n    <input\n      aria-labelledby="ml_aria_label_new_job_detector_description"\n      aria-describedby="ml_aria_description_new_job_detector_description"\n      ng-model="detector.detector_description"\n      placeholder="{{ detectorToString(detector) }}"\n      class="form-control" />\n  </div>\n\n  <div class="editor-color detector_field_form">\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_function">function</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_function"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.function\'\n          field=\'"function"\'\n          options=\'functionIds\'>\n        </field-select>\n      </div>\n    </div>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_fieldname">field_name</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_fieldname"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.field_name\'\n          field=\'"field_name"\'\n          options=\'fields\'>\n        </field-select>\n      </div>\n    </div>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_byfieldname">by_field_name</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_byfieldname"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.by_field_name\'\n          field=\'"by_field_name"\'\n          options=\'fields_byFieldName\'>\n        </field-select>\n      </div>\n    </div>\n\n  </div>\n  <div class="editor-color detector_field_form">\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_overfieldname">over_field_name</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_overfieldname"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.over_field_name\'\n          field=\'"over_field_name"\'\n          options=\'fields\'>\n        </field-select>\n      </div>\n    </div>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_partitionfieldname">partition_field_name</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_partitionfieldname"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.partition_field_name\'\n          field=\'"partition_field_name"\'\n          options=\'fields\'>\n        </field-select>\n      </div>\n    </div>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_detector_excludefrequent">exclude_frequent</ml-form-label>\n        <field-select\n          label-id=\'"new_job_detector_excludefrequent"\'\n          on-change=\'setDetectorProperty\'\n          value=\'detector.exclude_frequent\'\n          field=\'"exclude_frequent"\'\n          options=\'{all: "", none: ""}\'>\n        </field-select>\n      </div>\n    </div>\n\n  </div>\n  <small><div class=\'help-pane\'><ml-documentation-help-link ml-uri="{{helpLink.uri}}" ml-label="{{helpLink.label}}"></ml-documentation-help-link></div></small>\n\n  <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n  <button\n    ng-click="save()"\n    ng-disabled="(saveLock === true) || (detector.function === \'\')"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorModal.saveButtonAriaLabel\' | i18n: {defaultMessage: \'Save\'} }}">\n    {{ (editMode ? updateButtonLabel : addButtonLabel) }}\n  </button>\n  <button\n    ng-click="cancel()"\n    ng-disabled="(saveLock === true)"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorModal.cancelButtonAriaLabel\' | i18n: {defaultMessage: \'Cancel\'} }}"\n    i18n-id="xpack.ml.newJob.advanced.detectorModal.cancelButtonLabel"\n    i18n-default-message="Cancel"\n  ></button>\n</div>\n'},function(module,exports){module.exports='<div class="detector-filter-modal">\n  <ml-message-bar ></ml-message-bar>\n  <h3 class="euiTitle euiTitle--small">{{title}}</h3>\n  <div class="editor-color filter-field-form target-container">\n\n    <datalist id="fields_datalist">\n      <option ng-repeat="field in fields" >{{field}}</option>\n    </datalist>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_filter_targetfieldname">target_field_name</ml-form-label>\n\n        <input\n          aria-labelledby="ml_aria_label_new_filter_targetfieldname"\n          aria-describedby="ml_aria_description_new_filter_targetfieldname"\n          ng-model="filter.target_field_name"\n          tabindex="2"\n          ng-change="functionChange()"\n          list=\'fields_datalist\'\n          class="form-control" />\n\n        <ml-form-label label-id="new_action_targetfieldvalue">target_field_value</ml-form-label>\n\n        <input\n          aria-labelledby="ml_aria_label_new_action_targetfieldvalue"\n          aria-describedby="ml_aria_description_new_action_targetfieldvalue"\n          ng-model="filter.target_field_value"\n          tabindex="2"\n          ng-change="functionChange()"\n          class="form-control" />\n      </div>\n    </div>\n\n    <div class="field-cols">\n      <div class="form-group">\n        <ml-form-label label-id="new_action_conditionsconnective">conditions_connective</ml-form-label>\n        <select\n          aria-labelledby="ml_aria_label_new_action_conditionsconnective"\n          aria-describedby="ml_aria_description_new_action_conditionsconnective"\n          ng-model="filter.conditions_connective"\n          tabindex="2"\n          placeholder=""\n          class="form-control">\n            <option ng-repeat="index in ui.conditions_connective" value="{{index}}" >{{index}}</option>\n        </select>\n      </div>\n    </div>\n  </div>\n\n  <div class="conditions-list-container" >\n    <div class="title">\n      <span\n        aria-describedby="ml_aria_description_new_action_ruleconditions"\n        i18n-id="xpack.ml.newJob.advanced.detectorFilterModal.conditionsTitle"\n        i18n-default-message="Conditions"\n      ></span>\n      <i ml-info-icon="new_action_ruleconditions" />\n    </div>\n    <div class="table-title">\n      <div>\n        <span\n          aria-describedby="ml_aria_description_new_action_conditiontype"\n          i18n-id="xpack.ml.newJob.advanced.detectorFilterModal.conditionTypeTitle"\n          i18n-default-message="Type"\n        ></span>\n        <i ml-info-icon="new_action_conditiontype" />\n      </div>\n      <div><span aria-describedby="ml_aria_description_new_action_fieldname">field_name</span><i ml-info-icon="new_action_fieldname" /></div>\n      <div><span aria-describedby="ml_aria_description_new_action_fieldvalue">field_value</span><i ml-info-icon="new_action_fieldvalue" /></div>\n      <div><span aria-describedby="ml_aria_description_new_action_condition">lt/gt</span><i ml-info-icon="new_action_condition" /></div>\n      <div>\n        <span\n          aria-describedby="ml_aria_description_new_action_value"\n          i18n-id="xpack.ml.newJob.advanced.detectorFilterModal.conditionValueLabel"\n          i18n-default-message="value"\n        ></span>\n        <i ml-info-icon="new_action_value" />\n      </div>\n      <div></div>\n    </div>\n    <div ng-repeat="cond in filter.ruleConditions track by $index" class="rule-condition">\n      <div>\n        <select\n          ng-model="cond.conditionType"\n          placeholder=""\n          class="form-control">\n            <option ng-repeat="type in ui.ruleCondition.conditionType" value="{{type.value}}" >{{type.label}}</option>\n        </select>\n        <div ng-hide="$index === filter.ruleConditions.length-1" class=\'conditions-connective\'>-- {{filter.conditions_connective}} --</div>\n      </div>\n      <div>\n        <select\n          ng-model="cond.field_name"\n          placeholder=""\n          class="form-control">\n            <option ng-repeat="field in fields" >{{field}}</option>\n        </select>\n        \x3c!-- <input\n          ng-model="cond.field_name"\n          tabindex="2"\n          list=\'fields_datalist\'\n          class="form-control" /> --\x3e\n      </div>\n      <div>\n        <input\n          ng-model="cond.field_value"\n          tabindex="2"\n          class="form-control" />\n      </div>\n      <div>\n        <select\n          ng-model="cond.condition.operator"\n          placeholder=""\n          class="form-control">\n            <option ng-repeat="op in ui.ruleCondition.condition.operator" value="{{op.value}}" >{{op.label}}</option>\n        </select>\n      </div>\n      <div>\n        <input\n          ng-model="cond.condition.value"\n          tabindex="2"\n          class="form-control" />\n      </div>\n      <div>\n        <button\n          aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorFilterModal.removeConditionButtonAriaLabel\' | i18n: {defaultMessage: \'Remove Condition\'} }}"\n          ng-click="removeCondition($index)"\n          tooltip-append-to-body="true"\n          type="button"\n          class="kuiButton kuiButton--danger kuiButton--small remove-button">\n            <i aria-hidden="true" class="fa fa-trash"></i>\n        </button>\n      </div>\n    </div>\n  </div>\n  <button\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorFilterModal.addNewConditionButtonAriaLabel\' | i18n: {defaultMessage: \'Add new condition\'} }}"\n    ng-click="addNewCondition()"\n    type="button"\n    class="kuiButton kuiButton--primary kuiButton--small add-new"\n    i18n-id="xpack.ml.newJob.advanced.detectorFilterModal.addNewConditionButtonLabel"\n    i18n-default-message="{icon} Add new condition"\n    i18n-values="{ html_icon: \'<i aria-hidden=\\\'true\\\' class=\\\'fa fa-plus\\\'></i>\' }"\n  ></button>\n\n  <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n\n  <button\n    ng-click="save()"\n    ng-disabled="(saveLock === true || filter.ruleConditions.length === 0)"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorFilterModal.saveButtonAriaLabel\' | i18n: {defaultMessage: \'Save\'} }}">\n    {{ (editMode? updateButtonLabel : addButtonLabel) }}\n  </button>\n  <button\n    ng-click="cancel()"\n    ng-disabled="(saveLock === true)"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.ml.newJob.advanced.detectorFilterModal.cancelButtonAriaLabel\' | i18n: {defaultMessage: \'Cancel\'} }}"\n    i18n-id="xpack.ml.newJob.advanced.detectorFilterModal.cancelButtonLabel"\n    i18n-default-message="Cancel"\n  ></button>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2857)},function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(8);var _module=_modules.uiModules.get("apps/ml");_module.controller("MlSaveStatusModal",function($scope,$location,$modalInstance,params){$scope.pscope=params.pscope;$scope.ui={showTimepicker:false};$scope.openDatafeed=function(){$location.path("jobs");$modalInstance.close();params.openDatafeed()};$scope.close=function(){if($scope.pscope.ui.saveStatus.job===2){$location.path("jobs")}$scope.pscope.ui.saveStatus.job=0;$modalInstance.close()}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _field_select=__webpack_require__(2859);var _modules=__webpack_require__(8);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("fieldSelect",function(reactDirective){return reactDirective(_field_select.FieldSelect)})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldSelect=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _reactSelect=_interopRequireDefault(__webpack_require__(2860));__webpack_require__(2861);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var FieldSelect=function(_Component){_inherits(FieldSelect,_Component);function FieldSelect(){_classCallCheck(this,FieldSelect);return _possibleConstructorReturn(this,_getPrototypeOf(FieldSelect).apply(this,arguments))}_createClass(FieldSelect,[{key:"render",value:function render(){var _this$props=this.props,labelId=_this$props.labelId,onChange=_this$props.onChange,value=_this$props.value,options=_this$props.options,field=_this$props.field,placeholder=_this$props.placeholder;function change(selection){var val=selection?selection.value:"";onChange(val,field)}function getOptions(){var ops=[];_lodash.default.each(options,function(op,key){ops.push({label:key,value:key})});return ops}return _react.default.createElement(_reactSelect.default,{"aria-describedby":"ml_aria_description_"+labelId,"aria-labelledby":"ml_aria_label_"+labelId,placeholder:placeholder,options:getOptions(),value:value,onChange:change})}}]);return FieldSelect}(_react.Component);exports.FieldSelect=FieldSelect;FieldSelect.propTypes={labelId:_propTypes.default.string,onChange:_propTypes.default.func,value:_propTypes.default.string,options:_propTypes.default.object,field:_propTypes.default.string,placeholder:_propTypes.default.string}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3887)},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _job_group_select=_interopRequireDefault(__webpack_require__(2863));var _job_service=__webpack_require__(36);var _calendar_service=__webpack_require__(1357);var _compat=__webpack_require__(258);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlJobGroupSelect",function(){return{restrict:"E",template:_job_group_select.default,scope:{jobGroups:"=",disabled:"=",externalUpdateFunction:"="},controllerAs:"mlGroupSelect",bindToController:true,controller:function(_InitAfterBindingsWor){_inherits(MlGroupSelectController,_InitAfterBindingsWor);function MlGroupSelectController(){_classCallCheck(this,MlGroupSelectController);return _possibleConstructorReturn(this,_getPrototypeOf(MlGroupSelectController).apply(this,arguments))}_createClass(MlGroupSelectController,[{key:"initAfterBindings",value:function initAfterBindings($scope){var _this=this;this.$scope=$scope;this.selectedGroups=[];this.groups=[];this.$scope.newGroupLabel=_i18n.i18n.translate("xpack.ml.jobGroupSelect.newGroupLabel",{defaultMessage:"(new group)"});_job_service.mlJobService.loadJobs().then(function(){var tempGroupIds={};var jobGroups=_job_service.mlJobService.getJobGroups();_this.groups=jobGroups.map(function(g){tempGroupIds[g.id]=null;return{id:g.id,count:g.jobs.length,isTag:false}});if(Array.isArray(_this.jobGroups)===false){_this.jobGroups=[]}_calendar_service.mlCalendarService.loadCalendars(_job_service.mlJobService.jobs).then(function(){var calendarGroups=_calendar_service.mlCalendarService.getCalendarGroups();calendarGroups.forEach(function(g){if(tempGroupIds[g.id]===undefined){_this.groups.push({id:g.id,count:0,isTag:false})}});_this.populateSelectedGroups(_this.jobGroups)}).catch(function(error){console.log("Could not load groups from calendars",error);_this.populateSelectedGroups(_this.jobGroups)}).then(function(){$scope.$applyAsync()})});if(this.externalUpdateFunction!==undefined){this.externalUpdateFunction.update=function(groups){_this.populateSelectedGroups(groups)}}}},{key:"populateSelectedGroups",value:function populateSelectedGroups(groups){var _this2=this;this.selectedGroups=[];groups.forEach(function(gId){var tempGroup=_lodash.default.filter(_this2.groups,{id:gId});if(tempGroup.length){_this2.selectedGroups.push(tempGroup[0])}else{_this2.selectedGroups.push(_this2.createNewItem(gId))}})}},{key:"onGroupsChanged",value:function onGroupsChanged(){var _this3=this;this.jobGroups.length=0;this.selectedGroups.forEach(function(group){_this3.jobGroups.push(group.id)})}},{key:"createNewItem",value:function createNewItem(groupId){var gId=groupId.toLowerCase();return{id:gId,count:0,isTag:true}}},{key:"groupTypes",value:function groupTypes(group){if(group.isTag===false){return _i18n.i18n.translate("xpack.ml.jobGroupSelect.existingGroupsLabel",{defaultMessage:"Existing groups"})}}}]);return MlGroupSelectController}(_compat.InitAfterBindingsWorkaround)}})},function(module,exports){module.exports='<div class="ml-job-group-select">\n  <ui-select\n    ng-model="mlGroupSelect.selectedGroups"\n    on-select="mlGroupSelect.onGroupsChanged()"\n    on-remove="mlGroupSelect.onGroupsChanged()"\n    ng-disabled="mlGroupSelect.disabled"\n    multiple\n    tagging=\'mlGroupSelect.createNewItem\'\n    append-to-body=true\n  >\n    <ui-select-match\n      placeholder="{{:: \'xpack.ml.jobGroupSelect.jobGroupPlaceholder\' | i18n: { defaultMessage: \'Job Group\' } }}"\n    >\n      {{$item.id}}\n    </ui-select-match>\n    <ui-select-choices\n      repeat="group in mlGroupSelect.groups | filter: { id: $select.search }"\n      group-by="mlGroupSelect.groupTypes"\n    >\n      <div ng-if="group.isTag" class="select-item" ng-bind-html="(group.id | highlight: $select.search) +\' <small>\' + newGroupLabel + \'</small>\'"></div>\n      <div ng-if="!group.isTag" class="select-item" >\n        <div ng-bind-html="group.id | highlight: $select.search"></div>\n        <small\n          i18n-id="xpack.ml.jobGroupSelect.otherJobsInGroupLabel"\n          i18n-default-message="Other jobs in this group: {groupCount}"\n          i18n-values="{\n            groupCount: group.count,\n          }"\n        ></small>\n      </div>\n    </ui-select-choices>\n  </ui-select>\n</div>\n'},,function(module,exports,__webpack_require__){"use strict";__webpack_require__(2866)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _enable_model_plot_callout_view=__webpack_require__(2867);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlEnableModelPlotCallout",function(reactDirective){return reactDirective((0,_i18n.wrapInI18nContext)(_enable_model_plot_callout_view.EnableModelPlotCallout,undefined,{restrict:"E"}))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EnableModelPlotCallout=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EnableModelPlotCallout=function EnableModelPlotCallout(_ref){var message=_ref.message;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.advanced.enableModelPlot.proceedWithCautionTitle",defaultMessage:"Proceed with caution!"}),color:"warning",iconType:"help"},_react.default.createElement("p",null,message)))))};exports.EnableModelPlotCallout=EnableModelPlotCallout;EnableModelPlotCallout.propTypes={message:_propTypes.default.string.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2869)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2870);__webpack_require__(1360);__webpack_require__(2875);__webpack_require__(296);__webpack_require__(500);__webpack_require__(681);__webpack_require__(892);__webpack_require__(2884);__webpack_require__(577);__webpack_require__(682);__webpack_require__(402)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);__webpack_require__(360);var _agg_types=__webpack_require__(397);var _validation_utils=__webpack_require__(680);var _parse_interval=__webpack_require__(313);var _datemath=_interopRequireDefault(__webpack_require__(55));var _angular=_interopRequireDefault(__webpack_require__(26));var _routes=_interopRequireDefault(__webpack_require__(19));var _job_utils=__webpack_require__(58);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _ml_time_buckets=__webpack_require__(338);var _breadcrumbs=__webpack_require__(400);var _filter_agg_types=__webpack_require__(888);var _validate_job=__webpack_require__(678);var _adjust_interval=__webpack_require__(889);var _create_fields=__webpack_require__(890);var _change_job_id_case=__webpack_require__(1358);var _states=__webpack_require__(579);var _index_utils=__webpack_require__(226);var _check_ml_nodes=__webpack_require__(71);var _new_job_defaults=__webpack_require__(337);var _new_job_utils=__webpack_require__(294);var _job_service=__webpack_require__(36);var _prepopulate_job_settings=__webpack_require__(891);var _create_job_service=__webpack_require__(1360);var _messagebar_service=__webpack_require__(268);var _create_job=_interopRequireDefault(__webpack_require__(2874));var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job/simple/single_metric",{template:_create_job.default,k7Breadcrumbs:_breadcrumbs.getCreateSingleMetricJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlCreateSingleMetricJob",function($scope,$route,$filter,$timeout,Private,AppState){_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var msgs=_messagebar_service.mlMessageBarService;var MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var moveToAdvancedJobCreation=Private(_new_job_utils.moveToAdvancedJobCreationProvider);var mlSingleMetricJobService=Private(_create_job_service.SingleMetricJobServiceProvider);var stateDefaults={mlJobSettings:{}};var appState=new AppState(stateDefaults);$scope.index=$route.current.params.index;$scope.chartData=mlSingleMetricJobService.chartData;$scope.changeJobIDCase=_change_job_id_case.changeJobIDCase;$scope.addNewJobToRecentlyAccessed=_new_job_utils.addNewJobToRecentlyAccessed;var PAGE_WIDTH=_angular.default.element(".single-metric-job-container").width();var BAR_TARGET=PAGE_WIDTH>2e3?1e3:PAGE_WIDTH/2;var MAX_BARS=BAR_TARGET+BAR_TARGET/100*100;var REFRESH_INTERVAL_MS=100;var MAX_BUCKET_DIFF=3;var METRIC_AGG_TYPE="metrics";var DEFAULT_MODEL_MEMORY_LIMIT="10MB";var jobProgressChecks={25:false,50:false,75:false};var refreshCounter=0;$scope.JOB_STATE=_states.JOB_STATE;$scope.jobState=$scope.JOB_STATE.NOT_STARTED;$scope.CHART_STATE=_states.CHART_STATE;$scope.chartState=_states.CHART_STATE.NOT_STARTED;var globalForceStop=false;var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;(0,_index_utils.timeBasedIndexCheck)(indexPattern,true);$scope.indexPatternLinkText=_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.noResultsFound.indexPatternLinkText",{defaultMessage:"full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}});$scope.nameNotValidMessage=_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.nameNotValidMessage",{defaultMessage:"Enter a name for the job"});$scope.showAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.showAdvancedButtonAriaLabel",{defaultMessage:"Show Advanced"});$scope.hideAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.hideAdvancedButtonAriaLabel",{defaultMessage:"Hide Advanced"});var pageTitle=savedSearch.id!==undefined?_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.title}}):_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});$scope.ui={indexPattern:indexPattern,pageTitle:pageTitle,showJobInput:false,showJobFinished:false,dirty:true,formValid:false,bucketSpanValid:true,bucketSpanEstimator:{status:0,message:""},aggTypeOptions:(0,_filter_agg_types.filterAggTypes)(_agg_types.aggTypes.byType[METRIC_AGG_TYPE]),fields:[],timeFields:[],intervals:[{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.autoIntervalUnitTitle",{defaultMessage:"Auto"}),value:"auto"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.millisecondIntervalUnitTitle",{defaultMessage:"Millisecond"}),value:"ms"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.secondIntervalUnitTitle",{defaultMessage:"Second"}),value:"s"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.minuteIntervalUnitTitle",{defaultMessage:"Minute"}),value:"m"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.hourlyIntervalUnitTitle",{defaultMessage:"Hourly"}),value:"h"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.dailyIntervalUnitTitle",{defaultMessage:"Daily"}),value:"d"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.weeklyIntervalUnitTitle",{defaultMessage:"Weekly"}),value:"w"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.monthlyIntervalUnitTitle",{defaultMessage:"Monthly"}),value:"M"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.yearlyIntervalUnitTitle",{defaultMessage:"Yearly"}),value:"y"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.customIntervalUnitTitle",{defaultMessage:"Custom"}),value:"custom"}],chartHeight:310,showAdvanced:false,resultsUrl:"",validation:{checks:{jobId:{valid:true},groupIds:{valid:true},modelMemoryLimit:{valid:true}}},isCountOrSum:false};$scope.formConfig={agg:{type:undefined},field:null,bucketSpan:"15m",chartInterval:undefined,resultsIntervalSeconds:undefined,start:0,end:0,timeField:indexPattern.timeFieldName,indexPattern:undefined,usesSavedSearch:savedSearch.id!==undefined,combinedQuery:combinedQuery,jobId:"",description:"",jobGroups:[],useDedicatedIndex:false,isSparseData:false,modelMemoryLimit:DEFAULT_MODEL_MEMORY_LIMIT};$scope.bucketSpanEstimatorExportedFunctions={};$scope.aggChange=function(){loadFields();$scope.ui.isFormValid();$scope.ui.dirty=true;$scope.ui.isCountOrSum=$scope.formConfig.agg.type.dslName==="count"||$scope.formConfig.agg.type.dslName==="sum";if($scope.formConfig.agg.type.dslName==="count"){$scope.formConfig.field=null}};$scope.fieldChange=function(){$scope.ui.isFormValid();$scope.ui.dirty=true};$scope.bucketSpanFieldChange=function(){$scope.ui.isFormValid();$scope.ui.bucketSpanEstimator.status=0;$scope.ui.bucketSpanEstimator.message="";$scope.ui.bucketSpanValid=true;var bucketSpanInterval=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan);if(bucketSpanInterval===null||bucketSpanInterval.asMilliseconds()===0){$scope.ui.bucketSpanValid=false}};function setTime(){$scope.ui.bucketSpanValid=true;$scope.formConfig.start=_datemath.default.parse(_timefilter.timefilter.getTime().from).valueOf();$scope.formConfig.end=_datemath.default.parse(_timefilter.timefilter.getTime().to).valueOf();$scope.formConfig.format="epoch_millis";var bucketSpanInterval=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan);if(bucketSpanInterval===null||bucketSpanInterval.asMilliseconds()===0){$scope.ui.bucketSpanValid=false}var bounds=_timefilter.timefilter.getActiveBounds();$scope.formConfig.chartInterval=new MlTimeBuckets;$scope.formConfig.chartInterval.setBarTarget(BAR_TARGET);$scope.formConfig.chartInterval.setMaxBars(MAX_BARS);$scope.formConfig.chartInterval.setInterval("auto");$scope.formConfig.chartInterval.setBounds(bounds);(0,_adjust_interval.adjustIntervalDisplayed)($scope.formConfig);$scope.ui.isFormValid();$scope.ui.dirty=true}function loadFields(){var agg=$scope.formConfig.agg;var fields=[];agg.type.params.forEach(function(param){if(param.name==="field"){fields=(0,_create_fields.getIndexedFields)(indexPattern,param.filterFieldTypes.split(","))}});$scope.ui.fields=[];_lodash.default.each(fields,function(field,i){var id=(0,_job_utils.getSafeAggregationName)(field.displayName,i);var f={id:id,name:field.displayName,tooltip:field.displayName,agg:agg,mlType:field.mlType};$scope.ui.fields.push(f)});if($scope.ui.fields.length===1||$scope.formConfig.field===null&&agg.type.name==="cardinality"){$scope.formConfig.field=$scope.ui.fields[0]}}$scope.ui.isFormValid=function(){if($scope.formConfig.agg.type===undefined||$scope.formConfig.timeField===undefined){$scope.ui.formValid=false}else{$scope.ui.formValid=true}return $scope.ui.formValid};$scope.loadVis=function(){setTime();$scope.ui.isFormValid();if($scope.ui.formValid){$scope.ui.showJobInput=true;$scope.ui.showJobFinished=false;$scope.formConfig.indexPattern=indexPattern;$scope.ui.dirty=false;$scope.chartState=_states.CHART_STATE.LOADING;$scope.$applyAsync();mlSingleMetricJobService.getLineChartResults($scope.formConfig).then(function(resp){$scope.chartState=resp.totalResults?_states.CHART_STATE.LOADED:_states.CHART_STATE.NO_RESULTS}).catch(function(resp){msgs.error(resp.message);$scope.chartState=_states.CHART_STATE.NO_RESULTS}).then(function(){$scope.$broadcast("render");$scope.$applyAsync()})}};var ignoreModel=false;var refreshInterval=REFRESH_INTERVAL_MS;$scope.createJob=function(){var tempJob=mlSingleMetricJobService.getJobFromConfig($scope.formConfig);if((0,_validate_job.validateJob)(tempJob,$scope.ui.validation.checks)){msgs.clear();mlSingleMetricJobService.createJob($scope.formConfig).then(function(job){_job_service.mlJobService.openJob(job.job_id).then(function(){saveNewDatafeed(job,true)}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.openJobErrorMessage",{defaultMessage:"Could not open job: "}),resp);msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.creatingDatafeedErrorMessage",{defaultMessage:"Job created, creating datafeed anyway"}));saveNewDatafeed(job,false)})}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.saveFailedErrorMessage",{defaultMessage:"Save failed: "}),resp.resp);$scope.$applyAsync()})}else{if($scope.ui.validation.checks.modelMemoryLimit.valid===false){$scope.ui.showAdvanced=true}}function saveNewDatafeed(job,startDatafeedAfterSave){_job_service.mlJobService.saveNewDatafeed(job.datafeed_config,job.job_id).then(function(){if(startDatafeedAfterSave){mlSingleMetricJobService.startDatafeed($scope.formConfig).then(function(){$scope.jobState=_states.JOB_STATE.RUNNING;refreshCounter=0;ignoreModel=false;refreshInterval=REFRESH_INTERVAL_MS;$scope.formConfig.resultsIntervalSeconds=$scope.formConfig.chartInterval.getInterval().asSeconds();var bucketSpanSeconds=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan).asSeconds();if($scope.formConfig.resultsIntervalSeconds<bucketSpanSeconds){$scope.formConfig.resultsIntervalSeconds=bucketSpanSeconds}$scope.resultsUrl=_job_service.mlJobService.createResultsUrl([$scope.formConfig.jobId],$scope.formConfig.start,$scope.formConfig.end,"timeseriesexplorer");(0,_new_job_utils.focusOnResultsLink)("job_running_view_results_link",$timeout);loadCharts()}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.datafeedNotStartedErrorMessage",{defaultMessage:"Could not start datafeed: "}),resp)}).then(function(){$scope.$applyAsync()})}else{$scope.$applyAsync()}}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.singleMetric.saveDatafeedFailedErrorMessage",{defaultMessage:"Save datafeed failed: "}),resp);$scope.$applyAsync()})}};(0,_validation_utils.addJobValidationMethods)($scope,mlSingleMetricJobService);function loadCharts(){var forceStop=globalForceStop;var counterLimit=20-refreshInterval/REFRESH_INTERVAL_MS;if(refreshCounter>=counterLimit){refreshCounter=0;mlSingleMetricJobService.checkDatafeedState($scope.formConfig).then(function(state){if(state==="stopped"){console.log("Stopping poll because datafeed state is: "+state);$scope.$broadcast("render-results");forceStop=true;$scope.$applyAsync()}run()})}else{run()}function run(){refreshCounter++;reloadSwimlane().then(function(){if(forceStop===false&&$scope.chartData.percentComplete<100){if($scope.jobState===_states.JOB_STATE.STOPPING){$scope.jobState=_states.JOB_STATE.STOPPING}else{$scope.jobState=_states.JOB_STATE.RUNNING}}else{$scope.jobState=_states.JOB_STATE.FINISHED;(0,_new_job_utils.focusOnResultsLink)("job_finished_view_results_link",$timeout)}if(ignoreModel){jobCheck()}else{var fullModelRefresh=false;_lodash.default.each(jobProgressChecks,function(c,i){if(jobProgressChecks[i]===false&&$scope.chartData.percentComplete>=i){jobProgressChecks[i]=true;fullModelRefresh=true}});if(fullModelRefresh){$scope.chartData.model=[]}reloadModelChart().catch(function(){if(refreshCounter%10===0){console.log("Model has failed to load 10 times. Stop trying to load it.");ignoreModel=true}}).then(function(){jobCheck()})}$scope.$applyAsync()})}}function jobCheck(){var isLastRun=false;if($scope.jobState===_states.JOB_STATE.RUNNING||$scope.jobState===_states.JOB_STATE.STOPPING){refreshInterval=adjustRefreshInterval($scope.chartData.loadingDifference,refreshInterval);_lodash.default.delay(loadCharts,refreshInterval)}else{$scope.chartData.percentComplete=100;isLastRun=true}if(isLastRun&&!ignoreModel){$scope.chartData.model=[];reloadModelChart().catch(function(){}).then(function(){$scope.chartData.percentComplete=100;$scope.$broadcast("render-results");$scope.$applyAsync()})}else{$scope.$broadcast("render-results");$scope.$applyAsync()}}function reloadModelChart(){return mlSingleMetricJobService.loadModelData($scope.formConfig)}function reloadSwimlane(){return mlSingleMetricJobService.loadSwimlaneData($scope.formConfig)}function adjustRefreshInterval(loadingDifference,currentInterval){var INTERVAL_INCREASE_MS=100;var MAX_INTERVAL=1e4;var interval=currentInterval;if(interval<MAX_INTERVAL){if(loadingDifference<MAX_BUCKET_DIFF){interval=interval+INTERVAL_INCREASE_MS}else{if(interval-INTERVAL_INCREASE_MS>=REFRESH_INTERVAL_MS){interval=interval-INTERVAL_INCREASE_MS}}}return interval}$scope.resetJob=function(){$scope.jobState=_states.JOB_STATE.NOT_STARTED;_angular.default.element(".model-chart, .swimlane").css("opacity",0);_lodash.default.each(jobProgressChecks,function(c,i){jobProgressChecks[i]=false});window.setTimeout(function(){$scope.ui.showJobInput=true;$scope.loadVis()},500)};$scope.stopJob=function(){$scope.jobState=_states.JOB_STATE.STOPPING;mlSingleMetricJobService.stopDatafeed($scope.formConfig)};$scope.moveToAdvancedJobCreation=function(){var job=mlSingleMetricJobService.getJobFromConfig($scope.formConfig);moveToAdvancedJobCreation(job)};$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",$scope.loadVis);$scope.$on("$destroy",function(){globalForceStop=true});$scope.$evalAsync(function(){(0,_prepopulate_job_settings.preLoadJob)($scope,appState)})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeBucketsCalcAutoIntervalProvider=TimeBucketsCalcAutoIntervalProvider;var _moment=_interopRequireDefault(__webpack_require__(16));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var d=_moment.default.duration;function TimeBucketsCalcAutoIntervalProvider(){var roundingRules=[[d(500,"ms"),d(100,"ms")],[d(5,"second"),d(1,"second")],[d(10,"second"),d(5,"second")],[d(15,"second"),d(10,"second")],[d(30,"second"),d(15,"second")],[d(1,"minute"),d(30,"second")],[d(5,"minute"),d(1,"minute")],[d(10,"minute"),d(5,"minute")],[d(15,"minute"),d(10,"minute")],[d(30,"minute"),d(10,"minute")],[d(1,"hour"),d(30,"minute")],[d(2,"hour"),d(1,"hour")],[d(4,"hour"),d(2,"hour")],[d(6,"hour"),d(4,"hour")],[d(8,"hour"),d(6,"hour")],[d(12,"hour"),d(8,"hour")],[d(24,"hour"),d(12,"hour")],[d(2,"d"),d(1,"d")],[d(4,"d"),d(2,"d")],[d(1,"week"),d(4,"d")],[d(1,"month"),d(1,"week")],[d(1,"year"),d(1,"month")],[Infinity,d(1,"year")]];var revRoundingRules=roundingRules.slice(0).reverse();function find(rules,check,last){function pick(buckets,duration){var target=duration/buckets;var lastResp;for(var i=0;i<rules.length;i++){var rule=rules[i];var resp=check(rule[0],rule[1],target);if(resp==null){if(!last){continue}if(lastResp){return lastResp}break}if(!last){return resp}lastResp=resp}var ms=Math.max(Math.floor(target),1);return _moment.default.duration(ms,"ms")}return function(buckets,duration){var interval=pick(buckets,duration);if(interval){return _moment.default.duration(interval._data)}}}return{near:find(revRoundingRules,function near(upperBound,lowerBound,target){if(upperBound>target){if(upperBound===Infinity){return lowerBound}var boundMs=upperBound.asMilliseconds();var intervalMs=lowerBound.asMilliseconds();var retInterval=Math.abs(boundMs-target)<=Math.abs(intervalMs)?upperBound:lowerBound;return retInterval}},true),lessThan:find(revRoundingRules,function(upperBound,lowerBound,target){if(lowerBound<target){return upperBound!==Infinity?upperBound:lowerBound}}),atLeast:find(revRoundingRules,function atLeast(upperBound,lowerBound,target){if(lowerBound<=target){return lowerBound}})}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.inherits=inherits;function describeConst(val){return{writable:false,enumerable:false,configurable:false,value:val}}function inherits(SubClass,SuperClass){var prototype=Object.create(SuperClass.prototype,{constructor:describeConst(SubClass),superConstructor:describeConst(SuperClass)});Object.defineProperties(SubClass,{prototype:describeConst(prototype),Super:describeConst(SuperClass)});return SubClass}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.populateAppStateSettings=populateAppStateSettings;var _jquery=_interopRequireDefault(__webpack_require__(21));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function populateAppStateSettings(appState,scope){if(appState.mlJobSettings!==undefined&&Object.keys(appState.mlJobSettings).length){var finish=function finish(success){if(success){(0,_jquery.default)("#job-id-input").focus()}};var jobSettings=appState.mlJobSettings;(function(){if(scope.formConfig.hasOwnProperty("field")){return populateSingleMetricSettings(jobSettings,scope)}else if(scope.formConfig.hasOwnProperty("overField")){return populatePopulationSettings(jobSettings,scope)}else if(scope.formConfig.hasOwnProperty("fields")){return populateMultiMetricSettings(jobSettings,scope)}})().then(function(){return finish(true)}).catch(function(){return finish(false)})}}function populateSingleMetricSettings(jobSettings,scope){return new Promise(function(resolve,reject){jobSettings.fields.forEach(function(f){if(f.agg!==undefined){var agg=scope.ui.aggTypeOptions.find(function(o){return o.mlName===f.agg});if(agg!==undefined){scope.formConfig.agg.type=agg;scope.aggChange()}}if(f.fieldName!==undefined){var field=scope.ui.fields.find(function(o){return o.name===f.fieldName});scope.formConfig.field=field||null}});if(scope.formConfig.agg.type!==undefined&&scope.formConfig.field!==undefined||scope.formConfig.agg.type.name==="count"&&scope.formConfig.field===undefined){populateCommonSettings(jobSettings,scope);resolve()}else{reject()}})}function populateMultiMetricSettings(jobSettings,scope){return new Promise(function(resolve,reject){jobSettings.fields.forEach(function(f){var fieldName=f.fieldName!==undefined?f.fieldName:"__ml_event_rate_count__";var field=scope.ui.fields.find(function(o){return o.id===fieldName});if(field!==undefined){scope.formConfig.fields[field.id]=field}if(f.agg!==undefined){var agg=scope.ui.aggTypeOptions.find(function(o){return o.mlName===f.agg});if(agg!==undefined){scope.formConfig.fields[field.id].agg.type=agg}}});if(jobSettings.split!==undefined){var field=scope.ui.splitFields.find(function(o){return o.name===jobSettings.split});if(field!==undefined){scope.formConfig.splitField=field;scope.splitChange()}}if(scope.formConfig.fields!==undefined&&Object.keys(scope.formConfig.fields).length>0){populateCommonSettings(jobSettings,scope);resolve()}else{reject()}})}function populatePopulationSettings(jobSettings,scope){return new Promise(function(resolve,reject){if(jobSettings.population!==undefined){var loop=function loop(i){var f=jobSettings.fields[i];if(f.split!==undefined){var splitField=scope.ui.splitFields.find(function(o){return o.name===f.split});if(splitField!==undefined){scope.splitChange(i,splitField).then(function(){check(i)})}else{check(i)}}else{check(i)}};var check=function check(i){if(i+1<jobSettings.fields.length){loop(i+1)}};var overField=scope.ui.overFields.find(function(o){return o.name===jobSettings.population});if(overField!==undefined){scope.formConfig.overField=overField;scope.overChange()}jobSettings.fields.forEach(function(f){var fieldName=f.fieldName!==undefined?f.fieldName:"__ml_event_rate_count__";var tempField=scope.ui.fields.find(function(o){return o.id===fieldName});var field=_objectSpread({},tempField);if(field!==undefined){if(f.agg!==undefined){var agg=scope.ui.aggTypeOptions.find(function(o){return o.mlName===f.agg});if(agg!==undefined){field.agg={type:agg}}}scope.formConfig.fields.push(field)}});scope.formChange();loop(0)}if(scope.formConfig.fields!==undefined&&Object.keys(scope.formConfig.fields).length>0){populateCommonSettings(jobSettings,scope);resolve()}else{reject()}})}function populateCommonSettings(jobSettings,scope){if(typeof jobSettings.modelMemoryLimit==="string"){scope.formConfig.modelMemoryLimit=jobSettings.modelMemoryLimit}if(typeof jobSettings.bucketSpan==="string"){scope.formConfig.bucketSpan=jobSettings.bucketSpan}else{runEstimateBucketSpan(scope)}if(typeof jobSettings.description==="string"){scope.formConfig.description=jobSettings.description}if(Array.isArray(jobSettings.groups)){scope.formConfig.jobGroups=jobSettings.groups}if(Array.isArray(jobSettings.influencers)){scope.formConfig.influencerFields=jobSettings.influencers.map(function(i){return scope.ui.fields.find(function(f){return f.id===i})})}scope.formConfig.useDedicatedIndex=jobSettings.resultsIndexName!=="shared";scope.ui.showAdvanced=scope.formConfig.useDedicatedIndex}function runEstimateBucketSpan(scope){setTimeout(function(){if(scope.bucketSpanEstimatorExportedFunctions.guessBucketSpan&&typeof scope.bucketSpanEstimatorExportedFunctions.guessBucketSpan==="function"){scope.bucketSpanEstimatorExportedFunctions.guessBucketSpan()}},0)}},function(module,exports){module.exports='<ml-nav-menu name="new_job_single_metric"></ml-nav-menu>\n<ml-new-job-single-metric>\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlCreateSingleMetricJob" class="single-metric-job-container">\n    <div class="row">\n      <div class="col-md-6">\n        <h1\n          class="euiTitle euiTitle--large"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.newJobFromTitle"\n          i18n-default-message="New job from {pageTitle}"\n          i18n-values="{ pageTitle: ui.pageTitle }"\n        ></h1>\n      </div>\n      <div class="col-md-6">\n        <div class="pull-right">\n          <span\n            style="font-size:10px;"\n            ng-show="formConfig.chartInterval !== undefined"\n            i18n-id="xpack.ml.newJob.simple.singleMetric.chartIntervalLabel"\n            i18n-default-message="Chart interval: {interval}"\n            i18n-values="{ interval: formConfig.chartInterval.getInterval().expression }"\n          ></span>\n          <ml-full-time-range-selector\n            disabled=\'(jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)\'\n            index-pattern=\'ui.indexPattern\'\n            query=\'formConfig.combinedQuery\'\n          ></ml-full-time-range-selector>\n        </div>\n      </div>\n    </div>\n\n    <div class="euiSpacer euiSpacer--l"></div>\n\n    <div class="row form-controls">\n\n      <div class="form-group col-md-4">\n        <ml-form-label label-id="new_job_detector_function">\n          {{ ::\'xpack.ml.newJob.simple.singleMetric.aggregationLabel\' | i18n: {defaultMessage: \'Aggregation\'} }}\n        </ml-form-label>\n        <ui-select\n          aria-labelledby="ml_aria_label_new_job_detector_function"\n          aria-describedby="ml_aria_description_new_job_detector_function"\n          ng-model="formConfig.agg.type"\n          name="agg-type"\n          required\n          on-select="aggChange()"\n          ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n          class=""\n        >\n          <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.singleMetric.aggregationPlaceholder\' | i18n: {defaultMessage: \'Select an aggregation\'} }}">\n            {{$select.selected.title}}\n          </ui-select-match>\n          <ui-select-choices\n            repeat="agg in ui.aggTypeOptions | filter: { title: $select.search }"\n          >\n            <div ng-bind-html="agg.title | highlight: $select.search"></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n\n      <div class="form-group col-md-4">\n        <ml-form-label label-id="new_job_detector_fieldname_subset" tooltip-append-to-body="true">\n          {{ ::\'xpack.ml.newJob.simple.singleMetric.fieldLabel\' | i18n: {defaultMessage: \'Field\'} }}\n        </ml-form-label>\n        <ui-select\n          aria-labelledby="ml_aria_label_new_job_detector_fieldname_subset"\n          aria-describedby="ml_aria_description_new_job_detector_fieldname_subset"\n          ng-model="formConfig.field"\n          name="field-type"\n          required\n          on-select="fieldChange()"\n          ng-disabled="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n          class=""\n        >\n          <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.singleMetric.fieldPlaceholder\' | i18n: {defaultMessage: \'Select a field\'} }}">\n            <ml-field-type-icon type="$select.selected.mlType"></ml-field-type-icon>{{$select.selected.name}}\n          </ui-select-match>\n          <ui-select-choices repeat="field in ui.fields | filter: { name: $select.search }" group-by="\'mlType\'">\n            <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n            <span class="select-item" ng-bind-html="field.name | highlight: $select.search"></span>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n\n      <div class="form-group col-md-4">\n        <ml-form-label label-id="new_job_bucketspan">\n          {{ ::\'xpack.ml.newJob.simple.singleMetric.bucketSpanLabel\' | i18n: {defaultMessage: \'Bucket span\'} }}\n        </ml-form-label>\n        <div class=\'bucket-span-container\'>\n          <input\n            aria-labelledby="ml_aria_label_new_job_bucketspan"\n            aria-describedby="ml_aria_description_new_job_bucketspan"\n            ng-model="formConfig.bucketSpan"\n            required\n            placeholder={{formConfig-bucketSpan}}\n            ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED || ui.bucketSpanEstimator.status===1"\n            ng-change="bucketSpanFieldChange()"\n            ng-class=\'{"ng-invalid": (!ui.bucketSpanValid)}\'\n            class="form-control lowercase bucket-span-input" />\n\n          <ml-bucket-span-estimator\n            form-config=\'formConfig\'\n            job-state-wrapper=\'{jobState:jobState}\'\n            job-state=\'JOB_STATE\'\n            ui=\'ui\'\n            bucket-span-field-change="bucketSpanFieldChange"\n            exported-functions=\'bucketSpanEstimatorExportedFunctions\'>\n          </ml-bucket-span-estimator>\n\n          <button class="euiButton euiButton--primary euiButton--small euiButton--fill navbar-btn-link btn-load-vis"\n            aria-label="{{:: \'xpack.ml.newJob.simple.singleMetric.runSearchAriaLabel\' | i18n: { defaultMessage: \'Run search\' } }}"\n            ng-click="loadVis()"\n            ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED" >\n            <i class="fa fa-play" ></i>\n          </button>\n        </div>\n        <div\n          ng-hide="ui.bucketSpanValid"\n          class="validation-error"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.invalidIntervalFormatMessage"\n          i18n-default-message="Invalid interval format"\n        ></div>\n        <div ng-show="ui.bucketSpanEstimator.status===-1" class="validation-error">{{ui.bucketSpanEstimator.message}}</div>\n      </div>\n    </div>\n    <div class="row form-controls" ng-show=\'ui.isCountOrSum\'>\n      <div class="col-md-12">\n        <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n          <input type="checkbox"\n            aria-labelledby="ml_aria_label_new_job_sparsedata"\n            aria-describedby="ml_aria_description_new_job_sparsedata"\n            class=\'kuiCheckBox\'\n            ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n            ng-model="formConfig.isSparseData" />\n          <span\n            id="ml_aria_label_new_job_sparsedata"\n            class=\'kuiCheckBoxLabel__text\'\n            i18n-id="xpack.ml.newJob.simple.singleMetric.sparseDataLabel"\n            i18n-default-message="Sparse data"\n          ></span>\n          <i ml-info-icon="new_job_sparsedata" />\n        </label>\n      </div>\n    </div>\n\n    <div ng-show="ui.showJobInput">\n      <div class=\'chart-container\'>\n        <ml-single-metric-job-chart\n          chart-data="chartData"\n          chart-height=\'ui.chartHeight\'\n          chart-ticks-margin="chartData.chartTicksMargin">\n        </ml-single-metric-job-chart>\n\n        <div ng-show="chartState === CHART_STATE.NOT_STARTED || chartState === CHART_STATE.LOADING || chartState === CHART_STATE.NO_RESULTS"\n          class=\'chart-loader\'\n          style=\'height: {{ui.chartHeight}}px; margin-top: -{{ui.chartHeight + 32}}px; margin-left: {{chartData.chartTicksMargin.width - 1}}px;\'>\n            <div class=\'status-label\' ng-show="chartState === CHART_STATE.NOT_STARTED"></div>\n            <div class=\'status-label\' ng-show="chartState === CHART_STATE.LOADING">\n              <h2 class="euiTitle euiTitle"><i class=\'fa fa-spinner fa-spin\'></i></h2>\n            </div>\n            <div class=\'status-label\' ng-show="chartState === CHART_STATE.NO_RESULTS">\n              <div class=\'no-results\'>\n                <h4\n                  class="euiTitle euiTitle--small"\n                  i18n-id="xpack.ml.newJob.simple.singleMetric.noResultsFoundTitle"\n                  i18n-default-message="{infoIcon} No results found"\n                  i18n-values="{ html_infoIcon: \'<i class=\\\'fa fa-info-circle\\\'></i>\' }"\n                ></h4>\n                <span\n                  i18n-id="xpack.ml.newJob.simple.singleMetric.noResultsFoundDescription"\n                  i18n-default-message="Consider using the"\n                  i18n-description="after this label we have a link containing index pattern"\n                ></span>\n                <a ng-click="setFullTimeRange()">{{indexPatternLinkText}}</a>\n              </div>\n            </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="ui.showJobInput && (jobState === JOB_STATE.NOT_STARTED || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING)">\n      <div class="form-group">\n        <ml-form-label label-id="new_job_id" tooltip-append-to-body="true">\n          {{ ::\'xpack.ml.newJob.simple.singleMetric.nameLabel\' | i18n: {defaultMessage: \'Name\'} }}\n        </ml-form-label>\n        <input\n          aria-labelledby="ml_aria_label_new_job_id"\n          aria-describedby="ml_aria_description_new_job_id"\n          id="job-id-input"\n          ng-model="formConfig.jobId"\n          required\n          placeholder="{{ ::\'xpack.ml.newJob.simple.singleMetric.namePlaceholder\' | i18n: {defaultMessage: \'Job ID\'} }}"\n          ng-change="changeJobIDCase(formConfig)"\n          ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n          class="form-control lowercase" />\n          <div ng-hide="ui.validation.checks.jobId.valid" class="validation-error">\n            {{ ui.validation.checks.jobId.message || nameNotValidMessage }}\n          </div>\n        </div>\n\n      <div class="form-group">\n        <ml-form-label label-id="new_job_description">\n          {{ ::\'xpack.ml.newJob.simple.singleMetric.descriptionLabel\' | i18n: {defaultMessage: \'Description\'} }}\n        </ml-form-label>\n        <input\n          aria-labelledby="ml_aria_label_new_job_description"\n          aria-describedby="ml_aria_description_new_job_description"\n          ng-model="formConfig.description"\n          placeholder="{{ ::\'xpack.ml.newJob.simple.singleMetric.descriptionPlaceholder\' | i18n: {defaultMessage: \'Job description\'} }}"\n          ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n          class="form-control" />\n      </div>\n\n      <div class="form-group">\n        <ml-form-label label-id="new_job_group">\n            {{ ::\'xpack.ml.newJob.simple.singleMetric.jobGroupsLabel\' | i18n: {defaultMessage: \'Job Groups\'} }}\n        </ml-form-label>\n        <ml-job-group-select\n          aria-labelledby="ml_aria_label_new_job_group"\n          aria-describedby="ml_aria_description_new_job_group"\n          job-groups=\'formConfig.jobGroups\'\n          disabled=\'(jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)\' />\n        <div ng-hide="ui.validation.checks.groupIds.valid" class="validation-error">{{ ui.validation.checks.groupIds.message }}</div>\n      </div>\n\n      <div class="form-group">\n        <div ng-click="ui.showAdvanced = (!ui.showAdvanced || formConfig.useDedicatedIndex)" class="advanced-button-container">\n          <button\n            aria-label="{{ ui.showAdvanced ? hideAdvancedButtonAriaLabel : showAdvancedButtonAriaLabel }}"\n            aria-describedby="ml_aria_description_new_job_advanced_settings"\n            type="button"\n            ng-disabled="formConfig.useDedicatedIndex"\n            class="kuiButton kuiButton--small kuiButton--hollow advanced-button">\n            <i aria-hidden="true" ng-class="{ \'fa-caret-down\': ui.showAdvanced, \'fa-caret-right\': !ui.showAdvanced }" class="fa"></i>\n          </button>\n          <label\n            i18n-id="xpack.ml.newJob.simple.singleMetric.advancedLabel"\n            i18n-default-message="Advanced"\n          ></label><i ml-info-icon="new_job_advanced_settings" />\n        </div>\n        <div class=\'advanced-group\' ng-show="ui.showAdvanced">\n          <div class="form-group">\n            <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n              <input type="checkbox"\n                aria-labelledby="ml_aria_label_new_job_dedicated_index"\n                aria-describedby="ml_aria_description_new_job_dedicated_index"\n                class=\'kuiCheckBox\'\n                ng-model="formConfig.useDedicatedIndex" />\n              <span class=\'kuiCheckBoxLabel__text\'>\n                <span\n                  id="ml_aria_label_new_job_dedicated_index"\n                  i18n-id="xpack.ml.newJob.simple.singleMetric.useDedicatedIndexLabel"\n                  i18n-default-message="Use dedicated index"\n                ></span>\n                <i ml-info-icon="new_job_dedicated_index" />\n              </span>\n            </label>\n          </div>\n          <div class="form-group">\n            <label class=\'kuiFormLabel kuiVerticalRhythm\'>\n              <span\n                id="ml_aria_label_new_job_model_memory_limit"\n                i18n-id="xpack.ml.newJob.simple.singleMetric.modelMemoryLimitLabel"\n                i18n-default-message="Model memory limit"\n              ></span>\n              <i ml-info-icon="new_job_model_memory_limit" />\n            </label>\n            <div></div>\n            <input\n              aria-labelledby="ml_aria_label_new_job_model_memory_limit"\n              aria-describedby="ml_aria_description_new_job_model_memory_limit"\n              type="text"\n              ng-model=\'formConfig.modelMemoryLimit\'\n              class="kuiTextInput kuiTextInput--large" />\n            <div ng-hide="ui.validation.checks.modelMemoryLimit.valid" class="validation-error">{{ ui.validation.checks.modelMemoryLimit.message }}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="form-group">\n        <a\n          href=""\n          ng-click="moveToAdvancedJobCreation()"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.advancedConfigurationLinkText"\n          i18n-default-message="Move to advanced job configuration"\n        ></a>\n      </div>\n      <div class="euiFlexGroup euiFlexGroup--gutterSmall euiFlexGroup--alignItemsCenter euiFlexGroup--responsive">\n        <div class="euiFlexItem euiFlexItem--flexGrowZero">\n          <ml-validate-job\n            get-duration="getDuration"\n            get-job-config="getJobConfig"\n            fill="false"\n            is-current-job-config="isCurrentJobConfig"\n            is-disabled=\'ui.formValid === false || ui.dirty === true || formConfig.jobId === undefined || ui.bucketSpanValid === false\'\n            ng-show="jobState === JOB_STATE.NOT_STARTED"\n          />\n        </div>\n        <div class="euiFlexItem euiFlexItem--flexGrowZero">\n          <button\n            aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.createJobButtonAriaLabel\' | i18n: {defaultMessage: \'Create Job\'} }}"\n            ng-click="createJob()"\n            type="button"\n            ng-show="jobState === JOB_STATE.NOT_STARTED"\n            ng-disabled=\'ui.formValid === false || ui.dirty === true || formConfig.jobId === undefined || ui.bucketSpanValid === false\'\n            class="euiButton euiButton--primary euiButton--small euiButton--fill">\n            <span\n              class="euiButton__content"\n              i18n-id="xpack.ml.newJob.simple.singleMetric.createJobButtonLabel"\n              i18n-default-message="Create Job"\n            ></span>\n          </button>\n        </div>\n      </div>\n\n      <div\n        class=\'job-state-info\'\n        ng-show="jobState === JOB_STATE.RUNNING"\n        i18n-id="xpack.ml.newJob.simple.singleMetric.analysisRunningLabel"\n        i18n-default-message="Analysis running {spinIcon}"\n        i18n-values="{ html_spinIcon: \'<i class=\\\'fa fa-spinner fa-spin\\\'></i>\'}"\n      ></div>\n      <div\n        class=\'job-state-info\'\n        ng-show="jobState === JOB_STATE.STOPPING"\n        i18n-id="xpack.ml.newJob.simple.singleMetric.analysisStoppingLabel"\n        i18n-default-message="Analysis stopping {spinIcon}"\n        i18n-values="{ html_spinIcon: \'<i class=\\\'fa fa-spinner fa-spin\\\'></i>\'}"\n      ></div>\n\n      <button\n        aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.stopJobButtonAriaLabel\' | i18n: {defaultMessage: \'Stop Job\'} }}"\n        ng-click="stopJob()"\n        type="button"\n        ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n        ng-disabled="jobState === JOB_STATE.STOPPING"\n        class="euiButton euiButton--danger euiButton--small">\n        <span\n          ng-if="jobState === JOB_STATE.STOPPING"\n          class="euiButton__content"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.analysisStoppingButtonLabel"\n          i18n-default-message="Analysis stopping"\n        ></span>\n        <span\n          ng-if="jobState !== JOB_STATE.STOPPING"\n          class="euiButton__content"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.stopAnalysisButtonLabel"\n          i18n-default-message="Stop analysis"\n        ></span>\n      </button>\n\n      <a\n        href=\'{{resultsUrl}}\'\n        id="job_running_view_results_link"\n        ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n        aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.viewResultsOfRunningJobButtonAriaLabel\' | i18n: {defaultMessage: \'View results of running job\'} }}"\n        ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n        class="euiButton euiButton--primary euiButton--small euiButton--fill">\n        <span\n          class="euiButton__content"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.viewResultsOfRunningJobButtonLabel"\n          i18n-default-message="View Results"\n        ></span>\n      </a>\n\n    </div>\n    <div ng-show="jobState === JOB_STATE.FINISHED">\n      <h3 class="euiTitle euiTitle--large">\n        <span\n          i18n-id="xpack.ml.newJob.simple.singleMetric.jobCreatedTitle"\n          i18n-default-message="Job {jobId} created"\n          i18n-values="{ jobId: formConfig.jobId }"\n        ></span>\n        <i\n          style="color:green;"\n          class="fa fa-check"\n          aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.jobFinishedAriaLabel\' | i18n: {defaultMessage: \'Job finished\'} }}"\n        ></i>\n      </h3>\n      <div class="euiSpacer euiSpacer--m"></div>\n\n      <button\n        aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.resetButtonAriaLabel\' | i18n: {defaultMessage: \'Reset\'} }}"\n        ng-click="resetJob()"\n        type="button"\n        class="euiButton euiButton--primary euiButton--small euiButton--fill">\n        <span\n          class="euiButton__content"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.resetButtonLabel"\n          i18n-default-message="Reset"\n        ></span>\n      </button>\n      <a\n        href=\'{{resultsUrl}}\'\n        id="job_finished_view_results_link"\n        ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n        aria-label="{{ ::\'xpack.ml.newJob.simple.singleMetric.viewResultsOfFinishedJobButtonAriaLabel\' | i18n: {defaultMessage: \'View results of finished job\'} }}"\n        class="euiButton euiButton--primary euiButton--small euiButton--fill">\n        <span\n          class="euiButton__content"\n          i18n-id="xpack.ml.newJob.simple.singleMetric.viewResultsOfFinishedJobButtonLabel"\n          i18n-default-message="View Results"\n        ></span>\n      </a>\n\n    </div>\n    <div ng-if=\'jobState === JOB_STATE.FINISHED\'>\n      <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n      <ml-post-save-options\n        job-id=\'formConfig.jobId\'\n        bucket-span=\'formConfig.bucketSpan\'\n        include-influencers=\'false\'\n      ></ml-post-save-options>\n    </div>\n  </div>\n</ml-new-job-single-metric>\n'},function(module,exports,__webpack_require__){"use strict";var _jquery=_interopRequireDefault(__webpack_require__(21));var _d=_interopRequireDefault(__webpack_require__(27));var _angular=_interopRequireDefault(__webpack_require__(26));var _moment=_interopRequireDefault(__webpack_require__(16));var _time_buckets=__webpack_require__(312);var _chart_utils=__webpack_require__(280);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlSingleMetricJobChart",function(){function link(scope,element){var svgWidth=_angular.default.element(".single-metric-job-container").width();var lineChartHeight=scope.chartHeight;var swimlaneHeight=30;var margin={top:0,right:0,bottom:0,left:scope.chartTicksMargin.width};var svgHeight=lineChartHeight+swimlaneHeight+margin.top+margin.bottom;var vizWidth=svgWidth-margin.left-margin.right;var chartLimits={max:0,min:0};var lineChartXScale=null;var lineChartYScale=null;var lineChartValuesLine=null;var lineChartBoundedArea=null;var lineChartGroup;var modelChartGroup;var swimlaneGroup;var $progressBar;scope.$on("render",function(){init();createSVGGroups();drawLineChart()});scope.$on("render-results",function(){drawResults()});element.on("$destroy",function(){scope.$destroy()});function init(){margin.left=scope.chartTicksMargin.width;vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]);lineChartYScale=_d.default.scale.linear().range([lineChartHeight,0]);lineChartValuesLine=_d.default.svg.line().x(function(d){return lineChartXScale(d.date)}).y(function(d){return lineChartYScale(d.value)}).defined(function(d){return d.value!==null});lineChartBoundedArea=_d.default.svg.area().x(function(d){return lineChartXScale(d.date)||0}).y0(function(d){return lineChartYScale(Math.max(chartLimits.min,Math.min(chartLimits.max,d.upper)))}).y1(function(d){return lineChartYScale(Math.min(chartLimits.max,Math.max(chartLimits.min,d.lower)))})}function createSVGGroups(){if(scope.chartData.line===undefined){return}var chartElement=_d.default.select(element.get(0));chartElement.select("svg").remove();chartElement.select(".progress").remove();if(chartElement.select(".progress-bar")[0][0]===null){var style="width: ".concat(+vizWidth+2,"px;\n          margin-bottom: -").concat(+lineChartHeight+5,"px;\n          margin-left: ").concat(+margin.left-1,"px;'");chartElement.append("div").attr("class","progress").attr("style",style).append("div").attr("class","progress-bar")}$progressBar=(0,_jquery.default)(".progress-bar");var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);swimlaneGroup=svg.append("g").attr("class","swimlane").attr("transform","translate("+margin.left+","+margin.top+")");modelChartGroup=svg.append("g").attr("class","model-chart").attr("transform","translate("+margin.left+","+margin.top+")");lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")")}function drawLineChart(){var data=scope.chartData.line;lineChartXScale=lineChartXScale.domain(_d.default.extent(data,function(d){return d.date}));var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");if(data.length>0){var xDomain=lineChartXScale.domain();var bounds={min:(0,_moment.default)(xDomain[0]),max:(0,_moment.default)(xDomain[1])};timeBuckets.setBounds(bounds)}var xAxisTickFormat=timeBuckets.getScaledDateFormat();chartLimits.max=_d.default.max(data,function(d){return d.value});chartLimits.min=_d.default.min(data,function(d){return d.value});var padding=(chartLimits.max-chartLimits.min)*.1;chartLimits.max+=padding;chartLimits.min-=padding;lineChartYScale=lineChartYScale.domain([chartLimits.min,chartLimits.max]);var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-lineChartHeight).outerTickSize(0).tickPadding(10).ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);if(scope.chartData.fieldFormat!==undefined){yAxis.tickFormat(function(d){return scope.chartData.fieldFormat.convert(d,"text")})}lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",lineChartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawLineChartAxes(xAxis,yAxis);drawLineChartPaths(data);(0,_chart_utils.drawLineChartDots)(data,lineChartGroup,lineChartValuesLine)}function drawLineChartAxes(xAxis,yAxis){var axes=lineChartGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+lineChartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawLineChartPaths(data){lineChartGroup.append("path").attr("class","values-line").attr("d",lineChartValuesLine(data))}function drawResults(){var model=scope.chartData.model;drawModelPaths(model);drawSwimlane(vizWidth,lineChartHeight);updateProgressBar()}function drawModelPaths(model){modelChartGroup.selectAll("*").remove();modelChartGroup.append("path").attr("class","area bounds").attr("d",lineChartBoundedArea(model))}function drawSwimlane(swlWidth,swlHeight){var data=scope.chartData.swimlane;var cellWidth=0;if(data.length>0){cellWidth=lineChartXScale(data[0].time+scope.chartData.swimlaneInterval)-lineChartXScale(data[0].time)}_d.default.time.scale().range([0,swlWidth]).domain(_d.default.extent(data,function(d){return d.date}));_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var color=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);swimlaneGroup.select(".swimlane-cells").remove();var cells=swimlaneGroup.append("g").attr("class","swimlane-cells").selectAll("cells").data(data);cells.enter().append("rect").attr("x",function(d){return lineChartXScale(d.date)}).attr("y",0).attr("rx",0).attr("ry",0).attr("class",function(d){return d.value>0?"swimlane-cell":"swimlane-cell-hidden"}).attr("width",cellWidth).attr("height",swlHeight).style("fill",function(d){return color(d.value)})}function updateProgressBar(){var pcnt=scope.chartData.percentComplete<100?scope.chartData.percentComplete:0;$progressBar.css("width",pcnt+"%")}}return{scope:{chartData:"=",chartHeight:"=",chartTicksMargin:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";var _post_save_service=__webpack_require__(2877);var _i18n=__webpack_require__(4);var _create_watch_service=__webpack_require__(499);var _check_license=__webpack_require__(66);var _post_save_options=_interopRequireDefault(__webpack_require__(2878));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlPostSaveOptions",function(Private){return{restrict:"AE",replace:false,scope:{jobId:"=",bucketSpan:"=",includeInfluencers:"="},template:_post_save_options.default,link:function link($scope){var xpackFeature=Private(_check_license.xpackFeatureProvider);$scope.watcherEnabled=xpackFeature.isAvailable("watcher");$scope.status=_post_save_service.postSaveService.status;$scope.STATUS=_post_save_service.postSaveService.STATUS;_create_watch_service.mlCreateWatchService.reset();_create_watch_service.mlCreateWatchService.config.includeInfluencers=$scope.includeInfluencers;$scope.runInRealtime=false;$scope.createWatch=false;$scope.embedded=true;$scope.clickRunInRealtime=function(){$scope.createWatch=!$scope.runInRealtime?false:$scope.createWatch};$scope.apply=function(){_post_save_service.postSaveService.apply($scope.jobId,$scope.runInRealtime,$scope.createWatch,_i18n.i18n).catch(function(){}).then(function(){$scope.$applyAsync()})}}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.postSaveService=void 0;var _job_service=__webpack_require__(36);var _i18n=__webpack_require__(4);var _create_watch_service=__webpack_require__(499);var _messagebar_service=__webpack_require__(268);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var msgs=_messagebar_service.mlMessageBarService;var PostSaveService=function(){function PostSaveService(){_classCallCheck(this,PostSaveService);this.STATUS={SAVE_FAILED:-1,SAVING:0,SAVED:1};this.status={realtimeJob:null,watch:null};_create_watch_service.mlCreateWatchService.status=this.status;this.externalCreateWatch}_createClass(PostSaveService,[{key:"startRealtimeJob",value:function startRealtimeJob(jobId){var _this=this;return new Promise(function(resolve,reject){_this.status.realtimeJob=_this.STATUS.SAVING;var datafeedId=_job_service.mlJobService.getDatafeedId(jobId);_job_service.mlJobService.openJob(jobId).catch(function(){}).then(function(){_job_service.mlJobService.startDatafeed(datafeedId,jobId,0,undefined).then(function(){_this.status.realtimeJob=_this.STATUS.SAVED;resolve()}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.postSaveOptions.couldNotStartDatafeedErrorMessage",{defaultMessage:"Could not start datafeed:"}),resp);_this.status.realtimeJob=_this.STATUS.SAVE_FAILED;reject()})})})}},{key:"apply",value:function apply(jobId,runInRealtime,createWatch){var _this2=this;return new Promise(function(resolve){if(runInRealtime){_this2.startRealtimeJob(jobId,_i18n.i18n).then(function(){if(createWatch){_create_watch_service.mlCreateWatchService.createNewWatch(jobId).catch(function(){}).then(function(){resolve()})}else{resolve()}})}else{resolve()}})}}]);return PostSaveService}();var postSaveService=new PostSaveService;exports.postSaveService=postSaveService},function(module,exports){module.exports='<div class=\'post-save-options\'>\n\n  <div class=\'form-group\'>\n    <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n      <input ng-model=\'runInRealtime\' ng-disabled="status.realtimeJob!==null" type="checkbox" class=\'kuiCheckBox\' ng-click="clickRunInRealtime()"/>\n      <span class="kuiCheckBoxLabel__text">\n        <span\n          i18n-id="xpack.ml.newJob.simple.postSaveOptions.continueJobInRealTimeLabel"\n          i18n-default-message="Continue job in real-time"\n        ></span>\n        <span ng-hide="status.realtimeJob===null">\n          <i ng-show="status.realtimeJob === STATUS.SAVE_FAILED" aria-hidden="true" style="color:red;" class="fa fa-remove"></i>\n          <i ng-show="status.realtimeJob === STATUS.SAVING" aria-hidden="true" class="fa fa-spinner fa-spin"></i>\n          <i ng-show="status.realtimeJob === STATUS.SAVED" aria-hidden="true" style="color:green;" class="fa fa-check"></i>\n         </span>\n      </span>\n    </label>\n  </div>\n  <div ng-show=\'watcherEnabled\' class=\'form-group\'>\n    <label\n      class=\'kuiCheckBoxLabel kuiVerticalRhythm\'\n      ng-class="{\'disabled\': !runInRealtime}">\n      <input ng-model=\'createWatch\' ng-disabled="!runInRealtime || status.realtimeJob!==null" type="checkbox" class=\'kuiCheckBox\' />\n      <span class="kuiCheckBoxLabel__text">\n        <span\n          i18n-id="xpack.ml.newJob.simple.postSaveOptions.createWatchForRealTimeJobLabel"\n          i18n-default-message="Create watch for real-time job"\n        ></span>\n        <span ng-hide="status.watch===null">\n          <i ng-show="status.watch === STATUS.SAVE_FAILED" aria-hidden="true" style="color:red;" class="fa fa-remove"></i>\n          <i ng-show="status.watch === STATUS.SAVING" aria-hidden="true" class="fa fa-spinner fa-spin"></i>\n          <i ng-show="status.watch === STATUS.SAVED" aria-hidden="true" style="color:green;" class="fa fa-check"></i>\n        </span>\n      </span>\n    </label>\n\n    <div ng-if=\'runInRealtime && createWatch\'>\n      <ml-create-watch\n        job-id=\'jobId\'\n        bucket-span=\'bucketSpan\'\n        include-influencers=\'includeInfluencers\'\n        embedded=\'embedded\'\n      ></ml-create-watch>\n    </div>\n  </div>\n\n  <button\n    aria-label="{{ ::\'xpack.ml.newJob.simple.postSaveOptions.createWatchButtonAriaLabel\' | i18n: {defaultMessage: \'Create watch\'} }}"\n    ng-click="apply()"\n    ng-hide=\'(status.realtimeJob===STATUS.SAVED && createWatch===false) || (status.realtimeJob===STATUS.SAVED && status.watch===STATUS.SAVED && createWatch===true)\'\n    ng-disabled=\'runInRealtime===false\'\n    type="button"\n    class="kuiButton kuiButton--primary"\n    i18n-id="xpack.ml.newJob.simple.postSaveOptions.applyButtonLabel"\n    i18n-default-message="Apply">\n  </button>\n\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2880);__webpack_require__(499);__webpack_require__(2882)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _parse_interval=__webpack_require__(275);var _create_watch_service=__webpack_require__(499);var _create_watch=_interopRequireDefault(__webpack_require__(2881));var _ml_api_service=__webpack_require__(24);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlCreateWatch",function(){return{restrict:"AE",replace:false,scope:{jobId:"=",bucketSpan:"=",embedded:"="},template:_create_watch.default,link:function link($scope){$scope.config=_create_watch_service.mlCreateWatchService.config;$scope.status=_create_watch_service.mlCreateWatchService.status;$scope.STATUS=_create_watch_service.mlCreateWatchService.STATUS;$scope.ui={emailEnabled:false,embedded:$scope.embedded,watchAlreadyExists:false};if($scope.bucketSpan){var interval=(0,_parse_interval.parseInterval)($scope.bucketSpan);var bs=interval.asMinutes()*2;if(bs<1){bs=1}$scope.config.interval="".concat(bs,"m")}_ml_api_service.ml.getNotificationSettings().then(function(resp){if(_lodash.default.has(resp,"defaults.xpack.notification.email")){$scope.ui.emailEnabled=true;$scope.$applyAsync()}});_create_watch_service.mlCreateWatchService.loadWatch($scope.jobId).then(function(){$scope.ui.watchAlreadyExists=true}).catch(function(){$scope.ui.watchAlreadyExists=false}).then(function(){$scope.$applyAsync()})}}})},function(module,exports){module.exports='<div class="create-watch" ng-class="{\'create-watch-embedded\': ui.embedded}">\n\t<div ng-show="status.watch===null || status.watch===STATUS.SAVING || status.watch===STATUS.SAVE_FAILED">\n\t\t<div class="form-group">\n\t\t\t<div class="sub-form-group">\n\t\t\t\t<label\n\t\t\t\t\tfor="selectInterval"\n\t\t\t\t\tclass="kuiFormLabel kuiVerticalRhythm"\n\t\t\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.timeRangeLabel"\n\t\t\t\t\ti18n-default-message="Time range"\n\t\t\t\t></label><br />\n\t\t\t\t<span\n\t\t\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.nowLabel"\n\t\t\t\t\ti18n-default-message="Now -"\n\t\t\t\t></span>\n\t\t\t\t<input id="selectInterval" ng-model="config.interval" type="text" class="kuiTextInput kuiTextInput--small interval" placeholder="m">\n\t\t\t</div>\n\n\t\t\t<div class="sub-form-group">\n\t\t\t\t<label\n\t\t\t\t\tfor="selectSeverity"\n\t\t\t\t\tclass="kuiFormLabel kuiVerticalRhythm"\n\t\t\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.severityThresholdLabel"\n\t\t\t\t\ti18n-default-message="Severity threshold"\n\t\t\t\t></label><br />\n\t\t\t\t\t<div class="dropdown-group">\n\t\t\t\t\t\t<ml-severity-control\n\t\t\t\t\t\t\tconfig=\'config\'\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t    </div>\n\t\t</div>\n\t\t<div ng-show="ui.emailEnabled" class="form-group">\n\t\t\t<label for="sendEmail" class="kuiCheckBoxLabel kuiVerticalRhythm">\n\t\t\t\t<input id="sendEmail" ng-model="config.includeEmail" type="checkbox" class="kuiCheckBox" />\n\t\t\t\t<span\n\t\t\t\t\tclass="kuiCheckBoxLabel__text"\n\t\t\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.sendEmailLabel"\n\t\t\t\t\ti18n-default-message="Send email"\n\t\t\t\t></span>\n\t\t\t</label>\n\t\t\t<div ng-show="config.includeEmail" class="email-section">\n\t\t\t\t<input\n\t\t\t\t\ttype="text"\n\t\t\t\t\tng-model="config.email"\n\t\t\t\t\tclass="kuiTextInput kuiTextInput--large"\n\t\t\t\t\tplaceholder="{{ ::\'xpack.ml.newJob.simple.createWatch.emailAddressPlaceholder\' | i18n: {defaultMessage: \'email address\'} }}">\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div\n\t\t\tng-if="ui.watchAlreadyExists"\n\t\t\tclass="watch-exists-warning"\n\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.watchAlreadyExistsWarningMessage"\n\t\t\ti18n-default-message="Warning, watch ml-{jobId} already exists, clicking apply will overwrite the original."\n\t\t\ti18n-values="{ jobId }"\n\t\t>\n\t\t</div>\n\n\t</div>\n\n\t<div ng-show="status.watch===STATUS.SAVED">\n\t\t<div\n\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.watchCreatedLabel"\n\t\t\ti18n-default-message="Watch: {id} created"\n\t\t\ti18n-values="{ html_id: \'<strong>\' + config.id + \'</strong>\' }"\n\t\t></div>\n\t\t<br />\n\t\t<div>\n\t\t\t<a href="{{config.watcherEditURL}}" target="_blank" rel="noopener noreferrer">\n\t\t\t\t<span\n\t\t\t\t\ti18n-id="xpack.ml.newJob.simple.createWatch.editWatchLinkText"\n\t\t\t\t\ti18n-default-message="Edit {id} in Watcher"\n\t\t\t\t\ti18n-values="{ id: config.id }"\n\t\t\t\t></span>\n\t\t\t\t<i class="fa fa-external-link"></i></a>\n\t\t</div>\n\t</div>\n\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2883)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _select_severity=__webpack_require__(401);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlSeverityControl",function(){return{restrict:"AE",replace:false,scope:{config:"="},link:function link($scope,$element){$scope.handleThresholdChange=function(th){$scope.config.threshold=th};var props={onChangeHandler:$scope.handleThresholdChange,classNames:"form-control dropdown-toggle"};_reactDom.default.render(_react.default.createElement(_select_severity.SelectSeverity,props),$element[0])}}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2885)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _i18n=__webpack_require__(4);var _reactDom=_interopRequireDefault(__webpack_require__(17));var _bucket_span_estimator_view=__webpack_require__(2886);var _general=__webpack_require__(361);var _ml_api_service=__webpack_require__(24);var _i18n2=__webpack_require__(15);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlBucketSpanEstimator",function(){return{restrict:"AE",replace:false,scope:{bucketSpanFieldChange:"=",formConfig:"=",jobStateWrapper:"=",JOB_STATE:"=jobState",ui:"=ui",exportedFunctions:"="},link:function link($scope,$element){var STATUS={FAILED:-1,NOT_RUNNING:0,RUNNING:1,FINISHED:2};var errorHandler=function errorHandler(error){console.log("Bucket span could not be estimated",error);$scope.ui.bucketSpanEstimator.status=STATUS.FAILED;$scope.ui.bucketSpanEstimator.message=_i18n.i18n.translate("xpack.ml.newJob.simple.bucketSpanEstimator.bucketSpanCouldNotBeEstimatedMessage",{defaultMessage:"Bucket span could not be estimated"});$scope.$applyAsync()};$scope.guessBucketSpan=function(){$scope.ui.bucketSpanEstimator.status=STATUS.RUNNING;$scope.ui.bucketSpanEstimator.message="";$scope.$applyAsync();var data={aggTypes:[],duration:{start:$scope.formConfig.start,end:$scope.formConfig.end},fields:[],index:$scope.formConfig.indexPattern.title,query:$scope.formConfig.combinedQuery,splitField:$scope.formConfig.splitField&&$scope.formConfig.splitField.name,timeField:$scope.formConfig.timeField};if($scope.formConfig.fields===undefined){var fieldName=$scope.formConfig.field===null?null:$scope.formConfig.field.name;data.fields.push(fieldName);data.aggTypes.push($scope.formConfig.agg.type.dslName)}else{Object.keys($scope.formConfig.fields).map(function(id){var field=$scope.formConfig.fields[id];var fieldName=field.id===_general.EVENT_RATE_COUNT_FIELD?null:field.name;data.fields.push(fieldName);data.aggTypes.push(field.agg.type.dslName)})}_ml_api_service.ml.estimateBucketSpan(data).then(function(interval){if(interval.error){errorHandler(interval.message);return}var notify=$scope.formConfig.bucketSpan!==interval.name;$scope.formConfig.bucketSpan=interval.name;$scope.ui.bucketSpanEstimator.status=STATUS.FINISHED;if(notify&&typeof $scope.bucketSpanFieldChange==="function"){$scope.bucketSpanFieldChange()}$scope.$applyAsync()}).catch(errorHandler)};if($scope.exportedFunctions!==undefined&&_typeof($scope.exportedFunctions)==="object"){$scope.exportedFunctions.guessBucketSpan=$scope.guessBucketSpan}$scope.$watch("formConfig.agg.type",updateButton,true);$scope.$watch("jobStateWrapper.jobState",updateButton,true);$scope.$watch("[ui.showJobInput,ui.formValid,ui.bucketSpanEstimator.status]",updateButton,true);function updateButton(){var buttonDisabled=$scope.ui.showJobInput===false||$scope.ui.formValid===false||$scope.formConfig.agg.type===undefined||$scope.jobStateWrapper.jobState===$scope.JOB_STATE.RUNNING||$scope.jobStateWrapper.jobState===$scope.JOB_STATE.STOPPING||$scope.jobStateWrapper.jobState===$scope.JOB_STATE.FINISHED||$scope.ui.bucketSpanEstimator.status===STATUS.RUNNING;var estimatorRunning=$scope.ui.bucketSpanEstimator.status===STATUS.RUNNING;var buttonText=estimatorRunning?_i18n.i18n.translate("xpack.ml.newJob.simple.bucketSpanEstimator.estimatingBucketSpanButtonLabel",{defaultMessage:"Estimating bucket span"}):_i18n.i18n.translate("xpack.ml.newJob.simple.bucketSpanEstimator.estimateBucketSpanButtonLabel",{defaultMessage:"Estimate bucket span"});var props={buttonDisabled:buttonDisabled,estimatorRunning:estimatorRunning,guessBucketSpan:$scope.guessBucketSpan,buttonText:buttonText};_reactDom.default.render(_react.default.createElement(_i18n2.I18nContext,null,_react.default.createElement(_bucket_span_estimator_view.BucketSpanEstimator,props)),$element[0])}updateButton()}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BucketSpanEstimator=BucketSpanEstimator;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BucketSpanEstimator(_ref){var buttonDisabled=_ref.buttonDisabled,buttonText=_ref.buttonText,estimatorRunning=_ref.estimatorRunning,guessBucketSpan=_ref.guessBucketSpan;return _react.default.createElement("div",{className:"bucket-span-estimator"},_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.bucketSpanEstimator.estimateBucketSpanButtonTooltip",defaultMessage:"Experimental feature for estimating bucket span."}),position:"bottom"},_react.default.createElement(_eui.EuiButton,{disabled:buttonDisabled,fill:true,iconSide:"right",isLoading:estimatorRunning,onClick:guessBucketSpan,size:"s"},buttonText)))}BucketSpanEstimator.propTypes={buttonDisabled:_propTypes.default.bool.isRequired,buttonText:_propTypes.default.string.isRequired,estimatorRunning:_propTypes.default.bool.isRequired,guessBucketSpan:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_2=__webpack_require__(5);var eui_1=__webpack_require__(1);var full_time_range_selector_service_1=__webpack_require__(1359);exports.FullTimeRangeSelector=function(_ref){var indexPattern=_ref.indexPattern,query=_ref.query,disabled=_ref.disabled;return react_1.default.createElement(eui_1.EuiButton,{fill:true,isDisabled:disabled,onClick:function onClick(){return full_time_range_selector_service_1.setFullTimeRange(indexPattern,query)}},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}}))}},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _field_type_icon=__webpack_require__(1361);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFieldTypeIcon",function(){return{restrict:"E",replace:false,scope:{tooltipEnabled:"=",type:"="},link:function link(scope,element){scope.$watch("type",updateComponent);updateComponent();function updateComponent(){var props={tooltipEnabled:scope.tooltipEnabled,type:scope.type};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_field_type_icon.FieldTypeIcon,props)),element[0])}}}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2890)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2891);__webpack_require__(1363);__webpack_require__(2893);__webpack_require__(296);__webpack_require__(500);__webpack_require__(681);__webpack_require__(892);__webpack_require__(1364);__webpack_require__(2895);__webpack_require__(1365);__webpack_require__(1366);__webpack_require__(1367);__webpack_require__(1368);__webpack_require__(1369);__webpack_require__(577);__webpack_require__(682);__webpack_require__(402)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);__webpack_require__(360);var _agg_types=__webpack_require__(397);var _validation_utils=__webpack_require__(680);var _parse_interval=__webpack_require__(313);var _datemath=_interopRequireDefault(__webpack_require__(55));var _angular=_interopRequireDefault(__webpack_require__(26));var _routes=_interopRequireDefault(__webpack_require__(19));var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _ml_time_buckets=__webpack_require__(338);var _breadcrumbs=__webpack_require__(400);var _filter_agg_types=__webpack_require__(888);var _validate_job=__webpack_require__(678);var _adjust_interval=__webpack_require__(889);var _states=__webpack_require__(579);var _create_fields=__webpack_require__(890);var _index_utils=__webpack_require__(226);var _chart_data_utils=__webpack_require__(1362);var _check_ml_nodes=__webpack_require__(71);var _new_job_defaults=__webpack_require__(337);var _string_utils=__webpack_require__(67);var _new_job_utils=__webpack_require__(294);var _job_service=__webpack_require__(36);var _prepopulate_job_settings=__webpack_require__(891);var _create_job_service=__webpack_require__(1363);var _messagebar_service=__webpack_require__(268);var _ml_api_service=__webpack_require__(24);var _create_job=_interopRequireDefault(__webpack_require__(2892));var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job/simple/multi_metric",{template:_create_job.default,k7Breadcrumbs:_breadcrumbs.getCreateMultiMetricJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlCreateMultiMetricJob",function($scope,$timeout,Private,AppState){_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var msgs=_messagebar_service.mlMessageBarService;var MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var moveToAdvancedJobCreation=Private(_new_job_utils.moveToAdvancedJobCreationProvider);var chartDataUtils=Private(_chart_data_utils.ChartDataUtilsProvider);var mlMultiMetricJobService=Private(_create_job_service.MultiMetricJobServiceProvider);$scope.addNewJobToRecentlyAccessed=_new_job_utils.addNewJobToRecentlyAccessed;var stateDefaults={mlJobSettings:{}};var appState=new AppState(stateDefaults);mlMultiMetricJobService.clearChartData();$scope.chartData=mlMultiMetricJobService.chartData;var PAGE_WIDTH=_angular.default.element(".multi-metric-job-container").width();var BAR_TARGET=PAGE_WIDTH>1600?800:PAGE_WIDTH/2;var MAX_BARS=BAR_TARGET+BAR_TARGET/100*100;var REFRESH_INTERVAL_MS=100;var MAX_BUCKET_DIFF=3;var METRIC_AGG_TYPE="metrics";var DEFAULT_MODEL_MEMORY_LIMIT="10MB";var refreshCounter=0;$scope.JOB_STATE=_states.JOB_STATE;$scope.jobState=$scope.JOB_STATE.NOT_STARTED;$scope.CHART_STATE=_states.CHART_STATE;$scope.chartStates={eventRate:_states.CHART_STATE.LOADING,fields:{}};var globalForceStop=false;var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;(0,_index_utils.timeBasedIndexCheck)(indexPattern,true);var pageTitle=savedSearch.id!==undefined?_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.title}}):_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});$scope.analysisStoppingLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.analysisStoppingLabel",{defaultMessage:"Analysis stopping"});$scope.stopAnalysisLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.stopAnalysisLabel",{defaultMessage:"Stop analysis"});$scope.ui={indexPattern:indexPattern,pageTitle:pageTitle,showJobInput:true,showJobFinished:false,dirty:false,formValid:false,bucketSpanValid:true,bucketSpanEstimator:{status:0,message:""},cardinalityValidator:{status:0,message:""},aggTypeOptions:(0,_filter_agg_types.filterAggTypes)(_agg_types.aggTypes.byType[METRIC_AGG_TYPE]),fields:[],splitFields:[],timeFields:[],splitText:"",intervals:[{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.autoTitle",{defaultMessage:"Auto"}),value:"auto"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.millisecondTitle",{defaultMessage:"Millisecond"}),value:"ms"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.secondTitle",{defaultMessage:"Second"}),value:"s"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.minuteTitle",{defaultMessage:"Minute"}),value:"m"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.hourlyTitle",{defaultMessage:"Hourly"}),value:"h"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.dailyTitle",{defaultMessage:"Daily"}),value:"d"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.weeklyTitle",{defaultMessage:"Weekly"}),value:"w"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.monthlyTitle",{defaultMessage:"Monthly"}),value:"M"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.yearlyTitle",{defaultMessage:"Yearly"}),value:"y"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.intervals.customTitle",{defaultMessage:"Custom"}),value:"custom"}],eventRateChartHeight:100,chartHeight:150,showFieldCharts:false,showAdvanced:false,validation:{checks:{jobId:{valid:true},groupIds:{valid:true},modelMemoryLimit:{valid:true}}},isCountOrSum:false};$scope.formConfig={agg:{type:undefined},fields:{},bucketSpan:"15m",chartInterval:undefined,resultsIntervalSeconds:undefined,start:0,end:0,timeField:indexPattern.timeFieldName,splitField:undefined,influencerFields:[],firstSplitFieldName:undefined,indexPattern:indexPattern,combinedQuery:combinedQuery,usesSavedSearch:savedSearch.id!==undefined,jobId:"",description:"",jobGroups:[],useDedicatedIndex:false,enableModelPlot:false,isSparseData:false,modelMemoryLimit:DEFAULT_MODEL_MEMORY_LIMIT};$scope.formChange=function(){$scope.ui.isFormValid();$scope.ui.dirty=true;$scope.loadVis()};$scope.splitChange=function(){var splitField=$scope.formConfig.splitField;$scope.formConfig.firstSplitFieldName=undefined;if(splitField!==undefined){$scope.addDefaultFieldsToInfluencerList();$scope.ui.splitText=_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.dataSplitByLabel",{defaultMessage:"Data split by {splitFieldName}",values:{splitFieldName:splitField.name}});chartDataUtils.getSplitFields($scope.formConfig,$scope.formConfig.splitField.name,10).then(function(resp){if(resp.results.values&&resp.results.values.length){$scope.formConfig.firstSplitFieldName=resp.results.values[0]}setFieldsChartStates(_states.CHART_STATE.LOADING);drawCards(resp.results.values);$scope.formChange()});$scope.setModelMemoryLimit()}else{setFieldsChartStates(_states.CHART_STATE.LOADING);$scope.ui.splitText="";$scope.formConfig.modelMemoryLimit=DEFAULT_MODEL_MEMORY_LIMIT;destroyCards();$scope.formChange()}};$scope.splitReset=function(){$scope.formConfig.splitField=undefined;$scope.splitChange()};function setTime(){$scope.ui.bucketSpanValid=true;$scope.formConfig.start=_datemath.default.parse(_timefilter.timefilter.getTime().from).valueOf();$scope.formConfig.end=_datemath.default.parse(_timefilter.timefilter.getTime().to).valueOf();$scope.formConfig.format="epoch_millis";var bucketSpanInterval=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan);if(bucketSpanInterval===null||bucketSpanInterval.asMilliseconds()===0){$scope.ui.bucketSpanValid=false}var bounds=_timefilter.timefilter.getActiveBounds();$scope.formConfig.chartInterval=new MlTimeBuckets;$scope.formConfig.chartInterval.setBarTarget(BAR_TARGET);$scope.formConfig.chartInterval.setMaxBars(MAX_BARS);$scope.formConfig.chartInterval.setInterval("auto");$scope.formConfig.chartInterval.setBounds(bounds);(0,_adjust_interval.adjustIntervalDisplayed)($scope.formConfig);$scope.ui.isFormValid();$scope.ui.dirty=true}function initAgg(){_lodash.default.each($scope.ui.aggTypeOptions,function(agg){if(agg.mlName==="mean"){$scope.formConfig.agg.type=agg}})}$scope.ui.isFormValid=function(){if($scope.formConfig.agg.type===undefined||$scope.formConfig.timeField===undefined||Object.keys($scope.formConfig.fields).length===0){$scope.ui.formValid=false}else{$scope.ui.formValid=true}return $scope.ui.formValid};$scope.loadVis=function(){var thisLoadTimestamp=Date.now();$scope.chartData.lastLoadTimestamp=thisLoadTimestamp;setTime();$scope.ui.isFormValid();$scope.ui.showJobInput=true;$scope.ui.showJobFinished=false;$scope.ui.dirty=false;showSparseDataCheckbox();mlMultiMetricJobService.clearChartData();setFieldsChartStates(_states.CHART_STATE.LOADING);if(Object.keys($scope.formConfig.fields).length){$scope.ui.showFieldCharts=true;mlMultiMetricJobService.getLineChartResults($scope.formConfig,thisLoadTimestamp).then(function(resp){$scope.$applyAsync();loadDocCountData(resp.detectors)}).catch(function(resp){msgs.error(resp.message);_lodash.default.each($scope.formConfig.fields,function(field,id){$scope.chartStates.fields[id]=_states.CHART_STATE.NO_RESULTS});$scope.$applyAsync()})}else{$scope.ui.showFieldCharts=false;loadDocCountData([])}function loadDocCountData(dtrs){chartDataUtils.loadDocCountData($scope.formConfig,$scope.chartData).then(function(resp){if(thisLoadTimestamp===$scope.chartData.lastLoadTimestamp){_lodash.default.each(dtrs,function(dtr,id){var state=resp.totalResults?_states.CHART_STATE.LOADED:_states.CHART_STATE.NO_RESULTS;$scope.chartStates.fields[id]=state});$scope.chartData.lastLoadTimestamp=null;chartDataUtils.updateChartMargin($scope.chartData);$scope.chartStates.eventRate=resp.totalResults?_states.CHART_STATE.LOADED:_states.CHART_STATE.NO_RESULTS;$scope.$broadcast("render")}}).catch(function(resp){$scope.chartStates.eventRate=_states.CHART_STATE.NO_RESULTS;msgs.error(resp.message)}).then(function(){$scope.$applyAsync()})}};function setFieldsChartStates(state){_lodash.default.each($scope.chartStates.fields,function(chart,key){$scope.chartStates.fields[key]=state});$scope.$applyAsync()}function showSparseDataCheckbox(){$scope.ui.isCountOrSum=false;_lodash.default.each($scope.formConfig.fields,function(fd){if(fd.agg.type.dslName==="count"||fd.agg.type.dslName==="sum"){$scope.ui.isCountOrSum=true}})}function drawCards(labels){var $frontCard=_angular.default.element(".multi-metric-job-container .detector-container .card-front");$frontCard.addClass("card");$frontCard.find(".card-title").text(labels[0]);var marginTop=labels.length>1?54:0;$frontCard.css("margin-top",marginTop);var backCardTitle="";if(labels.length===2){backCardTitle=$scope.formConfig.fields[Object.keys($scope.formConfig.fields)[0]].agg.type.title;backCardTitle+=" ";backCardTitle+=Object.keys($scope.formConfig.fields)[0]}_angular.default.element(".card-behind").remove();for(var _i=0;_i<labels.length;_i++){var el='<div class="card card-behind card-behind-'.concat(_i,'"><div class="card-title">');el+=(0,_string_utils.mlEscape)(labels[_i]);el+='</div><label class="kuiFormLabel">';el+=(0,_string_utils.mlEscape)(backCardTitle);el+="</label></div>";var $backCard=_angular.default.element(el);$backCard.css("z-index",9-_i);$backCard.insertBefore($frontCard)}var cardsBehind=_angular.default.element(".card-behind");for(var _i2=0;_i2<cardsBehind.length;_i2++){cardsBehind[_i2].style.marginTop=marginTop+"px";marginTop-=(10-_i2*(10/labels.length))*(10/labels.length)}var i=0;var then=window.performance.now();var fps=20;var fpsInterval=1e3/fps;function fadeCard(callTime){if(i<cardsBehind.length){var now=callTime;var elapsed=now-then;if(elapsed>fpsInterval){cardsBehind[i].style.opacity=1;i++;then=now-elapsed%fpsInterval}window.requestAnimationFrame(fadeCard)}}fadeCard()}function destroyCards(){_angular.default.element(".card-behind").remove();var $frontCard=_angular.default.element(".multi-metric-job-container .detector-container .card-front");$frontCard.removeClass("card");$frontCard.find(".card-title").text("");$frontCard.css("margin-top",0)}var refreshInterval=REFRESH_INTERVAL_MS;$scope.createJob=function(){var tempJob=mlMultiMetricJobService.getJobFromConfig($scope.formConfig);if((0,_validate_job.validateJob)(tempJob,$scope.ui.validation.checks)){msgs.clear();mlMultiMetricJobService.createJob($scope.formConfig).then(function(job){_job_service.mlJobService.openJob(job.job_id).then(function(){saveNewDatafeed(job,true)}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.couldNotOpenJobErrorMessage",{defaultMessage:"Could not open job:"}),resp);msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.jobCreatedAndDatafeedCreatingAnywayErrorMessage",{defaultMessage:"Job created, creating datafeed anyway"}));saveNewDatafeed(job,false)})}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.saveFailedErrorMessage",{defaultMessage:"Save failed:"}),resp.resp);$scope.$applyAsync()})}else{if($scope.ui.validation.checks.modelMemoryLimit.valid===false){$scope.ui.showAdvanced=true}}function saveNewDatafeed(job,startDatafeedAfterSave){_job_service.mlJobService.saveNewDatafeed(job.datafeed_config,job.job_id).then(function(){if(startDatafeedAfterSave){mlMultiMetricJobService.startDatafeed($scope.formConfig).then(function(){$scope.jobState=_states.JOB_STATE.RUNNING;refreshCounter=0;refreshInterval=REFRESH_INTERVAL_MS;$scope.formConfig.resultsIntervalSeconds=$scope.formConfig.chartInterval.getInterval().asSeconds();var bucketSpanSeconds=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan).asSeconds();if($scope.formConfig.resultsIntervalSeconds<bucketSpanSeconds){$scope.formConfig.resultsIntervalSeconds=bucketSpanSeconds}$scope.resultsUrl=_job_service.mlJobService.createResultsUrl([$scope.formConfig.jobId],$scope.formConfig.start,$scope.formConfig.end,"explorer");(0,_new_job_utils.focusOnResultsLink)("job_running_view_results_link",$timeout);loadCharts()}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.couldNotStartDatafeedErrorMessage",{defaultMessage:"Could not start datafeed:"}),resp)}).then(function(){$scope.$applyAsync()})}else{$scope.$applyAsync()}}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.multiMetric.saveDatafeedFailedErrorMessage",{defaultMessage:"Save datafeed failed:"}),resp);$scope.$applyAsync()})}};$scope.getJobFromConfig=mlMultiMetricJobService.getJobFromConfig;(0,_validation_utils.addJobValidationMethods)($scope,mlMultiMetricJobService);function loadCharts(){var forceStop=globalForceStop;var counterLimit=20-refreshInterval/REFRESH_INTERVAL_MS;if(refreshCounter>=counterLimit){refreshCounter=0;_job_service.mlJobService.updateSingleJobDatafeedState($scope.formConfig.jobId).then(function(state){if(state==="stopped"){console.log("Stopping poll because datafeed state is: "+state);$scope.$applyAsync();$scope.$broadcast("render-results");forceStop=true}run()})}else{run()}function run(){refreshCounter++;reloadJobSwimlaneData().then(function(){reloadDetectorSwimlane().then(function(){if(forceStop===false&&$scope.chartData.percentComplete<100){if($scope.jobState===_states.JOB_STATE.STOPPING){$scope.jobState=_states.JOB_STATE.STOPPING}else{$scope.jobState=_states.JOB_STATE.RUNNING}}else{$scope.jobState=_states.JOB_STATE.FINISHED;(0,_new_job_utils.focusOnResultsLink)("job_finished_view_results_link",$timeout)}jobCheck()})})}}function jobCheck(){if($scope.jobState===_states.JOB_STATE.RUNNING||$scope.jobState===_states.JOB_STATE.STOPPING){refreshInterval=adjustRefreshInterval($scope.chartData.loadingDifference,refreshInterval);_lodash.default.delay(loadCharts,refreshInterval)}else{_lodash.default.each($scope.chartData.detectors,function(chart){chart.percentComplete=100})}if($scope.chartData.percentComplete>0){toggleSwimlaneVisibility()}$scope.$applyAsync();$scope.$broadcast("render-results")}function reloadJobSwimlaneData(){return chartDataUtils.loadJobSwimlaneData($scope.formConfig,$scope.chartData)}function reloadDetectorSwimlane(){return chartDataUtils.loadDetectorSwimlaneData($scope.formConfig,$scope.chartData)}function adjustRefreshInterval(loadingDifference,currentInterval){var INTERVAL_INCREASE_MS=100;var MAX_INTERVAL=1e4;var interval=currentInterval;if(interval<MAX_INTERVAL){if(loadingDifference<MAX_BUCKET_DIFF){interval=interval+INTERVAL_INCREASE_MS}else{if(interval-INTERVAL_INCREASE_MS>=REFRESH_INTERVAL_MS){interval=interval-INTERVAL_INCREASE_MS}}}return interval}$scope.resetJob=function(){$scope.jobState=_states.JOB_STATE.NOT_STARTED;toggleSwimlaneVisibility();window.setTimeout(function(){$scope.ui.showJobInput=true;$scope.loadVis()},500)};function toggleSwimlaneVisibility(){if($scope.jobState===_states.JOB_STATE.NOT_STARTED){_angular.default.element(".swimlane-cells").css("opacity",0);_angular.default.element(".bar").css("opacity",1)}else{_angular.default.element(".bar").css("opacity",.1)}}$scope.stopJob=function(){$scope.jobState=_states.JOB_STATE.STOPPING;mlMultiMetricJobService.stopDatafeed($scope.formConfig).catch(function(){}).then(function(){$scope.$applyAsync()})};$scope.moveToAdvancedJobCreation=function(){var job=mlMultiMetricJobService.getJobFromConfig($scope.formConfig);moveToAdvancedJobCreation(job)};var lastEstimatedModelMemoryLimit=null;$scope.setModelMemoryLimit=function(){var formConfig=$scope.formConfig;_ml_api_service.ml.calculateModelMemoryLimit({indexPattern:formConfig.indexPattern.title,splitFieldName:formConfig.splitField.name,query:formConfig.combinedQuery,fieldNames:Object.keys(formConfig.fields),influencerNames:formConfig.influencerFields.map(function(f){return f.name}),timeFieldName:formConfig.timeField,earliestMs:formConfig.start,latestMs:formConfig.end}).then(function(resp){var currentModelMemoryLimit=formConfig.modelMemoryLimit.toLowerCase();var defaultModelMemoryLimit=DEFAULT_MODEL_MEMORY_LIMIT.toLowerCase();if(currentModelMemoryLimit===defaultModelMemoryLimit||currentModelMemoryLimit===lastEstimatedModelMemoryLimit){formConfig.modelMemoryLimit=resp.modelMemoryLimit}lastEstimatedModelMemoryLimit=resp.modelMemoryLimit.toLowerCase()}).catch(function(){var currentModelMemoryLimit=formConfig.modelMemoryLimit.toLowerCase();if(currentModelMemoryLimit===lastEstimatedModelMemoryLimit){formConfig.modelMemoryLimit=DEFAULT_MODEL_MEMORY_LIMIT}})};initAgg();(0,_create_fields.createFields)($scope,indexPattern);$scope.loadVis();$scope.$evalAsync(function(){(0,_prepopulate_job_settings.preLoadJob)($scope,appState)});$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",function(){$scope.loadVis();if($scope.formConfig.splitField!==undefined){$scope.setModelMemoryLimit()}});$scope.$on("$destroy",function(){globalForceStop=true;_angular.default.element(window).off("resize")})})},function(module,exports){module.exports='<ml-nav-menu name="new_job_multi_metric"></ml-nav-menu>\n<ml-new-job-multi-metric>\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlCreateMultiMetricJob" class="multi-metric-job-container">\n    <div class="row">\n      <div class="col-md-6">\n        <h1\n          class="euiTitle euiTitle--large"\n          i18n-id="xpack.ml.newJob.simple.multiMetric.newJobFromTitle"\n          i18n-default-message="New job from {pageTitle}"\n          i18n-values="{ pageTitle: ui.pageTitle }"\n        ></h1>\n      </div>\n      <div class="col-md-6">\n        <div class="pull-right">\n          <span\n            style="font-size:10px;"\n            ng-show="formConfig.chartInterval !== undefined"\n            i18n-id="xpack.ml.newJob.simple.multiMetric.chartIntervalLabel"\n            i18n-default-message="Chart interval: {interval}"\n            i18n-values="{ interval: formConfig.chartInterval.getInterval().expression }"\n          ></span>\n          <ml-full-time-range-selector\n            disabled=\'(jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)\'\n            index-pattern=\'ui.indexPattern\'\n            query=\'formConfig.combinedQuery\'\n          ></ml-full-time-range-selector>\n        </div>\n      </div>\n    </div>\n\n    <div class="euiSpacer euiSpacer--s"></div>\n\n    <div class="row">\n      <div class="col-md-4">\n        <div class="row form-controls">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.multiMetric.jobSettingsTitle"\n            i18n-default-message="Job settings"\n          ></h4>\n          <div>\n            <div class=\'form-section\'>\n              <ml-fields-selection></ml-fields-selection>\n            </div>\n\n            <div class=\'form-section form-section-overflow\' >\n              <h4 class="euiTitle euiTitle--small">\n                <span\n                  i18n-id="xpack.ml.newJob.simple.multiMetric.splitDataTitle"\n                  i18n-default-message="Split Data"\n                ></span>\n                <button\n                  ng-if="formConfig.splitField !== undefined && (!ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)"\n                  ng-click="splitReset()"\n                  aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.removeSplitButtonAriaLabel\' | i18n: {defaultMessage: \'Reset Split Data to none.\'} }}"\n                  ng-disabled="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                  class="euiButton euiButton--primary euiButton--small remove-split"\n                  i18n-id="xpack.ml.newJob.simple.multiMetric.removeSplitButtonLabel"\n                  i18n-default-message="Remove split"\n                ></button>\n              </h4>\n              <div class="euiSpacer euiSpacer--s"></div>\n              <div class="row">\n                <div class="col-md-12">\n                  <div class="form-group">\n                    <ui-select\n                      ng-model="formConfig.splitField"\n                      ng-change="splitChange()"\n                      ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                    >\n                        <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.multiMetric.splitFieldPlaceholder\' | i18n: {defaultMessage: \'Select a field\'} }}">\n                          <ml-field-type-icon type="$select.selected.mlType"></ml-field-type-icon>{{$select.selected.name}}\n                        </ui-select-match>\n                        <ui-select-choices repeat="field in ui.splitFields | filter: { name: $select.search }" group-by="\'mlType\'">\n                          <div>\n                            <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n                            <span\n                              class="select-item"\n                              ng-bind-html="field.name | highlight: $select.search">\n                            </span>\n                          </div>\n                        </ui-select-choices>\n                    </ui-select>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\'form-section\' >\n              <ml-influencers-selection></ml-influencers-selection>\n            </div>\n\n            <div class=\'form-section\' >\n              <ml-bucket-span-selection></ml-bucket-span-selection>\n            </div>\n\n            <div class=\'form-section\' >\n              <div ng-show="jobState !== JOB_STATE.FINISHED">\n                <h4\n                  class="euiTitle euiTitle--small"\n                  i18n-id="xpack.ml.newJob.simple.multiMetric.jobDetailsTitle"\n                  i18n-default-message="Job Details"\n                ></h4>\n                <div class="euiSpacer euiSpacer--s"></div>\n              </div>\n\n              <div class="form-group">\n                <div ng-show="ui.showJobInput && (jobState === JOB_STATE.NOT_STARTED || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING)">\n                  <ml-general-job-details></ml-general-job-details>\n\n                  <div class="form-group">\n                    <a\n                      href=""\n                      ng-click="moveToAdvancedJobCreation()"\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.moveToAdvancedJobConfigurationLinkText"\n                      i18n-default-message="Move to advanced job configuration"\n                    ></a>\n                  </div>\n\n                  <div class="euiFlexGroup euiFlexGroup--gutterSmall euiFlexGroup--alignItemsCenter euiFlexGroup--responsive">\n                    <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                      <ml-validate-job\n                        get-duration="getDuration"\n                        get-job-config="getJobConfig"\n                        fill="false"\n                        is-current-job-config="isCurrentJobConfig"\n                        is-disabled="!ui.formValid"\n                        ng-show="jobState === JOB_STATE.NOT_STARTED"\n                      />\n                    </div>\n                    <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                      <button\n                        aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.createJobButtonAriaLabel\' | i18n: {defaultMessage: \'Create Job\'} }}"\n                        ng-click="createJob()"\n                        type="button"\n                        ng-show="jobState === JOB_STATE.NOT_STARTED"\n                        ng-disabled="!ui.formValid"\n                        class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                        <span\n                          class="euiButton__content"\n                          i18n-id="xpack.ml.newJob.simple.multiMetric.createJobButtonLabel"\n                          i18n-default-message="Create Job"\n                        ></span>\n                      </button>\n                    </div>\n                  </div>\n\n                  <div class=\'job-state-info\' ng-show="jobState === JOB_STATE.RUNNING">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.analysisRunningLabel"\n                      i18n-default-message="Analysis running"\n                    ></span>\n                    <i class=\'fa fa-spinner fa-spin\'></i>\n                  </div>\n                  <div class=\'job-state-info\' ng-show="jobState === JOB_STATE.STOPPING">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.analysisStoppingLabel"\n                      i18n-default-message="Analysis stopping"\n                    ></span>\n                    <i class=\'fa fa-spinner fa-spin\'></i>\n                  </div>\n\n                  <div class="euiSpacer euiSpacer--s"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.stopJobButtonAriaLabel\' | i18n: {defaultMessage: \'Stop Job\'} }}"\n                    ng-click="stopJob()"\n                    type="button"\n                    ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n                    ng-disabled="jobState === JOB_STATE.STOPPING"\n                    class="euiButton euiButton--danger euiButton--small">\n                    <span class="euiButton__content">\n                      {{(jobState === JOB_STATE.STOPPING) ? analysisStoppingLabel : stopAnalysisLabel }}\n                    </span>\n                  </button>\n\n                  <a\n                    href=\'{{resultsUrl}}\'\n                    id="job_running_view_results_link"\n                    ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.viewResultsOfRunningJobAriaLabel\' | i18n: {defaultMessage: \'View results of running job\'} }}"\n                    ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.viewResultsOfRunningJobLinkText"\n                      i18n-default-message="View Results"\n                    ></span>\n                  </a>\n                </div>\n                <div ng-show="jobState === JOB_STATE.FINISHED">\n                  <h3 class="euiTitle euiTitle--large">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.jobCreatedTitle"\n                      i18n-default-message="Job {jobId} created"\n                      i18n-values="{ jobId: formConfig.jobId }"\n                    ></span>\n                    <i style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.jobFinishedAriaLabel\' | i18n: {defaultMessage: \'Job finished\'} }}"></i>\n                  </h3>\n                  <div class="euiSpacer euiSpacer--m"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.resetButtonAriaLabel\' | i18n: {defaultMessage: \'Reset\'} }}"\n                    ng-click="resetJob()"\n                    type="button"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.resetButtonLabel"\n                      i18n-default-message="Reset"\n                    ></span>\n                  </button>\n                  <a\n                    href=\'{{resultsUrl}}\'\n                    id="job_finished_view_results_link"\n                    ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.multiMetric.viewResultsOfFinishedJobAriaLabel\' | i18n: {defaultMessage: \'View results of finished job\'} }}"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.multiMetric.viewResultsOfFinishedJobLinkText"\n                      i18n-default-message="View Results"\n                    ></span>\n                  </a>\n                </div>\n\n                <div ng-if=\'jobState === JOB_STATE.FINISHED\'>\n                  <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n                  <ml-post-save-options\n                    job-id=\'formConfig.jobId\'\n                    bucket-span=\'formConfig.bucketSpan\'\n                    include-influencers=\'true\'\n                    ></ml-post-save-options>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="col-md-8">\n        <div class="row charts-container">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.multiMetric.resultsTitle"\n            i18n-default-message="Results"\n          ></h4>\n          <div>\n            <div class=\'chart-list-panel event-rate-container\' style=\'height: {{ui.eventRateChartHeight + 70}}px;\'>\n              <label\n                class="kuiFormLabel"\n                i18n-id="xpack.ml.newJob.simple.multiMetric.documentCountLabel"\n                i18n-default-message="Document count"\n              ></label>\n\n              <div class=\'chart-container\'>\n                <div style=\'height: {{ui.eventRateChartHeight + 25}}px;\'>\n                  <ml-event-rate-chart\n                    chart-data="chartData.job"\n                    event-rate-chart-height=\'ui.eventRateChartHeight\'\n                    chart-ticks-margin="chartData.chartTicksMargin">\n                  </ml-event-rate-chart>\n                </div>\n\n                <div ng-show="chartStates.eventRate === CHART_STATE.NOT_STARTED || chartStates.eventRate === CHART_STATE.LOADING || chartStates.eventRate === CHART_STATE.NO_RESULTS"\n                  class=\'chart-loader event-rate-chart-loader\'\n                  style=\'height: {{ui.eventRateChartHeight}}px; margin-top: -{{ui.eventRateChartHeight + 30}}px;\'>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.NOT_STARTED"></div>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.LOADING">\n                      <h2 class="euiTitle euiTitle"><i class=\'fa fa-spinner fa-spin\'></i></h2>\n                    </div>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.NO_RESULTS">\n                      <div class=\'no-results\'>\n                        <h4 class="euiTitle euiTitle--small">\n                          <i class="fa fa-info-circle"></i>\n                          <span\n                            i18n-id="xpack.ml.newJob.simple.multiMetric.documentCountChart.noResultsFoundTitle"\n                            i18n-default-message="No results found"\n                          ></span>\n                        </h4>\n                        <span>\n                          <span\n                            i18n-id="xpack.ml.newJob.simple.multiMetric.documentCountChart.considerUsingText"\n                            i18n-default-message="Consider using the"\n                            i18n-description="Part of composite text xpack.ml.newJob.simple.multiMetric.documentCountChart.considerUsingText + xpack.ml.newJob.simple.multiMetric.documentCountChart.fullIndexPatternDataLinkText"\n                          ></span>\n                          <a\n                            ng-click="setFullTimeRange()"\n                            i18n-id="xpack.ml.newJob.simple.multiMetric.documentCountChart.fullIndexPatternDataLinkText"\n                            i18n-default-message="full {indexPatternTitle} data"\n                            i18n-values="{ indexPatternTitle: ui.indexPattern.title }"\n                            i18n-description="Part of composite text xpack.ml.newJob.simple.multiMetric.documentCountChart.considerUsingText + xpack.ml.newJob.simple.multiMetric.documentCountChart.fullIndexPatternDataLinkText"\n                          ></a>\n                        </span>\n                      </div>\n                    </div>\n                </div>\n\n              </div>\n\n            </div>\n            <div class=\'chart-list-panel detector-container\' ng-show=\'ui.showFieldCharts\'>\n              <label  class="kuiFormLabel" ng-hide="ui.splitText === \'\'">{{ui.splitText}}</label>\n              <div class=\'card-front\'>\n                <div class="card-title"></div>\n                <div ng-repeat=\'(id, chart) in chartData.detectors\' class=\'chart\' style=\'height: {{ui.chartHeight + 50}}px;\'>\n                  <label class="kuiFormLabel">{{formConfig.fields[id].agg.type.title}} {{formConfig.fields[id].name}}</label>\n                  <div class=\'chart-container\'>\n                    <div style=\'height: {{ui.chartHeight + 25}}px;\'>\n                      <ml-multi-metric-job-chart\n                        chart-data="chart"\n                        chart-height=\'ui.chartHeight\'\n                        chart-ticks-margin="chartData.chartTicksMargin">\n                      </ml-multi-metric-job-chart>\n                    </div>\n\n                    <div ng-show="chartStates.fields[id] === CHART_STATE.NOT_STARTED || chartStates.fields[id] === CHART_STATE.LOADING || chartStates.fields[id] === CHART_STATE.NO_RESULTS"\n                      class=\'chart-loader fields-chart-loader\'\n                      style=\'height: {{ui.chartHeight}}px; margin-top: -{{ui.chartHeight + 30}}px; margin-left: {{chartData.chartTicksMargin.width - 1}}px;\'>\n                        <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.NOT_STARTED"></div>\n                        <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.LOADING">\n                          <h2 class="euiTitle euiTitle"><i class=\'fa fa-spinner fa-spin\'></i></h2>\n                        </div>\n                        <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.NO_RESULTS">\n                          <div class=\'no-results\'>\n                            <h4 class="euiTitle euiTitle--small">\n                              <i class="fa fa-info-circle"></i>\n                              <span\n                                i18n-id="xpack.ml.newJob.simple.multiMetric.chart.noResultsFoundTitle"\n                                i18n-default-message="No results found"\n                              ></span>\n                            </h4>\n                          </div>\n                        </div>\n                    </div>\n\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</ml-new-job-multi-metric>\n'},function(module,exports,__webpack_require__){"use strict";var _jquery=_interopRequireDefault(__webpack_require__(21));var _d=_interopRequireDefault(__webpack_require__(27));var _angular=_interopRequireDefault(__webpack_require__(26));var _moment=_interopRequireDefault(__webpack_require__(16));var _time_buckets=__webpack_require__(312);var _chart_utils=__webpack_require__(280);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlMultiMetricJobChart",function(){function link(scope,element){var svgWidth=0;var lineChartHeight=scope.chartHeight;var marginTop=5;var progressBarMarginBottom=lineChartHeight+marginTop-15;var margin={top:marginTop,right:1,bottom:20,left:scope.chartTicksMargin.width};var svgHeight=lineChartHeight+margin.top+margin.bottom;var vizWidth=svgWidth-margin.left-margin.right;var chartLimits={max:0,min:0};var lineChartXScale=null;var lineChartYScale=null;var lineChartGroup;var swimlaneGroup;var lineChartValuesLine=null;var $progressBar;scope.$on("render",function(){init();createSVGGroups();drawLineChart()});scope.$on("render-results",function(){drawResults()});element.on("$destroy",function(){scope.$destroy()});function init(){var $el=_angular.default.element(".multi-metric-job-container .card-front");var offset=$el.hasClass("card")?30:0;margin.left=scope.chartTicksMargin.width;svgWidth=$el.width()-offset;vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]);lineChartYScale=_d.default.scale.linear().range([lineChartHeight,0]);lineChartValuesLine=_d.default.svg.line().x(function(d){return lineChartXScale(d.date)}).y(function(d){return lineChartYScale(d.value)}).defined(function(d){return d.value!==null})}function createSVGGroups(){if(scope.chartData.line===undefined){return}var chartElement=_d.default.select(element.get(0));chartElement.select("svg").remove();chartElement.select(".progress").remove();if(chartElement.select(".progress-bar")[0][0]===null){var style="width: ".concat(+vizWidth+2,"px;\n          margin-bottom: -").concat(+progressBarMarginBottom,"px;\n          margin-left: ").concat(+margin.left-1,"px;'");chartElement.append("div").attr("class","progress").attr("style",style).append("div").attr("class","progress-bar")}$progressBar=(0,_jquery.default)(".progress-bar");var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);swimlaneGroup=svg.append("g").attr("class","swimlane").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"));lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"))}function drawLineChart(){var data=scope.chartData.line;lineChartXScale=lineChartXScale.domain(_d.default.extent(data,function(d){return d.date}));chartLimits.max=_d.default.max(data,function(d){return d.value});chartLimits.min=_d.default.min(data,function(d){return d.value});var padding=(chartLimits.max-chartLimits.min)*.05;chartLimits.max+=padding;chartLimits.min-=padding;lineChartYScale=lineChartYScale.domain([chartLimits.min,chartLimits.max]);var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");if(data.length>0){var xDomain=lineChartXScale.domain();var bounds={min:(0,_moment.default)(xDomain[0]),max:(0,_moment.default)(xDomain[1])};timeBuckets.setBounds(bounds)}var xAxisTickFormat=timeBuckets.getScaledDateFormat();var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-lineChartHeight).outerTickSize(0).tickPadding(10).ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);if(scope.chartData.fieldFormat!==undefined){yAxis.tickFormat(function(d){return scope.chartData.fieldFormat.convert(d,"text")})}swimlaneGroup.append("rect").attr("x",0).attr("y",0).attr("height",lineChartHeight).attr("width",vizWidth).style("fill","#FFFFFF");lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",lineChartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawLineChartAxes(xAxis,yAxis);drawLineChartPaths(data);(0,_chart_utils.drawLineChartDots)(data,lineChartGroup,lineChartValuesLine)}function drawLineChartAxes(xAxis,yAxis){var axes=lineChartGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(lineChartHeight,")")).call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawLineChartPaths(data){lineChartGroup.append("path").attr("class","values-line").attr("d",lineChartValuesLine(data))}function drawResults(){drawSwimlane(vizWidth,lineChartHeight);updateProgressBar()}function drawSwimlane(swlWidth,swlHeight){var data=scope.chartData.swimlane;var cellWidth=0;if(data.length>0){cellWidth=lineChartXScale(data[0].time+scope.chartData.swimlaneInterval)-lineChartXScale(data[0].time)}_d.default.time.scale().range([0,swlWidth]).domain(_d.default.extent(data,function(d){return d.date}));_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var color=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);swimlaneGroup.select(".swimlane-cells").remove();var cells=swimlaneGroup.append("g").attr("class","swimlane-cells").selectAll("cells").data(data);cells.enter().append("rect").attr("x",function(d){return lineChartXScale(d.date)}).attr("y",0).attr("rx",0).attr("ry",0).attr("class",function(d){return d.value>0?"swimlane-cell":"swimlane-cell-hidden"}).attr("width",cellWidth-0).attr("height",swlHeight-0).style("fill",function(d){return color(d.value)})}function updateProgressBar(){var pcnt=scope.chartData.percentComplete<100?scope.chartData.percentComplete:0;$progressBar.css("width",pcnt+"%")}}return{scope:{chartData:"=",chartHeight:"=",chartTicksMargin:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";var _jquery=_interopRequireDefault(__webpack_require__(21));var _d=_interopRequireDefault(__webpack_require__(27));var _angular=_interopRequireDefault(__webpack_require__(26));var _moment=_interopRequireDefault(__webpack_require__(16));var _time_buckets=__webpack_require__(312);var _chart_utils=__webpack_require__(280);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlEventRateChart",function(){function link(scope,element){var svgWidth=0;var barChartHeight=scope.eventRateChartHeight;var marginTop=5;var progressBarMarginBottom=barChartHeight+marginTop-15;var margin={top:marginTop,right:1,bottom:20,left:scope.chartTicksMargin.width};var svgHeight=barChartHeight+margin.top+margin.bottom;var vizWidth=svgWidth-margin.left-margin.right;var chartLimits={max:0,min:0};var barChartXScale=null;var swimlaneXScale=null;var barChartYScale=null;var barChartGroup;var swimlaneGroup;var $progressBar;scope.$on("render",function(){init();createSVGGroups();drawBarChart()});scope.$on("render-results",function(){drawResults()});element.on("$destroy",function(){scope.$destroy()});function init(){var $el=_angular.default.element(".event-rate-container");margin.left=scope.chartTicksMargin.width;svgWidth=$el.width();vizWidth=svgWidth-margin.left-margin.right;barChartXScale=_d.default.scale.linear().rangeRound([0,vizWidth],.05);swimlaneXScale=_d.default.time.scale().range([0,vizWidth]);barChartYScale=_d.default.scale.linear().range([barChartHeight,0])}function createSVGGroups(){if(scope.chartData.bars===undefined){return}var chartElement=_d.default.select(element.get(0));chartElement.select("svg").remove();chartElement.select(".progress").remove();if(chartElement.select(".progress-bar")[0][0]===null){var style="width: ".concat(+vizWidth+2,"px;\n          margin-bottom: -").concat(+progressBarMarginBottom,"px;\n          margin-left: ").concat(+margin.left-1,"px;'");chartElement.append("div").attr("class","progress").attr("style",style).append("div").attr("class","progress-bar")}$progressBar=(0,_jquery.default)(".progress-bar");var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);barChartGroup=svg.append("g").attr("class","bar-chart").attr("transform","translate("+margin.left+","+margin.top+")");swimlaneGroup=svg.append("g").attr("class","swimlane").attr("transform","translate("+margin.left+","+margin.top+")")}function drawBarChart(){var data=scope.chartData.bars;var finerData=scope.chartData.bars;if(scope.chartData.line.length>0){finerData=scope.chartData.line}swimlaneXScale.domain(_d.default.extent(finerData,function(d){return d.date}));var timeExtent=_d.default.extent(data,function(d){return d.date});timeExtent[1]=new Date(timeExtent[1].getTime()+scope.chartData.barsInterval);barChartXScale=_d.default.time.scale().range([0,vizWidth]).domain(timeExtent);chartLimits.max=_d.default.max(data,function(d){return d.value});chartLimits.min=0;var padding=(chartLimits.max-chartLimits.min)*.05;chartLimits.max+=padding;barChartYScale=barChartYScale.domain([chartLimits.min,chartLimits.max]);var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");if(data.length>0){var xDomain=barChartXScale.domain();var bounds={min:(0,_moment.default)(xDomain[0]),max:(0,_moment.default)(xDomain[1])};timeBuckets.setBounds(bounds)}var xAxisTickFormat=timeBuckets.getScaledDateFormat();var xAxis=_d.default.svg.axis().scale(swimlaneXScale).orient("bottom").innerTickSize(-barChartHeight).outerTickSize(0).tickPadding(10).ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});var yAxis=_d.default.svg.axis().scale(barChartYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);barChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",barChartHeight).attr("width",vizWidth).style("fill","#FFFFFF");barChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",barChartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawBarChartAxes(xAxis,yAxis);drawBarChartPaths(data)}function drawBarChartAxes(xAxis,yAxis){var axes=barChartGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+barChartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawBarChartPaths(data){var earliestTime=scope.chartData.earliestTime;var cellWidth=0;if(data.length>0){cellWidth=barChartXScale(earliestTime+scope.chartData.barsInterval)-barChartXScale(earliestTime)}barChartGroup.selectAll("bar").data(data).enter().append("rect").style("fill","#32a7c2").attr("class","bar").attr("x",function(d){return barChartXScale(d.time)}).attr("width",cellWidth).attr("y",function(d){return barChartYScale(d.value)}).attr("height",function(d){return barChartHeight-barChartYScale(d.value)})}function drawResults(){updateProgressBar();drawSwimlane(vizWidth,barChartHeight)}function drawSwimlane(swlWidth,swlHeight){var lineData=scope.chartData.line;var data=scope.chartData.swimlane;var earliestTime=scope.chartData.earliestTime;var cellWidth=0;if(data.length>0){cellWidth=barChartXScale(earliestTime+scope.chartData.swimlaneInterval)-barChartXScale(earliestTime)}_d.default.time.scale().range([0,swlWidth]).domain(_d.default.extent(lineData,function(d){return d.date}));_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var color=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);swimlaneGroup.select(".swimlane-cells").remove();var cells=swimlaneGroup.append("g").attr("class","swimlane-cells").selectAll("cells").data(data);cells.enter().append("rect").attr("x",function(d){return swimlaneXScale(d.date)}).attr("y",0).attr("rx",0).attr("ry",0).attr("class",function(d){return d.value>0?"swimlane-cell":"swimlane-cell-hidden"}).attr("width",cellWidth-0).attr("height",swlHeight-0).style("fill",function(d){return color(d.value)})}function updateProgressBar(){var pcnt=scope.chartData.percentComplete;$progressBar.css("width",pcnt+"%")}}return{scope:{chartData:"=",eventRateChartHeight:"=",chartTicksMargin:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2896)},function(module,exports,__webpack_require__){"use strict";var _states=__webpack_require__(579);var _fields_selection=_interopRequireDefault(__webpack_require__(2897));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFieldsSelection",function(){return{restrict:"E",replace:true,template:_fields_selection.default,controller:function controller($scope){$scope.toggleFields=function(field){var key=field.id;var f=$scope.formConfig.fields[key];if(f===undefined){$scope.formConfig.fields[key]=field;$scope.chartStates.fields[key]=_states.CHART_STATE.LOADING}else{delete $scope.formConfig.fields[key];delete $scope.chartStates.fields[key]}if($scope.formConfig.splitField!==undefined){$scope.setModelMemoryLimit()}}}}})},function(module,exports){module.exports='<div class=\'fields-selection\'>\n  <h4\n    class="euiTitle euiTitle--small"\n    i18n-id="xpack.ml.newJob.simple.fieldsSelection.fieldsTitle"\n    i18n-default-message="Fields"\n  ></h4>\n  <div class="euiSpacer euiSpacer--s"></div>\n  <div class="row">\n    <div class="col-md-12">\n      <div class="form-group">\n\n        <div class=\'selection-list-container fields-list\'>\n          <div class="checkbox field-row" ng-repeat="field in ui.fields" >\n            <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n              <input type="checkbox"\n                class=\'kuiCheckBox\'\n                ng-checked="formConfig.fields[field.id] !== undefined"\n                ng-click="toggleFields(field); formChange()"\n                ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                />\n              <span\n                class=\'kuiCheckBoxLabel__text\'\n                tooltip=\'{{field.tooltip}}\'\n                tooltip-append-to-body="true">\n                {{field.name}}\n              </span>\n            </label>\n            <div class="agg-type-select-wrapper">\n              <select\n                ng-model="field.agg.type"\n                ng-options="agg as agg.title for agg in ui.aggTypeOptions | filterAggTypes:field"\n                ng-change="formChange()"\n                ng-disabled="formConfig.fields[field.id] === undefined || jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                class="form-control agg-type-select">\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="row form-controls" ng-show=\'ui.isCountOrSum\'>\n    <span class="col-md-12">\n      <label class=\'kuiCheckBoxLabel kuiVerticalRhythm sparse-data\'>\n        <input type="checkbox"\n          class=\'kuiCheckBox\'\n          ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n          ng-model  ="formConfig.isSparseData" />\n          <span class=\'kuiCheckBoxLabel__text\'>\n            <span\n              i18n-id="xpack.ml.newJob.simple.fieldsSelection.sparseDataLabel"\n              i18n-default-message="Sparse data"\n            ></span>\n            <i ml-info-icon="new_job_sparsedata" tooltip-append-to-body="true"></i>\n          </span>\n      </label>\n    </span>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _influencers_selection=_interopRequireDefault(__webpack_require__(2899));var _lodash=_interopRequireDefault(__webpack_require__(3));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlInfluencersSelection",function(){return{restrict:"E",replace:true,template:_influencers_selection.default,controller:function controller($scope){$scope.isDefaultInfluencer=function(field){var defaultFields=getDefaultFields();return defaultFields.find(function(f){return f.name===field.name})!==undefined};$scope.toggleInfluencerChange=function(){$scope.addDefaultFieldsToInfluencerList()};$scope.addDefaultFieldsToInfluencerList=function(){var defaultFields=getDefaultFields();var nonDefaultFields=getNonDefaultFields(defaultFields);$scope.formConfig.influencerFields=defaultFields.concat(nonDefaultFields)};function getDefaultFields(){var defaultFields=getSplitFields();if($scope.formConfig.hasOwnProperty("overField")===true){if(defaultFields.find(function(f){return f.name===$scope.formConfig.overField.name})===undefined){defaultFields.push($scope.formConfig.overField)}}return defaultFields}function getNonDefaultFields(defaultFields){return $scope.formConfig.influencerFields.filter(function(f){return defaultFields.find(function(sp){return sp.name===f.name})===undefined})}function getSplitFields(){if($scope.formConfig.hasOwnProperty("splitField")===false){var splitFields=$scope.formConfig.fields.map(function(f){return f.splitField}).filter(function(f){return f!==undefined&&f!==""});splitFields=_lodash.default.uniq(splitFields,"name");return splitFields}else{if($scope.formConfig.splitField===undefined){return[]}else{return[$scope.formConfig.splitField]}}}}}})},function(module,exports){module.exports='<div class="influencers-selection">\n  <div>\n    <h4\n      class="euiTitle euiTitle--small"\n      i18n-id="xpack.ml.newJob.simple.influencersSelection.keyFieldsTitle"\n      i18n-default-message="Key Fields (Influencers)"\n    ></h4>\n    <div class="euiSpacer euiSpacer--s"></div>\n  </div>\n  <div class="row">\n    <div class="col-md-12">\n      <div class="form-group">\n        <div class=\'selection-list-container\'>\n          <ui-select\n            ng-model="formConfig.influencerFields"\n            ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n            on-select="toggleInfluencerChange()"\n            on-remove="toggleInfluencerChange()"\n            multiple\n            append-to-body=true\n          >\n            <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.influencersSelection.keyFieldsAriaLabel\' | i18n: {defaultMessage: \'Key fields\'} }}">\n              <span ng-class="{\'default-influencer\': isDefaultInfluencer($item)}">\n                <ml-field-type-icon type="$item.mlType"></ml-field-type-icon>{{$item.name}}\n              </span>\n            </ui-select-match>\n            <ui-select-choices repeat="field in ui.splitFields | filter: { name: $select.search }" group-by="\'mlType\'">\n              <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n              <span class="select-item" ng-bind-html="(field.name | highlight: $select.search)"></span>\n            </ui-select-choices>\n          </ui-select>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _bucket_span_selection=_interopRequireDefault(__webpack_require__(2901));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlBucketSpanSelection",function(){return{restrict:"E",replace:true,template:_bucket_span_selection.default,controller:function controller($scope){$scope.bucketSpanFieldChange=function(){$scope.ui.bucketSpanEstimator.status=0;$scope.ui.bucketSpanEstimator.message="";$scope.formChange()};$scope.bucketSpanEstimatorExportedFunctions={}}}})},function(module,exports){module.exports='<div class=\'bucket-span-selection\'>\n  <h4\n    class="euiTitle euiTitle--small"\n    id="ml_aria_label_new_job_bucketspan"\n    i18n-id="xpack.ml.newJob.simple.bucketSpanSelection.bucketSpanTitle"\n    i18n-default-message="Bucket span"\n  ></h4><i ml-info-icon="new_job_bucketspan" />\n  <div class="euiSpacer euiSpacer--s"></div>\n  <div class="row">\n    <div class="col-md-12">\n      <div class="form-group">\n        <div>\n          <input\n            aria-labelledby="ml_aria_label_new_job_bucketspan"\n            aria-describedby="ml_aria_description_new_job_bucketspan"\n            ng-model="formConfig.bucketSpan"\n            required\n            placeholder={{formConfig-bucketSpan}}\n            ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED || ui.bucketSpanEstimator.status===1"\n            ng-change="bucketSpanFieldChange()"\n            ng-class=\'{"ng-invalid": (!ui.bucketSpanValid)}\'\n            class="form-control lowercase bucket-span-input" />\n\n          <ml-bucket-span-estimator\n            bucket-span-field-change="bucketSpanFieldChange"\n            form-config=\'formConfig\'\n            job-state-wrapper=\'{jobState:jobState}\'\n            job-state=\'JOB_STATE\'\n            ui=\'ui\'\n            exported-functions=\'bucketSpanEstimatorExportedFunctions\'>\n          </ml-bucket-span-estimator>\n\n        </div>\n        <div\n          ng-hide="ui.bucketSpanValid"\n          class="validation-error"\n          i18n-id="xpack.ml.newJob.simple.bucketSpanSelection.invalidIntervalFormatLabel"\n          i18n-default-message="Invalid interval format"\n        ></div>\n        <div ng-show="ui.bucketSpanEstimator.status===-1" class="validation-error">{{ui.bucketSpanEstimator.message}}</div>\n      </div>\n    </div>\n\n    <div class="col-md-0">\n    </div>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _general_job_details=_interopRequireDefault(__webpack_require__(2903));var _i18n=__webpack_require__(4);var _change_job_id_case=__webpack_require__(1358);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlGeneralJobDetails",function(){return{restrict:"E",replace:true,template:_general_job_details.default,controller:function controller($scope){$scope.changeJobIDCase=_change_job_id_case.changeJobIDCase;$scope.hideAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.generalJobDetails.hideAdvancedButtonAriaLabel",{defaultMessage:"Hide Advanced"});$scope.showAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.generalJobDetails.showAdvancedButtonAriaLabel",{defaultMessage:"Show Advanced"});$scope.enterNameForJobLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.generalJobDetails.enterNameForJobLabel",{defaultMessage:"Enter a name for the job"})}}})},function(module,exports){module.exports='<div class="general-job-details">\n  <div class="form-group">\n    <ml-form-label label-id="new_job_id" tooltip-append-to-body="true">\n        {{ ::\'xpack.ml.newJob.simple.generalJobDetails.nameLabel\' | i18n: {defaultMessage: \'Name\'} }}\n    </ml-form-label>\n    <input\n      aria-labelledby="ml_aria_label_new_job_id"\n      aria-describedby="ml_aria_description_new_job_id"\n      id="job-id-input"\n      ng-model="formConfig.jobId"\n      required\n      placeholder="{{ ::\'xpack.ml.newJob.simple.generalJobDetails.jobIdPlaceholder\' | i18n: {defaultMessage: \'Job ID\'} }}"\n      ng-change="changeJobIDCase(formConfig)"\n      ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n      class="form-control lowercase" />\n    <div ng-hide="ui.validation.checks.jobId.valid" class="validation-error">{{ ( ui.validation.checks.jobId.message || enterNameForJobLabel ) }}</div>\n  </div>\n\n  <div class="form-group">\n    <ml-form-label label-id="new_job_description">\n        {{ ::\'xpack.ml.newJob.simple.generalJobDetails.descriptionLabel\' | i18n: {defaultMessage: \'Description\'} }}\n    </ml-form-label>\n    <input\n      aria-labelledby="ml_aria_label_new_job_description"\n      aria-describedby="ml_aria_description_new_job_description"\n      ng-model="formConfig.description"\n      placeholder="{{ ::\'xpack.ml.newJob.simple.generalJobDetails.jobDescriptionPlaceholder\' | i18n: {defaultMessage: \'Job description\'} }}"\n      ng-disabled="jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n      class="form-control" />\n  </div>\n  <div class="form-group">\n    <ml-form-label label-id="new_job_group">\n        {{ ::\'xpack.ml.newJob.simple.generalJobDetails.jobGroupsLabel\' | i18n: {defaultMessage: \'Job Groups\'} }}\n    </ml-form-label>\n    <ml-job-group-select\n      aria-labelledby="ml_aria_label_new_job_group"\n      aria-describedby="ml_aria_description_new_job_group"\n      job-groups=\'formConfig.jobGroups\'\n      disabled=\'(jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)\' />\n    <div ng-hide="ui.validation.checks.groupIds.valid" class="validation-error">{{ ui.validation.checks.groupIds.message }}</div>\n  </div>\n\n  <div class="form-group">\n    <div ng-click="ui.showAdvanced = (!ui.showAdvanced || formConfig.useDedicatedIndex)" class="advanced-button-container">\n      <button\n        aria-label="{{ ui.showAdvanced ? hideAdvancedButtonAriaLabel : showAdvancedButtonAriaLabel }}"\n        ng-disabled="formConfig.useDedicatedIndex"\n        type="button"\n        class="kuiButton kuiButton--small kuiButton--hollow advanced-button">\n        <i aria-hidden="true" ng-class="{ \'fa-caret-down\': ui.showAdvanced, \'fa-caret-right\': !ui.showAdvanced }" class="fa"></i>\n      </button>\n      <label\n        class="kuiFormLabel"\n        aria-describedby="ml_aria_description_new_job_advanced_settings"\n        i18n-id="xpack.ml.newJob.simple.generalJobDetails.advancedLabel"\n        i18n-default-message="Advanced"\n      ></label>\n      <i ml-info-icon="new_job_advanced_settings" ></i>\n    </div>\n    <div class=\'advanced-group\' ng-show="ui.showAdvanced">\n      <div class="form-group">\n        <ml-enable-model-plot-checkbox\n          form-config=\'formConfig\'\n          ui=\'ui\'\n          get-job-from-config=\'getJobFromConfig\'>\n        </ml-enable-model-plot-checkbox>\n      </div>\n      <div class="form-group">\n      <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n        <input type="checkbox"\n          aria-labelledby="ml_aria_label_new_job_dedicated_index"\n          aria-describedby="ml_aria_description_new_job_dedicated_index"\n          class=\'kuiCheckBox\'\n          ng-model  ="formConfig.useDedicatedIndex" />\n        <span class=\'kuiCheckBoxLabel__text dedicated-index-label\'>\n          <span\n            id="ml_aria_label_new_job_dedicated_index"\n            i18n-id="xpack.ml.newJob.simple.generalJobDetails.useDedicatedIndexLabel"\n            i18n-default-message="Use dedicated index"\n          ></span>\n          <i ml-info-icon="new_job_dedicated_index" ></i>\n        </span>\n      </label>\n      </div>\n      <div class="form-group">\n        <label class=\'kuiFormLabel kuiVerticalRhythm\'>\n          <span\n            id="ml_aria_label_new_job_model_memory_limit"\n            i18n-id="xpack.ml.newJob.simple.generalJobDetails.modelMemoryLimitLabel"\n            i18n-default-message="Model memory limit"\n          ></span>\n          <i ml-info-icon="new_job_model_memory_limit"></i>\n        </label>\n        <div></div>\n        <input\n          aria-labelledby="ml_aria_label_new_job_model_memory_limit"\n          aria-describedby="ml_aria_description_new_job_model_memory_limit"\n          type="text"\n          ng-model=\'formConfig.modelMemoryLimit\'\n          class="kuiTextInput kuiTextInput--large model-memory-input-input" />\n        <div ng-hide="ui.validation.checks.modelMemoryLimit.valid" class="validation-error">{{ ui.validation.checks.modelMemoryLimit.message }}</div>\n      </div>\n    </div>\n  </div>\n  <div class="form-group"></div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _i18n=__webpack_require__(4);var _reactDom=_interopRequireDefault(__webpack_require__(17));var _enable_model_plot_checkbox_view=__webpack_require__(2905);var _ml_api_service=__webpack_require__(24);var _new_job_utils=__webpack_require__(294);var _i18n2=__webpack_require__(15);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlEnableModelPlotCheckbox",function(){return{restrict:"AE",replace:false,scope:{formConfig:"=",ui:"=ui",getJobFromConfig:"="},link:function link($scope,$element){var STATUS={FAILED:-1,NOT_RUNNING:0,RUNNING:1,FINISHED:2,WARNING:3};function errorHandler(error){console.log("Cardinality could not be validated",error);$scope.ui.cardinalityValidator.status=STATUS.FAILED;$scope.ui.cardinalityValidator.message=_i18n.i18n.translate("xpack.ml.newJob.simple.enableModelPlot.validatingConfigurationErrorMessage",{defaultMessage:"An error occurred validating the configuration "+"for running the job with model plot enabled. "+"Creating model plots can be resource intensive and not recommended where the cardinality of the selected fields is high. "+"You may want to select a dedicated results index on the Job Details tab."});$scope.formConfig.useDedicatedIndex=true}function validateCardinality(){$scope.ui.cardinalityValidator.status=STATUS.RUNNING;$scope.ui.cardinalityValidator.message="";var tempJob=$scope.getJobFromConfig($scope.formConfig);_ml_api_service.ml.validateCardinality(tempJob).then(function(response){var validationResult=(0,_new_job_utils.checkCardinalitySuccess)(response);if(validationResult.success===true){$scope.formConfig.enableModelPlot=true;$scope.ui.cardinalityValidator.status=STATUS.FINISHED}else{$scope.ui.cardinalityValidator.message=_i18n.i18n.translate("xpack.ml.newJob.simple.enableModelPlot.enableModelPlotDescription",{defaultMessage:"Creating model plots is resource intensive and not recommended "+"where the cardinality of the selected fields is greater than 100. Estimated cardinality "+"for this job is {highCardinality}. "+"If you enable model plot with this configuration we recommend you use a dedicated results index.",values:{highCardinality:validationResult.highCardinality}});$scope.ui.cardinalityValidator.status=STATUS.WARNING;$scope.formConfig.useDedicatedIndex=true;$scope.ui.showAdvanced=true}}).catch(errorHandler).then(function(){$scope.$applyAsync()})}function revalidateCardinalityOnFieldChange(){if($scope.formConfig.enableModelPlot===true&&$scope.ui.formValid===true){validateCardinality()}}$scope.handleCheckboxChange=function(isChecked){if(isChecked){$scope.formConfig.enableModelPlot=true;validateCardinality()}else{$scope.formConfig.enableModelPlot=false;$scope.ui.cardinalityValidator.status=STATUS.FINISHED;$scope.ui.cardinalityValidator.message="";updateCheckbox()}};$scope.$watch("ui.formValid",updateCheckbox,true);$scope.$watch("ui.cardinalityValidator.status",updateCheckbox,true);$scope.$watch("formConfig.fields",revalidateCardinalityOnFieldChange,true);$scope.$watch("formConfig.splitField",revalidateCardinalityOnFieldChange,true);$scope.$watch("formConfig.overField",revalidateCardinalityOnFieldChange,true);function updateCheckbox(){var checkboxDisabled=$scope.ui.cardinalityValidator.status===STATUS.RUNNING&&$scope.formConfig.enableModelPlot===true||$scope.ui.formValid!==true&&$scope.formConfig.enableModelPlot===false;var validatorRunning=$scope.ui.cardinalityValidator.status===STATUS.RUNNING;var warningStatus=($scope.ui.cardinalityValidator.status===STATUS.WARNING||$scope.ui.cardinalityValidator.status===STATUS.FAILED)&&$scope.ui.formValid===true;var checkboxText=validatorRunning?_i18n.i18n.translate("xpack.ml.newJob.simple.enableModelPlot.validatingCardinalityLabel",{defaultMessage:"Validating cardinality…"}):_i18n.i18n.translate("xpack.ml.newJob.simple.enableModelPlot.enableModelPlotLabel",{defaultMessage:"Enable model plot"});var props={checkboxDisabled:checkboxDisabled,checkboxText:checkboxText,onCheckboxChange:$scope.handleCheckboxChange,warningContent:$scope.ui.cardinalityValidator.message,warningStatus:warningStatus};_reactDom.default.render(_react.default.createElement(_i18n2.I18nContext,null,_react.default.createElement(_enable_model_plot_checkbox_view.EnableModelPlotCheckbox,props)),$element[0])}updateCheckbox()}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EnableModelPlotCheckbox=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _json_tooltip=__webpack_require__(893);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EnableModelPlotCheckbox=function(_Component){_inherits(EnableModelPlotCheckbox,_Component);function EnableModelPlotCheckbox(props){var _this;_classCallCheck(this,EnableModelPlotCheckbox);_this=_possibleConstructorReturn(this,_getPrototypeOf(EnableModelPlotCheckbox).call(this,props));_defineProperty(_assertThisInitialized(_this),"warningTitle",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.enableModelPlot.proceedWithCautionWarningTitle",defaultMessage:"Proceed with caution!"}));_defineProperty(_assertThisInitialized(_this),"onChange",function(e){_this.setState({checked:e.target.checked});_this.props.onCheckboxChange(e.target.checked)});_defineProperty(_assertThisInitialized(_this),"renderWarningCallout",function(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCallOut,{title:_this.warningTitle,color:"warning",iconType:"help"},_react.default.createElement("p",null,_this.props.warningContent)))))});_this.state={checked:false};return _this}_createClass(EnableModelPlotCheckbox,[{key:"render",value:function render(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"new_job_enable_model_plot",label:this.props.checkboxText,onChange:this.onChange,disabled:this.props.checkboxDisabled,checked:this.state.checked})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_json_tooltip.JsonTooltip,{id:"new_job_enable_model_plot",position:"top"}))),this.props.warningStatus&&this.renderWarningCallout())}}]);return EnableModelPlotCheckbox}(_react.Component);exports.EnableModelPlotCheckbox=EnableModelPlotCheckbox;EnableModelPlotCheckbox.propTypes={checkboxDisabled:_propTypes.default.bool,checkboxText:_propTypes.default.string.isRequired,onCheckboxChange:_propTypes.default.func.isRequired,warningStatus:_propTypes.default.bool.isRequired,warningContent:_propTypes.default.string.isRequired};EnableModelPlotCheckbox.defaultProps={checkboxDisabled:false}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getTooltips=void 0;var _i18n=__webpack_require__(4);var tooltips;var getTooltips=function getTooltips(){if(tooltips){return tooltips}return tooltips={new_job_id:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobIdTooltip",{defaultMessage:"Unique identifier for job, can use lowercase alphanumeric and underscores."})},new_job_description:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDescriptionTooltip",{defaultMessage:"Optional descriptive text."})},new_job_group:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobGroupTooltip",{defaultMessage:"Optional grouping for jobs. New groups can be created or picked from the list of existing groups."})},new_job_custom_urls:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobCustomUrlsTooltip",{defaultMessage:"Optional drill-through links to source data. Supports string substitution for analyzed fields e.g. {hostnameParam}.",values:{hostnameParam:"$hostname$"}})},new_job_bucketspan:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobBucketSpanTooltip",{defaultMessage:"Interval for time series analysis."})},new_job_sparsedata:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobSparseDataTooltip",{defaultMessage:"Check if you wish to ignore empty buckets from being considered anomalous."})},new_job_summarycountfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobSummaryCountFieldNameTooltip",{defaultMessage:"Optional, for use if input data has been pre-summarized e.g. {docCountParam}.",values:{docCountParam:"doc_count"}})},new_job_categorizationfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobCategorizationFieldNameTooltip",{defaultMessage:"Optional, for use if analyzing unstructured log data. Using text data types is recommended."})},new_job_categorizationfilters:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobCategorizationFiltersTooltip",{defaultMessage:"Optional, apply regular expressions to the categorization field"})},new_job_detectors:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorsTooltip",{defaultMessage:"Defines the fields and functions used for analysis."})},new_job_influencers:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobInfluencersTooltip",{defaultMessage:"Select which categorical fields have influence on the results. "+'Who/what might you "blame" for an anomaly? Recommend 1-3 influencers.'})},new_job_detector_description:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorDescriptionTooltip",{defaultMessage:"User-friendly text used for dashboards."})},new_job_detector_function:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorFunctionTooltip",{defaultMessage:"Analysis functions to be performed e.g. sum, count."})},new_job_detector_fieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorFieldNameTooltip",{defaultMessage:"Required for functions: sum, mean, median, max, min, info_content, distinct_count."})},new_job_detector_fieldname_subset:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorFieldNameSubsetTooltip",{defaultMessage:"Required for functions: sum, mean, max, min, distinct_count."})},new_job_detector_byfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorByFieldNameTooltip",{defaultMessage:"Required for individual analysis where anomalies are detected compared to an entity's own past behavior."})},new_job_detector_overfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorOverFieldNameTooltip",{defaultMessage:"Required for population analysis where anomalies are detected compared to the behavior of the population."})},new_job_detector_partitionfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorPartitionFieldNameTooltip",{defaultMessage:"Allows segmentation of modeling into logical groups."})},new_job_detector_excludefrequent:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDetectorExcludeFrequentTooltip",{defaultMessage:"If true will automatically identify and exclude frequently occurring entities which "+"may otherwise have dominated results."})},new_job_data_format:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDataFormatTooltip",{defaultMessage:"Describes the format of the input data: delimited, JSON, single line or Elasticsearch."})},new_job_time_field:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobTimeFieldTooltip",{defaultMessage:"Name of the field containing the timestamp."})},new_job_time_format:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobTimeFormatTooltip",{defaultMessage:"Format of the time field: epoch, epoch_ms or Java DateTimeFormatter string. Important to get right."})},new_job_delimiter:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDelimiterTooltip",{defaultMessage:"Character used to separate fields."})},new_job_quote_character:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobQuoteCharacterTooltip",{defaultMessage:"Character used to encapsulate values containing reserved characters."})},new_job_enable_datafeed_job:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobEnableDatafeedJobTooltip",{defaultMessage:"Required for jobs that analyze data from Elasticsearch."})},new_job_data_source:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDataSourceTooltip",{defaultMessage:"Elasticsearch versions 1.7.x and 2+ supported."})},new_job_datafeed_query:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDatafeedQueryTooltip",{defaultMessage:"Elasticsearch Query DSL for filtering input data."})},new_job_datafeed_query_delay:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDatafeedQueryDelayTooltip",{defaultMessage:"Advanced option. Time delay in seconds, between current time and latest input data time."})},new_job_datafeed_frequency:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDatafeedFrequencyTooltip",{defaultMessage:"Advanced option. The interval between searches."})},new_job_datafeed_scrollsize:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDatafeedScrollSizeTooltip",{defaultMessage:"Advanced option. The maximum number of documents requested for a search."})},new_job_data_preview:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDataPreviewTooltip",{defaultMessage:"This preview returns the contents of the source field only."})},new_job_elasticsearch_server:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobElasticsearchServerTooltip",{defaultMessage:"Server address and port of Elasticsearch source."})},new_job_enable_authenticated:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobEnableAuthenticatedTooltip",{defaultMessage:"Select to specify username and password for secure access."})},new_job_datafeed_retrieve_source:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDatafeedRetrieveSourceTooltip",{defaultMessage:"Advanced option. Select to retrieve unfiltered _source document, instead of specified fields."})},new_job_advanced_settings:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobAdvancedSettingsTooltip",{defaultMessage:"Advanced options"})},new_job_dedicated_index:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobDedicatedIndexTooltip",{defaultMessage:"Select to store results in a separate index for this job."})},new_job_enable_model_plot:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobEnableModelPlotTooltip",{defaultMessage:"Select to enable model plot. Stores model information along with results. "+"Can add considerable overhead to the performance of the system."})},new_job_model_memory_limit:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobModelMemoryLimitTooltip",{defaultMessage:"An approximate limit for the amount of memory used by the analytical models."})},new_filter_ruleaction:{text:_i18n.i18n.translate("xpack.ml.tooltips.newFilterRuleActionTooltip",{defaultMessage:"A string specifying the rule action. Initially, the only valid option is 'filter_results' but it "+"provisions for expansion to actions like 'disable_modeling'."})},new_filter_targetfieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newFilterTargetFieldNameTooltip",{defaultMessage:"A string expecting a field name. The filter will apply on all results for the targetFieldName "+"value the ruleConditions apply. When empty, filtering applies only to results for which the ruleConditions apply."})},new_action_targetfieldvalue:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionTargetFieldValueTooltip",{defaultMessage:"A string expecting a value for targetFieldName. If any of the ruleConditions apply, all results "+"will be excluded for that particular targetValue but not for others. Can only be specified if targetFieldName is not empty."})},new_action_conditionsconnective:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionConditionsConnectiveTooltip",{defaultMessage:"The logical connective of the ruleConditions."})},new_action_ruleconditions:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionRuleConditionsTooltip",{defaultMessage:"The list of conditions used to apply the rules."})},new_action_conditiontype:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionConditionTypeTooltip",{defaultMessage:"A string specifying the condition type."})},new_action_fieldname:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionFieldNameTooltip",{defaultMessage:"A string specifying the field name on which the rule applies. When empty, rule applies to all results."})},new_action_fieldvalue:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionFieldValueTooltip",{defaultMessage:"A string specifying the numerical field value on which the rule applies. "+"When empty, rule applies to all values of fieldName. Can only be specified if fieldName is not empty."})},new_action_condition:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionConditionTooltip",{defaultMessage:"The condition comparing fieldValue and value."})},new_action_value:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionValueTooltip",{defaultMessage:"The numerical value to compare against fieldValue."})},new_action_valuelist:{text:_i18n.i18n.translate("xpack.ml.tooltips.newActionValueListTooltip",{defaultMessage:"A string that is a unique identifier to a list. Only applicable and required when conditionType is categorical."})},forecasting_modal_run_duration:{text:_i18n.i18n.translate("xpack.ml.tooltips.forecastingModalRunDurationTooltip",{defaultMessage:"Length of forecast, up to a maximum of 3650 days. "+"Use s for seconds, m for minutes, h for hours, d for days, w for weeks."})},forecasting_modal_view_list:{text:_i18n.i18n.translate("xpack.ml.tooltips.forecastingModalViewListTooltip",{defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},new_job_recognizer_job_prefix:{text:_i18n.i18n.translate("xpack.ml.tooltips.newJobRecognizerJobPrefixTooltip",{defaultMessage:"A prefix which will be added to the beginning of each job ID."})},new_custom_url_label:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlLabelTooltip",{defaultMessage:"A label for the drill-through link."})},new_custom_url_link_to:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlLinkToTooltip",{defaultMessage:"Link to a Kibana dashboard, Discover or another URL."})},new_custom_url_dashboard:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlDashboardTooltip",{defaultMessage:"The dashboard to link to."})},new_custom_url_discover_index:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlDiscoverIndexTooltip",{defaultMessage:"The index pattern to view in Discover."})},new_custom_url_query_entity:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlQueryEntityTooltip",{defaultMessage:"Optional, entities from the anomaly that will be used in the dashboard query."})},new_custom_url_value:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlValueTooltip",{defaultMessage:"URL of the drill-through link. Supports string substitution for analyzed fields e.g. {hostnameParam}.",values:{hostnameParam:"$hostname$"}})},new_custom_url_time_range:{text:_i18n.i18n.translate("xpack.ml.tooltips.newCustomUrlTimeRangeTooltip",{defaultMessage:"The time span that will be displayed in the drill-down page. "+"Set automatically, or enter a specific interval e.g. 10m or 1h."})}}};exports.getTooltips=getTooltips},function(module,exports,__webpack_require__){"use strict";var _field_types=__webpack_require__(295);var _general=__webpack_require__(361);var _modules=__webpack_require__(8);var _module=_modules.uiModules.get("apps/ml");_module.filter("filterAggTypes",function(){return function(aggTypes,field){return aggTypes.filter(function(type){if(field.id===_general.EVENT_RATE_COUNT_FIELD){if(type.isCountType){return true}}else{if(!type.isCountType){if(field.mlType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD||field.mlType===_field_types.ML_JOB_FIELD_TYPES.IP){if(type.isAggregatableStringType){return true}}else{return true}}}return false})}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2909)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2910);__webpack_require__(1370);__webpack_require__(2912);__webpack_require__(296);__webpack_require__(500);__webpack_require__(681);__webpack_require__(892);__webpack_require__(1364);__webpack_require__(2913);__webpack_require__(1365);__webpack_require__(1366);__webpack_require__(1367);__webpack_require__(1368);__webpack_require__(1369);__webpack_require__(577);__webpack_require__(682);__webpack_require__(402);__webpack_require__(683)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);__webpack_require__(360);var _index=__webpack_require__(397);var _validation_utils=__webpack_require__(680);var _parse_interval=__webpack_require__(313);var _datemath=_interopRequireDefault(__webpack_require__(55));var _angular=_interopRequireDefault(__webpack_require__(26));var _routes=_interopRequireDefault(__webpack_require__(19));var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _ml_time_buckets=__webpack_require__(338);var _breadcrumbs=__webpack_require__(400);var _filter_agg_types=__webpack_require__(888);var _validate_job=__webpack_require__(678);var _adjust_interval=__webpack_require__(889);var _states=__webpack_require__(579);var _create_fields=__webpack_require__(890);var _index_utils=__webpack_require__(226);var _chart_data_utils=__webpack_require__(1362);var _check_ml_nodes=__webpack_require__(71);var _new_job_defaults=__webpack_require__(337);var _string_utils=__webpack_require__(67);var _new_job_utils=__webpack_require__(294);var _job_service=__webpack_require__(36);var _prepopulate_job_settings=__webpack_require__(891);var _create_job_service=__webpack_require__(1370);var _messagebar_service=__webpack_require__(268);var _create_job=_interopRequireDefault(__webpack_require__(2911));var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job/simple/population",{template:_create_job.default,k7Breadcrumbs:_breadcrumbs.getCreatePopulationJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlCreatePopulationJob",function($scope,$timeout,Private,AppState){_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var msgs=_messagebar_service.mlMessageBarService;var MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var moveToAdvancedJobCreation=Private(_new_job_utils.moveToAdvancedJobCreationProvider);var chartDataUtils=Private(_chart_data_utils.ChartDataUtilsProvider);var mlPopulationJobService=Private(_create_job_service.PopulationJobServiceProvider);$scope.addNewJobToRecentlyAccessed=_new_job_utils.addNewJobToRecentlyAccessed;var stateDefaults={mlJobSettings:{}};var appState=new AppState(stateDefaults);mlPopulationJobService.clearChartData();$scope.chartData=mlPopulationJobService.chartData;var jobDefaults=(0,_new_job_defaults.newJobDefaults)();var PAGE_WIDTH=_angular.default.element(".population-job-container").width();var BAR_TARGET=PAGE_WIDTH>1600?800:PAGE_WIDTH/2;var MAX_BARS=BAR_TARGET+BAR_TARGET/100*100;var REFRESH_INTERVAL_MS=100;var MAX_BUCKET_DIFF=3;var METRIC_AGG_TYPE="metrics";var DEFAULT_MODEL_MEMORY_LIMIT=jobDefaults.anomaly_detectors.model_memory_limit;var refreshCounter=0;$scope.JOB_STATE=_states.JOB_STATE;$scope.jobState=$scope.JOB_STATE.NOT_STARTED;$scope.CHART_STATE=_states.CHART_STATE;$scope.chartStates={eventRate:_states.CHART_STATE.LOADING,fields:{}};var globalForceStop=false;var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;(0,_index_utils.timeBasedIndexCheck)(indexPattern,true);var pageTitle=savedSearch.id!==undefined?_i18n.i18n.translate("xpack.ml.newJob.simple.population.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.title}}):_i18n.i18n.translate("xpack.ml.newJob.simple.population.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});$scope.analysisStoppingLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.population.analysisStoppingLabel",{defaultMessage:"Analysis stopping"});$scope.stopAnalysisLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.population.stopAnalysisLabel",{defaultMessage:"Stop analysis"});$scope.ui={indexPattern:indexPattern,pageTitle:pageTitle,showJobInput:true,showJobFinished:false,dirty:false,formValid:false,bucketSpanValid:true,bucketSpanEstimator:{status:0,message:""},cardinalityValidator:{status:0,message:""},aggTypeOptions:(0,_filter_agg_types.filterAggTypes)(_index.aggTypes.byType[METRIC_AGG_TYPE]),fields:[],overFields:[],splitFields:[],timeFields:[],splitText:"",intervals:[{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.autoTitle",{defaultMessage:"Auto"}),value:"auto"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.millisecondTitle",{defaultMessage:"Millisecond"}),value:"ms"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.secondTitle",{defaultMessage:"Second"}),value:"s"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.minuteTitle",{defaultMessage:"Minute"}),value:"m"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.hourlyTitle",{defaultMessage:"Hourly"}),value:"h"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.dailyTitle",{defaultMessage:"Daily"}),value:"d"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.weeklyTitle",{defaultMessage:"Weekly"}),value:"w"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.monthlyTitle",{defaultMessage:"Monthly"}),value:"M"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.yearlyTitle",{defaultMessage:"Yearly"}),value:"y"},{title:_i18n.i18n.translate("xpack.ml.newJob.simple.population.intervals.customTitle",{defaultMessage:"Custom"}),value:"custom"}],eventRateChartHeight:100,chartHeight:150,showFieldCharts:false,showAdvanced:false,validation:{checks:{jobId:{valid:true},groupIds:{valid:true},modelMemoryLimit:{valid:true},duplicateDetectors:{valid:true}}},isOverField:function isOverField(field){return field.name===$scope.formConfig.overField.name?null:field}};$scope.formConfig={agg:{type:undefined},fields:[],bucketSpan:"15m",chartInterval:undefined,resultsIntervalSeconds:undefined,start:0,end:0,overField:undefined,timeField:indexPattern.timeFieldName,influencerFields:[],firstSplitFieldName:undefined,indexPattern:indexPattern,combinedQuery:combinedQuery,usesSavedSearch:savedSearch.id!==undefined,jobId:"",description:"",jobGroups:[],useDedicatedIndex:false,enableModelPlot:false,modelMemoryLimit:DEFAULT_MODEL_MEMORY_LIMIT};$scope.formChange=function(refreshCardLayout){$scope.ui.isFormValid();$scope.ui.dirty=true;$scope.loadVis();if(refreshCardLayout){sortSplitCards()}};$scope.overChange=function(){$scope.addDefaultFieldsToInfluencerList();$scope.formChange()};$scope.splitChange=function(fieldIndex,splitField){return new Promise(function(resolve){$scope.formConfig.fields[fieldIndex].firstSplitFieldName=undefined;if(splitField!==undefined){$scope.formConfig.fields[fieldIndex].splitField=splitField;$scope.addDefaultFieldsToInfluencerList();chartDataUtils.getSplitFields($scope.formConfig,splitField.name,10).then(function(resp){if(resp.results.values&&resp.results.values.length){$scope.formConfig.fields[fieldIndex].firstSplitFieldName=resp.results.values[0];$scope.formConfig.fields[fieldIndex].cardLabels=resp.results.values}drawCards(fieldIndex,true);$scope.formChange();resolve()})}else{$scope.formConfig.fields[fieldIndex].splitField=undefined;$scope.formConfig.fields[fieldIndex].cardLabels=undefined;setFieldsChartStates(_states.CHART_STATE.LOADING);$scope.toggleInfluencerChange();$scope.ui.splitText="";destroyCards(fieldIndex);$scope.formChange();resolve()}})};$scope.splitReset=function(fieldIndex){$scope.splitChange(fieldIndex,undefined)};function setTime(){$scope.ui.bucketSpanValid=true;$scope.formConfig.start=_datemath.default.parse(_timefilter.timefilter.getTime().from).valueOf();$scope.formConfig.end=_datemath.default.parse(_timefilter.timefilter.getTime().to).valueOf();$scope.formConfig.format="epoch_millis";var bucketSpanInterval=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan);if(bucketSpanInterval===null||bucketSpanInterval.asMilliseconds()===0){$scope.ui.bucketSpanValid=false}var bounds=_timefilter.timefilter.getActiveBounds();$scope.formConfig.chartInterval=new MlTimeBuckets;$scope.formConfig.chartInterval.setBarTarget(BAR_TARGET);$scope.formConfig.chartInterval.setMaxBars(MAX_BARS);$scope.formConfig.chartInterval.setInterval("auto");$scope.formConfig.chartInterval.setBounds(bounds);(0,_adjust_interval.adjustIntervalDisplayed)($scope.formConfig);$scope.ui.isFormValid();$scope.ui.dirty=true}function initAgg(){_lodash.default.each($scope.ui.aggTypeOptions,function(agg){if(agg.mlName==="mean"){$scope.formConfig.agg.type=agg}})}$scope.ui.isFormValid=function(){if($scope.formConfig.agg.type===undefined||$scope.formConfig.timeField===undefined||$scope.formConfig.fields.length===0){$scope.ui.formValid=false}else{$scope.ui.formValid=true}return $scope.ui.formValid};$scope.loadVis=function(){var thisLoadTimestamp=Date.now();$scope.chartData.lastLoadTimestamp=thisLoadTimestamp;setTime();$scope.ui.isFormValid();$scope.ui.showJobInput=true;$scope.ui.showJobFinished=false;$scope.ui.dirty=false;mlPopulationJobService.clearChartData();setFieldsChartStates(_states.CHART_STATE.LOADING);if($scope.formConfig.fields.length){$scope.ui.showFieldCharts=true;mlPopulationJobService.getLineChartResults($scope.formConfig,thisLoadTimestamp).then(function(resp){$scope.$applyAsync();loadDocCountData(resp.detectors)}).catch(function(resp){msgs.error(resp.message);$scope.formConfig.fields.forEach(function(field){var id=field.id;$scope.chartStates.fields[id]=_states.CHART_STATE.NO_RESULTS});$scope.$applyAsync()})}else{$scope.ui.showFieldCharts=false;loadDocCountData([])}function loadDocCountData(dtrs){chartDataUtils.loadDocCountData($scope.formConfig,$scope.chartData).then(function(resp){if(thisLoadTimestamp===$scope.chartData.lastLoadTimestamp){_lodash.default.each(dtrs,function(dtr,id){var state=resp.totalResults?_states.CHART_STATE.LOADED:_states.CHART_STATE.NO_RESULTS;$scope.chartStates.fields[id]=state});$scope.chartData.lastLoadTimestamp=null;chartDataUtils.updateChartMargin($scope.chartData);$scope.chartStates.eventRate=resp.totalResults?_states.CHART_STATE.LOADED:_states.CHART_STATE.NO_RESULTS;$scope.$broadcast("render")}}).catch(function(resp){$scope.chartStates.eventRate=_states.CHART_STATE.NO_RESULTS;msgs.error(resp.message)}).then(function(){$scope.$applyAsync()})}};function setFieldsChartStates(state){_lodash.default.each($scope.chartStates.fields,function(chart,key){$scope.chartStates.fields[key]=state});$scope.$applyAsync()}function drawCards(fieldIndex){var animate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var labels=$scope.formConfig.fields[fieldIndex].cardLabels;var $frontCard=_angular.default.element(".population-job-container .detector-container.card-".concat(fieldIndex," .card-front"));$frontCard.addClass("card");$frontCard.find(".card-title").text(labels[0]);var marginTop=labels.length>1?54:0;$frontCard.css("margin-top",marginTop);var backCardTitle="";if(labels.length===2){backCardTitle=$scope.formConfig.fields[Object.keys($scope.formConfig.fields)[0]].agg.type.title;backCardTitle+=" ";backCardTitle+=Object.keys($scope.formConfig.fields)[0]}_angular.default.element(".detector-container.card-".concat(fieldIndex," .card-behind")).remove();for(var _i=0;_i<labels.length;_i++){var el='<div class="card card-behind card-behind-'.concat(_i,'"><div class="card-title">');el+=(0,_string_utils.mlEscape)(labels[_i]);el+='</div><label class="kuiFormLabel">';el+=(0,_string_utils.mlEscape)(backCardTitle);el+="</label></div>";var $backCard=_angular.default.element(el);$backCard.css("z-index",9-_i);$backCard.insertBefore($frontCard)}var cardsBehind=_angular.default.element(".detector-container.card-".concat(fieldIndex," .card-behind"));for(var _i2=0;_i2<cardsBehind.length;_i2++){cardsBehind[_i2].style.marginTop=marginTop+"px";marginTop-=(10-_i2*(10/labels.length))*(10/labels.length)}var i=0;var then=window.performance.now();var fps=20;var fpsInterval=1e3/fps;function fadeCard(callTime){if(i<cardsBehind.length){var now=callTime;var elapsed=now-then;if(elapsed>fpsInterval){cardsBehind[i].style.opacity=1;i++;then=now-elapsed%fpsInterval}window.requestAnimationFrame(fadeCard)}}if(animate){fadeCard()}else{for(var j=0;j<cardsBehind.length;j++){cardsBehind[j].style.opacity=1}}}function destroyCards(fieldIndex){_angular.default.element(".detector-container.card-".concat(fieldIndex," .card-behind")).remove();var $frontCard=_angular.default.element(".population-job-container .detector-container.card-".concat(fieldIndex," .card-front"));$frontCard.removeClass("card");$frontCard.find(".card-title").text("");$frontCard.css("margin-top",0)}function sortSplitCards(){$timeout(function(){$scope.formConfig.fields.forEach(function(f,i){if(f.splitField===undefined){destroyCards(i)}else{drawCards(i,false)}})},0)}var refreshInterval=REFRESH_INTERVAL_MS;$scope.createJob=function(){var tempJob=mlPopulationJobService.getJobFromConfig($scope.formConfig);if((0,_validate_job.validateJob)(tempJob,$scope.ui.validation.checks)){msgs.clear();mlPopulationJobService.createJob($scope.formConfig).then(function(job){_job_service.mlJobService.openJob(job.job_id).then(function(){saveNewDatafeed(job,true)}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.population.couldNotOpenJobErrorMessage",{defaultMessage:"Could not open job:"}),resp);msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.population.jobCreatedAndDatafeedCreatingAnywayErrorMessage",{defaultMessage:"Job created, creating datafeed anyway"}));saveNewDatafeed(job,false)})}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.population.saveFailedErrorMessage",{defaultMessage:"Save failed:"}),resp.resp);$scope.$applyAsync()})}else{if($scope.ui.validation.checks.modelMemoryLimit.valid===false){$scope.ui.showAdvanced=true}}function saveNewDatafeed(job,startDatafeedAfterSave){_job_service.mlJobService.saveNewDatafeed(job.datafeed_config,job.job_id).then(function(){if(startDatafeedAfterSave){mlPopulationJobService.startDatafeed($scope.formConfig).then(function(){$scope.jobState=_states.JOB_STATE.RUNNING;refreshCounter=0;refreshInterval=REFRESH_INTERVAL_MS;$scope.formConfig.resultsIntervalSeconds=$scope.formConfig.chartInterval.getInterval().asSeconds();var bucketSpanSeconds=(0,_parse_interval.parseInterval)($scope.formConfig.bucketSpan).asSeconds();if($scope.formConfig.resultsIntervalSeconds<bucketSpanSeconds){$scope.formConfig.resultsIntervalSeconds=bucketSpanSeconds}$scope.resultsUrl=_job_service.mlJobService.createResultsUrl([$scope.formConfig.jobId],$scope.formConfig.start,$scope.formConfig.end,"explorer");(0,_new_job_utils.focusOnResultsLink)("job_running_view_results_link",$timeout);loadCharts()}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.population.couldNotStartDatafeedErrorMessage",{defaultMessage:"Could not start datafeed:"}),resp)}).then(function(){$scope.$applyAsync()})}else{$scope.$applyAsync()}}).catch(function(resp){msgs.error(_i18n.i18n.translate("xpack.ml.newJob.simple.population.saveDatafeedFailedErrorMessage",{defaultMessage:"Save datafeed failed:"}),resp);$scope.$applyAsync()})}};$scope.getJobFromConfig=mlPopulationJobService.getJobFromConfig;(0,_validation_utils.addJobValidationMethods)($scope,mlPopulationJobService);function loadCharts(){var forceStop=globalForceStop;var counterLimit=20-refreshInterval/REFRESH_INTERVAL_MS;if(refreshCounter>=counterLimit){refreshCounter=0;_job_service.mlJobService.updateSingleJobDatafeedState($scope.formConfig.jobId).then(function(state){if(state==="stopped"){console.log("Stopping poll because datafeed state is: "+state);$scope.$applyAsync();$scope.$broadcast("render-results");forceStop=true}run()})}else{run()}function run(){refreshCounter++;reloadJobSwimlaneData().then(function(){reloadDetectorSwimlane().then(function(){if(forceStop===false&&$scope.chartData.percentComplete<100){if($scope.jobState===_states.JOB_STATE.STOPPING){$scope.jobState=_states.JOB_STATE.STOPPING}else{$scope.jobState=_states.JOB_STATE.RUNNING}}else{$scope.jobState=_states.JOB_STATE.FINISHED;(0,_new_job_utils.focusOnResultsLink)("job_finished_view_results_link",$timeout)}jobCheck()})})}}function jobCheck(){if($scope.jobState===_states.JOB_STATE.RUNNING||$scope.jobState===_states.JOB_STATE.STOPPING){refreshInterval=adjustRefreshInterval($scope.chartData.loadingDifference,refreshInterval);_lodash.default.delay(loadCharts,refreshInterval)}else{_lodash.default.each($scope.chartData.detectors,function(chart){chart.percentComplete=100})}if($scope.chartData.percentComplete>0){toggleSwimlaneVisibility()}$scope.$applyAsync();$scope.$broadcast("render-results")}function reloadJobSwimlaneData(){return chartDataUtils.loadJobSwimlaneData($scope.formConfig,$scope.chartData)}function reloadDetectorSwimlane(){return chartDataUtils.loadDetectorSwimlaneData($scope.formConfig,$scope.chartData)}function adjustRefreshInterval(loadingDifference,currentInterval){var INTERVAL_INCREASE_MS=100;var MAX_INTERVAL=1e4;var interval=currentInterval;if(interval<MAX_INTERVAL){if(loadingDifference<MAX_BUCKET_DIFF){interval=interval+INTERVAL_INCREASE_MS}else{if(interval-INTERVAL_INCREASE_MS>=REFRESH_INTERVAL_MS){interval=interval-INTERVAL_INCREASE_MS}}}return interval}$scope.resetJob=function(){$scope.jobState=_states.JOB_STATE.NOT_STARTED;toggleSwimlaneVisibility();window.setTimeout(function(){$scope.ui.showJobInput=true;$scope.loadVis()},500)};function toggleSwimlaneVisibility(){if($scope.jobState===_states.JOB_STATE.NOT_STARTED){_angular.default.element(".swimlane-cells").css("opacity",0);_angular.default.element(".bar").css("opacity",1)}else{_angular.default.element(".bar").css("opacity",.1)}}$scope.stopJob=function(){$scope.jobState=_states.JOB_STATE.STOPPING;mlPopulationJobService.stopDatafeed($scope.formConfig).catch(function(){}).then(function(){$scope.$applyAsync()})};$scope.moveToAdvancedJobCreation=function(){var job=mlPopulationJobService.getJobFromConfig($scope.formConfig);moveToAdvancedJobCreation(job)};initAgg();(0,_create_fields.createFields)($scope,indexPattern);$scope.loadVis();$scope.$evalAsync(function(){(0,_prepopulate_job_settings.preLoadJob)($scope,appState)});$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",$scope.loadVis);$scope.$on("$destroy",function(){globalForceStop=true;_angular.default.element(window).off("resize")})})},function(module,exports){module.exports='<ml-nav-menu name="new_job_population"></ml-nav-menu>\n<ml-chart-tooltip></ml-chart-tooltip>\n<ml-new-job-population>\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlCreatePopulationJob" class="population-job-container">\n    <div class="row">\n      <div class="col-md-6">\n        <h3\n          class="euiTitle euiTitle--large"\n          i18n-id="xpack.ml.newJob.simple.population.newJobFromTitle"\n          i18n-default-message="New job from {pageTitle}"\n          i18n-values="{ pageTitle: ui.pageTitle }"\n        ></h3>\n      </div>\n      <div class="col-md-6">\n        <div class="pull-right">\n          <span\n            style="font-size:10px;"\n            ng-show="formConfig.chartInterval !== undefined"\n            i18n-id="xpack.ml.newJob.simple.population.chartIntervalLabel"\n            i18n-default-message="Chart interval: {interval}"\n            i18n-values="{ interval: formConfig.chartInterval.getInterval().expression }"\n          ></span>\n          <ml-full-time-range-selector\n            disabled=\'(jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)\'\n            index-pattern=\'ui.indexPattern\'\n            query=\'formConfig.combinedQuery\'\n          ></ml-full-time-range-selector>\n        </div>\n      </div>\n    </div>\n\n    <div class="euiSpacer euiSpacer--s"></div>\n\n    <div class="row">\n      <div class="col-md-4">\n        <div class="row form-controls">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.population.jobSettingsTitle"\n            i18n-default-message="Job settings"\n          ></h4>\n          <div>\n            <div class=\'form-section form-section-overflow\' >\n              <h4\n                class="euiTitle euiTitle--small"\n                i18n-id="xpack.ml.newJob.simple.population.populationTitle"\n                i18n-default-message="Population"\n              ></h4>\n              <div class="euiSpacer euiSpacer--s"></div>\n              <div class="row">\n                <div class="col-md-12">\n                  <div class="form-group">\n                    <ui-select\n                      ng-model="formConfig.overField"\n                      on-select="overChange()"\n                      ng-disabled="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                      append-to-body=true>\n                      <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.population.selectPopulationFieldPlaceholder\' | i18n: {defaultMessage: \'Select population field\'} }}">\n                        <ml-field-type-icon type="$select.selected.mlType"></ml-field-type-icon>{{$select.selected.name}}\n                      </ui-select-match>\n                      <ui-select-choices repeat="field in ui.overFields | filter: { name: $select.search }" group-by="\'mlType\'">\n                        <div>\n                          <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n                          <span\n                            class="select-item"\n                            ng-bind-html="field.name | highlight: $select.search">\n                          </span>\n                        </div>\n                      </ui-select-choices>\n                    </ui-select>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\'form-section form-section-overflow\'>\n              <ml-fields-selection-population></ml-fields-selection-population>\n              <div ng-hide="ui.validation.checks.duplicateDetectors.valid" class="validation-error">{{ ui.validation.checks.duplicateDetectors.message }}</div>\n            </div>\n\n            \x3c!-- <div class=\'form-section\' >\n              <h4 class="euiTitle euiTitle--small">Split Data</h4>\n              <div class="row">\n                <div class="col-md-12">\n                  <div class="form-group">\n                    <select\n                      ng-model="formConfig.splitField"\n                      ng-change="splitChange()"\n                      ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                      class="form-control">\n                        <option value=\'{{undefined}}\'>--No split--</option>\n                        <option ng-repeat="field in ui.splitFields" value=\'{{field}}\'>{{field}}</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div> --\x3e\n\n            <div class=\'form-section\' >\n              <ml-influencers-selection></ml-influencers-selection>\n            </div>\n\n            <div class=\'form-section\' >\n              <ml-bucket-span-selection></ml-bucket-span-selection>\n            </div>\n\n            <div class=\'form-section\' >\n              <div ng-show="jobState !== JOB_STATE.FINISHED">\n                <h4\n                  class="euiTitle euiTitle--small"\n                  i18n-id="xpack.ml.newJob.simple.population.jobDetailsTitle"\n                  i18n-default-message="Job Details"\n                ></h4>\n                <div class="euiSpacer euiSpacer--s"></div>\n              </div>\n\n              <div class="form-group">\n                <div ng-show="ui.showJobInput && (jobState === JOB_STATE.NOT_STARTED || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING)">\n                  <ml-general-job-details></ml-general-job-details>\n\n                  <div class="form-group">\n                    <a\n                      href=""\n                      ng-click="moveToAdvancedJobCreation()"\n                      i18n-id="xpack.ml.newJob.simple.population.moveToAdvancedJobConfigurationLinkText"\n                      i18n-default-message="Move to advanced job configuration"\n                    ></a>\n                  </div>\n\n                  <div class="euiFlexGroup euiFlexGroup--gutterSmall euiFlexGroup--alignItemsCenter euiFlexGroup--responsive">\n                    <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                      <ml-validate-job\n                        get-duration="getDuration"\n                        get-job-config="getJobConfig"\n                        fill="false"\n                        is-current-job-config="isCurrentJobConfig"\n                        is-disabled="!ui.formValid"\n                        ng-show="jobState === JOB_STATE.NOT_STARTED"\n                      />\n                    </div>\n                    <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                      <button\n                        aria-label="{{ ::\'xpack.ml.newJob.simple.population.createJobButtonAriaLabel\' | i18n: {defaultMessage: \'Create Job\'} }}"\n                        ng-click="createJob()"\n                        type="button"\n                        ng-show="jobState === JOB_STATE.NOT_STARTED"\n                        ng-disabled="!ui.formValid"\n                        class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                        <span\n                          class="euiButton__content"\n                          i18n-id="xpack.ml.newJob.simple.population.createJobButtonLabel"\n                          i18n-default-message="Create Job"\n                        ></span>\n                      </button>\n                    </div>\n                  </div>\n\n                  <div class=\'job-state-info\' ng-show="jobState === JOB_STATE.RUNNING">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.population.analysisRunningLabel"\n                      i18n-default-message="Analysis running"\n                    ></span>\n                    <i class=\'fa fa-spinner fa-spin\'></i>\n                  </div>\n                  <div class=\'job-state-info\' ng-show="jobState === JOB_STATE.STOPPING">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.population.analysisStoppingLabel"\n                      i18n-default-message="Analysis stopping"\n                    ></span>\n                    <i class=\'fa fa-spinner fa-spin\'></i>\n                  </div>\n\n                  <div class="euiSpacer euiSpacer--s"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.population.stopJobButtonAriaLabel\' | i18n: {defaultMessage: \'Stop Job\'} }}"\n                    ng-click="stopJob()"\n                    type="button"\n                    ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n                    ng-disabled="jobState === JOB_STATE.STOPPING"\n                    class="euiButton euiButton--danger euiButton--small">\n                    <span class="euiButton__content">\n                      {{(jobState === JOB_STATE.STOPPING) ? analysisStoppingLabel : stopAnalysisLabel }}\n                    </span>\n                  </button>\n\n                  <a\n                    href=\'{{resultsUrl}}\'\n                    id="job_running_view_results_link"\n                    ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.population.viewResultsOfRunningJobAriaLabel\' | i18n: {defaultMessage: \'View results of running job\'} }}"\n                    ng-show="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.population.viewResultsLinkText"\n                      i18n-default-message="View Results"\n                    ></span>\n                  </a>\n                </div>\n                <div ng-show="jobState === JOB_STATE.FINISHED">\n                  <h3 class="euiTitle euiTitle--large">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.population.jobCreatedTitle"\n                      i18n-default-message="Job {jobId} created"\n                      i18n-values="{ jobId: formConfig.jobId }"\n                    ></span>\n                    <i style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.population.jobFinishedAriaLabel\' | i18n: {defaultMessage: \'Job finished\'} }}"></i>\n                  </h3>\n                  <div class="euiSpacer euiSpacer--m"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.population.resetButtonAriaLabel\' | i18n: {defaultMessage: \'Reset\'} }}"\n                    ng-click="resetJob()"\n                    type="button"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.population.resetButtonLabel"\n                      i18n-default-message="Reset"\n                    ></span>\n                  </button>\n                  <a\n                    href=\'{{resultsUrl}}\'\n                    id="job_finished_view_results_link"\n                    ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.population.viewResultsOfFinishedJobAriaLabel\' | i18n: {defaultMessage: \'View results of finished job\'} }}"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.population.viewResultsLinkText"\n                      i18n-default-message="View Results"\n                    ></span>\n                  </a>\n                </div>\n\n                <div ng-if=\'jobState === JOB_STATE.FINISHED\'>\n                  <hr class="euiHorizontalRule euiHorizontalRule--full euiHorizontalRule--marginMedium">\n                  <ml-post-save-options\n                    job-id=\'formConfig.jobId\'\n                    bucket-span=\'formConfig.bucketSpan\'\n                    include-influencers=\'true\'\n                    ></ml-post-save-options>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="col-md-8">\n        <div class="row charts-container">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.population.resultsTitle"\n            i18n-default-message="Results"\n          ></h4>\n          <div>\n            <div class=\'chart-list-panel event-rate-container\' style=\'height: {{ui.eventRateChartHeight + 70}}px;\'>\n              <label\n                class="kuiFormLabel"\n                i18n-id="xpack.ml.newJob.simple.population.documentCountLabel"\n                i18n-default-message="Document count"\n              ></label>\n\n              <div class=\'chart-container\'>\n                <div style=\'height: {{ui.eventRateChartHeight + 25}}px;\'>\n                  <ml-event-rate-chart\n                    chart-data="chartData.job"\n                    event-rate-chart-height=\'ui.eventRateChartHeight\'\n                    chart-ticks-margin="chartData.chartTicksMargin">\n                  </ml-event-rate-chart>\n                </div>\n\n                <div ng-show="chartStates.eventRate === CHART_STATE.NOT_STARTED || chartStates.eventRate === CHART_STATE.LOADING || chartStates.eventRate === CHART_STATE.NO_RESULTS"\n                  class=\'chart-loader event-rate-chart-loader\'\n                  style=\'height: {{ui.eventRateChartHeight}}px; margin-top: -{{ui.eventRateChartHeight + 30}}px;\'>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.NOT_STARTED"></div>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.LOADING">\n                      <h2 class="euiTitle euiTitle"><i class=\'fa fa-spinner fa-spin\'></i></h2>\n                    </div>\n                    <div class=\'status-label\' ng-if="chartStates.eventRate === CHART_STATE.NO_RESULTS">\n                      <div class=\'no-results\'>\n                        <h4 class="euiTitle euiTitle--small">\n                          <i class="fa fa-info-circle"></i>\n                          <span\n                            i18n-id="xpack.ml.newJob.simple.population.documentCountChart.noResultsFoundTitle"\n                            i18n-default-message="No results found"\n                          ></span>\n                          </h4>\n                        <span>\n                          <span\n                            i18n-id="xpack.ml.newJob.simple.population.documentCountChart.noResultsDescription"\n                            i18n-default-message="Consider using the"\n                            i18n-description="Part of composite text xpack.ml.newJob.simple.population.documentCountChart.noResultsDescription + xpack.ml.newJob.simple.population.documentCountChart.fullIndexPatternDataLinkText"\n                          ></span>\n                          <a\n                            ng-click="setFullTimeRange()"\n                            i18n-id="xpack.ml.newJob.simple.population.documentCountChart.fullIndexPatternDataLinkText"\n                            i18n-default-message="full {indexPatternTitle} data"\n                            i18n-values="{ indexPatternTitle: ui.indexPattern.title }"\n                            i18n-description="Part of composite text xpack.ml.newJob.simple.population.documentCountChart.noResultsDescription + xpack.ml.newJob.simple.population.documentCountChart.fullIndexPatternDataLinkText"\n                          ></a>\n                        </span>\n                      </div>\n                    </div>\n                </div>\n\n              </div>\n\n            </div>\n            <div ng-repeat=\'(id, chart) in chartData.detectors track by id\'>\n              <div class=\'chart-list-panel chart-list-panel-population detector-container card-{{id}}\' ng-show=\'ui.showFieldCharts\'>\n                <div class=\'card-front\'>\n                  <div class="card-title"></div>\n                  <div class=\'chart\' style=\'height: {{ui.chartHeight + 90}}px;\'>\n                    <label\n                      ng-if="formConfig.fields[id].splitField === undefined"\n                      class="kuiFormLabel"\n                      i18n-id="xpack.ml.newJob.simple.population.chart.chartWithoutSplitFieldLabel"\n                      i18n-default-message="{aggTypeTitle} {fieldName} over {overFieldName}"\n                      i18n-values="{ aggTypeTitle: formConfig.fields[id].agg.type.title, fieldName: formConfig.fields[id].name, overFieldName: formConfig.overField.name }"\n                    ></label>\n                    <label\n                      ng-if="formConfig.fields[id].splitField !== undefined"\n                      class="kuiFormLabel"\n                      i18n-id="xpack.ml.newJob.simple.population.chart.chartWithSplitFieldLabel"\n                      i18n-default-message="{aggTypeTitle} {fieldName} over {overFieldName} split by {splitFieldName}"\n                      i18n-values="{ aggTypeTitle: formConfig.fields[id].agg.type.title, fieldName: formConfig.fields[id].name, overFieldName: formConfig.overField.name, splitFieldName: formConfig.fields[id].splitField.name }"\n                    ></label>\n                    <div class="split-controls">\n                      <div\n                        class="split-align"\n                        i18n-id="xpack.ml.newJob.simple.population.chart.splitDataLabel"\n                        i18n-default-message="Split data:"\n                      ></div>\n                      <div class="split-field-container">\n                        <ui-select\n                          class="split-field-select"\n                          ng-model="formConfig.fields[id].splitField"\n                          ng-change="splitChange(id, $select.selected)"\n                          append-to-body="true"\n                          ng-disabled="ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                        >\n                            <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.population.chart.splitFieldPlaceholder\' | i18n: {defaultMessage: \'Select a field\'} }}">\n                              <ml-field-type-icon type="$select.selected.mlType"></ml-field-type-icon>{{$select.selected.name}}\n                            </ui-select-match>\n                            <ui-select-choices repeat="field in ui.splitFields | filter: { name: $select.search } | filter: ui.isOverField" group-by="\'mlType\'">\n                              <div>\n                                <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n                                <span\n                                  class="select-item"\n                                  ng-bind-html="field.name | highlight: $select.search">\n                                </span>\n                              </div>\n                            </ui-select-choices>\n                        </ui-select>\n                      </div>\n                      <button\n                        ng-if="formConfig.fields[id].splitField !== undefined && (!ui.formValid === false || jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED)"\n                        ng-click="splitReset(id)"\n                        aria-label="{{ ::\'xpack.ml.newJob.simple.population.chart.removeSplitButtonAriaLabel\' | i18n: {defaultMessage: \'Remove split\'} }}"\n                        ng-disabled="jobState === JOB_STATE.RUNNING || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                        class="euiButton euiButton--primary euiButton--small split-align remove-split"\n                        i18n-id="xpack.ml.newJob.simple.population.chart.removeSplitButtonLabel"\n                        i18n-default-message="Remove split"\n                      ></button>\n                    </div>\n\n                    <div class=\'chart-container\'>\n                      <div style=\'height: {{ui.chartHeight + 25}}px;\'>\n                        <ml-population-job-chart\n                          chart-data="chart"\n                          chart-height=\'ui.chartHeight\'\n                          chart-ticks-margin="chartData.chartTicksMargin"\n                          over-field-name="formConfig.overField.name">\n                        </ml-population-job-chart>\n                      </div>\n\n                      <div ng-show="chartStates.fields[id] === CHART_STATE.NOT_STARTED || chartStates.fields[id] === CHART_STATE.LOADING || chartStates.fields[id] === CHART_STATE.NO_RESULTS"\n                        class=\'chart-loader fields-chart-loader\'\n                        style=\'height: {{ui.chartHeight}}px; margin-top: -{{ui.chartHeight + 30}}px; margin-left: {{chartData.chartTicksMargin.width - 1}}px;\'>\n                          <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.NOT_STARTED"></div>\n                          <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.LOADING">\n                            <h2 class="euiTitle euiTitle"><i class=\'fa fa-spinner fa-spin\'></i></h2>\n                          </div>\n                          <div class=\'status-label\' ng-show="chartStates.fields[id] === CHART_STATE.NO_RESULTS">\n                            <div class=\'no-results\'>\n                              <h4 class="euiTitle euiTitle--small">\n                                <i class="fa fa-info-circle"></i>\n                                <span\n                                  i18n-id="xpack.ml.newJob.simple.population.chart.noResultsFoundTitle"\n                                  i18n-default-message="No results found"\n                                ></span>\n                               </h4>\n                            </div>\n                          </div>\n                      </div>\n\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</ml-new-job-population>\n'},function(module,exports,__webpack_require__){"use strict";var _jquery=_interopRequireDefault(__webpack_require__(21));var _i18n=__webpack_require__(4);var _d=_interopRequireDefault(__webpack_require__(27));var _angular=_interopRequireDefault(__webpack_require__(26));var _moment=_interopRequireDefault(__webpack_require__(16));var _date_utils=__webpack_require__(279);var _time_buckets=__webpack_require__(312);var _chart_utils=__webpack_require__(280);var _string_utils=__webpack_require__(67);var _chart_tooltip_service=__webpack_require__(362);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlPopulationJobChart",function(){function link(scope,element){var svgWidth=0;var chartHeight=scope.chartHeight;var margin={top:0,right:0,bottom:20,left:scope.chartTicksMargin.width};var svgHeight=chartHeight+margin.top+margin.bottom;var vizWidth=svgWidth-margin.left-margin.right;var chartLimits={max:0,min:0};var chartXScale=null;var chartYScale=null;var chartGroup;var swimlaneGroup;var $progressBar;scope.$on("render",function(){init();createSVGGroups();drawChart()});scope.$on("render-results",function(){drawResults()});element.on("$destroy",function(){scope.$destroy()});function init(){var $el=_angular.default.element(".population-job-container .card-front");var offset=$el.hasClass("card")?30:0;margin.left=scope.chartTicksMargin.width;svgWidth=$el.width()-offset;vizWidth=svgWidth-margin.left-margin.right;chartXScale=_d.default.time.scale().range([0,vizWidth]);chartYScale=_d.default.scale.linear().range([chartHeight,0])}function createSVGGroups(){if(scope.chartData.line===undefined){return}var chartElement=_d.default.select(element.get(0));chartElement.select("svg").remove();chartElement.select(".progress").remove();if(chartElement.select(".progress-bar")[0][0]===null){var style="width: ".concat(+vizWidth+2,"px;\n          margin-bottom: -").concat(+chartHeight-15,"px;\n          margin-left: ").concat(+margin.left-1,"px;'");chartElement.append("div").attr("class","progress").attr("style",style).append("div").attr("class","progress-bar")}$progressBar=(0,_jquery.default)(".progress-bar");var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);swimlaneGroup=svg.append("g").attr("class","swimlane").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"));chartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"))}function drawChart(){if(scope.chartData.line.length===0){return}var data=scope.chartData.line.reduce(function(p,c){if(c.values.length){c.values.forEach(function(v){p.push({date:c.date,value:v.value,label:v.label})})}else{p.push({date:c.date,value:null,label:null})}return p},[]);chartXScale=chartXScale.domain(_d.default.extent(data,function(d){return d.date}));chartLimits.max=_d.default.max(data,function(d){return d.value});chartLimits.min=_d.default.min(data,function(d){return d.value});var padding=(chartLimits.max-chartLimits.min)*.05;chartLimits.max+=padding;chartLimits.min-=padding;chartYScale=chartYScale.domain([chartLimits.min,chartLimits.max]);var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");if(data.length>0){var xDomain=chartXScale.domain();var bounds={min:(0,_moment.default)(xDomain[0]),max:(0,_moment.default)(xDomain[1])};timeBuckets.setBounds(bounds)}var xAxisTickFormat=timeBuckets.getScaledDateFormat();var xAxis=_d.default.svg.axis().scale(chartXScale).orient("bottom").innerTickSize(-chartHeight).outerTickSize(0).tickPadding(10).ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});var yAxis=_d.default.svg.axis().scale(chartYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);if(scope.chartData.fieldFormat!==undefined){yAxis.tickFormat(function(d){return scope.chartData.fieldFormat.convert(d,"text")})}swimlaneGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("fill","#FFFFFF");chartGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawChartAxes(xAxis,yAxis);drawChartDots(data)}function drawChartAxes(xAxis,yAxis){var axes=chartGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(chartHeight,")")).call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawChartDots(data){var dotGroup=chartGroup.append("g").classed("values-dots",true);dotGroup.selectAll("circle").data(data).enter().append("circle").attr("cx",function(d){return chartXScale(d.date)}).attr("cy",function(d){return chartYScale(d.value)}).attr("r",3).style("display",function(d){return d.value===null?"none":"auto"}).on("mouseover",function(d){showTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()})}function showTooltip(data,el){scope;var contents="";var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(data.date);contents+="".concat(formattedDate,"<br/><hr/>");contents+="".concat((0,_string_utils.mlEscape)(scope.overFieldName),": ").concat((0,_string_utils.mlEscape)(data.label),"<br/>");contents+=_i18n.i18n.translate("xpack.ml.newJob.simple.population.chartTooltipValueLabel",{defaultMessage:"Value: {dataValue}",values:{dataValue:scope.chartData.fieldFormat!==undefined?scope.chartData.fieldFormat.convert(data.value,"text"):parseInt(data.value)}});_chart_tooltip_service.mlChartTooltipService.show(contents,el,{x:5,y:10})}function drawResults(){drawSwimlane(vizWidth,chartHeight);updateProgressBar()}function drawSwimlane(swlWidth,swlHeight){var data=scope.chartData.swimlane;var cellWidth=0;if(data.length>0){cellWidth=chartXScale(data[0].time+scope.chartData.swimlaneInterval)-chartXScale(data[0].time)}_d.default.time.scale().range([0,swlWidth]).domain(_d.default.extent(data,function(d){return d.date}));_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var color=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);swimlaneGroup.select(".swimlane-cells").remove();var cells=swimlaneGroup.append("g").attr("class","swimlane-cells").selectAll("cells").data(data);cells.enter().append("rect").attr("x",function(d){return chartXScale(d.date)}).attr("y",0).attr("rx",0).attr("ry",0).attr("class",function(d){return d.value>0?"swimlane-cell":"swimlane-cell-hidden"}).attr("width",cellWidth-0).attr("height",swlHeight-0).style("fill",function(d){return color(d.value)})}function updateProgressBar(){var pcnt=scope.chartData.percentComplete<100?scope.chartData.percentComplete:0;$progressBar.css("width",pcnt+"%")}}return{scope:{chartData:"=",chartHeight:"=",chartTicksMargin:"=",overFieldName:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2914);__webpack_require__(402)},function(module,exports,__webpack_require__){"use strict";var _states=__webpack_require__(579);var _general=__webpack_require__(361);var _fields_selection=_interopRequireDefault(__webpack_require__(2915));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFieldsSelectionPopulation",function(){return{restrict:"E",replace:true,template:_fields_selection.default,controller:function controller($scope){$scope.eventRateSelected=false;$scope.tempSelectedField={field:undefined};$scope.selectField=function(){$scope.addField()};$scope.addField=function(){if($scope.eventRateSelected===false||$scope.eventRateSelected===true&&$scope.tempSelectedField.field.id!==_general.EVENT_RATE_COUNT_FIELD){var field=_objectSpread({},$scope.tempSelectedField.field,{agg:{type:$scope.tempSelectedField.field.agg.type}});$scope.formConfig.fields.push(field);$scope.chartStates.fields[field.id]=_states.CHART_STATE.LOADING;$scope.sortFields();$scope.formChange(true)}$scope.tempSelectedField.field=undefined};$scope.removeField=function(index,field){$scope.formConfig.fields.splice(index,1);delete $scope.chartStates.fields[field.id];$scope.sortFields();$scope.formChange(true)};$scope.sortFields=function(){$scope.eventRateSelected=false;var eventRateIndex=-1;$scope.formConfig.fields.forEach(function(f,i){if(f.id===_general.EVENT_RATE_COUNT_FIELD){eventRateIndex=i;$scope.eventRateSelected=true}});if(eventRateIndex>=0){$scope.formConfig.fields.splice(0,0,$scope.formConfig.fields.splice(eventRateIndex,1)[0])}}}}})},function(module,exports){module.exports='<div class=\'fields-selection-population\'>\n  <h4\n    class="euiTitle euiTitle--small"\n    i18n-id="xpack.ml.newJob.simple.fieldsSelectionPopulation.fieldsTitle"\n    i18n-default-message="Fields"\n  ></h4>\n  <div class="euiSpacer euiSpacer--s"></div>\n  <div class="row">\n    <div class="col-md-12">\n      <div class="form-group">\n        <div class="field-select-container">\n          <ui-select\n            ng-model="tempSelectedField.field"\n            on-select="selectField()"\n            ng-disabled="formConfig.overField === undefined || jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n            append-to-body=true>\n            <ui-select-match placeholder="{{ ::\'xpack.ml.newJob.simple.fieldsSelectionPopulation.addFieldPlaceholder\' | i18n: {defaultMessage: \'Add field\'} }}">\n                <ml-field-type-icon type="$select.selected.mlType"></ml-field-type-icon>{{$select.selected.name}}\n            </ui-select-match>\n            <ui-select-choices repeat="field in ui.fields | filter: { name: $select.search }" group-by="\'mlType\'">\n              <ml-field-type-icon type="field.mlType"></ml-field-type-icon>\n              <span class="select-item" ng-bind-html="field.name | highlight: $select.search"></span>\n            </ui-select-choices>\n          </ui-select>\n\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="row" ng-show="formConfig.fields.length > 0">\n    <div class="col-md-12">\n      <div class="form-group">\n\n        <div class=\'selection-list-container fields-list\'>\n          <div class="checkbox field-row" ng-repeat="field in formConfig.fields track by $index">\n            <div class=\'field kuiCheckBoxLabel kuiVerticalRhythm\'>\n              <span\n                class=\'kuiCheckBoxLabel__text\'\n                tooltip=\'{{field.tooltip}}\'\n                tooltip-append-to-body="true">\n                {{field.name}}\n              </span>\n            </div>\n            <div>\n              <div class="agg-type">\n                <div class="agg-type-select-wrapper">\n                  <select\n                    class="form-control agg-type-select"\n                    ng-model="field.agg.type"\n                    ng-options="agg as agg.title for agg in ui.aggTypeOptions | filterAggTypes:field"\n                    ng-change="formChange()"\n                    ng-disabled="formConfig.fields[$index] === undefined || jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED">\n                  </select>\n                </div>\n                <button\n                  aria-label="{{ ::\'xpack.ml.newJob.simple.fieldsSelectionPopulation.removeDetectorButtonAriaLabel\' | i18n: {defaultMessage: \'Remove Detector\'} }}"\n                  ng-click="removeField($index, field)"\n                  tooltip-append-to-body="true"\n                  ng-disabled="formConfig.fields[$index] === undefined || jobState === JOB_STATE.RUNNING  || jobState === JOB_STATE.STOPPING || jobState === JOB_STATE.FINISHED"\n                  type="button"\n                  class="euiButton euiButton--danger euiButton--small remove-button">\n                    <i aria-hidden="true" class="fa fa-trash"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _chart_tooltip=_interopRequireDefault(__webpack_require__(2917));var _modules=__webpack_require__(8);var _chart_tooltip_service=__webpack_require__(362);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlChartTooltip",function(){return{restrict:"E",replace:true,template:_chart_tooltip.default,link:function link(scope,element){_chart_tooltip_service.mlChartTooltipService.element=element}}})},function(module,exports){module.exports='<div class="ml-chart-tooltip euiText"></div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2919)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2920);__webpack_require__(1371);__webpack_require__(500);__webpack_require__(577)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _angular=_interopRequireDefault(__webpack_require__(26));__webpack_require__(360);var _datemath=_interopRequireDefault(__webpack_require__(55));var _job_utils=__webpack_require__(58);var _breadcrumbs=__webpack_require__(400);var _new_job_utils=__webpack_require__(294);var _routes=_interopRequireDefault(__webpack_require__(19));var _check_module=__webpack_require__(2921);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _index_utils=__webpack_require__(226);var _check_ml_nodes=__webpack_require__(71);var _job_service=__webpack_require__(36);var _create_job_service=__webpack_require__(1371);var _messagebar_service=__webpack_require__(268);var _ml_api_service=__webpack_require__(24);var _create_job=_interopRequireDefault(__webpack_require__(2922));var _notify=__webpack_require__(14);var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job/simple/recognize",{template:_create_job.default,k7Breadcrumbs:_breadcrumbs.getCreateRecognizerJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}});_routes.default.when("/modules/check_view_or_create",{template:_create_job.default,resolve:{checkViewOrCreateJobs:_check_module.checkViewOrCreateJobs}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlCreateRecognizerJobs",function($scope,$window,$route,Private){var mlCreateRecognizerJobsService=Private(_create_job_service.CreateRecognizerJobsServiceProvider);_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var msgs=_messagebar_service.mlMessageBarService;var SAVE_STATE={NOT_SAVED:0,SAVING:1,SAVED:2,FAILED:3,PARTIAL_FAILURE:4};var DATAFEED_STATE={NOT_STARTED:0,STARTING:1,STARTED:2,FINISHED:3,STOPPING:4,FAILED:5};$scope.addNewJobToRecentlyAccessed=_new_job_utils.addNewJobToRecentlyAccessed;$scope.SAVE_STATE=SAVE_STATE;$scope.DATAFEED_STATE=DATAFEED_STATE;$scope.overallState=SAVE_STATE.NOT_SAVED;var moduleId=$route.current.params.id;$scope.moduleId=moduleId;var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;var pageTitle=savedSearch.id!==undefined?_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.title}}):_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});$scope.displayQueryWarning=savedSearch.id!==undefined;$scope.hideAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.hideAdvancedButtonAriaLabel",{defaultMessage:"Hide Advanced"});$scope.showAdvancedButtonAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.showAdvancedButtonAriaLabel",{defaultMessage:"Show Advanced"});$scope.showAdvancedAriaLabel=_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.showAdvancedAriaLabel",{defaultMessage:"Show advanced"});$scope.ui={formValid:true,indexPattern:indexPattern,pageTitle:pageTitle,showJobInput:true,numberOfJobs:0,kibanaLabels:{dashboard:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.dashboardsLabel",{defaultMessage:"Dashboards"}),search:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.searchesLabel",{defaultMessage:"Searches"}),visualization:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.visualizationsLabel",{defaultMessage:"Visualizations"})},validation:{checks:{jobLabel:{valid:true},groupIds:{valid:true}}}};$scope.formConfig={indexPattern:indexPattern,jobLabel:"",jobGroups:[],jobs:[],kibanaObjects:{},start:0,end:0,useFullIndexData:true,startDatafeedAfterSave:true,useDedicatedIndex:false};$scope.resultsUrl="";$scope.resetJob=function(){$scope.overallState=SAVE_STATE.NOT_SAVED;$scope.formConfig.jobs=[];$scope.formConfig.kibanaObjects={};loadJobConfigs()};function loadJobConfigs(){_ml_api_service.ml.getDataRecognizerModule({moduleId:moduleId}).then(function(resp){if(resp.jobs&&resp.jobs.length){var tempGroups={};resp.jobs.forEach(function(job){$scope.formConfig.jobs.push({id:job.id,jobConfig:job.config,jobState:SAVE_STATE.NOT_SAVED,datafeedId:null,datafeedConfig:{},datafeedState:SAVE_STATE.NOT_SAVED,runningState:DATAFEED_STATE.NOT_STARTED,errors:[]});$scope.ui.numberOfJobs++;if(job.config.groups&&job.config.groups.length){job.config.groups.forEach(function(group){tempGroups[group]=null})}});$scope.formConfig.jobGroups=Object.keys(tempGroups);resp.datafeeds.forEach(function(datafeed){var job=_lodash.default.find($scope.formConfig.jobs,{id:datafeed.config.job_id});if(job!==undefined){var datafeedId=_job_service.mlJobService.getDatafeedId(job.id);job.datafeedId=datafeedId;job.datafeedConfig=datafeed.config}})}if(resp.kibana){_lodash.default.each(resp.kibana,function(obj,key){$scope.formConfig.kibanaObjects[key]=obj.map(function(o){return{id:o.id,title:o.title,saveState:SAVE_STATE.NOT_SAVED,config:o.config,exists:false,errors:[]}})});checkIfKibanaObjectsExist($scope.formConfig.kibanaObjects)}$scope.$applyAsync()})}$scope.changeUseFullIndexData=function(){var shouldEnableTimeFilter=!$scope.formConfig.useFullIndexData;if(shouldEnableTimeFilter){_timefilter.timefilter.enableTimeRangeSelector()}else{_timefilter.timefilter.disableTimeRangeSelector()}$scope.$applyAsync()};$scope.changeJobLabelCase=function(){$scope.formConfig.jobLabel=$scope.formConfig.jobLabel.toLowerCase()};$scope.save=function(){if(validateJobs()){msgs.clear();$scope.overallState=SAVE_STATE.SAVING;_angular.default.element(".results").css("opacity",1);window.setTimeout(function(){saveDataRecognizerItems().then(function(){if($scope.formConfig.startDatafeedAfterSave){startDatafeeds().then(function(){$scope.setOverallState()}).catch(function(){$scope.setOverallState()})}else{$scope.setOverallState()}})},500)}};function saveDataRecognizerItems(){return new Promise(function(resolve){setAllToSaving();var prefix=$scope.formConfig.jobLabel;var indexPatternName=$scope.formConfig.indexPattern.title;var groups=$scope.formConfig.jobGroups;var useDedicatedIndex=$scope.formConfig.useDedicatedIndex;var tempQuery=savedSearch.id===undefined?undefined:combinedQuery;_ml_api_service.ml.setupDataRecognizerConfig({moduleId:moduleId,prefix:prefix,groups:groups,query:tempQuery,indexPatternName:indexPatternName,useDedicatedIndex:useDedicatedIndex}).then(function(resp){if(resp.jobs){$scope.formConfig.jobs.forEach(function(job){var jobId="".concat(prefix).concat(job.id);var jobResult=resp.jobs.find(function(j){return j.id===jobId});if(jobResult!==undefined){if(jobResult.success){job.jobState=SAVE_STATE.SAVED}else{job.jobState=SAVE_STATE.FAILED;if(jobResult.error&&jobResult.error.msg){job.errors.push(jobResult.error.msg)}}}else{job.jobState=SAVE_STATE.FAILED;job.errors.push(_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.job.couldNotSaveJobErrorMessage",{defaultMessage:"Could not save job {jobId}",values:{jobId:jobId}}))}var datafeedId=(0,_job_utils.prefixDatafeedId)(job.datafeedId,prefix);var datafeedResult=resp.datafeeds.find(function(d){return d.id===datafeedId});if(datafeedResult!==undefined){if(datafeedResult.success){job.datafeedState=SAVE_STATE.SAVED}else{job.datafeedState=SAVE_STATE.FAILED;if(datafeedResult.error&&datafeedResult.error.msg){job.errors.push(datafeedResult.error.msg)}}}else{job.datafeedState=SAVE_STATE.FAILED;job.errors.push(_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.datafeed.couldNotSaveDatafeedErrorMessage",{defaultMessage:"Could not save datafeed {datafeedId}",values:{datafeedId:datafeedId}}))}$scope.$applyAsync()})}if(resp.kibana){_lodash.default.each($scope.formConfig.kibanaObjects,function(kibanaObject,objName){kibanaObject.forEach(function(obj){var kibanaObjectResult=resp.kibana[objName].find(function(o){return o.id===obj.id});if(kibanaObjectResult!==undefined){if(kibanaObjectResult.success||kibanaObjectResult.success===false&&kibanaObjectResult.exists===true){obj.saveState=SAVE_STATE.SAVED}else{obj.saveState=SAVE_STATE.FAILED;if(kibanaObjectResult.error&&kibanaObjectResult.error.message){obj.errors.push(kibanaObjectResult.error.message)}}}else{obj.saveState=SAVE_STATE.FAILED;obj.errors.push(_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.kibanaObject.couldNotSaveErrorMessage",{defaultMessage:"Could not save {objName} {objId}",values:{objName:objName,objId:obj.id}}))}$scope.$applyAsync()})})}resolve()}).catch(function(err){console.log("Error setting up module",err);_notify.toastNotifications.addWarning({title:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.moduleSetupFailedWarningTitle",{defaultMessage:"Error setting up module {moduleId}",values:{moduleId:moduleId}}),text:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.moduleSetupFailedWarningDescription",{defaultMessage:"An error occurred trying to create the {count, plural, one {job} other {jobs}} in the module.",values:{count:$scope.formConfig.jobs.length}})});$scope.overallState=SAVE_STATE.FAILED;$scope.$applyAsync()})})}function setAllToSaving(){$scope.formConfig.jobs.forEach(function(j){j.jobState=SAVE_STATE.SAVING;j.datafeedState=SAVE_STATE.SAVING});_lodash.default.each($scope.formConfig.kibanaObjects,function(kibanaObject){kibanaObject.forEach(function(obj){obj.saveState=SAVE_STATE.SAVING})});$scope.$applyAsync()}function startDatafeeds(){return new Promise(function(resolve,reject){var jobs=$scope.formConfig.jobs;var numberOfJobs=jobs.length;mlCreateRecognizerJobsService.indexTimeRange($scope.formConfig.indexPattern,$scope.formConfig).then(function(resp){if($scope.formConfig.useFullIndexData){$scope.formConfig.start=resp.start.epoch;$scope.formConfig.end=resp.end.epoch}else{$scope.formConfig.start=_datemath.default.parse(_timefilter.timefilter.getTime().from).valueOf();$scope.formConfig.end=_datemath.default.parse(_timefilter.timefilter.getTime().to).valueOf()}var jobsCounter=0;var datafeedCounter=0;open(jobs[jobsCounter]);function incrementAndOpen(job){jobsCounter++;if(jobsCounter<numberOfJobs){open(jobs[jobsCounter])}else{if(job.runningState===DATAFEED_STATE.FAILED){reject()}}}function open(job){if(job.jobState===SAVE_STATE.FAILED){datafeedCounter++;job.runningState=DATAFEED_STATE.FAILED;incrementAndOpen(job);return}job.runningState=DATAFEED_STATE.STARTING;var jobId=$scope.formConfig.jobLabel+job.id;_job_service.mlJobService.openJob(jobId).then(function(){incrementAndOpen(job);start(job)}).catch(function(err){console.log("Opening job failed",err);start(job);job.errors.push(err.message);incrementAndOpen(job)})}function start(job){var jobId=$scope.formConfig.jobLabel+job.id;var datafeedId=(0,_job_utils.prefixDatafeedId)(job.datafeedId,$scope.formConfig.jobLabel);mlCreateRecognizerJobsService.startDatafeed(datafeedId,jobId,$scope.formConfig.start,$scope.formConfig.end).then(function(){job.runningState=DATAFEED_STATE.STARTED;datafeedCounter++;if(datafeedCounter===numberOfJobs){resolve()}}).catch(function(err){console.log("Starting datafeed failed",err);job.errors.push(err.message);job.runningState=DATAFEED_STATE.FAILED;reject(err)}).then(function(){$scope.$applyAsync()})}})})}function checkIfKibanaObjectsExist(kibanaObjects){_lodash.default.each(kibanaObjects,function(objects,type){objects.forEach(function(obj){checkForSavedObject(type,obj).then(function(result){if(result){obj.saveState=SAVE_STATE.SAVED;obj.exists=true}})})})}function checkForSavedObject(type,savedObject){return new Promise(function(resolve,reject){var exists=false;mlCreateRecognizerJobsService.loadExistingSavedObjects(type).then(function(resp){var savedObjects=resp.savedObjects;savedObjects.forEach(function(obj){if(savedObject.title===obj.attributes.title){exists=true;savedObject.id=obj.id}});resolve(exists)}).catch(function(resp){console.log("Could not load saved objects",resp);reject(resp)})})}$scope.setOverallState=function(){var jobIds=[];var failedJobsCount=$scope.formConfig.jobs.reduce(function(count,job){if(job.jobState===SAVE_STATE.FAILED||job.datafeedState===SAVE_STATE.FAILED){return count+1}else{jobIds.push("".concat($scope.formConfig.jobLabel).concat(job.id));return count}},0);if(failedJobsCount){if(failedJobsCount===$scope.formConfig.jobs.length){$scope.overallState=SAVE_STATE.FAILED}else{$scope.overallState=SAVE_STATE.PARTIAL_FAILURE}}else{$scope.overallState=SAVE_STATE.SAVED}$scope.resultsUrl=_job_service.mlJobService.createResultsUrl(jobIds,$scope.formConfig.start,$scope.formConfig.end,"explorer");$scope.$applyAsync()};function validateJobs(){var valid=true;var checks=$scope.ui.validation.checks;_lodash.default.each(checks,function(item){item.valid=true});var label="".concat($scope.formConfig.jobLabel,"extra");if((0,_job_utils.isJobIdValid)(label)===false){valid=false;checks.jobLabel.valid=false;var msg=_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.jobLabelAllowedCharactersDescription",{defaultMessage:"Job label can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});checks.jobLabel.message=msg}$scope.formConfig.jobGroups.forEach(function(group){if((0,_job_utils.isJobIdValid)(group)===false){valid=false;checks.groupIds.valid=false;var _msg=_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.jobGroupAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});checks.groupIds.message=_msg}});return valid}loadJobConfigs()})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkViewOrCreateJobs=checkViewOrCreateJobs;var _chrome=_interopRequireDefault(__webpack_require__(9));var _i18n=__webpack_require__(4);var _job_service=__webpack_require__(36);var _ml_api_service=__webpack_require__(24);var _notify=__webpack_require__(14);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function checkViewOrCreateJobs(Private,$route,kbnBaseUrl,kbnUrl){return new Promise(function(resolve,reject){var moduleId=$route.current.params.id;var indexPatternId=$route.current.params.index;_ml_api_service.ml.dataRecognizerModuleJobsExist({moduleId:moduleId}).then(function(resp){var basePath="".concat(_chrome.default.getBasePath(),"/app/");if(resp.jobsExist===true){var resultsPageUrl=_job_service.mlJobService.createResultsUrlForJobs(resp.jobs,"explorer");window.location.href="".concat(basePath).concat(resultsPageUrl);reject()}else{window.location.href="".concat(basePath,"ml#/jobs/new_job/simple/recognize?id=").concat(moduleId,"&index=").concat(indexPatternId);reject()}}).catch(function(err){console.log("Error checking whether jobs in module ".concat(moduleId," exists"),err);_notify.toastNotifications.addWarning({title:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.moduleCheckJobsExistWarningTitle",{defaultMessage:"Error checking module {moduleId}",values:{moduleId:moduleId}}),text:_i18n.i18n.translate("xpack.ml.newJob.simple.recognize.moduleCheckJobsExistWarningDescription",{defaultMessage:"An error occurred trying to check whether the jobs in the module have been created."})});kbnUrl.redirect("/jobs");reject()})})}},function(module,exports){module.exports='<ml-nav-menu name="new_job_multi_metric"></ml-nav-menu>\n<ml-new-job-recognizer>\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlCreateRecognizerJobs" class="recognizer-job-container">\n    <div class="row">\n      <div class="col-md-12">\n        <h3\n          class="euiTitle euiTitle--large"\n          i18n-id="xpack.ml.newJob.simple.recognize.newJobFromTitle"\n          i18n-default-message="New job from {pageTitle}"\n          i18n-values="{ pageTitle: ui.pageTitle }"\n        ></h3>\n\n        <div ng-if="displayQueryWarning === true" class="euiCallOut euiCallOut--warning">\n            <div class="euiCallOutHeader">\n              <svg class="euiIcon euiCallOutHeader__icon euiIcon--medium" xmlns="http://www.w3.org/2000/svg"\n                  width="16" height="16" viewBox="0 0 16 16">\n                <g fill-rule="evenodd">\n                  <path d="M7.5 2.236L1.618 14h11.764L7.5 2.236zm.894-.447l5.882 11.764A1 1 0 0 1 13.382 15H1.618a1 1 0 0 1-.894-1.447L6.606 1.789a1 1 0 0 1 1.788 0z"\n                  />\n                  <path d="M7 6h1v5H7zM7 12h1v1H7z" />\n                </g>\n              </svg>\n              <span\n                class="euiCallOutHeader__title"\n                i18n-id="xpack.ml.newJob.simple.recognize.searchWillBeOverwrittenLabel"\n                i18n-default-message="Search will be overwritten"\n              ></span>\n            </div>\n            <div class="euiText euiText--small">\n              <p\n                i18n-id="xpack.ml.newJob.simple.recognize.usingSavedSearchDescription"\n                i18n-default-message="Using a saved search will mean the query used in the datafeeds will be different from the default ones we supply in the {moduleId} module."\n                i18n-values="{ moduleId }"\n              ></p>\n            </div>\n          </div>\n      </div>\n    </div>\n\n    <div class="euiSpacer euiSpacer--s"></div>\n\n    <div class="row">\n      <div class="col-md-4">\n        <div class="row form-controls">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.recognize.jobSettingsTitle"\n            i18n-default-message="Job settings"\n          ></h4>\n          <div>\n\n            <div class=\'form-section\' >\n              <div ng-show="jobState !== SAVE_STATE.FINISHED">\n                <h4\n                  class="euiTitle euiTitle--small"\n                  i18n-id="xpack.ml.newJob.simple.recognize.jobDetailsTitle"\n                  i18n-default-message="Job Details"\n                ></h4>\n                <div class="euiSpacer euiSpacer--s"></div>\n              </div>\n\n              <div class="form-group">\n                <div ng-show="ui.showJobInput && (overallState === SAVE_STATE.NOT_SAVED || overallState === SAVE_STATE.SAVING)">\n                  <div class="form-group">\n                    <ml-form-label label-id="new_job_recognizer_job_prefix">\n                      {{ ::\'xpack.ml.newJob.simple.recognize.jobIdPrefixLabel\' | i18n: {defaultMessage: \'Job ID prefix\'} }}\n                    </ml-form-label>\n                    <input\n                      aria-labelledby="ml_aria_label_new_job_recognizer_job_prefix"\n                      aria-describedby="ml_aria_description_new_job_recognizer_job_prefix"\n                      ng-model="formConfig.jobLabel"\n                      placeholder="{{ ::\'xpack.ml.newJob.simple.recognize.jobIdPrefixPlaceholder\' | i18n: {defaultMessage: \'Job ID prefix\'} }}"\n                      ng-change="changeJobLabelCase()"\n                      ng-disabled="overallState === SAVE_STATE.SAVING"\n                      class="form-control lowercase" />\n                      <div ng-hide="ui.validation.checks.jobLabel.valid" class="validation-error">{{ ui.validation.checks.jobLabel.message }}</div>\n                  </div>\n                  <div class="form-group">\n                    <ml-form-label label-id="new_job_group">\n                      {{ ::\'xpack.ml.newJob.simple.recognize.jobGroupsLabel\' | i18n: {defaultMessage: \'Job groups\'} }}\n                    </ml-form-label>\n                    <ml-job-group-select\n                      aria-labelledby="ml_aria_label_new_job_group"\n                      aria-describedby="ml_aria_description_new_job_group"\n                      job-groups=\'formConfig.jobGroups\'\n                      disabled=\'(overallState === SAVE_STATE.SAVING)\' />\n                    <div ng-hide="ui.validation.checks.groupIds.valid" class="validation-error">{{ ui.validation.checks.groupIds.message }}</div>\n                  </div>\n                  <div class="form-group">\n                    <div ng-click="ui.showAdvanced = (!ui.showAdvanced || formConfig.useDedicatedIndex)" class="advanced-button-container">\n                      <button\n                        aria-label="{{ ui.showAdvanced ? hideAdvancedButtonAriaLabel : showAdvancedButtonAriaLabel }}"\n                        ng-disabled="formConfig.useDedicatedIndex"\n                        type="button"\n                        class="kuiButton kuiButton--small kuiButton--hollow advanced-button">\n                        <i\n                          ng-class="{ \'fa-caret-down\': ui.showAdvanced, \'fa-caret-right\': !ui.showAdvanced }"\n                          class="fa"\n                          aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.showAdvancedAriaLabel\' | i18n: {defaultMessage: \'Show advanced\'} }}"\n                        ></i>\n                      </button>\n                      <label\n                        class="kuiFormLabel"\n                        aria-describedby="ml_aria_description_new_job_advanced_settings"\n                        i18n-id="xpack.ml.newJob.simple.recognize.advancedLabel"\n                        i18n-default-message="Advanced"\n                      ></label>\n                      <i\n                        ml-info-icon="new_job_advanced_settings"\n                        aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.advancedSettingsAriaLabel\' | i18n: {defaultMessage: \'Advanced settings\'} }}"\n                      />\n                    </div>\n                    <div class=\'advanced-group\' ng-show="ui.showAdvanced">\n                      <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                        <input type="checkbox"\n                          aria-labelledby="ml_aria_label_new_job_dedicated_index"\n                          aria-describedby="ml_aria_description_new_job_dedicated_index"\n                          class=\'kuiCheckBox\'\n                          ng-model="formConfig.useDedicatedIndex" />\n                        <span class=\'kuiCheckBoxLabel__text\'>\n                          <span\n                            id="ml_aria_label_new_job_dedicated_index"\n                            i18n-id="xpack.ml.newJob.simple.recognize.useDedicatedIndexLabel"\n                            i18n-default-message="Use dedicated index"\n                          ></span>\n                          <i\n                            ml-info-icon="new_job_dedicated_index"\n                            aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.useDedicatedIndexAriaLabel\' | i18n: {defaultMessage: \'Use dedicated index\'} }}"\n                          />\n                        </span>\n                      </label>\n                    </div>\n                  </div>\n\n                  <div class="form-group">\n                    <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                      <input type="checkbox"\n                        class=\'kuiCheckBox\'\n                        ng-model="formConfig.startDatafeedAfterSave" />\n                        <span\n                          class=\'kuiCheckBoxLabel__text\'\n                          i18n-id="xpack.ml.newJob.simple.recognize.startDatafeedAfterSaveLabel"\n                          i18n-default-message="Start datafeed after save"\n                        ></span>\n                    </label>\n                  </div>\n                  <div class="form-group">\n                    <label class=\'kuiCheckBoxLabel kuiVerticalRhythm\'>\n                      <input type="checkbox"\n                        class=\'kuiCheckBox\'\n                        ng-change="changeUseFullIndexData()"\n                        ng-model="formConfig.useFullIndexData" />\n                        <span\n                          class=\'kuiCheckBoxLabel__text\'\n                          i18n-id="xpack.ml.newJob.simple.recognize.useFullDataLabel"\n                          i18n-default-message="Use full {indexPatternTitle} data"\n                          i18n-values="{ indexPatternTitle: formConfig.indexPattern.title }"\n                        ></span>\n                    </label>\n                  </div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.createJobButtonAriaLabel\' | i18n: {defaultMessage: \'Create Job\'} }}"\n                    ng-click="save()"\n                    type="button"\n                    ng-show="overallState === SAVE_STATE.NOT_SAVED"\n                    ng-disabled="!ui.formValid"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.recognize.createJobButtonLabel"\n                      i18n-default-message="Create {numberOfJobs, plural, zero {Job} one {Job} other {Jobs}}"\n                      i18n-values="{ numberOfJobs: ui.numberOfJobs }"\n                    ></span>\n                  </button>\n\n                  <div class=\'job-state-info\' ng-show="overallState === SAVE_STATE.SAVING">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.recognize.analysisRunningLabel"\n                      i18n-default-message="Analysis running"\n                    ></span>\n                    <i\n                      class=\'fa fa-spinner fa-spin\'\n                      aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.analysisRunningAriaLabel\' | i18n: {defaultMessage: \'Analysis running\'} }}"\n                    ></i>\n                  </div>\n                </div>\n                <div ng-show="overallState === SAVE_STATE.SAVED || overallState === SAVE_STATE.PARTIAL_FAILURE">\n                  <h3 ng-if="overallState === SAVE_STATE.SAVED" class="euiTitle euiTitle--large">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.recognize.jobsCreatedTitle"\n                      i18n-default-message="Jobs created"\n                    ></span>\n                    <i\n                      style="color:green;"\n                      class="fa fa-check"\n                      aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.savedAriaLabel\' | i18n: {defaultMessage: \'Saved\'} }}"\n                    ></i>\n                  </h3>\n\n                  <h3 ng-if="overallState === SAVE_STATE.PARTIAL_FAILURE" class="euiTitle euiTitle--large">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.recognize.someJobsCreationFailedTitle"\n                      i18n-default-message="Some jobs failed to be created"\n                    ></span>\n                    <i\n                      style="color:red;"\n                      class="fa fa-remove"\n                      aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.someJobsCreationFailed.saveFailedAriaLabel\' | i18n: {defaultMessage: \'Save failed\'} }}"\n                    ></i>\n                  </h3>\n\n                  <div class="euiSpacer euiSpacer--m"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.someJobsCreationFailed.resetButtonAriaLabel\' | i18n: {defaultMessage: \'Reset\'} }}"\n                    ng-click="resetJob()"\n                    type="button"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.recognize.someJobsCreationFailed.resetButtonLabel"\n                      i18n-default-message="Reset"\n                    ></span>\n                  </button>\n                  <a\n                    href=\'{{resultsUrl}}\'\n                    ng-click="addNewJobToRecentlyAccessed(formConfig.jobId, resultsUrl)"\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.viewResultsAriaLabel\' | i18n: {defaultMessage: \'View Results\'} }}"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.recognize.viewResultsLinkText"\n                      i18n-default-message="View Results"\n                    ></span>\n                  </a>\n                </div>\n\n                <div ng-show="overallState === SAVE_STATE.FAILED">\n                  <h3 class="euiTitle euiTitle--large">\n                    <span\n                      i18n-id="xpack.ml.newJob.simple.recognize.jobsCreationFailedTitle"\n                      i18n-default-message="Jobs creation failed"\n                    ></span>\n                    <i\n                      style="color:red;"\n                      class="fa fa-remove"\n                      aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.jobsCreationFailed.saveFailedAriaLabel\' | i18n: {defaultMessage: \'Save failed\'} }}"\n                    ></i>\n                  </h3>\n                  <div class="euiSpacer euiSpacer--m"></div>\n\n                  <button\n                    aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.jobsCreationFailed.resetButtonAriaLabel\' | i18n: {defaultMessage: \'Reset\'} }}"\n                    ng-click="resetJob()"\n                    type="button"\n                    class="euiButton euiButton--primary euiButton--small euiButton--fill">\n                    <span\n                      class="euiButton__content"\n                      i18n-id="xpack.ml.newJob.simple.recognize.jobsCreationFailed.resetButtonLabel"\n                      i18n-default-message="Jobs creation failed"\n                    ></span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="col-md-8">\n        <div class="row charts-container">\n          <h4\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.simple.recognize.jobsTitle"\n            i18n-default-message="Jobs"\n          ></h4>\n          <div class=\'jobs-list\'>\n            <div ng-repeat=\'job in formConfig.jobs\' class=\'job-container\'>\n              <div class=\'labels\'>\n                <div class=\'title\'>{{formConfig.jobLabel}}{{job.id}}</div>\n                <div class=\'sub-title\'>{{job.jobConfig.description}}</div>\n                <div class=\'validation-error\' ng-repeat="error in job.errors">{{error}}</div>\n              </div>\n              <div class=\'results\'>\n                <div class=\'result-box\'>\n                  <div\n                    class=\'result-box-title\'\n                    i18n-id="xpack.ml.newJob.simple.recognize.jobLabel"\n                    i18n-default-message="Job"\n                  ></div>\n                  <div class=\'result-box-inner\'>\n                    <i ng-show="job.jobState === SAVE_STATE.NOT_SAVED" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.job.notSavedAriaLabel\' | i18n: {defaultMessage: \'Not saved\'} }}" ></i>\n                    <i ng-show="job.jobState === SAVE_STATE.FAILED" style="color:red;" class="fa fa-remove" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.job.saveFailedAriaLabel\' | i18n: {defaultMessage: \'Save failed\'} }}" ></i>\n                    <i ng-show="job.jobState === SAVE_STATE.SAVING" class="fa fa-spinner fa-spin" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.job.savingAriaLabel\' | i18n: {defaultMessage: \'Saving\'} }}" ></i>\n                    <i ng-show="job.jobState === SAVE_STATE.SAVED" style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.job.savedAriaLabel\' | i18n: {defaultMessage: \'Saved\'} }}" ></i>\n                  </div>\n                </div>\n                <div class=\'result-box\'>\n                  <div\n                    class=\'result-box-title\'\n                    i18n-id="xpack.ml.newJob.simple.recognize.datafeedLabel"\n                    i18n-default-message="Datafeed"\n                  ></div>\n                  <div class=\'result-box-inner\'>\n                    <i ng-show="job.datafeedState === SAVE_STATE.NOT_SAVED" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.datafeed.notSavedAriaLabel\' | i18n: {defaultMessage: \'Not saved\'} }}" ></i>\n                    <i ng-show="job.datafeedState === SAVE_STATE.FAILED" style="color:red;" class="fa fa-remove" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.datafeed.saveFailedAriaLabel\' | i18n: {defaultMessage: \'Save failed\'} }}" ></i>\n                    <i ng-show="job.datafeedState === SAVE_STATE.SAVING" class="fa fa-spinner fa-spin" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.datafeed.savingAriaLabel\' | i18n: {defaultMessage: \'Saving\'} }}" ></i>\n                    <i ng-show="job.datafeedState === SAVE_STATE.SAVED" style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.datafeed.savedAriaLabel\' | i18n: {defaultMessage: \'Saved\'} }}" ></i>\n                  </div>\n                </div>\n                <div class=\'result-box\' ng-if="formConfig.startDatafeedAfterSave">\n                  <div\n                    class=\'result-box-title\'\n                    i18n-id="xpack.ml.newJob.simple.recognize.runningLabel"\n                    i18n-default-message="Running"\n                  ></div>\n                  <div class=\'result-box-inner\'>\n                    <i ng-show="job.runningState === DATAFEED_STATE.NOT_STARTED" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.running.notStartedAriaLabel\' | i18n: {defaultMessage: \'Not started\'} }}" ></i>\n                    <i ng-show="job.runningState === DATAFEED_STATE.FAILED" style="color:red;" class="fa fa-remove" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.running.startFailedAriaLabel\' | i18n: {defaultMessage: \'Start failed\'} }}" ></i>\n                    <i ng-show="job.runningState === DATAFEED_STATE.STARTING" class="fa fa-spinner fa-spin"aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.running.startingAriaLabel\' | i18n: {defaultMessage: \'Starting\'} }}" ></i>\n                    <i ng-show="job.runningState === DATAFEED_STATE.STARTED" style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.running.startedAriaLabel\' | i18n: {defaultMessage: \'Started\'} }}" ></i>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="row charts-container" ng-repeat=\'(key, value) in formConfig.kibanaObjects\'>\n          <h4 class="euiTitle euiTitle--small">{{ui.kibanaLabels[key]}}</h4>\n          <div class=\'save-objects-list\'>\n            <div ng-repeat=\'obj in value | orderBy:"title"\' class=\'job-container\'>\n              <div class=\'labels\'>\n                <div class=\'title\' ng-class="{exists: obj.exists}">\n                  {{obj.title}}\n                  <span\n                    ng-if="obj.exists"\n                    i18n-id="xpack.ml.newJob.simple.recognize.alreadyExistsLabel"\n                    i18n-default-message="(already exists)"\n                  ></span>\n                </div>\n                <div class=\'validation-error\' ng-repeat="error in obj.errors">{{error}}</div>\n              </div>\n              <div class=\'results\'>\n                <div class=\'result-box\'>\n                  <div class=\'result-box-inner\'>\n                    <i ng-show="obj.saveState === SAVE_STATE.NOT_SAVED" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.results.notSavedAriaLabel\' | i18n: {defaultMessage: \'Not saved\'} }}" ></i>\n                    <i ng-show="obj.saveState === SAVE_STATE.FAILED" style="color:red;" class="fa fa-remove" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.results.saveFailedAriaLabel\' | i18n: {defaultMessage: \'Save failed\'} }}" ></i>\n                    <i ng-show="obj.saveState === SAVE_STATE.SAVING" class="fa fa-spinner fa-spin" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.results.savingAriaLabel\' | i18n: {defaultMessage: \'Saving\'} }}" ></i>\n                    <i ng-show="obj.saveState === SAVE_STATE.SAVED  && !obj.exists" style="color:green;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.results.savedAriaLabel\' | i18n: {defaultMessage: \'Saved\'} }}" ></i>\n                    <i ng-show="obj.saveState === SAVE_STATE.SAVED && obj.exists" style="color:#BBBBBB;" class="fa fa-check" aria-label="{{ ::\'xpack.ml.newJob.simple.recognize.results.alreadySavedAriaLabel\' | i18n: {defaultMessage: \'Already saved\'} }}" ></i>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</ml-new-job-recognizer>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2924);__webpack_require__(2930);__webpack_require__(1372)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2925)},function(module,exports,__webpack_require__){"use strict";var _routes=_interopRequireDefault(__webpack_require__(19));var _check_license=__webpack_require__(66);var _breadcrumbs=__webpack_require__(400);var _breadcrumbs2=__webpack_require__(684);var _preconfigured_job_redirect=__webpack_require__(2926);var _check_privilege=__webpack_require__(39);var _index_utils=__webpack_require__(226);var _check_ml_nodes=__webpack_require__(71);var _index_or_search=_interopRequireDefault(__webpack_require__(2927));var _timefilter=__webpack_require__(22);__webpack_require__(2928);__webpack_require__(864);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job",{redirectTo:"/jobs/new_job/step/index_or_search"});_routes.default.when("/data_frames/new_job",{redirectTo:"/data_frames/new_job/step/index_or_search"});_routes.default.when("/jobs/new_job/step/index_or_search",{template:_index_or_search.default,k7Breadcrumbs:_breadcrumbs.getCreateJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPatterns:_index_utils.loadIndexPatterns,preConfiguredJobRedirect:_preconfigured_job_redirect.preConfiguredJobRedirect,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable,nextStepPath:function nextStepPath(){return"#/jobs/new_job/step/job_type"}}});_routes.default.when("/datavisualizer_index_select",{template:_index_or_search.default,k7Breadcrumbs:_breadcrumbs.getDataVisualizerIndexOrSearchBreadcrumbs,resolve:{CheckLicense:_check_license.checkBasicLicense,privileges:_check_privilege.checkFindFileStructurePrivilege,indexPatterns:_index_utils.loadIndexPatterns,nextStepPath:function nextStepPath(){return"#jobs/new_job/datavisualizer"}}});_routes.default.when("/data_frames/new_job/step/index_or_search",{template:_index_or_search.default,k7Breadcrumbs:_breadcrumbs2.getDataFrameIndexOrSearchBreadcrumbs,resolve:{CheckLicense:_check_license.checkBasicLicense,privileges:_check_privilege.checkCreateDataFrameJobsPrivilege,indexPatterns:_index_utils.loadIndexPatterns,nextStepPath:function nextStepPath(){return"#data_frames/new_job/step/pivot"}}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlNewJobStepIndexOrSearch",function($scope,$route){_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();$scope.indexPatterns=(0,_index_utils.getIndexPatterns)().filter(function(indexPattern){return!indexPattern.get("type")});var path=$route.current.locals.nextStepPath;$scope.withIndexPatternUrl=function(pattern){if(!pattern){return}return"".concat(path,"?index=").concat(encodeURIComponent(pattern.id))};$scope.withSavedSearchUrl=function(savedSearch){if(!savedSearch){return}return"".concat(path,"?savedSearchId=").concat(encodeURIComponent(savedSearch.id))}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.preConfiguredJobRedirect=preConfiguredJobRedirect;var _chrome=_interopRequireDefault(__webpack_require__(9));var _lodash=__webpack_require__(3);var _general=__webpack_require__(361);var _job_service=__webpack_require__(36);var _index_utils=__webpack_require__(226);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function preConfiguredJobRedirect(AppState,Private,courier){return new Promise(function(resolve,reject){var basePath="".concat(_chrome.default.getBasePath(),"/app/ml#");var stateDefaults={mlJobSettings:{}};var appState=new AppState(stateDefaults);var redirectUrl=getWizardUrlFromAppState(appState);if(redirectUrl===null){var job=_job_service.mlJobService.currentJob;if(job){(0,_index_utils.loadIndexPatterns)(Private,courier).then(function(){redirectUrl=getWizardUrlFromCloningJob(job);if(redirectUrl===null){window.location.href="".concat(basePath,"/jobs/new_job/advanced");reject()}else{window.location.href="".concat(basePath,"/").concat(redirectUrl);reject()}}).catch(function(error){console.log(error);resolve()})}else{resolve()}}else{window.location.href="".concat(basePath,"/").concat(redirectUrl);reject()}})}function getWizardUrlFromAppState(appState){if(appState.mlJobSettings!==undefined&&Object.keys(appState.mlJobSettings).length){var page="";var jobSettings=appState.mlJobSettings;if(jobSettings.fields&&jobSettings.fields.length){if(jobSettings.fields.length>1||jobSettings.split!==undefined){if(jobSettings.population!==undefined){page="population"}else{page="multi_metric"}}else{page="single_metric"}}return"jobs/new_job/simple/".concat(page)}else{return null}}function getWizardUrlFromCloningJob(job){var created=(0,_lodash.get)(job,"custom_settings.created_by");var page="";if(created!==undefined){if(created===_general.WIZARD_TYPE.SINGLE_METRIC){page="single_metric"}else if(created===_general.WIZARD_TYPE.MULTI_METRIC){page="multi_metric"}else if(created===_general.WIZARD_TYPE.POPULATION){page="population"}else{return null}var indexPatternId=(0,_index_utils.getIndexPatternIdFromName)(job.datafeed_config.indices[0]);return"jobs/new_job/simple/".concat(page,"?index=").concat(indexPatternId,"&_g=()")}else{return null}}},function(module,exports){module.exports='<ml-nav-menu name="new_job"></ml-nav-menu>\n<ml-new-job class="index-or-saved-search-selection">\n  <ml-message-bar></ml-message-bar>\n  <div class=\'kuiViewContent kuiViewContent--constrainedWidth kuiViewContentItem\' >\n    <div ng-controller="MlNewJobStepIndexOrSearch" class="visWizard">\n      <div class="visWizard__column visWizard__column--small">\n        <h3\n          class="kuiTitle kuiVerticalRhythm"\n          i18n-id="xpack.ml.newJob.wizard.createFromNewSearchTitle"\n          i18n-default-message="From a New Search, Select Index"\n        ></h3>\n        <paginated-selectable-list\n          per-page="20"\n          list="indexPatterns"\n          list-property="attributes.title"\n          user-make-url="withIndexPatternUrl"\n          class="visWizard__row visWizard__list--paginated--selectable kuiVerticalRhythm"\n          disable-auto-focus="true"\n        ></paginated-selectable-list>\n      </div>\n      <div class="visWizard__column visWizard__column--large">\n\n        <h3\n          class="kuiTitle kuiVerticalRhythm"\n          i18n-id="xpack.ml.newJob.wizard.createFromSavedSearchTitle"\n          i18n-default-message="Or, From a Saved Search"\n        ></h3>\n        <saved-object-finder\n          title="{{ ::\'xpack.ml.newJob.wizard.savedSearchesTooltip\' | i18n: {defaultMessage: \'Saved Searches\'} }}"\n          type="searches"\n          class="visWizard__row visWizard__savedObjectFinder kuiVerticalRhythm"\n          make-url="withSavedSearchUrl"\n          disable-auto-focus="true"\n        ></saved-object-finder>\n       </div>\n    </div>\n    </div>\n</ml-new-job>\n'},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _modules=__webpack_require__(8);__webpack_require__(865);__webpack_require__(567);var _paginated_selectable_list=_interopRequireDefault(__webpack_require__(2929));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("kibana");function throwError(message){throw new Error(message)}_module.directive("paginatedSelectableList",function(){return{restrict:"E",scope:{perPage:"=?",list:"=",listProperty:"@",userMakeUrl:"=?",userOnSelect:"=?",disableAutoFocus:"="},template:_paginated_selectable_list.default,controller:function controller($scope,$filter){function calculateHitsByQuery(){$scope.hitsByQuery=$filter("filter")($scope.hits,$scope.query)}if(!$scope.userMakeUrl&&!$scope.userOnSelect){throwError("paginatedSelectableList directive expects a makeUrl or onSelect function")}if($scope.userMakeUrl&&$scope.userOnSelect){throwError("paginatedSelectableList directive expects a makeUrl or onSelect attribute but not both")}$scope.perPage=$scope.perPage||10;$scope.hits=$scope.list=_lodash.default.sortBy($scope.list,$scope.accessor);$scope.$watchGroup(["hits","query"],calculateHitsByQuery);calculateHitsByQuery();$scope.hitCount=$scope.hits.length;$scope.isAscending=true;$scope.sortHits=function(hits){var sortedList=_lodash.default.sortBy(hits,$scope.accessor);$scope.isAscending=!$scope.isAscending;$scope.hits=$scope.isAscending?sortedList:sortedList.reverse()};$scope.makeUrl=function(hit){return $scope.userMakeUrl(hit)};$scope.onSelect=function(hit,$event){return $scope.userOnSelect(hit,$event)};$scope.accessor=function(val){var prop=$scope.listProperty;return prop?_lodash.default.get(val,prop):val}}}})},function(module,exports){module.exports='<form\n  role="form"\n  class="kuiVerticalRhythm"\n>\n  <div class="kuiBar">\n    <div class="kuiBarSection">\n      <div class="kuiSearchInput fullWidth">\n        <div class="kuiSearchInput__icon kuiIcon fa-search"></div>\n        <input\n          class="kuiSearchInput__input"\n          input-focus\n          disable-input-focus="disableAutoFocus"\n          ng-model="query"\n          placeholder="{{ ::\'common.ui.paginateSelectableList.searchPlaceholder\' | i18n: {defaultMessage: \'Filter…\'} }}"\n          class="form-control"\n          name="query"\n          type="text"\n          autocomplete="off"\n        >\n      </div>\n    </div>\n\n    <div class="kuiBarSection">\n      <p\n        class="kuiText kuiSubduedText"\n        i18n-id="common.ui.paginateSelectableList.ofTotalHitCount"\n        i18n-default-message="{matchingHits} of {hitCount}"\n        i18n-values="{ hitCount, matchingHits: hitsByQuery.length }"\n      ></p>\n    </div>\n  </div>\n</form>\n\n<paginate\n  list="hitsByQuery"\n  per-page="{{ perPage }}"\n  class="kuiVerticalRhythm"\n>\n  <button\n    class="paginate-heading list-group-item list-sort-button"\n    ng-click="sortHits(hits)"\n    aria-live="assertive"\n  >\n    <span class="euiScreenReaderOnly"\n      i18n-id="common.ui.paginateSelectableList.sortByButtonLabelScreenReaderOnly"\n      i18n-default-message="Sort by"\n    ></span>\n    <span\n      i18n-id="common.ui.paginateSelectableList.sortByButtonLabel"\n      i18n-default-message="Name"\n    ></span>\n    <span\n      class="fa"\n      ng-class="isAscending ? \'fa-caret-up\' : \'fa-caret-down\'"\n    >\n      <span class="euiScreenReaderOnly"\n        ng-if="isAscending"\n        i18n-id="common.ui.paginateSelectableList.sortByButtonLabeAscendingScreenReaderOnly"\n        i18n-default-message="ascending"\n      ></span>\n      <span class="euiScreenReaderOnly"\n        ng-if="!isAscending"\n        i18n-id="common.ui.paginateSelectableList.sortByButtonLabeDescendingScreenReaderOnly"\n        i18n-default-message="descending"\n      ></span>\n    </span>\n  </button>\n  <ul class="li-striped list-group list-group-menu">\n    <li class="list-group-item list-group-menu-item" ng-repeat="hit in page">\n      <a\n        data-test-subj="paginatedListItem-{{accessor(hit)}}"\n        ng-show="userMakeUrl"\n        kbn-href="{{ makeUrl(hit) }}">\n        <span>{{ accessor(hit) }}</span>\n      </a>\n\n      <div ng-show="userOnSelect" ng-click="onSelect(hit, $event)">\n        <span>{{ accessor(hit) }}</span>\n      </div>\n    </li>\n\n    <li class="list-group-item list-group-no-results" ng-if="hitsByQuery.length === 0">\n      <p i18n-id="common.ui.paginateSelectableList.noMatchesFoundDescription"\n        i18n-default-message="No matches found."\n      ></p>\n    </li>\n  </ul>\n</paginate>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2931)},function(module,exports,__webpack_require__){"use strict";var _routes=_interopRequireDefault(__webpack_require__(19));var _i18n=__webpack_require__(4);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _breadcrumbs=__webpack_require__(400);var _new_job_utils=__webpack_require__(294);var _index_utils=__webpack_require__(226);var _recently_accessed=__webpack_require__(677);var _check_ml_nodes=__webpack_require__(71);var _job_type=_interopRequireDefault(__webpack_require__(2932));var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_routes.default.when("/jobs/new_job/step/job_type",{template:_job_type.default,k7Breadcrumbs:_breadcrumbs.getCreateJobBreadcrumbs,resolve:{CheckLicense:_check_license.checkLicenseExpired,privileges:_check_privilege.checkCreateJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlNewJobStepJobType",function($scope,Private){_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch;$scope.indexWarningTitle="";$scope.isTimeBasedIndex=(0,_index_utils.timeBasedIndexCheck)(indexPattern);if($scope.isTimeBasedIndex===false){$scope.indexWarningTitle=savedSearch.id===undefined?_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternNotTimeBasedMessage",{defaultMessage:"Index pattern {indexPatternTitle} is not time based",values:{indexPatternTitle:indexPattern.title}}):_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternFromSavedSearchNotTimeBasedMessage",{defaultMessage:"{savedSearchTitle} uses index pattern {indexPatternTitle} which is not time based",values:{savedSearchTitle:savedSearch.title,indexPatternTitle:indexPattern.title}})}$scope.indexPattern=indexPattern;$scope.savedSearch=savedSearch;$scope.recognizerResults={count:0,onChange:function onChange(){$scope.$applyAsync()}};$scope.pageTitleLabel=savedSearch.id!==undefined?_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.savedSearchPageTitleLabel",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.title}}):_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternPageTitleLabel",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});$scope.getUrl=function(basePath){return savedSearch.id===undefined?"".concat(basePath,"?index=").concat(indexPattern.id):"".concat(basePath,"?savedSearchId=").concat(savedSearch.id)};$scope.addSelectionToRecentlyAccessed=function(){var title=savedSearch.id===undefined?indexPattern.title:savedSearch.title;var url=$scope.getUrl("");(0,_recently_accessed.addItemToRecentlyAccessed)("jobs/new_job/datavisualizer",title,url)}})},function(module,exports){module.exports='<ml-nav-menu name="new_job"></ml-nav-menu>\n<ml-new-job class="job-type-gallery">\n  <ml-message-bar></ml-message-bar>\n  <div ng-controller="MlNewJobStepJobType">\n    \x3c!-- Presents the various options for creating a job --\x3e\n    <div class="job-types-content">\n      <h1\n        class="euiTitle euiTitle--large"\n        i18n-id="xpack.ml.newJob.wizard.jobType.createJobFromTitle"\n        i18n-default-message="Create a job from the {pageTitleLabel}"\n        i18n-values="{ pageTitleLabel }"\n      ></h1>\n      <div class="euiSpacer euiSpacer--l"></div>\n\n      <div ng-if="isTimeBasedIndex===false">\n        <div class="index-warning">\n          <div class="euiCallOut euiCallOut--warning">\n            <div class="euiCallOutHeader">\n              <svg class="euiIcon euiCallOutHeader__icon euiIcon--medium" xmlns="http://www.w3.org/2000/svg"\n              width="16" height="16" viewBox="0 0 16 16">\n                <g fill-rule="evenodd">\n                  <path d="M7.5 2.236L1.618 14h11.764L7.5 2.236zm.894-.447l5.882 11.764A1 1 0 0 1 13.382 15H1.618a1 1 0 0 1-.894-1.447L6.606 1.789a1 1 0 0 1 1.788 0z"\n                  />\n                  <path d="M7 6h1v5H7zM7 12h1v1H7z" />\n                </g>\n              </svg>\n              <span class="euiCallOutHeader__title">{{indexWarningTitle}}</span>\n            </div>\n            <div class="euiText euiText--small">\n              <p>\n                <span\n                  i18n-id="xpack.ml.newJob.wizard.jobType.howToRunAnomalyDetectionDescription"\n                  i18n-default-message="Anomaly detection can only be run over indices which are time based."\n                ></span>\n                <br/>\n                <a\n                  class="euiLink euiLink--primary"\n                  href="#jobs/new_job\\"\n                  i18n-id="xpack.ml.newJob.wizard.jobType.selectDifferentIndexLinkText"\n                  i18n-default-message="Select a different index"\n                ></a>\n              </p>\n            </div>\n          </div>\n        </div>\n        <div class="euiSpacer euiSpacer--xxl"></div>\n      </div>\n\n      <div ng-show="recognizerResults.count!==0" class="recognizer-section">\n        <div class="euiText">\n          <h3\n            class="euiTitle euiTitle--small"\n            i18n-id="xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationTitle"\n            i18n-default-message="Use a supplied configuration"\n            >\n          </h3>\n          <p\n            i18n-id="xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationDescription"\n            i18n-default-message="The fields in your data have been recognized as matching known configurations.\n            Select to create a set of machine learning jobs and associated dashboards."\n          ></p>\n        </div>\n        <div class="euiSpacer euiSpacer--m"></div>\n        <ml-data-recognizer\n          class-name=\'"euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--fourths"\'\n          item-class-name=\'""\'\n          index-pattern=\'indexPattern\'\n          saved-search=\'savedSearch\'\n          results=recognizerResults/>\n        <div class="euiSpacer euiSpacer--xxl"></div>\n      </div>\n\n      <div class="euiText">\n        <h3\n          class="euiTitle euiTitle--small"\n          i18n-id="xpack.ml.newJob.wizard.jobType.useWizardTitle"\n          i18n-default-message="Use a wizard"\n        ></h3>\n        <p\n          i18n-id="xpack.ml.newJob.wizard.jobType.useWizardDescription"\n          i18n-default-message="Use one of the wizards to create a machine learning job to find anomalies in your data."\n        ></p>\n      </div>\n\n      <div class="euiSpacer euiSpacer--m"></div>\n\n      <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--fourths">\n        <div class="euiFlexItem" ng-class=\'{disabled: isTimeBasedIndex===false}\'>\n          <a ng-href="{{getUrl(\'#jobs/new_job/simple/single_metric\')}}" ng-class=\'{disabled: isTimeBasedIndex===false}\' class="euiLink synopsis">\n            <div class="euiPanel euiPanel--paddingMedium synopsisPanel">\n              <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n                <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                  <icon\n                    type="\'createSingleMetricJob\'"\n                    size="\'xl\'"\n                    aria-label="{{ ::\'xpack.ml.newJob.wizard.jobType.singleMetricAriaLabel\' | i18n: {defaultMessage: \'Single metric job\'} }}"\n                    class="synopsisIcon"\n                  />\n                </div>\n                <div class="euiFlexItem synopsisContent">\n                  <h4\n                    class="euiTitle euiTitle--small synopsisTitle"\n                    i18n-id="xpack.ml.newJob.wizard.jobType.singleMetricTitle"\n                    i18n-default-message="Single metric"\n                  ></h4>\n                  <div class="euiText synopsisBody">\n                    <p>\n                      <span\n                        class="euiTextColor euiTextColor--subdued"\n                        i18n-id="xpack.ml.newJob.wizard.jobType.singleMetricDescription"\n                        i18n-default-message="Detect anomalies in a single time series."\n                      ></span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </a>\n        </div>\n        <div class="euiFlexItem" ng-class=\'{disabled: isTimeBasedIndex===false}\'>\n          <a ng-href="{{getUrl(\'#jobs/new_job/simple/multi_metric\')}}" ng-class=\'{disabled: isTimeBasedIndex===false}\' class="euiLink synopsis">\n            <div class="euiPanel euiPanel--paddingMedium synopsisPanel">\n              <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n                <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                  <icon\n                    type="\'createMultiMetricJob\'"\n                    size="\'xl\'"\n                    aria-label="{{ ::\'xpack.ml.newJob.wizard.jobType.multiMetricAriaLabel\' | i18n: {defaultMessage: \'Multi metric job\'} }}"\n                    class="synopsisIcon"\n                  />\n                </div>\n                <div class="euiFlexItem synopsisContent">\n                  <h4\n                    class="euiTitle euiTitle--small synopsisTitle"\n                    i18n-id="xpack.ml.newJob.wizard.jobType.multiMetricTitle"\n                    i18n-default-message="Multi metric"\n                  ></h4>\n                  <div class="euiText synopsisBody">\n                    <p>\n                      <span\n                        class="euiTextColor euiTextColor--subdued"\n                        i18n-id="xpack.ml.newJob.wizard.jobType.multiMetricDescription"\n                        i18n-default-message="Detect anomalies in multiple metrics by splitting a time series by a categorical field."\n                      ></span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </a>\n        </div>\n        <div class="euiFlexItem" ng-class=\'{disabled: isTimeBasedIndex===false}\'>\n          <a ng-href="{{getUrl(\'#jobs/new_job/simple/population\')}}" ng-class=\'{disabled: isTimeBasedIndex===false}\' class="euiLink synopsis">\n            <div class="euiPanel euiPanel--paddingMedium synopsisPanel">\n              <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n                <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                  <icon\n                    type="\'createPopulationJob\'"\n                    size="\'xl\'"\n                    aria-label="{{ ::\'xpack.ml.newJob.wizard.jobType.populationAriaLabel\' | i18n: {defaultMessage: \'Population job\'} }}"\n                    class="synopsisIcon"\n                  />\n                </div>\n                <div class="euiFlexItem synopsisContent">\n                  <h4\n                    class="euiTitle euiTitle--small synopsisTitle"\n                    i18n-id="xpack.ml.newJob.wizard.jobType.populationTitle"\n                    i18n-default-message="Population"\n                  ></h4>\n                  <div class="euiText synopsisBody">\n                    <p>\n                      <span\n                        class="euiTextColor euiTextColor--subdued"\n                        i18n-id="xpack.ml.newJob.wizard.jobType.populationDescription"\n                        i18n-default-message="Detect activity that is unusual compared to the behavior of the population."\n                      ></span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </a>\n        </div>\n        <div class="euiFlexItem" ng-class=\'{disabled: isTimeBasedIndex===false}\'>\n          <a ng-href="{{getUrl(\'#jobs/new_job/advanced\')}}" ng-class=\'{disabled: isTimeBasedIndex===false}\' class="euiLink synopsis">\n            <div class="euiPanel euiPanel--paddingMedium synopsisPanel">\n              <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n                <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                  <icon\n                    type="\'createAdvancedJob\'"\n                    size="\'xl\'"\n                    aria-label="{{ ::\'xpack.ml.newJob.wizard.jobType.advancedAriaLabel\' | i18n: {defaultMessage: \'Advanced job\'} }}"\n                    class="synopsisIcon"\n                  />\n                </div>\n                <div class="euiFlexItem synopsisContent">\n                  <h4\n                    class="euiTitle euiTitle--small synopsisTitle"\n                    i18n-id="xpack.ml.newJob.wizard.jobType.advancedTitle"\n                    i18n-default-message="Advanced"\n                  ></h4>\n                  <div class="euiText synopsisBody">\n                    <p>\n                      <span\n                        class="euiTextColor euiTextColor--subdued"\n                        i18n-id="xpack.ml.newJob.wizard.jobType.advancedDescription"\n                        i18n-default-message="Use the full range of options to create a job for more advanced use cases."\n                      ></span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </a>\n        </div>\n      </div>\n\n      <div class="euiSpacer euiSpacer--xxl"></div>\n\n      <div class="euiText">\n        <h3\n          class="euiTitle euiTitle--small"\n          i18n-id="xpack.ml.newJob.wizard.jobType.learnMoreAboutDataTitle"\n          i18n-default-message="Learn more about your data"\n        ></h3>\n        <p\n          i18n-id="xpack.ml.newJob.wizard.jobType.learnMoreAboutDataDescription"\n          i18n-default-message="If you\'re not sure what type of job to create, first explore the fields and metrics in your data."\n        ></p>\n      </div>\n      <div class="euiSpacer euiSpacer--m"></div>\n\n      <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--fourths">\n        <div class="euiFlexItem" ng-class=\'{disabled: isTimeBasedIndex===false}\'>\n          <a\n            ng-href="{{getUrl(\'#jobs/new_job/datavisualizer\')}}"\n            ng-click="addSelectionToRecentlyAccessed()"\n            ng-class=\'{disabled: isTimeBasedIndex===false}\'\n            class="euiLink synopsis">\n            <div class="euiPanel euiPanel--paddingMedium synopsisPanel">\n              <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n                <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                  <icon\n                    type="\'dataVisualizer\'"\n                    size="\'xl\'"\n                    aria-label="{{ ::\'xpack.ml.newJob.wizard.jobType.dataVisualizerAriaLabel\' | i18n: {defaultMessage: \'Data Visualizer\'} }}"\n                    class="synopsisIcon"\n                  />\n                </div>\n                <div class="euiFlexItem synopsisContent">\n                  <h4\n                    class="euiTitle euiTitle--small synopsisTitle"\n                    i18n-id="xpack.ml.newJob.wizard.jobType.dataVisualizerTitle"\n                    i18n-default-message="Data Visualizer"\n                  ></h4>\n                  <div class="euiText synopsisBody">\n                    <p>\n                      <span\n                        class="euiTextColor euiTextColor--subdued"\n                        i18n-id="xpack.ml.newJob.wizard.jobType.dataVisualizerDescription"\n                        i18n-default-message="Learn more about the characteristics of your data and identify the fields for analysis with machine learning."\n                      ></span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </a>\n        </div>\n      </div>\n\n    </div>\n\n  </div>\n</ml-new-job>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _data_recognizer=__webpack_require__(1373);var _modules=__webpack_require__(8);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlDataRecognizer",function(reactDirective){return reactDirective(_data_recognizer.DataRecognizer,undefined,{restrict:"AE"})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RecognizedResult=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RecognizedResult=function RecognizedResult(_ref){var config=_ref.config,indexPattern=_ref.indexPattern,savedSearch=_ref.savedSearch;var id=savedSearch===undefined||savedSearch.id===undefined?"index=".concat(indexPattern.id):"savedSearchId=".concat(savedSearch.id);var href="#/jobs/new_job/simple/recognize?id=".concat(config.id,"&").concat(id);var logo=null;if(config.logo&&config.logo.icon){logo=_react.default.createElement("div",{className:"synopsisIcon"},_react.default.createElement(_eui.EuiIcon,{type:config.logo.icon,size:"xl"}))}else if(config.logo&&config.logo.src){logo=_react.default.createElement("div",null,_react.default.createElement("img",{className:"synopsisIcon",alt:"",src:config.logo.src}))}else{logo=_react.default.createElement("h3",{className:"euiTitle euiTitle--small"},config.id)}return _react.default.createElement("div",{className:"euiFlexItem"},_react.default.createElement("a",{href:href,className:"euiLink synopsis"},_react.default.createElement("div",{className:"euiPanel euiPanel--paddingMedium synopsisPanel"},_react.default.createElement("div",{className:"euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive"},_react.default.createElement("div",{className:"euiFlexItem euiFlexItem--flexGrowZero ml-data-recognizer-logo"},logo),_react.default.createElement("div",{className:"euiFlexItem synopsisContent"},_react.default.createElement("h4",{className:"euiTitle euiTitle--small synopsisTitle"},config.title),_react.default.createElement("div",{className:"euiText synopsisBody"},_react.default.createElement("p",null,_react.default.createElement("span",{className:"euiTextColor euiTextColor--subdued"},config.description))))))))};exports.RecognizedResult=RecognizedResult;RecognizedResult.propTypes={config:_propTypes.default.object,indexPattern:_propTypes.default.object,savedSearch:_propTypes.default.object}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2936)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _validate_job_view=__webpack_require__(2937);var _job_service=__webpack_require__(36);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlValidateJob",function(reactDirective){return reactDirective((0,_i18n.wrapInI18nContext)(_validate_job_view.ValidateJob),undefined,{restrict:"E"},{mlJobService:_job_service.mlJobService})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ValidateJob=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _metadata=__webpack_require__(241);var _validation=__webpack_require__(572);var _validation_utils=__webpack_require__(680);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var jobTipsUrl="https://www.elastic.co/guide/en/kibana/".concat(_metadata.metadata.branch,"/job-tips.html");var defaultIconType="questionInCircle";var getDefaultState=function getDefaultState(){return{ui:{iconType:defaultIconType,isLoading:false,isModalVisible:false},data:{messages:[],success:false},title:""}};var statusToEuiColor=function statusToEuiColor(status){switch(status){case _validation.VALIDATION_STATUS.INFO:return"primary";break;case _validation.VALIDATION_STATUS.ERROR:return"danger";break;default:return status}};var statusToEuiIconType=function statusToEuiIconType(status){switch(status){case _validation.VALIDATION_STATUS.INFO:return"iInCircle";break;case _validation.VALIDATION_STATUS.ERROR:return"cross";break;case _validation.VALIDATION_STATUS.SUCCESS:return"check";break;case _validation.VALIDATION_STATUS.WARNING:return"alert";break;default:return status}};var Link=function Link(_ref){var url=_ref.url;return _react.default.createElement(_eui.EuiLink,{href:url,target:"_BLANK"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"}))};Link.propTypes={url:_propTypes.default.string.isRequired};var Message=function Message(_ref2){var message=_ref2.message;return _react.default.createElement(_react.default.Fragment,null,message.text," ",message.url&&_react.default.createElement(Link,{url:message.url}))};Message.propTypes={message:_propTypes.default.shape({text:_propTypes.default.string,url:_propTypes.default.string})};var Callout=function Callout(_ref3){var message=_ref3.message;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{color:statusToEuiColor(message.status),size:"s",title:message.heading||_react.default.createElement(Message,{message:message}),iconType:statusToEuiIconType(message.status)},message.heading&&_react.default.createElement(Message,{message:message})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))};Callout.propTypes={message:_propTypes.default.shape({status:_propTypes.default.string,text:_propTypes.default.string,url:_propTypes.default.string})};var Modal=function Modal(_ref4){var close=_ref4.close,title=_ref4.title,children=_ref4.children;return _react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:close,style:{width:"800px"}},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,title)),_react.default.createElement(_eui.EuiModalBody,null,children),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButton,{onClick:close,size:"s",fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.closeButtonLabel",defaultMessage:"Close"})))))};Modal.propType={close:_propTypes.default.func.isRequired,title:_propTypes.default.string};var ValidateJob=function(_Component){_inherits(ValidateJob,_Component);function ValidateJob(props){var _this;_classCallCheck(this,ValidateJob);_this=_possibleConstructorReturn(this,_getPrototypeOf(ValidateJob).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeModal",function(){var newState=getDefaultState();newState.ui.iconType=_this.state.ui.iconType;_this.setState(newState)});_defineProperty(_assertThisInitialized(_this),"openModal",function(){var job=_this.props.getJobConfig();var getDuration=_this.props.getDuration;var duration=typeof getDuration==="function"?getDuration():undefined;var fields=_this.props.fields;if(_typeof(job)==="object"){var shouldShowLoadingIndicator=true;_this.props.mlJobService.validateJob({duration:duration,fields:fields,job:job}).then(function(data){shouldShowLoadingIndicator=false;_this.setState(_objectSpread({},_this.state,{ui:_objectSpread({},_this.state.ui,{iconType:statusToEuiIconType((0,_validation_utils.getMostSevereMessageStatus)(data.messages)),isLoading:false,isModalVisible:true}),data:data,title:job.job_id}))});var delay=250;setTimeout(function(){if(shouldShowLoadingIndicator){_this.setState(_objectSpread({},_this.state,{ui:_objectSpread({},_this.state.ui,{isLoading:true,isModalVisible:false})}))}},delay)}});_this.state=getDefaultState();return _this}_createClass(ValidateJob,[{key:"render",value:function render(){var fill=this.props.fill===false?false:true;var isCurrentJobConfig=this.props.isCurrentJobConfig!==true?false:true;var isDisabled=this.props.isDisabled!==true?false:true;return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiButton,{onClick:this.openModal,size:"s",fill:fill,iconType:isCurrentJobConfig?this.state.ui.iconType:defaultIconType,iconSide:"right",isDisabled:isDisabled,isLoading:this.state.ui.isLoading},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.validateJobButtonLabel",defaultMessage:"Validate Job"})),!isDisabled&&this.state.ui.isModalVisible&&_react.default.createElement(Modal,{close:this.closeModal,title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.validateJobTitle",defaultMessage:"Validate job {title}",values:{title:this.state.title}})},this.state.data.messages.map(function(m,i){return _react.default.createElement(Callout,{key:"".concat(m.id,"_").concat(i),message:m})}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.jobValidationDescriptionText",defaultMessage:"Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results."})),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText",defaultMessage:"For more information, see {mlJobTipsLink}.",values:{mlJobTipsLink:_react.default.createElement(_eui.EuiLink,{href:jobTipsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText",defaultMessage:"Machine Learning Job Tips"}))}}))))}}]);return ValidateJob}(_react.Component);exports.ValidateJob=ValidateJob;ValidateJob.propTypes={fields:_propTypes.default.object,fill:_propTypes.default.bool,getDuration:_propTypes.default.func,getJobConfig:_propTypes.default.func.isRequired,isCurrentJobConfig:_propTypes.default.bool,isDisabled:_propTypes.default.bool,mlJobService:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(2939)},function(module,exports,__webpack_require__){"use strict";var _messagebar=_interopRequireDefault(__webpack_require__(2940));var _messagebar_service=__webpack_require__(268);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.controller("MlMessageBarController",function($scope){$scope.messages=_messagebar_service.mlMessageBarService.getMessages();$scope.removeMessage=_messagebar_service.mlMessageBarService.removeMessage}).directive("mlMessageBar",function(){return{restrict:"AE",template:_messagebar.default}})},function(module,exports){module.exports='<div ng-controller="MlMessageBarController">\n  <div\n    ng-repeat="msg in messages"\n    class=\'ml-message {{msg.style}}\'>\n      {{msg.text}} <a ng-click="removeMessage($index)">x</a>\n  </div>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});__webpack_require__(2942);__webpack_require__(2944);__webpack_require__(2945);__webpack_require__(2968);__webpack_require__(2969);__webpack_require__(2998)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_dom_1=tslib_1.__importDefault(__webpack_require__(17));var modules_1=__webpack_require__(8);var chrome_1=tslib_1.__importDefault(__webpack_require__(9));var _module=modules_1.uiModules.get("apps/ml",["react"]);var i18n_1=__webpack_require__(15);var page_1=__webpack_require__(2943);_module.directive("mlDataFrameAccessDenied",function($injector){return{scope:{},restrict:"E",link:function link(scope,element){var kbnBaseUrl=$injector.get("kbnBaseUrl");var kbnUrl=$injector.get("kbnUrl");var goToKibana=function goToKibana(){window.location.href=chrome_1.default.getBasePath()+kbnBaseUrl};var retry=function retry(){kbnUrl.redirect("/data_frames")};var props={goToKibana:goToKibana,retry:retry};react_dom_1.default.render(react_1.default.createElement(i18n_1.I18nContext,null,react_1.default.createElement(page_1.Page,props)),element[0]);element.on("$destroy",function(){react_dom_1.default.unmountComponentAtNode(element[0]);scope.$destroy()})}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_2=__webpack_require__(5);var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);exports.Page=function(_ref){var goToKibana=_ref.goToKibana,retry=_ref.retry;return react_1.default.createElement(eui_1.EuiPage,null,react_1.default.createElement(eui_1.EuiPageBody,null,react_1.default.createElement(eui_1.EuiPageContentHeader,null,react_1.default.createElement(eui_1.EuiPageContentHeaderSection,null,react_1.default.createElement(eui_1.EuiTitle,null,react_1.default.createElement("h1",null,react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.accessDeniedTitle",defaultMessage:"Access denied"}))))),react_1.default.createElement(eui_1.EuiPageContentBody,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"m"}),react_1.default.createElement(eui_1.EuiCallOut,{title:i18n_1.i18n.translate("xpack.ml.dataframe.noPermissionToAccessMLLabel",{defaultMessage:"You need permission to access Data Frames"}),color:"danger",iconType:"cross"},react_1.default.createElement(eui_1.EuiText,{size:"s"},react_1.default.createElement("p",null,react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.noGrantedPrivilegesDescription",defaultMessage:"You must have the privileges granted in the {kibanaUserParam} and {dataFrameUserParam} roles.{br}Your system admin can set these roles on the Management User page.",values:{kibanaUserParam:react_1.default.createElement("span",{className:"text-monospace"},"kibana_user"),dataFrameUserParam:react_1.default.createElement("span",{className:"text-monospace"},"data_frame_transforms_user"),br:react_1.default.createElement("br",null)}})))),react_1.default.createElement(eui_1.EuiSpacer,{size:"m"}),react_1.default.createElement(eui_1.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButton,{fill:true,onClick:goToKibana,size:"s"},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.accessDenied.backToKibanaHomeButtonLabel",defaultMessage:"Back to Kibana home"}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButton,{fill:true,onClick:retry,size:"s"},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.accessDenied.retryButtonLabel",defaultMessage:"Retry"})))))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var routes_1=tslib_1.__importDefault(__webpack_require__(19));var breadcrumbs_1=__webpack_require__(684);var template='<ml-nav-menu name="access-denied" /><ml-data-frame-access-denied />';routes_1.default.when("/data_frames/access-denied",{template:template,k7Breadcrumbs:breadcrumbs_1.getDataFrameBreadcrumbs})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_dom_1=tslib_1.__importDefault(__webpack_require__(17));var modules_1=__webpack_require__(8);var _module=modules_1.uiModules.get("apps/ml",["react"]);var i18n_1=__webpack_require__(15);var page_1=__webpack_require__(2946);_module.directive("mlDataFramePage",function(){return{scope:{},restrict:"E",link:function link(scope,element){react_dom_1.default.render(react_1.default.createElement(i18n_1.I18nContext,null,react_1.default.createElement(page_1.Page)),element[0]);element.on("$destroy",function(){react_dom_1.default.unmountComponentAtNode(element[0]);scope.$destroy()})}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_2=__webpack_require__(5);var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var create_job_button_1=__webpack_require__(2947);var job_list_1=__webpack_require__(2954);exports.Page=function(){return react_1.default.createElement(eui_1.EuiPage,null,react_1.default.createElement(eui_1.EuiPageBody,null,react_1.default.createElement(eui_1.EuiPageContentHeader,null,react_1.default.createElement(eui_1.EuiPageContentHeaderSection,null,react_1.default.createElement(eui_1.EuiTitle,null,react_1.default.createElement("h1",null,react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.jobsList.dataFrameTitle",defaultMessage:"Data frame jobs"}),react_1.default.createElement("span",null," "),react_1.default.createElement(eui_1.EuiBetaBadge,{label:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.betaBadgeLabel",{defaultMessage:"Beta"}),tooltipContent:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.betaBadgeTooltipContent",{defaultMessage:"Data frames are a beta feature. We'd love to hear your feedback."})})))),react_1.default.createElement(eui_1.EuiPageContentHeaderSection,null,react_1.default.createElement(create_job_button_1.CreateJobButton,null))),react_1.default.createElement(eui_1.EuiPageContentBody,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"l"}),react_1.default.createElement(eui_1.EuiPanel,null,react_1.default.createElement(job_list_1.DataFrameJobList,null)))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var create_job_button_1=__webpack_require__(2948);exports.CreateJobButton=create_job_button_1.CreateJobButton},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);var react_2=__webpack_require__(5);var check_privilege_1=__webpack_require__(39);var common_1=__webpack_require__(227);exports.CreateJobButton=function(){var disabled=!check_privilege_1.checkPermission("canCreateDataFrameJob")||!check_privilege_1.checkPermission("canPreviewDataFrameJob")||!check_privilege_1.checkPermission("canStartStopDataFrameJob");var button=react_1.default.createElement(eui_1.EuiButton,{disabled:disabled,fill:true,onClick:common_1.moveToDataFrameWizard,iconType:"plusInCircle",size:"s"},react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.jobsList.createDataFrameButton",defaultMessage:"Create data frame"}));if(disabled){return react_1.default.createElement(eui_1.EuiToolTip,{position:"top",content:check_privilege_1.createPermissionFailureMessage("canCreateDataFrameJob")},button)}return button}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function isAggName(arg){return/^[^\s^\[\]>][^\[\]>]+[^\s^\[\]>]$/.test(arg)}exports.isAggName=isAggName},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));exports.KibanaContext=react_1.default.createContext(null);function isKibanaContext(arg){return arg.combinedQuery!==undefined&&arg.currentIndexPattern!==undefined&&arg.currentSavedSearch!==undefined&&arg.indexPatterns!==undefined&&typeof arg.kbnBaseUrl==="string"&&arg.kibanaConfig!==undefined}exports.isKibanaContext=isKibanaContext},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var rison_node_1=tslib_1.__importDefault(__webpack_require__(239));var chrome_1=tslib_1.__importDefault(__webpack_require__(9));function moveToDataFrameWizard(){window.location.href="#/data_frames/new_job"}exports.moveToDataFrameWizard=moveToDataFrameWizard;function moveToDataFrameJobsList(){window.location.href="#/data_frames"}exports.moveToDataFrameJobsList=moveToDataFrameJobsList;function moveToDiscover(indexPatternId,kbnBaseUrl){var _g=rison_node_1.default.encode({});var _a=rison_node_1.default.encode({index:indexPatternId});var baseUrl=chrome_1.default.addBasePath(kbnBaseUrl);var hash="#/discover?_g=".concat(_g,"&_a=").concat(_a);window.location.href="".concat(baseUrl).concat(hash)}exports.moveToDiscover=moveToDiscover},function(module,exports,__webpack_require__){"use strict";var _exports$pivotAggsFie;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var field_types_1=__webpack_require__(295);var PIVOT_SUPPORTED_AGGS;(function(PIVOT_SUPPORTED_AGGS){PIVOT_SUPPORTED_AGGS["AVG"]="avg";PIVOT_SUPPORTED_AGGS["CARDINALITY"]="cardinality";PIVOT_SUPPORTED_AGGS["MAX"]="max";PIVOT_SUPPORTED_AGGS["MIN"]="min";PIVOT_SUPPORTED_AGGS["SUM"]="sum";PIVOT_SUPPORTED_AGGS["VALUE_COUNT"]="value_count"})(PIVOT_SUPPORTED_AGGS=exports.PIVOT_SUPPORTED_AGGS||(exports.PIVOT_SUPPORTED_AGGS={}));exports.pivotSupportedAggs=[PIVOT_SUPPORTED_AGGS.AVG,PIVOT_SUPPORTED_AGGS.CARDINALITY,PIVOT_SUPPORTED_AGGS.MAX,PIVOT_SUPPORTED_AGGS.MIN,PIVOT_SUPPORTED_AGGS.SUM,PIVOT_SUPPORTED_AGGS.VALUE_COUNT];exports.pivotAggsFieldSupport=(_exports$pivotAggsFie={},_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.ATTACHMENT,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.BOOLEAN,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.DATE,[PIVOT_SUPPORTED_AGGS.MAX,PIVOT_SUPPORTED_AGGS.MIN,PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.GEO_POINT,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.GEO_SHAPE,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.IP,[PIVOT_SUPPORTED_AGGS.CARDINALITY,PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.MURMUR3,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.NUMBER,[PIVOT_SUPPORTED_AGGS.AVG,PIVOT_SUPPORTED_AGGS.CARDINALITY,PIVOT_SUPPORTED_AGGS.MAX,PIVOT_SUPPORTED_AGGS.MIN,PIVOT_SUPPORTED_AGGS.SUM,PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.STRING,[PIVOT_SUPPORTED_AGGS.CARDINALITY,PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES._SOURCE,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.UNKNOWN,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_defineProperty(_exports$pivotAggsFie,field_types_1.KBN_FIELD_TYPES.CONFLICT,[PIVOT_SUPPORTED_AGGS.VALUE_COUNT]),_exports$pivotAggsFie)},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var common_1=__webpack_require__(501);var pivot_group_by_1=__webpack_require__(1374);function getPivotQuery(search){if(typeof search==="string"){return{query_string:{query:search,default_operator:"AND"}}}return search}exports.getPivotQuery=getPivotQuery;function isSimpleQuery(arg){return arg.query_string!==undefined}exports.isSimpleQuery=isSimpleQuery;function isDefaultQuery(query){return isSimpleQuery(query)&&query.query_string.query==="*"}exports.isDefaultQuery=isDefaultQuery;function getDataFramePreviewRequest(indexPatternTitle,query,groupBy,aggs){var request={source:{index:indexPatternTitle},pivot:{group_by:{},aggregations:{}}};if(!isDefaultQuery(query)){request.source.query=query}groupBy.forEach(function(g){if(g.agg===pivot_group_by_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.TERMS){var termsAgg={terms:{field:g.field}};request.pivot.group_by[g.aggName]=termsAgg}else if(g.agg===pivot_group_by_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.HISTOGRAM){var histogramAgg={histogram:{field:g.field,interval:g.interval}};request.pivot.group_by[g.aggName]=histogramAgg}else if(g.agg===pivot_group_by_1.PIVOT_SUPPORTED_GROUP_BY_AGGS.DATE_HISTOGRAM){var dateHistogramAgg={date_histogram:{field:g.field,calendar_interval:g.calendar_interval}};var timeUnitMatch=g.calendar_interval.match(pivot_group_by_1.dateHistogramIntervalFormatRegex);if(timeUnitMatch!==null&&Array.isArray(timeUnitMatch)&&timeUnitMatch.length===2){var format=pivot_group_by_1.DATE_HISTOGRAM_FORMAT[timeUnitMatch[1]];if(format!==undefined){dateHistogramAgg.date_histogram.format=format}}request.pivot.group_by[g.aggName]=dateHistogramAgg}});aggs.forEach(function(agg){request.pivot.aggregations[agg.aggName]=_defineProperty({},agg.agg,{field:agg.field})});return request}exports.getDataFramePreviewRequest=getDataFramePreviewRequest;function getDataFrameRequest(indexPatternTitle,pivotState,jobDetailsState){var request=_objectSpread({},getDataFramePreviewRequest(indexPatternTitle,getPivotQuery(pivotState.search),common_1.dictionaryToArray(pivotState.groupByList),common_1.dictionaryToArray(pivotState.aggList)),{dest:{index:jobDetailsState.targetIndex}});return request}exports.getDataFrameRequest=getDataFrameRequest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var job_list_1=__webpack_require__(2955);exports.DataFrameJobList=job_list_1.DataFrameJobList},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var common_1=__webpack_require__(227);var common_2=__webpack_require__(580);var job_service_1=__webpack_require__(1375);var columns_1=__webpack_require__(2960);var expanded_row_1=__webpack_require__(2964);var use_refresh_interval_1=__webpack_require__(2967);function getItemIdToExpandedRowMap(itemIds,dataFrameJobs){return itemIds.reduce(function(m,jobId){var item=dataFrameJobs.find(function(job){return job.config.id===jobId});if(item!==undefined){m[jobId]=react_1.default.createElement(expanded_row_1.ExpandedRow,{item:item})}return m},{})}var ExpandableTable=eui_1.EuiInMemoryTable;exports.DataFrameJobList=function(){var _react_1$useState=react_1.useState([]),_react_1$useState2=_slicedToArray(_react_1$useState,2),dataFrameJobs=_react_1$useState2[0],setDataFrameJobs=_react_1$useState2[1];var _react_1$useState3=react_1.useState(false),_react_1$useState4=_slicedToArray(_react_1$useState3,2),blockRefresh=_react_1$useState4[0],setBlockRefresh=_react_1$useState4[1];var _react_1$useState5=react_1.useState([]),_react_1$useState6=_slicedToArray(_react_1$useState5,2),expandedRowItemIds=_react_1$useState6[0],setExpandedRowItemIds=_react_1$useState6[1];var getJobs=job_service_1.getJobsFactory(setDataFrameJobs,blockRefresh);use_refresh_interval_1.useRefreshInterval(getJobs,setBlockRefresh);if(dataFrameJobs.length===0){return react_1.default.createElement(eui_1.EuiEmptyPrompt,{title:react_1.default.createElement("h2",null,"No data frame jobs found"),actions:[react_1.default.createElement(eui_1.EuiButtonEmpty,{onClick:common_1.moveToDataFrameWizard},"Create your first data frame job")]})}var columns=columns_1.getColumns(getJobs,expandedRowItemIds,setExpandedRowItemIds);var sorting={sort:{field:common_2.DataFrameJobListColumn.id,direction:eui_1.SortDirection.ASC}};var itemIdToExpandedRowMap=getItemIdToExpandedRowMap(expandedRowItemIds,dataFrameJobs);return react_1.default.createElement(ExpandableTable,{columns:columns,hasActions:false,isExpandable:true,isSelectable:false,items:dataFrameJobs,itemId:common_2.DataFrameJobListColumn.id,itemIdToExpandedRowMap:itemIdToExpandedRowMap,pagination:true,sorting:sorting})}},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var ml_api_service_1=__webpack_require__(24);exports.getJobsFactory=function(setDataFrameJobs,blockRefresh){return _asyncToGenerator(regeneratorRuntime.mark(function _callee(){var forceRefresh,jobConfigs,jobStats,tableRows,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:forceRefresh=_args.length>0&&_args[0]!==undefined?_args[0]:false;if(!(forceRefresh===true||blockRefresh===false)){_context.next=16;break}_context.prev=2;_context.next=5;return ml_api_service_1.ml.dataFrame.getDataFrameTransforms();case 5:jobConfigs=_context.sent;_context.next=8;return ml_api_service_1.ml.dataFrame.getDataFrameTransformsStats();case 8:jobStats=_context.sent;tableRows=jobConfigs.transforms.reduce(function(reducedtableRows,config){var stats=jobStats.transforms.find(function(d){return config.id===d.id});if(stats===undefined){return reducedtableRows}reducedtableRows.push({config:config,id:config.id,state:stats.state,stats:stats.stats});return reducedtableRows},[]);setDataFrameJobs(tableRows);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context["catch"](2);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.errorGettingDataFrameJobsList",{defaultMessage:"An error occurred getting the data frame jobs list: {error}",values:{error:JSON.stringify(_context.t0)}}));case 16:case"end":return _context.stop()}}},_callee,null,[[2,13]])}))}},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var ml_api_service_1=__webpack_require__(24);exports.deleteJobFactory=function(getJobs){return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(d){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ml_api_service_1.ml.dataFrame.deleteDataFrameTransformsJob(d.config.id);case 3:getJobs(true);notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteJobSuccessMessage",{defaultMessage:"Data frame job {jobId} deleted successfully.",values:{jobId:d.config.id}}));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteJobErrorMessage",{defaultMessage:"An error occurred deleting the data frame job {jobId}: {error}",values:{jobId:d.config.id,error:JSON.stringify(_context.t0)}}));case 10:case"end":return _context.stop()}}},_callee,null,[[0,7]])}));return function(_x){return _ref.apply(this,arguments)}}()}},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var ml_api_service_1=__webpack_require__(24);exports.startJobFactory=function(getJobs){return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(d){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ml_api_service_1.ml.dataFrame.startDataFrameTransformsJob(d.config.id);case 3:notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startJobSuccessMessage",{defaultMessage:"Data frame job {jobId} started successfully.",values:{jobId:d.config.id}}));getJobs(true);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startJobErrorMessage",{defaultMessage:"An error occurred starting the data frame job {jobId}: {error}",values:{jobId:d.config.id,error:JSON.stringify(_context.t0)}}));case 10:case"end":return _context.stop()}}},_callee,null,[[0,7]])}));return function(_x){return _ref.apply(this,arguments)}}()}},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}Object.defineProperty(exports,"__esModule",{value:true});var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var ml_api_service_1=__webpack_require__(24);exports.stopJobFactory=function(getJobs){return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(d){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ml_api_service_1.ml.dataFrame.stopDataFrameTransformsJob(d.config.id);case 3:getJobs(true);notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.stopJobSuccessMessage",{defaultMessage:"Data frame job {jobId} stopped successfully.",values:{jobId:d.config.id}}));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context["catch"](0);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.stopJobErrorMessage",{defaultMessage:"An error occurred stopping the data frame job {jobId}: {error}",values:{jobId:d.config.id,error:JSON.stringify(_context.t0)}}));case 10:case"end":return _context.stop()}}},_callee,null,[[0,7]])}));return function(_x){return _ref.apply(this,arguments)}}()}},function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(580);var actions_1=__webpack_require__(2961);exports.getColumns=function(getJobs,expandedRowItemIds,setExpandedRowItemIds){var actions=actions_1.getActions(getJobs);function toggleDetails(item){var index=expandedRowItemIds.indexOf(item.config.id);if(index!==-1){expandedRowItemIds.splice(index,1);setExpandedRowItemIds(_toConsumableArray(expandedRowItemIds))}else{expandedRowItemIds.push(item.config.id)}setExpandedRowItemIds(_toConsumableArray(expandedRowItemIds))}return[{align:eui_1.RIGHT_ALIGNMENT,width:"40px",isExpander:true,render:function render(item){return react_1.default.createElement(eui_1.EuiButtonIcon,{onClick:function onClick(){return toggleDetails(item)},"aria-label":expandedRowItemIds.includes(item.config.id)?i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.rowCollapse",{defaultMessage:"Hide details for {jobId}",values:{jobId:item.config.id}}):i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.rowExpand",{defaultMessage:"Show details for {jobId}",values:{jobId:item.config.id}}),iconType:expandedRowItemIds.includes(item.config.id)?"arrowUp":"arrowDown"})}},{field:common_1.DataFrameJobListColumn.id,name:"ID",sortable:true,truncateText:true},{field:common_1.DataFrameJobListColumn.configSourceIndex,name:i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndex",{defaultMessage:"Source index"}),sortable:true,truncateText:true},{field:common_1.DataFrameJobListColumn.configDestIndex,name:i18n_1.i18n.translate("xpack.ml.dataframe.targetIndex",{defaultMessage:"Target index"}),sortable:true,truncateText:true},{name:i18n_1.i18n.translate("xpack.ml.dataframe.status",{defaultMessage:"Status"}),sortable:true,truncateText:true,render:function render(item){var color=item.state.task_state==="started"?"primary":"hollow";return react_1.default.createElement(eui_1.EuiBadge,{color:color},item.state.task_state)}},{name:i18n_1.i18n.translate("xpack.ml.dataframe.progress",{defaultMessage:"Progress"}),sortable:true,truncateText:true,render:function render(item){var progress=0;if(item.state.progress!==undefined){progress=Math.round(item.state.progress.percent_complete)}return react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiProgress,{value:progress,max:100,color:"primary",size:"m"},progress,"%")),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{size:"xs"},"".concat(progress,"%"))))}},{name:i18n_1.i18n.translate("xpack.ml.dataframe.tableActionLabel",{defaultMessage:"Actions"}),actions:actions}]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var check_privilege_1=__webpack_require__(39);var common_1=__webpack_require__(580);var job_service_1=__webpack_require__(1375);var action_start_1=__webpack_require__(2962);var action_delete_1=__webpack_require__(2963);exports.getActions=function(getJobs){var canStartStopDataFrameJob=check_privilege_1.checkPermission("canStartStopDataFrameJob");var deleteJob=job_service_1.deleteJobFactory(getJobs);var startJob=job_service_1.startJobFactory(getJobs);var stopJob=job_service_1.stopJobFactory(getJobs);return[{isPrimary:true,render:function render(item){if(item.state.task_state!==common_1.DATA_FRAME_RUNNING_STATE.STARTED){return react_1.default.createElement(action_start_1.StartAction,{startJob:startJob,item:item})}var buttonStopText=i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.stopActionName",{defaultMessage:"Stop"});var stopButton=react_1.default.createElement(eui_1.EuiButtonEmpty,{size:"xs",color:"text",disabled:!canStartStopDataFrameJob,iconType:"stop",onClick:function onClick(){return stopJob(item)},"aria-label":buttonStopText},buttonStopText);if(!canStartStopDataFrameJob){return react_1.default.createElement(eui_1.EuiToolTip,{position:"top",content:check_privilege_1.createPermissionFailureMessage("canStartStopDataFrameJob")},stopButton)}return stopButton}},{render:function render(item){return react_1.default.createElement(action_delete_1.DeleteAction,{deleteJob:deleteJob,item:item})}}]}},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var check_privilege_1=__webpack_require__(39);var common_1=__webpack_require__(580);exports.StartAction=function(_ref){var startJob=_ref.startJob,item=_ref.item;var canStartStopDataFrameJob=check_privilege_1.checkPermission("canStartStopDataFrameJob");var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),isModalVisible=_react_1$useState2[0],setModalVisible=_react_1$useState2[1];var closeModal=function closeModal(){return setModalVisible(false)};var startAndCloseModal=function startAndCloseModal(){setModalVisible(false);startJob(item)};var openModal=function openModal(){return setModalVisible(true)};var buttonStartText=i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startActionName",{defaultMessage:"Start"});var completedBatchJob=common_1.isCompletedBatchJob(item);var startButton=react_1.default.createElement(eui_1.EuiButtonEmpty,{size:"xs",color:"text",disabled:!canStartStopDataFrameJob||completedBatchJob,iconType:"play",onClick:openModal,"aria-label":buttonStartText},buttonStartText);if(!canStartStopDataFrameJob||completedBatchJob){startButton=react_1.default.createElement(eui_1.EuiToolTip,{position:"top",content:!canStartStopDataFrameJob?check_privilege_1.createPermissionFailureMessage("canStartStopDataFrameJob"):i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.completeBatchJobToolTip",{defaultMessage:"{jobId} is a completed batch job and cannot be restarted.",values:{jobId:item.config.id}})},startButton)}return react_1.default.createElement(react_1.Fragment,null,startButton,isModalVisible&&react_1.default.createElement(eui_1.EuiOverlayMask,null,react_1.default.createElement(eui_1.EuiConfirmModal,{title:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startModalTitle",{defaultMessage:"Start {jobId}",values:{jobId:item.config.id}}),onCancel:closeModal,onConfirm:startAndCloseModal,cancelButtonText:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:eui_1.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},react_1.default.createElement("p",null,i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.startModalBody",{defaultMessage:"A data frame job will increase search and indexing load in your cluster. Please stop the job if excessive load is experienced. Are you sure you want to start this job?"})))))}},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var check_privilege_1=__webpack_require__(39);var common_1=__webpack_require__(580);exports.DeleteAction=function(_ref){var deleteJob=_ref.deleteJob,item=_ref.item;var disabled=item.state.task_state===common_1.DATA_FRAME_RUNNING_STATE.STARTED;var canDeleteDataFrameJob=check_privilege_1.checkPermission("canDeleteDataFrameJob");var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),isModalVisible=_react_1$useState2[0],setModalVisible=_react_1$useState2[1];var closeModal=function closeModal(){return setModalVisible(false)};var deleteAndCloseModal=function deleteAndCloseModal(){setModalVisible(false);deleteJob(item)};var openModal=function openModal(){return setModalVisible(true)};var buttonDeleteText=i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteActionName",{defaultMessage:"Delete"});var deleteButton=react_1.default.createElement(eui_1.EuiButtonEmpty,{size:"xs",color:"text",disabled:disabled||!canDeleteDataFrameJob,iconType:"trash",onClick:openModal,"aria-label":buttonDeleteText},buttonDeleteText);if(disabled||!canDeleteDataFrameJob){deleteButton=react_1.default.createElement(eui_1.EuiToolTip,{position:"top",content:disabled?i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the data frame job in order to delete it."}):check_privilege_1.createPermissionFailureMessage("canStartStopDataFrameJob")},deleteButton)}return react_1.default.createElement(react_1.Fragment,null,deleteButton,isModalVisible&&react_1.default.createElement(eui_1.EuiOverlayMask,null,react_1.default.createElement(eui_1.EuiConfirmModal,{title:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteModalTitle",{defaultMessage:"Delete {jobId}",values:{jobId:item.config.id}}),onCancel:closeModal,onConfirm:deleteAndCloseModal,cancelButtonText:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:eui_1.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger"},react_1.default.createElement("p",null,i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.deleteModalBody",{defaultMessage:"Are you sure you want to delete this job? The job's target index and optional Kibana index pattern will not be deleted."})))))}},function(module,exports,__webpack_require__){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);var i18n_1=__webpack_require__(4);var job_details_pane_1=__webpack_require__(2965);var job_json_pane_1=__webpack_require__(2966);function getItemDescription(value){if(_typeof(value)==="object"){return JSON.stringify(value)}return value.toString()}exports.ExpandedRow=function(_ref){var item=_ref.item;var state={title:"State",items:Object.entries(item.state).map(function(s){return{title:s[0].toString(),description:getItemDescription(s[1])}}),position:"left"};var stats={title:"Stats",items:Object.entries(item.stats).map(function(s){return{title:s[0].toString(),description:getItemDescription(s[1])}}),position:"right"};var tabs=[{id:"job-details",name:i18n_1.i18n.translate("xpack.ml.dataframe.jobsList.jobDetails.tabs.jobSettingsLabel",{defaultMessage:"Job details"}),content:react_1.default.createElement(job_details_pane_1.JobDetailsPane,{sections:[state,stats]})},{id:"job-json",name:"JSON",content:react_1.default.createElement(job_json_pane_1.JobJsonPane,{json:item.config})}];return react_1.default.createElement(eui_1.EuiTabbedContent,{size:"s",tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){},expand:false})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);exports.Section=function(_ref){var section=_ref.section;if(section.items.length===0){return null}return react_1.default.createElement(eui_1.EuiPanel,null,react_1.default.createElement(eui_1.EuiTitle,{size:"xs"},react_1.default.createElement("span",null,section.title)),react_1.default.createElement(eui_1.EuiDescriptionList,{compressed:true,type:"column",listItems:section.items}))};exports.JobDetailsPane=function(_ref2){var sections=_ref2.sections;return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}),sections.filter(function(s){return s.position==="left"}).map(function(s){return react_1.default.createElement(exports.Section,{section:s,key:s.title})})),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}),sections.filter(function(s){return s.position==="right"}).map(function(s){return react_1.default.createElement(exports.Section,{section:s,key:s.title})})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);exports.JobJsonPane=function(_ref){var json=_ref.json;return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,{style:{width:"100%"}},react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}),react_1.default.createElement(eui_1.EuiCodeEditor,{value:JSON.stringify(json,null,2),readOnly:true,mode:"json"})),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false}," "))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(0);var timefilter_1=__webpack_require__(22);var jobs_list_1=__webpack_require__(679);exports.useRefreshInterval=function(getJobs,setBlockRefresh){react_1.useEffect(function(){var jobsRefreshInterval=null;timefilter_1.timefilter.disableTimeRangeSelector();timefilter_1.timefilter.enableAutoRefreshSelector();initAutoRefresh();initAutoRefreshUpdate();function initAutoRefresh(){var _timefilter_1$timefil=timefilter_1.timefilter.getRefreshInterval(),value=_timefilter_1$timefil.value;if(value===0){timefilter_1.timefilter.setRefreshInterval({pause:false,value:jobs_list_1.DEFAULT_REFRESH_INTERVAL_MS})}setAutoRefresh()}function initAutoRefreshUpdate(){timefilter_1.timefilter.on("refreshIntervalUpdate",function(){setAutoRefresh()})}function setAutoRefresh(){var _timefilter_1$timefil2=timefilter_1.timefilter.getRefreshInterval(),value=_timefilter_1$timefil2.value,pause=_timefilter_1$timefil2.pause;if(pause){clearRefreshInterval()}else{setRefreshInterval(value)}getJobs(true)}function setRefreshInterval(interval){clearRefreshInterval();if(interval>=jobs_list_1.MINIMUM_REFRESH_INTERVAL_MS){setBlockRefresh(false);var intervalId=window.setInterval(function(){getJobs()},interval);jobsRefreshInterval=intervalId}}function clearRefreshInterval(){setBlockRefresh(true);if(jobsRefreshInterval!==null){window.clearInterval(jobsRefreshInterval)}}return function(){clearRefreshInterval()}},[])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var routes_1=tslib_1.__importDefault(__webpack_require__(19));var check_license_1=__webpack_require__(66);var check_privilege_1=__webpack_require__(39);var index_utils_1=__webpack_require__(226);var breadcrumbs_1=__webpack_require__(684);var template='<ml-nav-menu name="data_frame" /><ml-data-frame-page />';routes_1.default.when("/data_frames/?",{template:template,k7Breadcrumbs:breadcrumbs_1.getDataFrameBreadcrumbs,resolve:{CheckLicense:check_license_1.checkBasicLicense,privileges:check_privilege_1.checkGetDataFrameJobsPrivilege,indexPatterns:index_utils_1.loadIndexPatterns}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_dom_1=tslib_1.__importDefault(__webpack_require__(17));var modules_1=__webpack_require__(8);var _module=modules_1.uiModules.get("apps/ml",["react"]);var i18n_1=__webpack_require__(15);var timefilter_1=__webpack_require__(22);var new_job_utils_1=__webpack_require__(294);var common_1=__webpack_require__(227);var page_1=__webpack_require__(2970);_module.directive("mlNewDataFrame",function($injector){return{scope:{},restrict:"E",link:function link(scope,element){var indexPatterns=$injector.get("indexPatterns");var kbnBaseUrl=$injector.get("kbnBaseUrl");var kibanaConfig=$injector.get("config");var Private=$injector.get("Private");timefilter_1.timefilter.disableTimeRangeSelector();timefilter_1.timefilter.disableAutoRefreshSelector();var createSearchItems=Private(new_job_utils_1.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,savedSearch=_createSearchItems.savedSearch,combinedQuery=_createSearchItems.combinedQuery;var kibanaContext={combinedQuery:combinedQuery,currentIndexPattern:indexPattern,currentSavedSearch:savedSearch,indexPatterns:indexPatterns,kbnBaseUrl:kbnBaseUrl,kibanaConfig:kibanaConfig};react_dom_1.default.render(react_1.default.createElement(i18n_1.I18nContext,null,react_1.default.createElement(common_1.KibanaContext.Provider,{value:kibanaContext},react_1.default.createElement(page_1.Page))),element[0]);element.on("$destroy",function(){react_dom_1.default.unmountComponentAtNode(element[0]);scope.$destroy()})}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var react_2=__webpack_require__(5);var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var wizard_1=__webpack_require__(2971);exports.Page=function(){return react_1.default.createElement(eui_1.EuiPage,null,react_1.default.createElement(eui_1.EuiPageBody,null,react_1.default.createElement(eui_1.EuiPageContentHeader,null,react_1.default.createElement(eui_1.EuiPageContentHeaderSection,null,react_1.default.createElement(eui_1.EuiTitle,null,react_1.default.createElement("h1",null,react_1.default.createElement(react_2.FormattedMessage,{id:"xpack.ml.dataframe.transformsWizard.newDataFrameTitle",defaultMessage:"New data frame"}),react_1.default.createElement("span",null," "),react_1.default.createElement(eui_1.EuiBetaBadge,{label:i18n_1.i18n.translate("xpack.ml.dataframe.transformsWizard.betaBadgeLabel",{defaultMessage:"Beta"}),tooltipContent:i18n_1.i18n.translate("xpack.ml.dataframe.transformsWizard.betaBadgeTooltipContent",{defaultMessage:"Data frames are a beta feature. We'd love to hear your feedback."})}))))),react_1.default.createElement(eui_1.EuiPageContentBody,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"l"}),react_1.default.createElement(wizard_1.Wizard,null))))}},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var wizard_nav_1=__webpack_require__(2972);var define_pivot_1=__webpack_require__(2974);var job_create_1=__webpack_require__(2992);var common_1=__webpack_require__(227);var job_details_1=__webpack_require__(2995);var common_2=__webpack_require__(227);var WIZARD_STEPS;(function(WIZARD_STEPS){WIZARD_STEPS[WIZARD_STEPS["DEFINE_PIVOT"]=0]="DEFINE_PIVOT";WIZARD_STEPS[WIZARD_STEPS["JOB_DETAILS"]=1]="JOB_DETAILS";WIZARD_STEPS[WIZARD_STEPS["JOB_CREATE"]=2]="JOB_CREATE"})(WIZARD_STEPS||(WIZARD_STEPS={}));var DefinePivotStep=function DefinePivotStep(_ref){var isCurrentStep=_ref.isCurrentStep,pivotState=_ref.pivotState,setCurrentStep=_ref.setCurrentStep,setPivot=_ref.setPivot;var definePivotRef=react_1.useRef(null);return react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement("div",{ref:definePivotRef}),isCurrentStep&&react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(define_pivot_1.DefinePivotForm,{onChange:setPivot,overrides:pivotState}),react_1.default.createElement(wizard_nav_1.WizardNav,{next:function next(){return setCurrentStep(WIZARD_STEPS.JOB_DETAILS)},nextActive:pivotState.valid})),!isCurrentStep&&react_1.default.createElement(define_pivot_1.DefinePivotSummary,Object.assign({},pivotState)))};exports.Wizard=react_1.default.memo(function(){var kibanaContext=react_1.useContext(common_2.KibanaContext);if(!common_2.isKibanaContext(kibanaContext)){return null}var indexPattern=kibanaContext.currentIndexPattern;var _react_1$useState=react_1.useState(WIZARD_STEPS.DEFINE_PIVOT),_react_1$useState2=_slicedToArray(_react_1$useState,2),currentStep=_react_1$useState2[0],setCurrentStep=_react_1$useState2[1];var _react_1$useState3=react_1.useState(define_pivot_1.getDefaultPivotState(kibanaContext)),_react_1$useState4=_slicedToArray(_react_1$useState3,2),pivotState=_react_1$useState4[0],setPivot=_react_1$useState4[1];var _react_1$useState5=react_1.useState(job_details_1.getDefaultJobDetailsState()),_react_1$useState6=_slicedToArray(_react_1$useState5,2),jobDetailsState=_react_1$useState6[0],setJobDetails=_react_1$useState6[1];var jobDetails=currentStep===WIZARD_STEPS.JOB_DETAILS?react_1.default.createElement(job_details_1.JobDetailsForm,{onChange:setJobDetails,overrides:jobDetailsState}):react_1.default.createElement(job_details_1.JobDetailsSummary,Object.assign({},jobDetailsState));var _react_1$useState7=react_1.useState(job_create_1.getDefaultJobCreateState),_react_1$useState8=_slicedToArray(_react_1$useState7,2),jobCreateState=_react_1$useState8[0],setJobCreate=_react_1$useState8[1];var jobCreate=currentStep===WIZARD_STEPS.JOB_CREATE?react_1.default.createElement(job_create_1.JobCreateForm,{createIndexPattern:jobDetailsState.createIndexPattern,jobId:jobDetailsState.jobId,jobConfig:common_1.getDataFrameRequest(indexPattern.title,pivotState,jobDetailsState),onChange:setJobCreate,overrides:jobCreateState}):react_1.default.createElement(job_create_1.JobCreateSummary,null);var stepsConfig=[{title:i18n_1.i18n.translate("xpack.ml.dataframe.transformsWizard.definePivotStepTitle",{defaultMessage:"Define pivot"}),children:react_1.default.createElement(DefinePivotStep,{isCurrentStep:currentStep===WIZARD_STEPS.DEFINE_PIVOT,pivotState:pivotState,setCurrentStep:setCurrentStep,setPivot:setPivot})},{title:i18n_1.i18n.translate("xpack.ml.dataframe.transformsWizard.jobDetailsStepTitle",{defaultMessage:"Job details"}),children:react_1.default.createElement(react_1.Fragment,null,jobDetails,currentStep===WIZARD_STEPS.JOB_DETAILS&&react_1.default.createElement(wizard_nav_1.WizardNav,{previous:function previous(){setCurrentStep(WIZARD_STEPS.DEFINE_PIVOT)},next:function next(){return setCurrentStep(WIZARD_STEPS.JOB_CREATE)},nextActive:jobDetailsState.valid})),status:currentStep>=WIZARD_STEPS.JOB_DETAILS?undefined:"incomplete"},{title:i18n_1.i18n.translate("xpack.ml.dataframe.transformsWizard.createStepTitle",{defaultMessage:"Create"}),children:react_1.default.createElement(react_1.Fragment,null,jobCreate,currentStep===WIZARD_STEPS.JOB_CREATE&&!jobCreateState.created&&react_1.default.createElement(wizard_nav_1.WizardNav,{previous:function previous(){return setCurrentStep(WIZARD_STEPS.JOB_DETAILS)}})),status:currentStep>=WIZARD_STEPS.JOB_CREATE?undefined:"incomplete"}];return react_1.default.createElement(eui_1.EuiSteps,{steps:stepsConfig})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);tslib_1.__exportStar(__webpack_require__(2973),exports)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);exports.WizardNav=function(_ref){var previous=_ref.previous,_ref$previousActive=_ref.previousActive,previousActive=_ref$previousActive===void 0?true:_ref$previousActive,next=_ref.next,_ref$nextActive=_ref.nextActive,nextActive=_ref$nextActive===void 0?true:_ref$nextActive;return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,null),previous&&react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButton,{disabled:!previousActive,onClick:previous,iconType:"arrowLeft",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.wizard.previousStepButton",{defaultMessage:"Previous"}))),next&&react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiButton,{disabled:!nextActive,onClick:next,iconType:"arrowRight",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.wizard.nextStepButton",{defaultMessage:"Next"}))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var define_pivot_form_1=__webpack_require__(2975);exports.DefinePivotForm=define_pivot_form_1.DefinePivotForm;exports.getDefaultPivotState=define_pivot_form_1.getDefaultPivotState;var define_pivot_summary_1=__webpack_require__(2991);exports.DefinePivotSummary=define_pivot_summary_1.DefinePivotSummary},function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(501);var dropdown_1=__webpack_require__(2976);var aggregation_list_1=__webpack_require__(1376);var group_by_list_1=__webpack_require__(1377);var source_index_preview_1=__webpack_require__(2986);var pivot_preview_1=__webpack_require__(1378);var common_2=__webpack_require__(227);var common_3=__webpack_require__(1379);var defaultSearch="*";var emptySearch="";function getDefaultPivotState(kibanaContext){return{aggList:{},groupByList:{},search:kibanaContext.currentSavedSearch.id!==undefined?kibanaContext.combinedQuery:defaultSearch,valid:false}}exports.getDefaultPivotState=getDefaultPivotState;function isAggNameConflict(aggName,aggList,groupByList){if(aggList[aggName]!==undefined){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.definePivot.aggExistsErrorMessage",{defaultMessage:"An aggregation configuration with the name '{aggName}' already exists.",values:{aggName:aggName}}));return true}if(groupByList[aggName]!==undefined){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.definePivot.groupByExistsErrorMessage",{defaultMessage:"A group by configuration with the name '{aggName}' already exists.",values:{aggName:aggName}}));return true}var conflict=false;var aggNameSplit=aggName.split(".");var aggNameCheck;aggNameSplit.forEach(function(aggNamePart){aggNameCheck=aggNameCheck===undefined?aggNamePart:"".concat(aggNameCheck,".").concat(aggNamePart);if(aggList[aggNameCheck]!==undefined||groupByList[aggNameCheck]!==undefined){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.definePivot.nestedConflictErrorMessage",{defaultMessage:"Couldn't add configuration '{aggName}' because of a nesting conflict with '{aggNameCheck}'.",values:{aggName:aggName,aggNameCheck:aggNameCheck}}));conflict=true}});if(conflict){return true}conflict=Object.keys(aggList).some(function(aggListName){var aggListNameSplit=aggListName.split(".");var aggListNameCheck;return aggListNameSplit.some(function(aggListNamePart){aggListNameCheck=aggListNameCheck===undefined?aggListNamePart:"".concat(aggListNameCheck,".").concat(aggListNamePart);if(aggListNameCheck===aggName){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.definePivot.nestedAggListConflictErrorMessage",{defaultMessage:"Couldn't add configuration '{aggName}' because of a nesting conflict with '{aggListName}'.",values:{aggName:aggName,aggListName:aggListName}}));return true}return false})});if(conflict){return true}conflict=Object.keys(groupByList).some(function(groupByListName){var groupByListNameSplit=groupByListName.split(".");var groupByListNameCheck;return groupByListNameSplit.some(function(groupByListNamePart){groupByListNameCheck=groupByListNameCheck===undefined?groupByListNamePart:"".concat(groupByListNameCheck,".").concat(groupByListNamePart);if(groupByListNameCheck===aggName){notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.definePivot.nestedGroupByListConflictErrorMessage",{defaultMessage:"Couldn't add configuration '{aggName}' because of a nesting conflict with '{groupByListName}'.",values:{aggName:aggName,groupByListName:groupByListName}}));return true}return false})});return conflict}exports.isAggNameConflict=isAggNameConflict;exports.DefinePivotForm=react_1.default.memo(function(_ref){var _ref$overrides=_ref.overrides,overrides=_ref$overrides===void 0?{}:_ref$overrides,onChange=_ref.onChange;var kibanaContext=react_1.useContext(common_2.KibanaContext);if(!common_2.isKibanaContext(kibanaContext)){return null}var indexPattern=kibanaContext.currentIndexPattern;var defaults=_objectSpread({},getDefaultPivotState(kibanaContext),overrides);var _react_1$useState=react_1.useState(defaults.search),_react_1$useState2=_slicedToArray(_react_1$useState,2),search=_react_1$useState2[0],setSearch=_react_1$useState2[1];var addToSearch=function addToSearch(newSearch){var currentDisplaySearch=search===defaultSearch?emptySearch:search;setSearch("".concat(currentDisplaySearch," ").concat(newSearch).trim())};var searchHandler=function searchHandler(d){var newSearch=d.currentTarget.value===emptySearch?defaultSearch:d.currentTarget.value;setSearch(newSearch)};var _react_1$useState3=react_1.useState(defaults.groupByList),_react_1$useState4=_slicedToArray(_react_1$useState3,2),groupByList=_react_1$useState4[0],setGroupByList=_react_1$useState4[1];var _common_3$getPivotDro=common_3.getPivotDropdownOptions(indexPattern),groupByOptions=_common_3$getPivotDro.groupByOptions,groupByOptionsData=_common_3$getPivotDro.groupByOptionsData,aggOptions=_common_3$getPivotDro.aggOptions,aggOptionsData=_common_3$getPivotDro.aggOptionsData;var addGroupBy=function addGroupBy(d){var label=d[0].label;var config=groupByOptionsData[label];var aggName=config.aggName;if(isAggNameConflict(aggName,aggList,groupByList)){return}groupByList[aggName]=config;setGroupByList(_objectSpread({},groupByList))};var updateGroupBy=function updateGroupBy(previousAggName,item){var groupByListWithoutPrevious=_objectSpread({},groupByList);delete groupByListWithoutPrevious[previousAggName];if(isAggNameConflict(item.aggName,aggList,groupByListWithoutPrevious)){return}groupByListWithoutPrevious[item.aggName]=item;setGroupByList(_objectSpread({},groupByListWithoutPrevious))};var deleteGroupBy=function deleteGroupBy(aggName){delete groupByList[aggName];setGroupByList(_objectSpread({},groupByList))};var _react_1$useState5=react_1.useState(defaults.aggList),_react_1$useState6=_slicedToArray(_react_1$useState5,2),aggList=_react_1$useState6[0],setAggList=_react_1$useState6[1];var addAggregation=function addAggregation(d){var label=d[0].label;var config=aggOptionsData[label];var aggName=config.aggName;if(isAggNameConflict(aggName,aggList,groupByList)){return}aggList[aggName]=config;setAggList(_objectSpread({},aggList))};var updateAggregation=function updateAggregation(previousAggName,item){var aggListWithoutPrevious=_objectSpread({},aggList);delete aggListWithoutPrevious[previousAggName];if(isAggNameConflict(item.aggName,aggListWithoutPrevious,groupByList)){return}aggListWithoutPrevious[item.aggName]=item;setAggList(_objectSpread({},aggListWithoutPrevious))};var deleteAggregation=function deleteAggregation(aggName){delete aggList[aggName];setAggList(_objectSpread({},aggList))};var pivotAggsArr=common_1.dictionaryToArray(aggList);var pivotGroupByArr=common_1.dictionaryToArray(groupByList);var pivotQuery=common_2.getPivotQuery(search);var valid=pivotGroupByArr.length>0&&pivotAggsArr.length>0;react_1.useEffect(function(){onChange({aggList:aggList,groupByList:groupByList,search:search,valid:valid})},[pivotAggsArr.map(function(d){return"".concat(d.agg," ").concat(d.field," ").concat(d.aggName)}).join(" "),pivotGroupByArr.map(function(d){return"".concat(d.agg," ").concat(d.field," ").concat(common_2.isGroupByHistogram(d)?d.interval:""," ").concat(common_2.isGroupByDateHistogram(d)?d.calendar_interval:""," ").concat(d.aggName)}).join(" "),search,valid]);var maxIndexFields=1024;var numIndexFields=indexPattern.fields.length;var disabledQuery=numIndexFields>maxIndexFields;return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:{minWidth:"420px"}},react_1.default.createElement(eui_1.EuiForm,null,kibanaContext.currentSavedSearch.id===undefined&&typeof search==="string"&&react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.indexPatternLabel",{defaultMessage:"Index pattern"}),helpText:disabledQuery?i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.indexPatternHelpText",{defaultMessage:"An optional query for this index pattern is not supported. The number of supported index fields is {maxIndexFields} whereas this index has {numIndexFields} fields.",values:{maxIndexFields:maxIndexFields,numIndexFields:numIndexFields}}):""},react_1.default.createElement("span",null,kibanaContext.currentIndexPattern.title)),!disabledQuery&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.queryLabel",{defaultMessage:"Query"}),helpText:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.queryHelpText",{defaultMessage:"Use a query string to filter the source data (optional)."})},react_1.default.createElement(eui_1.EuiFieldSearch,{placeholder:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.queryPlaceholder",{defaultMessage:"Search..."}),onChange:searchHandler,value:search===defaultSearch?emptySearch:search}))),kibanaContext.currentSavedSearch.id!==undefined&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.savedSearchLabel",{defaultMessage:"Saved search"})},react_1.default.createElement("span",null,kibanaContext.currentSavedSearch.title)),react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.groupByLabel",{defaultMessage:"Group by"})},react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(group_by_list_1.GroupByListForm,{list:groupByList,options:groupByOptionsData,onChange:updateGroupBy,deleteHandler:deleteGroupBy}),react_1.default.createElement(dropdown_1.DropDown,{changeHandler:addGroupBy,options:groupByOptions,placeholder:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.groupByPlaceholder",{defaultMessage:"Add a group by field ..."})}))),react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.aggregationsLabel",{defaultMessage:"Aggregations"})},react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(aggregation_list_1.AggListForm,{list:aggList,options:aggOptionsData,onChange:updateAggregation,deleteHandler:deleteAggregation}),react_1.default.createElement(dropdown_1.DropDown,{changeHandler:addAggregation,options:aggOptions,placeholder:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.aggregationsPlaceholder",{defaultMessage:"Add an aggregation ..."})}))),!valid&&react_1.default.createElement(eui_1.EuiFormHelpText,{style:{maxWidth:"320px"}},i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.formHelp",{defaultMessage:"Data frame transforms are scalable and automated processes for pivoting. Choose at least one group-by and aggregation to get started."})))),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(source_index_preview_1.SourceIndexPreview,{cellClick:addToSearch,query:pivotQuery}),react_1.default.createElement(eui_1.EuiSpacer,{size:"l"}),react_1.default.createElement(pivot_preview_1.PivotPreview,{aggs:aggList,groupBy:groupByList,query:pivotQuery})))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);exports.DropDown=function(_ref){var changeHandler=_ref.changeHandler,options=_ref.options,_ref$placeholder=_ref.placeholder,placeholder=_ref$placeholder===void 0?"Search ...":_ref$placeholder;return react_1.default.createElement(eui_1.EuiComboBox,{placeholder:placeholder,singleSelection:{asPlainText:true},options:options,selectedOptions:[],onChange:changeHandler,isClearable:false})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var agg_label_form_1=__webpack_require__(2978);exports.AggListForm=function(_ref){var deleteHandler=_ref.deleteHandler,list=_ref.list,_onChange=_ref.onChange,options=_ref.options;var listKeys=Object.keys(list);return react_1.default.createElement(react_1.Fragment,null,listKeys.map(function(aggName){var otherAggNames=listKeys.filter(function(k){return k!==aggName});return react_1.default.createElement(react_1.Fragment,{key:aggName},react_1.default.createElement(eui_1.EuiPanel,{paddingSize:"s"},react_1.default.createElement(agg_label_form_1.AggLabelForm,{deleteHandler:deleteHandler,item:list[aggName],onChange:function onChange(item){return _onChange(aggName,item)},otherAggNames:otherAggNames,options:options})),listKeys.length>0&&react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}))}))}},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var popover_form_1=__webpack_require__(2979);exports.AggLabelForm=function(_ref){var deleteHandler=_ref.deleteHandler,item=_ref.item,otherAggNames=_ref.otherAggNames,onChange=_ref.onChange,options=_ref.options;var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),isPopoverVisible=_react_1$useState2[0],setPopoverVisibility=_react_1$useState2[1];function update(updateItem){onChange(_objectSpread({},updateItem));setPopoverVisibility(false)}return react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},react_1.default.createElement(eui_1.EuiFlexItem,{className:"mlAggregationLabel--text"},react_1.default.createElement("span",{className:"eui-textTruncate"},item.aggName)),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--button"},react_1.default.createElement(eui_1.EuiPopover,{id:"mlFormPopover",ownFocus:true,button:react_1.default.createElement(eui_1.EuiButtonIcon,{"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.aggLabelForm.editAggAriaLabel",{defaultMessage:"Edit aggregation"}),size:"s",iconType:"pencil",onClick:function onClick(){return setPopoverVisibility(!isPopoverVisible)}}),isOpen:isPopoverVisible,closePopover:function closePopover(){return setPopoverVisibility(false)}},react_1.default.createElement(popover_form_1.PopoverForm,{defaultData:item,onChange:update,otherAggNames:otherAggNames,options:options}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--button"},react_1.default.createElement(eui_1.EuiButtonIcon,{"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.aggLabelForm.deleteItemAriaLabel",{defaultMessage:"Delete item"}),size:"s",iconType:"cross",onClick:function onClick(){return deleteHandler(item.aggName)}})))}},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(501);var common_2=__webpack_require__(227);exports.PopoverForm=function(_ref){var defaultData=_ref.defaultData,otherAggNames=_ref.otherAggNames,onChange=_ref.onChange,options=_ref.options;var _react_1$useState=react_1.useState(defaultData.aggName),_react_1$useState2=_slicedToArray(_react_1$useState,2),aggName=_react_1$useState2[0],setAggName=_react_1$useState2[1];var _react_1$useState3=react_1.useState(defaultData.agg),_react_1$useState4=_slicedToArray(_react_1$useState3,2),agg=_react_1$useState4[0],setAgg=_react_1$useState4[1];var _react_1$useState5=react_1.useState(defaultData.field),_react_1$useState6=_slicedToArray(_react_1$useState5,2),field=_react_1$useState6[0],setField=_react_1$useState6[1];var optionsArr=common_1.dictionaryToArray(options);var availableFields=optionsArr.filter(function(o){return o.agg===defaultData.agg}).map(function(o){return{text:o.field}});var availableAggs=optionsArr.filter(function(o){return o.field===defaultData.field}).map(function(o){return{text:o.agg}});var aggNameError="";var validAggName=common_2.isAggName(aggName);if(!validAggName){aggNameError=i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.aggNameInvalidCharError",{defaultMessage:'Invalid name. The characters "[", "]", and ">" are not allowed and the name must not start or end with a space character.'})}if(validAggName){validAggName=!otherAggNames.includes(aggName);aggNameError=i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.aggNameAlreadyUsedError",{defaultMessage:"Another aggregation already uses that name."})}var formValid=validAggName;return react_1.default.createElement(eui_1.EuiForm,{style:{width:"300px"}},react_1.default.createElement(eui_1.EuiFormRow,{error:!validAggName&&[aggNameError],isInvalid:!validAggName,label:i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.nameLabel",{defaultMessage:"Aggregation name"})},react_1.default.createElement(eui_1.EuiFieldText,{defaultValue:aggName,isInvalid:!validAggName,onChange:function onChange(e){return setAggName(e.target.value)}})),availableAggs.length>0&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.aggLabel",{defaultMessage:"Aggregation"})},react_1.default.createElement(eui_1.EuiSelect,{options:availableAggs,value:agg,onChange:function onChange(e){return setAgg(e.target.value)}})),availableFields.length>0&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.fieldLabel",{defaultMessage:"Field"})},react_1.default.createElement(eui_1.EuiSelect,{options:availableFields,value:field,onChange:function onChange(e){return setField(e.target.value)}})),react_1.default.createElement(eui_1.EuiFormRow,{hasEmptyLabelSpace:true},react_1.default.createElement(eui_1.EuiButton,{isDisabled:!formValid,onClick:function onClick(){return onChange(_objectSpread({},defaultData,{aggName:aggName,agg:agg,field:field}))}},i18n_1.i18n.translate("xpack.ml.dataframe.agg.popoverForm.submitButtonLabel",{defaultMessage:"Apply"}))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);exports.AggListSummary=function(_ref){var list=_ref.list;var aggNames=Object.keys(list);return react_1.default.createElement(eui_1.EuiForm,null,aggNames.map(function(aggName){return react_1.default.createElement(react_1.Fragment,{key:aggName},react_1.default.createElement(eui_1.EuiPanel,{paddingSize:"s"},react_1.default.createElement("div",{className:"eui-textTruncate"},aggName)),aggNames.length>0&&react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var group_by_label_form_1=__webpack_require__(2982);exports.GroupByListForm=function(_ref){var deleteHandler=_ref.deleteHandler,list=_ref.list,_onChange=_ref.onChange,options=_ref.options;var listKeys=Object.keys(list);return react_1.default.createElement(react_1.Fragment,null,listKeys.map(function(aggName){var otherAggNames=listKeys.filter(function(k){return k!==aggName});return react_1.default.createElement(react_1.Fragment,{key:aggName},react_1.default.createElement(eui_1.EuiPanel,{paddingSize:"s"},react_1.default.createElement(group_by_label_form_1.GroupByLabelForm,{deleteHandler:deleteHandler,item:list[aggName],otherAggNames:otherAggNames,onChange:function onChange(item){return _onChange(aggName,item)},options:options})),listKeys.length>0&&react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}))}))}},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(227);var popover_form_1=__webpack_require__(2983);exports.GroupByLabelForm=function(_ref){var deleteHandler=_ref.deleteHandler,item=_ref.item,otherAggNames=_ref.otherAggNames,onChange=_ref.onChange,options=_ref.options;var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),isPopoverVisible=_react_1$useState2[0],setPopoverVisibility=_react_1$useState2[1];function update(updateItem){onChange(_objectSpread({},updateItem));setPopoverVisibility(false)}var interval;if(common_1.isGroupByDateHistogram(item)){interval=item.calendar_interval}else if(common_1.isGroupByHistogram(item)){interval=item.interval}return react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},react_1.default.createElement(eui_1.EuiFlexItem,{className:"mlGroupByLabel--text"},react_1.default.createElement("span",{className:"eui-textTruncate"},item.aggName)),interval!==undefined&&react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--text mlGroupByLabel--interval"},react_1.default.createElement(eui_1.EuiTextColor,{color:"subdued",className:"eui-textTruncate"},interval)),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--button"},react_1.default.createElement(eui_1.EuiPopover,{id:"mlIntervalFormPopover",ownFocus:true,button:react_1.default.createElement(eui_1.EuiButtonIcon,{"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.groupByLabelForm.editIntervalAriaLabel",{defaultMessage:"Edit interval"}),size:"s",iconType:"pencil",onClick:function onClick(){return setPopoverVisibility(!isPopoverVisible)}}),isOpen:isPopoverVisible,closePopover:function closePopover(){return setPopoverVisibility(false)}},react_1.default.createElement(popover_form_1.PopoverForm,{defaultData:item,onChange:update,otherAggNames:otherAggNames,options:options}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--button"},react_1.default.createElement(eui_1.EuiButtonIcon,{"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.groupByLabelForm.deleteItemAriaLabel",{defaultMessage:"Delete item"}),size:"s",iconType:"cross",onClick:function onClick(){return deleteHandler(item.aggName)}})))}},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var common_1=__webpack_require__(501);var common_2=__webpack_require__(227);function isIntervalValid(interval,intervalType){if(interval!==""&&interval!==undefined){if(intervalType===common_2.PIVOT_SUPPORTED_GROUP_BY_AGGS.HISTOGRAM){if(!common_2.histogramIntervalFormatRegex.test(interval)){return false}if(parseFloat(interval)===0&&parseInt(interval,10)===0){return false}return true}else if(intervalType===common_2.PIVOT_SUPPORTED_GROUP_BY_AGGS.DATE_HISTOGRAM){if(!common_2.dateHistogramIntervalFormatRegex.test(interval)){return false}var timeUnitMatch=interval.match(common_2.dateHistogramIntervalFormatRegex);if(timeUnitMatch!==null&&Array.isArray(timeUnitMatch)&&timeUnitMatch.length===2){var timeUnit=timeUnitMatch[1];var intervalNum=parseInt(interval.replace(timeUnit,""),10);if((timeUnit==="w"||timeUnit==="M"||timeUnit==="y")&&intervalNum>1){return false}}return true}}return false}exports.isIntervalValid=isIntervalValid;function getDefaultInterval(defaultData){if(common_2.isGroupByDateHistogram(defaultData)){return defaultData.calendar_interval}else if(common_2.isGroupByHistogram(defaultData)){return defaultData.interval}return undefined}exports.PopoverForm=function(_ref){var defaultData=_ref.defaultData,otherAggNames=_ref.otherAggNames,onChange=_ref.onChange,options=_ref.options;var _react_1$useState=react_1.useState(defaultData.agg),_react_1$useState2=_slicedToArray(_react_1$useState,2),agg=_react_1$useState2[0],setAgg=_react_1$useState2[1];var _react_1$useState3=react_1.useState(defaultData.aggName),_react_1$useState4=_slicedToArray(_react_1$useState3,2),aggName=_react_1$useState4[0],setAggName=_react_1$useState4[1];var _react_1$useState5=react_1.useState(defaultData.field),_react_1$useState6=_slicedToArray(_react_1$useState5,2),field=_react_1$useState6[0],setField=_react_1$useState6[1];var _react_1$useState7=react_1.useState(getDefaultInterval(defaultData)),_react_1$useState8=_slicedToArray(_react_1$useState7,2),interval=_react_1$useState8[0],setInterval=_react_1$useState8[1];function getUpdatedItem(){var updatedItem=_objectSpread({},defaultData,{agg:agg,aggName:aggName,field:field});if(common_2.isGroupByHistogram(updatedItem)&&interval!==undefined){updatedItem.interval=interval}else if(common_2.isGroupByDateHistogram(updatedItem)&&interval!==undefined){updatedItem.calendar_interval=interval}return updatedItem}var optionsArr=common_1.dictionaryToArray(options);var availableFields=optionsArr.filter(function(o){return o.agg===defaultData.agg}).map(function(o){return{text:o.field}});var availableAggs=optionsArr.filter(function(o){return o.field===defaultData.field}).map(function(o){return{text:o.agg}});var aggNameError="";var validAggName=common_2.isAggName(aggName);if(!validAggName){aggNameError=i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.aggNameInvalidCharError",{defaultMessage:'Invalid name. The characters "[", "]", and ">" are not allowed and the name must not start or end with a space character.'})}if(validAggName){validAggName=!otherAggNames.includes(aggName);aggNameError=i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.aggNameAlreadyUsedError",{defaultMessage:"Another group by configuration already uses that name."})}var validInterval=(common_2.isGroupByDateHistogram(defaultData)||common_2.isGroupByHistogram(defaultData))&&isIntervalValid(interval,defaultData.agg);var formValid=validAggName;if(formValid&&(common_2.isGroupByDateHistogram(defaultData)||common_2.isGroupByHistogram(defaultData))){formValid=isIntervalValid(interval,defaultData.agg)}return react_1.default.createElement(eui_1.EuiForm,{style:{width:"300px"}},react_1.default.createElement(eui_1.EuiFormRow,{error:!validAggName&&[aggNameError],isInvalid:!validAggName,label:i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.nameLabel",{defaultMessage:"Group by name"})},react_1.default.createElement(eui_1.EuiFieldText,{defaultValue:aggName,isInvalid:!validAggName,onChange:function onChange(e){return setAggName(e.target.value)}})),availableAggs.length>0&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.groupby.popoverForm.aggLabel",{defaultMessage:"Aggregation"})},react_1.default.createElement(eui_1.EuiSelect,{options:availableAggs,value:agg,onChange:function onChange(e){return setAgg(e.target.value)}})),availableFields.length>0&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.fieldLabel",{defaultMessage:"Field"})},react_1.default.createElement(eui_1.EuiSelect,{options:availableFields,value:field,onChange:function onChange(e){return setField(e.target.value)}})),(common_2.isGroupByDateHistogram(defaultData)||common_2.isGroupByHistogram(defaultData))&&react_1.default.createElement(eui_1.EuiFormRow,{error:!validInterval&&[i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.intervalError",{defaultMessage:"Invalid interval."})],isInvalid:!validInterval,label:i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.intervalLabel",{defaultMessage:"Interval"})},react_1.default.createElement(react_1.Fragment,null,common_2.isGroupByHistogram(defaultData)&&react_1.default.createElement(eui_1.EuiFieldText,{defaultValue:interval,isInvalid:!validInterval,onChange:function onChange(e){return setInterval(e.target.value)}}),common_2.isGroupByDateHistogram(defaultData)&&react_1.default.createElement(eui_1.EuiSelect,{options:[{value:"1m",text:"1m"},{value:"1h",text:"1h"},{value:"1d",text:"1d"},{value:"1w",text:"1w"},{value:"1M",text:"1M"},{value:"1q",text:"1q"},{value:"1y",text:"1y"}],value:interval,onChange:function onChange(e){return setInterval(e.target.value)}}))),react_1.default.createElement(eui_1.EuiFormRow,{hasEmptyLabelSpace:true},react_1.default.createElement(eui_1.EuiButton,{isDisabled:!formValid,onClick:function onClick(){return onChange(getUpdatedItem())}},i18n_1.i18n.translate("xpack.ml.dataframe.groupBy.popoverForm.submitButtonLabel",{defaultMessage:"Apply"}))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var eui_1=__webpack_require__(1);var group_by_label_summary_1=__webpack_require__(2985);exports.GroupByListSummary=function(_ref){var list=_ref.list;var listKeys=Object.keys(list);return react_1.default.createElement(react_1.Fragment,null,listKeys.map(function(optionsDataId){return react_1.default.createElement(react_1.Fragment,{key:optionsDataId},react_1.default.createElement(eui_1.EuiPanel,{paddingSize:"s"},react_1.default.createElement(group_by_label_summary_1.GroupByLabelSummary,{item:list[optionsDataId],optionsDataId:optionsDataId})),listKeys.length>0&&react_1.default.createElement(eui_1.EuiSpacer,{size:"s"}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);var common_1=__webpack_require__(227);exports.GroupByLabelSummary=function(_ref){var item=_ref.item,optionsDataId=_ref.optionsDataId;var interval;if(common_1.isGroupByDateHistogram(item)){interval=item.calendar_interval}else if(common_1.isGroupByHistogram(item)){interval=item.interval}return react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},react_1.default.createElement(eui_1.EuiFlexItem,{className:"mlGroupByLabel--text"},react_1.default.createElement("span",{className:"eui-textTruncate"},optionsDataId)),interval!==undefined&&react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,className:"mlGroupByLabel--text mlGroupByLabel--interval"},react_1.default.createElement(eui_1.EuiTextColor,{color:"subdued",className:"eui-textTruncate"},interval)))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var source_index_preview_1=__webpack_require__(2987);exports.SourceIndexPreview=source_index_preview_1.SourceIndexPreview},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var moment_timezone_1=tslib_1.__importDefault(__webpack_require__(224));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var ExpandableTable=eui_1.EuiInMemoryTable;var field_types_1=__webpack_require__(295);var date_utils_1=__webpack_require__(279);var common_1=__webpack_require__(227);var common_2=__webpack_require__(685);var expanded_row_1=__webpack_require__(2988);var use_source_index_data_1=__webpack_require__(2989);var CELL_CLICK_ENABLED=false;var SORT_DIRECTON;(function(SORT_DIRECTON){SORT_DIRECTON["ASC"]="asc";SORT_DIRECTON["DESC"]="desc"})(SORT_DIRECTON||(SORT_DIRECTON={}));var SourceIndexPreviewTitle=function SourceIndexPreviewTitle(_ref){var indexPatternTitle=_ref.indexPatternTitle;return react_1.default.createElement(eui_1.EuiTitle,{size:"xs"},react_1.default.createElement("span",null,i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.sourceIndexPatternTitle",{defaultMessage:"Source index {indexPatternTitle}",values:{indexPatternTitle:indexPatternTitle}})))};exports.SourceIndexPreview=react_1.default.memo(function(_ref2){var cellClick=_ref2.cellClick,query=_ref2.query;var _react_1$useState=react_1.useState(false),_react_1$useState2=_slicedToArray(_react_1$useState,2),clearTable=_react_1$useState2[0],setClearTable=_react_1$useState2[1];var kibanaContext=react_1.useContext(common_1.KibanaContext);if(!common_1.isKibanaContext(kibanaContext)){return null}var indexPattern=kibanaContext.currentIndexPattern;var _react_1$useState3=react_1.useState([]),_react_1$useState4=_slicedToArray(_react_1$useState3,2),selectedFields=_react_1$useState4[0],setSelectedFields=_react_1$useState4[1];var _react_1$useState5=react_1.useState(false),_react_1$useState6=_slicedToArray(_react_1$useState5,2),isColumnsPopoverVisible=_react_1$useState6[0],setColumnsPopoverVisible=_react_1$useState6[1];if(clearTable){setTimeout(function(){return setClearTable(false)},0)}function toggleColumnsPopover(){setColumnsPopoverVisible(!isColumnsPopoverVisible)}function closeColumnsPopover(){setColumnsPopoverVisible(false)}function toggleColumn(column){setClearTable(true);setSelectedFields(_toConsumableArray(common_2.toggleSelectedField(selectedFields,column)))}var _react_1$useState7=react_1.useState({}),_react_1$useState8=_slicedToArray(_react_1$useState7,2),itemIdToExpandedRowMap=_react_1$useState8[0],setItemIdToExpandedRowMap=_react_1$useState8[1];function toggleDetails(item){if(itemIdToExpandedRowMap[item._id]){delete itemIdToExpandedRowMap[item._id]}else{itemIdToExpandedRowMap[item._id]=react_1.default.createElement(expanded_row_1.ExpandedRow,{item:item})}setItemIdToExpandedRowMap(_objectSpread({},itemIdToExpandedRowMap))}var _use_source_index_dat=use_source_index_data_1.useSourceIndexData(indexPattern,query,selectedFields,setSelectedFields),errorMessage=_use_source_index_dat.errorMessage,status=_use_source_index_dat.status,tableItems=_use_source_index_dat.tableItems;if(status===use_source_index_data_1.SOURCE_INDEX_STATUS.ERROR){return react_1.default.createElement(eui_1.EuiPanel,{grow:false},react_1.default.createElement(SourceIndexPreviewTitle,{indexPatternTitle:indexPattern.title}),react_1.default.createElement(eui_1.EuiCallOut,{title:i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.sourceIndexPatternError",{defaultMessage:"An error occurred loading the source index data."}),color:"danger",iconType:"cross"},react_1.default.createElement("p",null,errorMessage)))}if(status===use_source_index_data_1.SOURCE_INDEX_STATUS.LOADED&&tableItems.length===0){return react_1.default.createElement(eui_1.EuiPanel,{grow:false},react_1.default.createElement(SourceIndexPreviewTitle,{indexPatternTitle:indexPattern.title}),react_1.default.createElement(eui_1.EuiCallOut,{title:i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.dataFrameSourceIndexNoDataCalloutTitle",{defaultMessage:"Empty source index query result."}),color:"primary"},react_1.default.createElement("p",null,i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.dataFrameSourceIndexNoDataCalloutBody",{defaultMessage:"The query for the source index returned no results. Please make sure the index contains documents and your query is not too restrictive."}))))}var docFields=[];var docFieldsCount=0;if(tableItems.length>0){docFields=Object.keys(tableItems[0]._source);docFields.sort();docFieldsCount=docFields.length}var columns=selectedFields.map(function(k){var column={field:'_source["'.concat(k,'"]'),name:k,sortable:true,truncateText:true};var field=indexPattern.fields.find(function(f){return f.name===k});var formatField=function formatField(d){return field!==undefined&&field.type===field_types_1.KBN_FIELD_TYPES.DATE?date_utils_1.formatHumanReadableDateTimeSeconds(moment_timezone_1.default(d).unix()*1e3):d};var render=function render(d){if(Array.isArray(d)&&d.every(function(item){return typeof item==="string"})){return"".concat(d.map(function(item){return formatField(item)}).slice(0,5).join(", ")).concat(d.length>5?", …":"")}else if(Array.isArray(d)){return react_1.default.createElement(eui_1.EuiToolTip,{content:i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.dataFrameSourceIndexArrayToolTipContent",{defaultMessage:"The full content of this array based column is available in the expanded row."})},react_1.default.createElement(eui_1.EuiBadge,null,"array"))}return formatField(d)};column.render=render;if(CELL_CLICK_ENABLED&&cellClick){column.render=function(d){return react_1.default.createElement(eui_1.EuiButtonEmpty,{size:"xs",onClick:function onClick(){return cellClick("".concat(k,":(").concat(d,")"))}},render(d))}}return column});var sorting=false;if(columns.length>0){sorting={sort:{field:columns[0].field,direction:SORT_DIRECTON.ASC}}}columns.unshift({align:eui_1.RIGHT_ALIGNMENT,width:"40px",isExpander:true,render:function render(item){return react_1.default.createElement(eui_1.EuiButtonIcon,{onClick:function onClick(){return toggleDetails(item)},"aria-label":itemIdToExpandedRowMap[item._id]?i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.rowCollapse",{defaultMessage:"Collapse"}):i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.rowExpand",{defaultMessage:"Expand"}),iconType:itemIdToExpandedRowMap[item._id]?"arrowUp":"arrowDown"})}});var euiCopyText=i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.copyClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the source index preview to the clipboard."});return react_1.default.createElement(eui_1.EuiPanel,{grow:false},react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(SourceIndexPreviewTitle,{indexPatternTitle:indexPattern.title})),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},react_1.default.createElement(eui_1.EuiFlexItem,null,docFieldsCount>common_2.MAX_COLUMNS&&react_1.default.createElement(eui_1.EuiText,{size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.fieldSelection",{defaultMessage:"showing {selectedFieldsLength, number} of {docFieldsCount, number} {docFieldsCount, plural, one {field} other {fields}}",values:{selectedFieldsLength:selectedFields.length,docFieldsCount:docFieldsCount}}))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiText,{size:"s"},react_1.default.createElement(eui_1.EuiPopover,{id:"popover",button:react_1.default.createElement(eui_1.EuiButtonIcon,{iconType:"gear",onClick:toggleColumnsPopover,"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.selectColumnsAriaLabel",{defaultMessage:"Select columns"})}),isOpen:isColumnsPopoverVisible,closePopover:closeColumnsPopover,ownFocus:true},react_1.default.createElement(eui_1.EuiPopoverTitle,null,i18n_1.i18n.translate("xpack.ml.dataframe.sourceIndexPreview.selectFieldsPopoverTitle",{defaultMessage:"Select fields"})),react_1.default.createElement("div",{style:{maxHeight:"400px",overflowY:"scroll"}},docFields.map(function(d){return react_1.default.createElement(eui_1.EuiCheckbox,{key:d,id:d,label:d,checked:selectedFields.includes(d),onChange:function onChange(){return toggleColumn(d)},disabled:selectedFields.includes(d)&&selectedFields.length===1})}))))),react_1.default.createElement(eui_1.EuiFlexItem,{grow:false},react_1.default.createElement(eui_1.EuiCopy,{beforeMessage:euiCopyText,textToCopy:common_2.getSourceIndexDevConsoleStatement(query,indexPattern.title)},function(copy){return react_1.default.createElement(eui_1.EuiButtonIcon,{onClick:copy,iconType:"copyClipboard","aria-label":euiCopyText})}))))),status===use_source_index_data_1.SOURCE_INDEX_STATUS.LOADING&&react_1.default.createElement(eui_1.EuiProgress,{size:"xs",color:"accent"}),status!==use_source_index_data_1.SOURCE_INDEX_STATUS.LOADING&&react_1.default.createElement(eui_1.EuiProgress,{size:"xs",color:"accent",max:1,value:0}),clearTable===false&&react_1.default.createElement(ExpandableTable,{compressed:true,items:tableItems,columns:columns,pagination:{initialPageSize:5,pageSizeOptions:[5,10,25]},hasActions:false,isSelectable:false,itemId:"_id",itemIdToExpandedRowMap:itemIdToExpandedRowMap,isExpandable:true,sorting:sorting}))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var lodash_1=__webpack_require__(3);var react_1=tslib_1.__importDefault(__webpack_require__(0));var eui_1=__webpack_require__(1);var common_1=__webpack_require__(685);exports.ExpandedRow=function(_ref){var item=_ref.item;var keys=common_1.getSelectableFields([item]);var list=keys.map(function(k){var value=lodash_1.get(item._source,k,"");return react_1.default.createElement("span",{key:k},react_1.default.createElement(eui_1.EuiBadge,null,k,":"),react_1.default.createElement("small",null," ",typeof value==="string"?value:JSON.stringify(value),"  "))});return react_1.default.createElement(eui_1.EuiText,null,list)}},function(module,exports,__webpack_require__){"use strict";function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var lodash_1=__webpack_require__(3);var react_1=__webpack_require__(0);var ml_api_service_1=__webpack_require__(24);var common_1=__webpack_require__(227);var common_2=__webpack_require__(685);var SEARCH_SIZE=1e3;var SOURCE_INDEX_STATUS;(function(SOURCE_INDEX_STATUS){SOURCE_INDEX_STATUS[SOURCE_INDEX_STATUS["UNUSED"]=0]="UNUSED";SOURCE_INDEX_STATUS[SOURCE_INDEX_STATUS["LOADING"]=1]="LOADING";SOURCE_INDEX_STATUS[SOURCE_INDEX_STATUS["LOADED"]=2]="LOADED";SOURCE_INDEX_STATUS[SOURCE_INDEX_STATUS["ERROR"]=3]="ERROR"})(SOURCE_INDEX_STATUS=exports.SOURCE_INDEX_STATUS||(exports.SOURCE_INDEX_STATUS={}));exports.useSourceIndexData=function(indexPattern,query,selectedFields,setSelectedFields){var _react_1$useState=react_1.useState(""),_react_1$useState2=_slicedToArray(_react_1$useState,2),errorMessage=_react_1$useState2[0],setErrorMessage=_react_1$useState2[1];var _react_1$useState3=react_1.useState(SOURCE_INDEX_STATUS.UNUSED),_react_1$useState4=_slicedToArray(_react_1$useState3,2),status=_react_1$useState4[0],setStatus=_react_1$useState4[1];var _react_1$useState5=react_1.useState([]),_react_1$useState6=_slicedToArray(_react_1$useState5,2),tableItems=_react_1$useState6[0],setTableItems=_react_1$useState6[1];var getSourceIndexData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var resp,docs,newSelectedFields,flattenedFields,transformedTableItems;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setErrorMessage("");setStatus(SOURCE_INDEX_STATUS.LOADING);_context.prev=2;_context.next=5;return ml_api_service_1.ml.esSearch({index:indexPattern.title,size:SEARCH_SIZE,body:{query:common_1.isDefaultQuery(query)?{match_all:{}}:query}});case 5:resp=_context.sent;docs=resp.hits.hits;if(selectedFields.length===0){newSelectedFields=common_2.getDefaultSelectableFields(docs);setSelectedFields(newSelectedFields)}flattenedFields=common_2.getFlattenedFields(docs[0]._source);transformedTableItems=docs.map(function(doc){var item={};flattenedFields.forEach(function(ff){item[ff]=lodash_1.get(doc._source,ff);if(item[ff]===undefined){item[ff]=doc._source['"'.concat(ff,'"')]}});return _objectSpread({},doc,{_source:item})});setTableItems(transformedTableItems);setStatus(SOURCE_INDEX_STATUS.LOADED);_context.next=19;break;case 14:_context.prev=14;_context.t0=_context["catch"](2);setErrorMessage(JSON.stringify(_context.t0));setTableItems([]);setStatus(SOURCE_INDEX_STATUS.ERROR);case 19:case"end":return _context.stop()}}},_callee,null,[[2,14]])}));return function getSourceIndexData(){return _ref.apply(this,arguments)}}();react_1.useEffect(function(){getSourceIndexData()},[indexPattern.title,JSON.stringify(query)]);return{errorMessage:errorMessage,status:status,tableItems:tableItems}}},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}Object.defineProperty(exports,"__esModule",{value:true});var react_1=__webpack_require__(0);var common_1=__webpack_require__(501);var ml_api_service_1=__webpack_require__(24);var common_2=__webpack_require__(227);var PIVOT_PREVIEW_STATUS;(function(PIVOT_PREVIEW_STATUS){PIVOT_PREVIEW_STATUS[PIVOT_PREVIEW_STATUS["UNUSED"]=0]="UNUSED";PIVOT_PREVIEW_STATUS[PIVOT_PREVIEW_STATUS["LOADING"]=1]="LOADING";PIVOT_PREVIEW_STATUS[PIVOT_PREVIEW_STATUS["LOADED"]=2]="LOADED";PIVOT_PREVIEW_STATUS[PIVOT_PREVIEW_STATUS["ERROR"]=3]="ERROR"})(PIVOT_PREVIEW_STATUS=exports.PIVOT_PREVIEW_STATUS||(exports.PIVOT_PREVIEW_STATUS={}));exports.usePivotPreviewData=function(indexPattern,query,aggs,groupBy){var _react_1$useState=react_1.useState(""),_react_1$useState2=_slicedToArray(_react_1$useState,2),errorMessage=_react_1$useState2[0],setErrorMessage=_react_1$useState2[1];var _react_1$useState3=react_1.useState(PIVOT_PREVIEW_STATUS.UNUSED),_react_1$useState4=_slicedToArray(_react_1$useState3,2),status=_react_1$useState4[0],setStatus=_react_1$useState4[1];var _react_1$useState5=react_1.useState([]),_react_1$useState6=_slicedToArray(_react_1$useState5,2),dataFramePreviewData=_react_1$useState6[0],setDataFramePreviewData=_react_1$useState6[1];var aggsArr=common_1.dictionaryToArray(aggs);var groupByArr=common_1.dictionaryToArray(groupBy);var previewRequest=common_2.getDataFramePreviewRequest(indexPattern.title,query,groupByArr,aggsArr);var getDataFramePreviewData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var resp;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(aggsArr.length===0||groupByArr.length===0)){_context.next=3;break}setDataFramePreviewData([]);return _context.abrupt("return");case 3:setErrorMessage("");setStatus(PIVOT_PREVIEW_STATUS.LOADING);_context.prev=5;_context.next=8;return ml_api_service_1.ml.dataFrame.getDataFrameTransformsPreview(previewRequest);case 8:resp=_context.sent;setDataFramePreviewData(resp.preview);setStatus(PIVOT_PREVIEW_STATUS.LOADED);_context.next=18;break;case 13:_context.prev=13;_context.t0=_context["catch"](5);setErrorMessage(JSON.stringify(_context.t0));setDataFramePreviewData([]);setStatus(PIVOT_PREVIEW_STATUS.ERROR);case 18:case"end":return _context.stop()}}},_callee,null,[[5,13]])}));return function getDataFramePreviewData(){return _ref.apply(this,arguments)}}();react_1.useEffect(function(){getDataFramePreviewData()},[indexPattern.title,aggsArr.map(function(a){return"".concat(a.agg," ").concat(a.field," ").concat(a.aggName)}).join(" "),groupByArr.map(function(g){return"".concat(g.agg," ").concat(g.field," ").concat(g.aggName," ").concat(common_2.isGroupByDateHistogram(g)?g.calendar_interval:""," ").concat(common_2.isGroupByHistogram(g)?g.interval:"")}).join(" "),JSON.stringify(query)]);return{errorMessage:errorMessage,status:status,dataFramePreviewData:dataFramePreviewData,previewRequest:previewRequest}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);var aggregation_list_1=__webpack_require__(1376);var group_by_list_1=__webpack_require__(1377);var pivot_preview_1=__webpack_require__(1378);var common_1=__webpack_require__(227);var defaultSearch="*";var emptySearch="";exports.DefinePivotSummary=function(_ref){var search=_ref.search,groupByList=_ref.groupByList,aggList=_ref.aggList;var kibanaContext=react_1.useContext(common_1.KibanaContext);if(!common_1.isKibanaContext(kibanaContext)){return null}var pivotQuery=common_1.getPivotQuery(search);var displaySearch=search===defaultSearch?emptySearch:search;return react_1.default.createElement(eui_1.EuiFlexGroup,null,react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:{minWidth:"420px"}},react_1.default.createElement(eui_1.EuiForm,null,kibanaContext.currentSavedSearch.id===undefined&&typeof search==="string"&&react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotSummary.indexPatternLabel",{defaultMessage:"Index pattern"})},react_1.default.createElement("span",null,kibanaContext.currentIndexPattern.title)),displaySearch!==emptySearch&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotSummary.queryLabel",{defaultMessage:"Query"})},react_1.default.createElement("span",null,displaySearch))),kibanaContext.currentSavedSearch.id!==undefined&&react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotForm.savedSearchLabel",{defaultMessage:"Saved search"})},react_1.default.createElement("span",null,kibanaContext.currentSavedSearch.title)),react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotSummary.groupByLabel",{defaultMessage:"Group by"})},react_1.default.createElement(group_by_list_1.GroupByListSummary,{list:groupByList})),react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.definePivotSummary.aggregationsLabel",{defaultMessage:"Aggregations"})},react_1.default.createElement(aggregation_list_1.AggListSummary,{list:aggList})))),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,null,react_1.default.createElement(pivot_preview_1.PivotPreview,{aggs:aggList,groupBy:groupByList,query:pivotQuery}))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var job_create_form_1=__webpack_require__(2993);exports.JobCreateForm=job_create_form_1.JobCreateForm;exports.getDefaultJobCreateState=job_create_form_1.getDefaultJobCreateState;var job_create_summary_1=__webpack_require__(2994);exports.JobCreateSummary=job_create_summary_1.JobCreateSummary},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var eui_1=__webpack_require__(1);var ml_api_service_1=__webpack_require__(24);var jobs_list_1=__webpack_require__(679);var common_1=__webpack_require__(227);var common_2=__webpack_require__(227);function getDefaultJobCreateState(){return{created:false,started:false,indexPatternId:undefined}}exports.getDefaultJobCreateState=getDefaultJobCreateState;exports.JobCreateForm=react_1.default.memo(function(_ref){var createIndexPattern=_ref.createIndexPattern,jobConfig=_ref.jobConfig,jobId=_ref.jobId,onChange=_ref.onChange,overrides=_ref.overrides;var defaults=_objectSpread({},getDefaultJobCreateState(),overrides);var _react_1$useState=react_1.useState(defaults.created),_react_1$useState2=_slicedToArray(_react_1$useState,2),created=_react_1$useState2[0],setCreated=_react_1$useState2[1];var _react_1$useState3=react_1.useState(defaults.started),_react_1$useState4=_slicedToArray(_react_1$useState3,2),started=_react_1$useState4[0],setStarted=_react_1$useState4[1];var _react_1$useState5=react_1.useState(defaults.indexPatternId),_react_1$useState6=_slicedToArray(_react_1$useState5,2),indexPatternId=_react_1$useState6[0],setIndexPatternId=_react_1$useState6[1];var _react_1$useState7=react_1.useState(undefined),_react_1$useState8=_slicedToArray(_react_1$useState7,2),progressPercentComplete=_react_1$useState8[0],setProgressPercentComplete=_react_1$useState8[1];var kibanaContext=react_1.useContext(common_2.KibanaContext);if(!common_2.isKibanaContext(kibanaContext)){return null}react_1.useEffect(function(){onChange({created:created,started:started,indexPatternId:indexPatternId})},[created,started,indexPatternId]);function createDataFrame(){return _createDataFrame.apply(this,arguments)}function _createDataFrame(){_createDataFrame=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setCreated(true);_context3.prev=1;_context3.next=4;return ml_api_service_1.ml.dataFrame.createDataFrameTransformsJob(jobId,jobConfig);case 4:notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createJobSuccessMessage",{defaultMessage:"Data frame job {jobId} created successfully.",values:{jobId:jobId}}));_context3.next=12;break;case 7:_context3.prev=7;_context3.t0=_context3["catch"](1);setCreated(false);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createJobErrorMessage",{defaultMessage:"An error occurred creating the data frame job {jobId}: {error}",values:{jobId:jobId,error:JSON.stringify(_context3.t0)}}));return _context3.abrupt("return",false);case 12:if(createIndexPattern){createKibanaIndexPattern()}return _context3.abrupt("return",true);case 14:case"end":return _context3.stop()}}},_callee3,null,[[1,7]])}));return _createDataFrame.apply(this,arguments)}function startDataFrame(){return _startDataFrame.apply(this,arguments)}function _startDataFrame(){_startDataFrame=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setStarted(true);_context4.prev=1;_context4.next=4;return ml_api_service_1.ml.dataFrame.startDataFrameTransformsJob(jobId);case 4:notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.startJobSuccessMessage",{defaultMessage:"Data frame job {jobId} started successfully.",values:{jobId:jobId}}));_context4.next=11;break;case 7:_context4.prev=7;_context4.t0=_context4["catch"](1);setStarted(false);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.startJobErrorMessage",{defaultMessage:"An error occurred starting the data frame job {jobId}: {error}",values:{jobId:jobId,error:JSON.stringify(_context4.t0)}}));case 11:case"end":return _context4.stop()}}},_callee4,null,[[1,7]])}));return _startDataFrame.apply(this,arguments)}function createAndStartDataFrame(){return _createAndStartDataFrame.apply(this,arguments)}function _createAndStartDataFrame(){_createAndStartDataFrame=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(){var success;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return createDataFrame();case 2:success=_context5.sent;if(!success){_context5.next=6;break}_context5.next=6;return startDataFrame();case 6:case"end":return _context5.stop()}}},_callee5)}));return _createAndStartDataFrame.apply(this,arguments)}var createKibanaIndexPattern=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var indexPatternName,newIndexPattern,id;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:indexPatternName=jobConfig.dest.index;_context.prev=1;_context.next=4;return kibanaContext.indexPatterns.get();case 4:newIndexPattern=_context.sent;Object.assign(newIndexPattern,{id:"",title:indexPatternName});_context.next=8;return newIndexPattern.create();case 8:id=_context.sent;if(kibanaContext.kibanaConfig.get("defaultIndex")){_context.next=12;break}_context.next=12;return kibanaContext.kibanaConfig.set("defaultIndex",id);case 12:notify_1.toastNotifications.addSuccess(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.reateIndexPatternSuccessMessage",{defaultMessage:"Kibana index pattern {indexPatternName} created successfully.",values:{indexPatternName:indexPatternName}}));setIndexPatternId(id);return _context.abrupt("return",true);case 17:_context.prev=17;_context.t0=_context["catch"](1);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern {indexPatternName}: {error}",values:{indexPatternName:indexPatternName,error:JSON.stringify(_context.t0)}}));return _context.abrupt("return",false);case 21:case"end":return _context.stop()}}},_callee,null,[[1,17]])}));return function createKibanaIndexPattern(){return _ref2.apply(this,arguments)}}();if(started===true&&progressPercentComplete===undefined){var startProgressBar=function startProgressBar(){var interval=setInterval(_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var stats,percent;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return ml_api_service_1.ml.dataFrame.getDataFrameTransformsStats(jobId);case 3:stats=_context2.sent;percent=Math.round(stats.transforms[0].state.progress.percent_complete);setProgressPercentComplete(percent);if(percent>=100){clearInterval(interval)}_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2["catch"](0);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.progressErrorMessage",{defaultMessage:"An error occurred getting the progress percentage: {error}",values:{error:JSON.stringify(_context2.t0)}}));clearInterval(interval);case 13:case"end":return _context2.stop()}}},_callee2,null,[[0,9]])})),jobs_list_1.PROGRESS_JOBS_REFRESH_INTERVAL_MS);setProgressPercentComplete(0)};startProgressBar()}function getJobConfigDevConsoleStatement(){return"PUT _data_frame/transforms/".concat(jobId,"\n").concat(JSON.stringify(jobConfig,null,2),"\n\n")}var FLEX_GROUP_STYLE={height:"90px",maxWidth:"800px"};var FLEX_ITEM_STYLE={width:"200px"};var PANEL_ITEM_STYLE={width:"300px"};return react_1.default.createElement(eui_1.EuiForm,null,!created&&react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",style:FLEX_GROUP_STYLE},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:FLEX_ITEM_STYLE},react_1.default.createElement(eui_1.EuiButton,{fill:true,isDisabled:created&&started,onClick:createAndStartDataFrame},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createAndStartDataFrameButton",{defaultMessage:"Create and start"}))),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{color:"subdued",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createAndStartDataFrameDescription",{defaultMessage:"Creates and starts the data frame job. A data frame job will increase search and indexing load in your cluster. Please stop the job if excessive load is experienced. After the job is started, you will be offered options to continue exploring the data frame job."})))),created&&react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",style:FLEX_GROUP_STYLE},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:FLEX_ITEM_STYLE},react_1.default.createElement(eui_1.EuiButton,{fill:true,isDisabled:created&&started,onClick:startDataFrame},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.startDataFrameButton",{defaultMessage:"Start"}))),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{color:"subdued",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.startDataFrameDescription",{defaultMessage:"Starts the data frame job. A data frame job will increase search and indexing load in your cluster. Please stop the job if excessive load is experienced. After the job is started, you will be offered options to continue exploring the data frame job."})))),react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",style:FLEX_GROUP_STYLE},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:FLEX_ITEM_STYLE},react_1.default.createElement(eui_1.EuiButton,{isDisabled:created,onClick:createDataFrame},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createDataFrameButton",{defaultMessage:"Create"}))),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{color:"subdued",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createDataFrameDescription",{defaultMessage:"Create the data frame job without starting it. You will be able to start the job later by returning to the data frame jobs list."})))),react_1.default.createElement(eui_1.EuiFlexGroup,{alignItems:"center",style:FLEX_GROUP_STYLE},react_1.default.createElement(eui_1.EuiFlexItem,{grow:false,style:FLEX_ITEM_STYLE},react_1.default.createElement(eui_1.EuiCopy,{textToCopy:getJobConfigDevConsoleStatement()},function(copy){return react_1.default.createElement(eui_1.EuiButton,{onClick:copy,style:{width:"100%"}},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.copyJobConfigToClipBoardButton",{defaultMessage:"Copy to clipboard"}))})),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{color:"subdued",size:"s"},i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.copyJobConfigToClipBoardDescription",{defaultMessage:"Copies to the clipboard the Kibana Dev Console command for creating the job."})))),progressPercentComplete!==undefined&&react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiSpacer,{size:"m"}),react_1.default.createElement(eui_1.EuiText,{size:"xs"},react_1.default.createElement("strong",null,i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.progressTitle",{defaultMessage:"Progress"}))),react_1.default.createElement(eui_1.EuiFlexGroup,{gutterSize:"xs"},react_1.default.createElement(eui_1.EuiFlexItem,{style:{width:"400px"},grow:false},react_1.default.createElement(eui_1.EuiProgress,{size:"l",color:"primary",value:progressPercentComplete,max:100})),react_1.default.createElement(eui_1.EuiFlexItem,null,react_1.default.createElement(eui_1.EuiText,{size:"xs"},progressPercentComplete,"%")))),created&&react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiHorizontalRule,null),react_1.default.createElement(eui_1.EuiFlexGrid,{gutterSize:"l"},react_1.default.createElement(eui_1.EuiFlexItem,{style:PANEL_ITEM_STYLE},react_1.default.createElement(eui_1.EuiCard,{icon:react_1.default.createElement(eui_1.EuiIcon,{size:"xxl",type:"list"}),title:i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.jobsListCardTitle",{defaultMessage:"Data frame jobs"}),description:i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.jobManagementCardDescription",{defaultMessage:"Return to the data frame job management page."}),onClick:common_1.moveToDataFrameJobsList})),started===true&&createIndexPattern===true&&indexPatternId===undefined&&react_1.default.createElement(eui_1.EuiFlexItem,{style:PANEL_ITEM_STYLE},react_1.default.createElement(eui_1.EuiPanel,{style:{position:"relative"}},react_1.default.createElement(eui_1.EuiProgress,{size:"xs",color:"primary",position:"absolute"}),react_1.default.createElement(eui_1.EuiText,{color:"subdued",size:"s"},react_1.default.createElement("p",null,i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.creatingIndexPatternMessage",{defaultMessage:"Creating Kibana index pattern ..."}))))),started===true&&indexPatternId!==undefined&&react_1.default.createElement(eui_1.EuiFlexItem,{style:PANEL_ITEM_STYLE},react_1.default.createElement(eui_1.EuiCard,{icon:react_1.default.createElement(eui_1.EuiIcon,{size:"xxl",type:"discoverApp"}),title:i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.discoverCardTitle",{defaultMessage:"Discover"}),description:i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.discoverCardDescription",{defaultMessage:"Use Discover to explore the data frame pivot."}),onClick:function onClick(){return common_1.moveToDiscover(indexPatternId,kibanaContext.kbnBaseUrl)}})))))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importDefault(__webpack_require__(0));exports.JobCreateSummary=react_1.default.memo(function(){return null})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var job_details_form_1=__webpack_require__(2996);exports.JobDetailsForm=job_details_form_1.JobDetailsForm;exports.getDefaultJobDetailsState=job_details_form_1.getDefaultJobDetailsState;var job_details_summary_1=__webpack_require__(2997);exports.JobDetailsSummary=job_details_summary_1.JobDetailsSummary},function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var notify_1=__webpack_require__(14);var eui_1=__webpack_require__(1);var ml_api_service_1=__webpack_require__(24);var common_1=__webpack_require__(227);function getDefaultJobDetailsState(){return{createIndexPattern:true,jobId:"",targetIndex:"",touched:false,valid:false}}exports.getDefaultJobDetailsState=getDefaultJobDetailsState;exports.JobDetailsForm=react_1.default.memo(function(_ref){var _ref$overrides=_ref.overrides,overrides=_ref$overrides===void 0?{}:_ref$overrides,onChange=_ref.onChange;var kibanaContext=react_1.useContext(common_1.KibanaContext);if(!common_1.isKibanaContext(kibanaContext)){return null}var defaults=_objectSpread({},getDefaultJobDetailsState(),overrides);var _react_1$useState=react_1.useState(defaults.jobId),_react_1$useState2=_slicedToArray(_react_1$useState,2),jobId=_react_1$useState2[0],setJobId=_react_1$useState2[1];var _react_1$useState3=react_1.useState(defaults.targetIndex),_react_1$useState4=_slicedToArray(_react_1$useState3,2),targetIndex=_react_1$useState4[0],setTargetIndex=_react_1$useState4[1];var _react_1$useState5=react_1.useState([]),_react_1$useState6=_slicedToArray(_react_1$useState5,2),jobIds=_react_1$useState6[0],setJobIds=_react_1$useState6[1];var _react_1$useState7=react_1.useState([]),_react_1$useState8=_slicedToArray(_react_1$useState7,2),indexNames=_react_1$useState8[0],setIndexNames=_react_1$useState8[1];var _react_1$useState9=react_1.useState([]),_react_1$useState10=_slicedToArray(_react_1$useState9,2),indexPatternTitles=_react_1$useState10[0],setIndexPatternTitles=_react_1$useState10[1];var _react_1$useState11=react_1.useState(defaults.createIndexPattern),_react_1$useState12=_slicedToArray(_react_1$useState11,2),createIndexPattern=_react_1$useState12[0],setCreateIndexPattern=_react_1$useState12[1];react_1.useEffect(function(){_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.t0=setJobIds;_context.next=4;return ml_api_service_1.ml.dataFrame.getDataFrameTransforms();case 4:_context.t1=function(job){return job.id};_context.t2=_context.sent.transforms.map(_context.t1);(0,_context.t0)(_context.t2);_context.next=12;break;case 9:_context.prev=9;_context.t3=_context["catch"](0);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.errorGettingDataFrameJobsList",{defaultMessage:"An error occurred getting the existing data frame job Ids: {error}",values:{error:JSON.stringify(_context.t3)}}));case 12:_context.prev=12;_context.t4=setIndexNames;_context.next=16;return ml_api_service_1.ml.getIndices();case 16:_context.t5=function(index){return index.name};_context.t6=_context.sent.map(_context.t5);(0,_context.t4)(_context.t6);_context.next=24;break;case 21:_context.prev=21;_context.t7=_context["catch"](12);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.errorGettingDataFrameIndexNames",{defaultMessage:"An error occurred getting the existing index names: {error}",values:{error:JSON.stringify(_context.t7)}}));case 24:_context.prev=24;_context.t8=setIndexPatternTitles;_context.next=28;return kibanaContext.indexPatterns.getTitles();case 28:_context.t9=_context.sent;(0,_context.t8)(_context.t9);_context.next=35;break;case 32:_context.prev=32;_context.t10=_context["catch"](24);notify_1.toastNotifications.addDanger(i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.errorGettingIndexPatternTitles",{defaultMessage:"An error occurred getting the existing index pattern titles: {error}",values:{error:JSON.stringify(_context.t10)}}));case 35:case"end":return _context.stop()}}},_callee,null,[[0,9],[12,21],[24,32]])}))()},[]);var jobIdExists=jobIds.some(function(id){return jobId===id});var indexNameExists=indexNames.some(function(name){return targetIndex===name});var indexPatternTitleExists=indexPatternTitles.some(function(name){return targetIndex===name});var valid=jobId!==""&&targetIndex!==""&&!jobIdExists&&!indexNameExists&&(!indexPatternTitleExists||!createIndexPattern);react_1.useEffect(function(){onChange({createIndexPattern:createIndexPattern,jobId:jobId,targetIndex:targetIndex,touched:true,valid:valid})},[createIndexPattern,jobId,targetIndex,valid]);return react_1.default.createElement(eui_1.EuiForm,null,react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.jobIdLabel",{defaultMessage:"Job id"}),isInvalid:jobIdExists,error:jobIdExists&&[i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.jobIdError",{defaultMessage:"A job with this id already exists."})]},react_1.default.createElement(eui_1.EuiFieldText,{placeholder:"job id",value:jobId,onChange:function onChange(e){return setJobId(e.target.value)},"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.jobIdInputAriaLabel",{defaultMessage:"Choose a unique job id."}),isInvalid:jobIdExists})),react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.targetIndexLabel",{defaultMessage:"Target index"}),isInvalid:indexNameExists,error:indexNameExists&&[i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.targetIndexError",{defaultMessage:"An index with this name already exists."})]},react_1.default.createElement(eui_1.EuiFieldText,{placeholder:"target index",value:targetIndex,onChange:function onChange(e){return setTargetIndex(e.target.value)},"aria-label":i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.targetIndexInputAriaLabel",{defaultMessage:"Choose a unique target index name."}),isInvalid:indexNameExists})),react_1.default.createElement(eui_1.EuiFormRow,{isInvalid:createIndexPattern&&indexPatternTitleExists,error:createIndexPattern&&indexPatternTitleExists&&[i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsForm.indexPatternTitleError",{defaultMessage:"An index pattern with this title already exists."})]},react_1.default.createElement(eui_1.EuiSwitch,{name:"mlDataFrameCreateIndexPattern",label:i18n_1.i18n.translate("xpack.ml.dataframe.jobCreateForm.createIndexPatternLabel",{defaultMessage:"Create index pattern"}),checked:createIndexPattern===true,onChange:function onChange(){return setCreateIndexPattern(!createIndexPattern)}})))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var react_1=tslib_1.__importStar(__webpack_require__(0));var i18n_1=__webpack_require__(4);var eui_1=__webpack_require__(1);exports.JobDetailsSummary=react_1.default.memo(function(_ref){var createIndexPattern=_ref.createIndexPattern,jobId=_ref.jobId,targetIndex=_ref.targetIndex,touched=_ref.touched;if(touched===false){return null}var targetIndexHelpText=createIndexPattern?i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsSummary.createIndexPatternMessage",{defaultMessage:"A Kibana index pattern will be created for this job."}):"";return react_1.default.createElement(react_1.Fragment,null,react_1.default.createElement(eui_1.EuiFormRow,{label:i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsSummary.jobIdLabel",{defaultMessage:"Job id"})},react_1.default.createElement(eui_1.EuiFieldText,{defaultValue:jobId,disabled:true})),react_1.default.createElement(eui_1.EuiFormRow,{helpText:targetIndexHelpText,label:i18n_1.i18n.translate("xpack.ml.dataframe.jobDetailsSummary.targetIndexLabel",{defaultMessage:"Target index"})},react_1.default.createElement(eui_1.EuiFieldText,{defaultValue:targetIndex,disabled:true})))})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var routes_1=tslib_1.__importDefault(__webpack_require__(19));var check_license_1=__webpack_require__(66);var check_privilege_1=__webpack_require__(39);var index_utils_1=__webpack_require__(226);var breadcrumbs_1=__webpack_require__(684);var template='<ml-nav-menu name="new_data_frame" /><ml-new-data-frame />';routes_1.default.when("/data_frames/new_job/step/pivot?",{template:template,k7Breadcrumbs:breadcrumbs_1.getDataFrameCreateBreadcrumbs,resolve:{CheckLicense:check_license_1.checkBasicLicense,privileges:check_privilege_1.checkCreateDataFrameJobsPrivilege,indexPattern:index_utils_1.loadCurrentIndexPattern,savedSearch:index_utils_1.loadCurrentSavedSearch}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3e3);__webpack_require__(3003);__webpack_require__(1372);__webpack_require__(3008);__webpack_require__(500);__webpack_require__(682)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3001)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _breadcrumbs=__webpack_require__(1380);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _routes=_interopRequireDefault(__webpack_require__(19));var _datavisualizer_selector=__webpack_require__(3002);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="datavisualizer" />\n  <datavisualizer-selector />\n';_routes.default.when("/datavisualizer",{template:template,k7Breadcrumbs:_breadcrumbs.getDataVisualizerBreadcrumbs,resolve:{CheckLicense:_check_license.checkBasicLicense,privileges:_check_privilege.checkFindFileStructurePrivilege}});_module.directive("datavisualizerSelector",function($injector){var reactDirective=$injector.get("reactDirective");return reactDirective((0,_i18n.wrapInI18nContext)(_datavisualizer_selector.DatavisualizerSelector),undefined,{restrict:"E"},{})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatavisualizerSelector=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _check_license=__webpack_require__(66);var _react2=__webpack_require__(5);var _timefilter=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function startTrialDescription(){return _react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.fullMLFeaturesDescription",defaultMessage:"To experience the full Machine Learning features that a {platinumSubscriptionLink} offers, start a 30-day trial.",values:{platinumSubscriptionLink:_react.default.createElement(_eui.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.platinumSubscriptionTitle",defaultMessage:"Platinum subscription"}))}}))}var DatavisualizerSelector=(0,_react2.injectI18n)(function(props){_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();var startTrialVisible=(0,_check_license.isFullLicense)()===false;return _react.default.createElement(_eui.EuiPage,{restrictWidth:1e3},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"l"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerTitle",defaultMessage:"Data Visualizer"}))))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerDescription",defaultMessage:"The Machine Learning Data Visualizer tool helps you understand your data, by analyzing the metrics and fields in a log file or an existing Elasticsearch index."})))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"addDataApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataTitle",defaultMessage:"Import data"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataDescription",defaultMessage:"Import data from a log file. You can upload files up to 100 MB."}),betaBadgeLabel:props.intl.formatMessage({id:"xpack.ml.datavisualizer.selector.experimentalBadgeLabel",defaultMessage:"Experimental"}),betaBadgeTooltipContent:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.experimentalBadgeTooltipLabel",defaultMessage:"Experimental feature. We'd love to hear your feedback."}),footer:_react.default.createElement(_eui.EuiButton,{target:"_self",href:"#/filedatavisualizer"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.uploadFileButtonLabel",defaultMessage:"Upload file"}))})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternTitle",defaultMessage:"Select an index pattern"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternDescription",defaultMessage:"Visualize the data in an existing Elasticsearch index."}),footer:_react.default.createElement(_eui.EuiButton,{target:"_self",href:"#datavisualizer_index_select"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexButtonLabel",defaultMessage:"Select index"}))}))),startTrialVisible===true&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"600px"}},_react.default.createElement(_eui.EuiCard,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialTitle",defaultMessage:"Start trial"}),description:startTrialDescription(),footer:_react.default.createElement(_eui.EuiButton,{target:"_blank",href:"kibana#/management/elasticsearch/license_management/home"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialButtonLabel",defaultMessage:"Start trial"}))}))))))});exports.DatavisualizerSelector=DatavisualizerSelector},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _risonNode=_interopRequireDefault(__webpack_require__(239));__webpack_require__(3004);var _chrome=_interopRequireDefault(__webpack_require__(9));var _routes=_interopRequireDefault(__webpack_require__(19));var _esQuery=__webpack_require__(38);var _notify=__webpack_require__(14);var _field_types=__webpack_require__(295);var _breadcrumbs=__webpack_require__(1380);var _field_types_utils=__webpack_require__(578);var _ml_time_buckets=__webpack_require__(338);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _new_job_utils=__webpack_require__(294);var _index_utils=__webpack_require__(226);var _check_ml_nodes=__webpack_require__(71);var _ml_api_service=__webpack_require__(24);var _datavisualizer=_interopRequireDefault(__webpack_require__(3007));var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}_routes.default.when("/jobs/new_job/datavisualizer",{template:_datavisualizer.default,k7Breadcrumbs:_breadcrumbs.getDataVisualizerBreadcrumbs,resolve:{CheckLicense:_check_license.checkBasicLicense,privileges:_check_privilege.checkGetJobsPrivilege,indexPattern:_index_utils.loadCurrentIndexPattern,savedSearch:_index_utils.loadCurrentSavedSearch,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlDataVisualizerViewFields",function($scope,$timeout,$window,Private,AppState,config){_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.enableAutoRefreshSelector();var createSearchItems=Private(_new_job_utils.SearchItemsProvider);var _createSearchItems=createSearchItems(),indexPattern=_createSearchItems.indexPattern,query=_createSearchItems.query;(0,_index_utils.timeBasedIndexCheck)(indexPattern,true);var OMIT_FIELDS=["_source","_type","_index","_id","_version","_score"];$scope.metricCards=[];$scope.totalMetricFieldCount=0;$scope.populatedMetricFieldCount=0;$scope.showAllMetrics=false;$scope.fieldCards=[];$scope.totalNonMetricFieldCount=0;$scope.populatedNonMetricFieldCount=0;$scope.ML_JOB_FIELD_TYPES=_field_types.ML_JOB_FIELD_TYPES;$scope.showAllFields=false;$scope.filterFieldType="*";$scope.urlBasePath=_chrome.default.getBasePath();$scope.appState=new AppState;$scope.indexPattern=indexPattern;$scope.earliest=_timefilter.timefilter.getActiveBounds().min.valueOf();$scope.latest=_timefilter.timefilter.getActiveBounds().max.valueOf();$scope.metricFilterIcon=0;$scope.metricFieldFilter="";$scope.fieldFilterIcon=0;$scope.fieldFilter="";$scope.recognizerResults={count:0,onChange:function onChange(){$scope.$applyAsync()}};$scope.showSidebar=(0,_check_license.isFullLicense)();$scope.searchQueryText="";var queryBarQry=$scope.appState.query!==undefined?$scope.appState.query:query;if(queryBarQry.language==="lucene"){$scope.searchQueryText=_lodash.default.get(queryBarQry,"query","")}else{_notify.toastNotifications.addWarning({title:_i18n.i18n.translate("xpack.ml.datavisualizer.languageSyntaxNotSupportedWarningTitle",{defaultMessage:"{language} syntax not supported",values:{language:queryBarQry.language!==undefined?queryBarQry.language:""}}),text:_i18n.i18n.translate("xpack.ml.datavisualizer.languageSyntaxNotSupportedWarningDescription",{defaultMessage:"The Data Visualizer currently only supports queries using the lucene query syntax."})})}$scope.searchQuery=buildSearchQuery();$scope.samplerShardSize=$scope.appState.samplerShardSize?$scope.appState.samplerShardSize:5e3;var MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var metricFieldRegexp;var metricFieldFilterTimeout;var fieldRegexp;var fieldFilterTimeout;var indexedFieldTypes=[];_lodash.default.each(indexPattern.fields,function(field){if(!field.scripted){var dataVisualizerType=(0,_field_types_utils.kbnTypeToMLJobType)(field);if(dataVisualizerType!==undefined){indexedFieldTypes.push(dataVisualizerType)}}});indexedFieldTypes=_lodash.default.chain(indexedFieldTypes).unique().without(_field_types.ML_JOB_FIELD_TYPES.NUMBER).value();$scope.indexedFieldTypes=indexedFieldTypes.sort();$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",function(){$scope.earliest=_timefilter.timefilter.getActiveBounds().min.valueOf();$scope.latest=_timefilter.timefilter.getActiveBounds().max.valueOf();loadOverallStats()});$scope.submitSearchQuery=function(){$scope.searchQuery=buildSearchQuery();saveAppState();loadOverallStats()};$scope.samplerShardSizeChanged=function(){saveAppState();loadOverallStats()};$scope.toggleAllMetrics=function(){$scope.showAllMetrics=!$scope.showAllMetrics;createMetricCards()};$scope.toggleAllFields=function(){$scope.showAllFields=!$scope.showAllFields;createNonMetricCards()};$scope.filterFieldTypeChanged=function(fieldType){$scope.filterFieldType=fieldType;createNonMetricCards()};$scope.metricFieldFilterChanged=function(){if(metricFieldFilterTimeout!==undefined){$timeout.cancel(metricFieldFilterTimeout)}metricFieldFilterTimeout=$timeout(function(){if($scope.metricFieldFilter&&$scope.metricFieldFilter!==""){metricFieldRegexp=new RegExp("("+$scope.metricFieldFilter+")","gi")}else{metricFieldRegexp=undefined}createMetricCards();metricFieldFilterTimeout=undefined},1500);$timeout(function(){$scope.metricFilterIcon=1},250)};$scope.clearMetricFilter=function(){$scope.metricFieldFilter="";metricFieldRegexp=undefined;createMetricCards()};$scope.fieldFilterChanged=function(){if(fieldFilterTimeout!==undefined){$timeout.cancel(fieldFilterTimeout)}fieldFilterTimeout=$timeout(function(){if($scope.fieldFilter&&$scope.fieldFilter!==""){fieldRegexp=new RegExp("("+$scope.fieldFilter+")","gi")}else{fieldRegexp=undefined}createNonMetricCards();fieldFilterTimeout=undefined},1500);$timeout(function(){$scope.fieldFilterIcon=1},250)};$scope.clearFieldFilter=function(){$scope.fieldFilter="";fieldRegexp=undefined;createNonMetricCards()};$scope.createJob=function(){var _a=_risonNode.default.encode({query:{language:"lucene",query:$scope.searchQueryText}});var path="".concat($scope.urlBasePath,"/app/ml#/jobs/new_job/advanced?index=").concat($scope.indexPattern,"&_a=").concat(_a);$window.open(path,"_self")};function buildSearchQuery(){var searchQuery=(0,_esQuery.luceneStringToDsl)($scope.searchQueryText);var queryStringOptions=config.get("query:queryString:options");(0,_esQuery.decorateQuery)(searchQuery,queryStringOptions);return searchQuery}function saveAppState(){$scope.appState.query={language:"lucene",query:$scope.searchQueryText};$scope.appState.samplerShardSize=$scope.samplerShardSize;$scope.appState.save()}function createMetricCards(){$scope.metricCards.length=0;var aggregatableExistsFields=$scope.overallStats.aggregatableExistsFields||[];var allMetricFields=[];if(metricFieldRegexp===undefined){allMetricFields=_lodash.default.filter(indexPattern.fields,function(f){return f.type===_field_types.KBN_FIELD_TYPES.NUMBER&&!_lodash.default.contains(OMIT_FIELDS,f.displayName)})}else{allMetricFields=_lodash.default.filter(indexPattern.fields,function(f){return f.type===_field_types.KBN_FIELD_TYPES.NUMBER&&!_lodash.default.contains(OMIT_FIELDS,f.displayName)&&f.displayName.match(metricFieldRegexp)})}var metricExistsFields=_lodash.default.filter(allMetricFields,function(f){return _lodash.default.find(aggregatableExistsFields,{fieldName:f.displayName})});var metricCards=[];if(indexPattern.timeFieldName!==undefined){metricCards.push({type:_field_types.ML_JOB_FIELD_TYPES.NUMBER,existsInDocs:true,loading:true})}else{_timefilter.timefilter.disableTimeRangeSelector();$scope.showSidebar=false}$scope.totalMetricFieldCount=allMetricFields.length+1;$scope.populatedMetricFieldCount=metricExistsFields.length+1;if($scope.totalMetricFieldCount===$scope.populatedMetricFieldCount){$scope.showAllMetrics=true}var aggregatableFields=$scope.overallStats.aggregatableExistsFields;if($scope.showAllMetrics===true){aggregatableFields=aggregatableFields.concat($scope.overallStats.aggregatableNotExistsFields)}var metricFields=$scope.showAllMetrics?allMetricFields:metricExistsFields;_lodash.default.each(metricFields,function(field){var fieldData=_lodash.default.find(aggregatableFields,{fieldName:field.displayName});var card=_objectSpread({},fieldData,{fieldFormat:field.format,type:_field_types.ML_JOB_FIELD_TYPES.NUMBER,loading:true});metricCards.push(card)});$scope.metricCards=metricCards;loadMetricFieldStats()}function createNonMetricCards(){$scope.fieldCards.length=0;var allNonMetricFields=[];if($scope.filterFieldType==="*"){allNonMetricFields=_lodash.default.filter(indexPattern.fields,function(f){return f.type!==_field_types.KBN_FIELD_TYPES.NUMBER&&!_lodash.default.contains(OMIT_FIELDS,f.displayName)})}else{if($scope.filterFieldType===_field_types.ML_JOB_FIELD_TYPES.TEXT||$scope.filterFieldType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD){var aggregatableCheck=$scope.filterFieldType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD?true:false;allNonMetricFields=_lodash.default.filter(indexPattern.fields,function(f){return!_lodash.default.contains(OMIT_FIELDS,f.displayName)&&f.type===_field_types.KBN_FIELD_TYPES.STRING&&f.aggregatable===aggregatableCheck})}else{allNonMetricFields=_lodash.default.filter(indexPattern.fields,function(f){return!_lodash.default.contains(OMIT_FIELDS,f.displayName)&&f.type===$scope.filterFieldType})}}if(fieldRegexp!==undefined){allNonMetricFields=_lodash.default.filter(allNonMetricFields,function(f){return f.displayName.match(fieldRegexp)})}$scope.totalNonMetricFieldCount=allNonMetricFields.length;var populatedNonMetricFields=[];var nonMetricFieldData=[];var populatedNonMetricFieldCount=0;_lodash.default.each(allNonMetricFields,function(f){var checkAggregatableField=_lodash.default.find($scope.overallStats.aggregatableExistsFields,{fieldName:f.displayName});if(checkAggregatableField!==undefined){populatedNonMetricFields.push(f);nonMetricFieldData.push(checkAggregatableField);populatedNonMetricFieldCount++}else{var checkNonAggregatableField=_lodash.default.find($scope.overallStats.nonAggregatableExistsFields,{fieldName:f.displayName});if(checkNonAggregatableField!==undefined){populatedNonMetricFields.push(f);nonMetricFieldData.push(checkNonAggregatableField);populatedNonMetricFieldCount++}}});$scope.populatedNonMetricFieldCount=populatedNonMetricFieldCount;if($scope.totalNonMetricFieldCount===$scope.populatedNonMetricFieldCount){$scope.showAllFields=true}var nonMetricFieldsToShow=$scope.showAllFields===true?allNonMetricFields:populatedNonMetricFields;if($scope.showAllFields===true){nonMetricFieldData=nonMetricFieldData.concat($scope.overallStats.aggregatableNotExistsFields,$scope.overallStats.nonAggregatableNotExistsFields)}var fieldCards=[];_lodash.default.each(nonMetricFieldsToShow,function(field){var fieldData=_lodash.default.find(nonMetricFieldData,{fieldName:field.displayName});var card=_objectSpread({},fieldData,{fieldFormat:field.format,aggregatable:field.aggregatable,scripted:field.scripted,loading:fieldData.existsInDocs});var dataVisualizerType=(0,_field_types_utils.kbnTypeToMLJobType)(field);if(dataVisualizerType!==undefined){card.type=dataVisualizerType}else{card.type=field.type;card.isUnsupportedType=true}fieldCards.push(card)});$scope.fieldCards=_lodash.default.sortBy(fieldCards,"fieldName");loadNonMetricFieldStats()}function loadMetricFieldStats(){var numberFields=_lodash.default.filter($scope.metricCards,{existsInDocs:true});numberFields=_lodash.default.map(numberFields,function(card){var props={fieldName:card.fieldName,type:card.type};if(_lodash.default.has(card,["stats","cardinality"])){props.cardinality=card.stats.cardinality}return props});var buckets=new MlTimeBuckets;var bounds=_timefilter.timefilter.getActiveBounds();var BAR_TARGET=75;buckets.setInterval("auto");buckets.setBounds(bounds);buckets.setBarTarget(BAR_TARGET);var aggInterval=buckets.getInterval();_ml_api_service.ml.getVisualizerFieldStats({indexPatternTitle:indexPattern.title,query:$scope.searchQuery,timeFieldName:indexPattern.timeFieldName,earliest:$scope.earliest,latest:$scope.latest,samplerShardSize:$scope.samplerShardSize,interval:aggInterval.expression,fields:numberFields}).then(function(resp){_lodash.default.each($scope.metricCards,function(card){if(card.fieldName!==undefined){card.stats=_objectSpread({},card.stats,_lodash.default.find(resp,{fieldName:card.fieldName}))}else{card.stats=_lodash.default.find(resp,function(stats){return stats.fieldName===undefined})}card.loading=false});$scope.metricFilterIcon=0}).catch(function(err){console.log("DataVisualizer - error getting stats for metric cards from elasticsearch:",err);if(err.statusCode===500){_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.metricInternalServerErrorTitle",{defaultMessage:"Error loading data for metrics in index {index}. {message}. "+"The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}else{_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.loadingMetricDataErrorTitle",{defaultMessage:"Error loading data for metrics in index {index}. {message}",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}}).then(function(){$scope.$applyAsync()})}function loadNonMetricFieldStats(){var fields=_lodash.default.filter($scope.fieldCards,{existsInDocs:true});fields=_lodash.default.map(fields,function(card){var props={fieldName:card.fieldName,type:card.type};if(_lodash.default.has(card,["stats","cardinality"])){props.cardinality=card.stats.cardinality}return props});if(fields.length>0){_ml_api_service.ml.getVisualizerFieldStats({indexPatternTitle:indexPattern.title,query:$scope.searchQuery,fields:fields,timeFieldName:indexPattern.timeFieldName,earliest:$scope.earliest,latest:$scope.latest,samplerShardSize:$scope.samplerShardSize,maxExamples:10}).then(function(resp){_lodash.default.each($scope.fieldCards,function(card){card.stats=_objectSpread({},card.stats,_lodash.default.find(resp,{fieldName:card.fieldName}));card.loading=false});$scope.fieldFilterIcon=0}).catch(function(err){console.log("DataVisualizer - error getting non metric field stats from elasticsearch:",err);if(err.statusCode===500){_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.fieldsInternalServerErrorTitle",{defaultMessage:"Error loading data for fields in index {index}. {message}. "+"The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}else{_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.loadingFieldsDataErrorTitle",{defaultMessage:"Error loading data for fields in index {index}. {message}",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}}).then(function(){$scope.$applyAsync()})}else{$scope.fieldFilterIcon=0}}function loadOverallStats(){var aggregatableFields=[];var nonAggregatableFields=[];_lodash.default.each(indexPattern.fields,function(field){if(OMIT_FIELDS.indexOf(field.displayName)===-1){if(field.aggregatable===true){aggregatableFields.push(field.displayName)}else{nonAggregatableFields.push(field.displayName)}}});_ml_api_service.ml.getVisualizerOverallStats({indexPatternTitle:indexPattern.title,query:$scope.searchQuery,timeFieldName:indexPattern.timeFieldName,samplerShardSize:$scope.samplerShardSize,earliest:$scope.earliest,latest:$scope.latest,aggregatableFields:aggregatableFields,nonAggregatableFields:nonAggregatableFields}).then(function(resp){$scope.overallStats=resp;createMetricCards();createNonMetricCards()}).catch(function(err){console.log("DataVisualizer - error getting overall stats from elasticsearch:",err);if(err.statusCode===500){_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.overallFieldsInternalServerErrorTitle",{defaultMessage:"Error loading data for fields in index {index}. {message}. "+"The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}else{_notify.notify.error(_i18n.i18n.translate("xpack.ml.datavisualizer.loadingOverallFieldsDataErrorTitle",{defaultMessage:"Error loading data for fields in index {index}. {message}",values:{index:indexPattern.title,message:err.message}}),{lifetime:3e4})}$scope.$applyAsync()})}loadOverallStats()})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3005)},function(module,exports,__webpack_require__){"use strict";var _form_filter_input=_interopRequireDefault(__webpack_require__(3006));var _i18n=__webpack_require__(4);var _angular=_interopRequireDefault(__webpack_require__(26));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFormFilterInput",function(){return{scope:{placeholder:"@?",filter:"=",filterIcon:"=",filterChanged:"=",clearFilter:"="},restrict:"E",replace:false,template:_form_filter_input.default,link:function link(scope){var placeholderIsDefined=_angular.default.isDefined(scope.placeholder);scope.placeholder=placeholderIsDefined?scope.placeholder:_i18n.i18n.translate("xpack.ml.formFilterInput.filterPlaceholder",{defaultMessage:"Filter"});scope.ariaLabel=placeholderIsDefined?scope.placeholder:_i18n.i18n.translate("xpack.ml.formFilterInput.filterAriaLabel",{defaultMessage:"Filter"})}}})},function(module,exports){module.exports='<div class="fa fa-search"></div>\n<input\n  class="form-control ml-filter-input-left-icon"\n  type="text"\n  aria-label="{{ariaLabel}}"\n  placeholder="{{placeholder}}"\n  ng-model="filter"\n  ng-change="filterChanged()" />\n<div class="ml-filter-progress-icon">\n  <div ng-show="filterIcon===1">\n    <i class=\'fa fa-spinner fa-spin\'></i>\n  </div>\n  <div ng-show="filterIcon===0">\n    <a\n      aria-label="{{ ::\'xpack.ml.formFilterInput.clearFilterAriaLabel\' | i18n: {defaultMessage: \'Clear filter\'} }}"\n      ng-click="clearFilter()"\n    >\n      <i class="fa fa-times-circle"></i>\n    </a>\n  </div>\n</div>\n'},function(module,exports){module.exports='<ml-nav-menu name="datavisualizer"></ml-nav-menu>\n<ml-chart-tooltip></ml-chart-tooltip>\n<ml-datavisualizer class="data-visualizer-container">\n  <div ng-controller="MlDataVisualizerViewFields" >\n    <div class="title-container euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--alignItemsCenter euiFlexGroup--responsive">\n      <div class="euiFlexItem euiFlexItem--flexGrowZero euiText">\n        <h1>{{indexPattern.title}}</h1>\n      </div>\n      <div class="euiFlexItem euiFlexItem--flexGrowZero">\n        <ml-full-time-range-selector ng-if="indexPattern.timeFieldName !== undefined" index-pattern=\'indexPattern\' query=\'searchQuery\' />\n      </div>\n    </div>\n\n    <div\n      class="main-container"\n      ng-class="{\'no-sidebar\': showSidebar===false}"\n    >\n\n      <div class="kuiPanel kuiVerticalRhythm datavisualizer-panel">\n\n        <form\n          ng-submit="submitSearchQuery()"\n          name="querybarform"\n          class="flexGroup__filler query-bar-form"\n          style="width: 100%"\n        >\n          <div class="kuiLocalSearch">\n            <input\n              type="text"\n              class="kuiLocalSearchInput"\n              ng-model="searchQueryText"\n              placeholder="{{ ::\'xpack.ml.datavisualizer.searchFieldPlaceholder\' | i18n: {\n                defaultMessage: \'Search… (e.g. status:200 AND extension:PHP)\'\n              } }}"\n              aria-label="{{ ::\'xpack.ml.datavisualizer.searchFieldAriaLabel\' | i18n: {\n                defaultMessage: \'Search input\'\n              } }}"\n              autocomplete="off"\n            >\n            <button\n              class="kuiLocalSearchButton"\n              type="submit"\n              aria-label="{{ ::\'xpack.ml.datavisualizer.searchButtonAriaLabel\' | i18n: {\n                defaultMessage: \'Search\'\n              } }}"\n            >\n              <span aria-hidden="true" class="kuiIcon fa-search"></span>\n            </button>\n          </div>\n        </form>\n\n        <div class="document-count-container">\n          <label\n            for="sampleShardSize"\n            i18n-id="xpack.ml.datavisualizer.sampleLabel"\n            i18n-default-message="Sample"\n          ></label>\n          <select id="sampleShardSize" class="kuiSelect type-input" ng-model="samplerShardSize" ng-change="samplerShardSizeChanged(samplerShardSize)">\n            <option ng-value="1000">1000</option>\n            <option ng-value="5000">5000</option>\n            <option ng-value="10000">10000</option>\n            <option ng-value="100000">100000</option>\n            <option\n              ng-value="-1"\n              i18n-id="xpack.ml.datavisualizer.allOptionLabel"\n              i18n-default-message="all"\n            ></option>\n          </select>\n          <span\n            i18n-id="xpack.ml.datavisualizer.documentsPerShardDescription"\n            i18n-default-message="documents per shard from a total of {wrappedTotalCount} {totalCount, plural, one {document} other {documents}}"\n            i18n-values="{\n              html_wrappedTotalCount: \'<span class=\\\'field-emphasis\\\'>\' + overallStats.totalCount + \'</span>\',\n              totalCount: overallStats.totalCount\n            }"\n          ></span>\n          <i\n            aria-hidden="true"\n            class="fa fa-info-circle"\n            tooltip-placement="right"\n            tooltip="{{ ::\'xpack.ml.datavisualizer.documentsPerShardTooltip\' | i18n: {\n              defaultMessage: \'Selecting a smaller sample size will reduce query run times and the load on the cluster.\'\n            } }}"\n          ></i>\n        </div>\n\n      </div>\n\n      <div ng-show="metricCards.length > 0" class="kuiPanel kuiVerticalRhythm datavisualizer-panel card-panel">\n      \t<div class="euiText">\n          <h2\n            class="kuiSubTitle kuiVerticalRhythm"\n            i18n-id="xpack.ml.datavisualizer.metricsTitle"\n            i18n-default-message="Metrics"\n          ></h2>\n        </div>\n\n        <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--responsive euiFlexGroup--wrap">\n          <div class="field-sort-controls euiFlexItem euiFlexItem--flexGrowZero">\n            <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n              <div ng-if="showAllMetrics === false" class="field-count-label euiFlexItem euiFlexItem--flexGrowZero">\n                <span\n                  i18n-id="xpack.ml.datavisualizer.showMetricsDescription"\n                  i18n-default-message="{wrappedMetricCardsCount} {metricCardsCount, plural, one {field exists} other {fields exist}} in documents ({totalMetricFieldCount} in total)"\n                  i18n-values="{\n                      html_wrappedMetricCardsCount: \'<span class=\\\'field-emphasis\\\'>\' + metricCards.length + \'</span>\',\n                      metricCardsCount: metricCards.length,\n                      html_totalMetricFieldCount: \'<span class=\\\'field-emphasis\\\'>\' + totalMetricFieldCount + \'</span>\'\n                  }"\n                ></span>\n              </div>\n\n              <div ng-if="showAllMetrics === true" class="field-count-label euiFlexItem euiFlexItem--flexGrowZero">\n                <span\n                  i18n-id="xpack.ml.datavisualizer.showAllMetricsDescription"\n                  i18n-default-message="{wrappedMetricCardsCount} {metricCardsCount, plural, one {field} other {fields}} ({wrappedPopulatedMetricFieldCount} {populatedMetricFieldCount, plural, one {exists} other {exist}} in documents)"\n                  i18n-values="{\n                    html_wrappedMetricCardsCount: \'<span class=\\\'field-emphasis\\\'>\' + metricCards.length + \'</span>\',\n                    metricCardsCount: metricCards.length,\n                    html_wrappedPopulatedMetricFieldCount: \'<span class=\\\'field-emphasis\\\'>\' + populatedMetricFieldCount + \'</span>\',\n                    populatedMetricFieldCount\n                  }"\n                ></span>\n              </div>\n\n              <div ng-hide="populatedMetricFieldCount === totalMetricFieldCount" class="field-group-input euiFlexItem euiFlexItem--flexGrowZero">\n                <input id="toggleAllMetricsCheckbox" type="checkbox" class="kuiCheckBox" ng-click="toggleAllMetrics()" ng-checked="showAllMetrics === true">\n                <label\n                  for="toggleAllMetricsCheckbox"\n                  i18n-id="xpack.ml.datavisualizer.showEmptyFieldsLabel"\n                  i18n-default-message="show empty fields"\n                ></label>\n              </div>\n            </div>\n          </div>\n          <div class="field-filter-controls euiFlexItem euiFlexItem--flexGrowZero">\n            <ml-form-filter-input\n              filter="metricFieldFilter"\n              filter-icon="metricFilterIcon"\n              filter-changed="metricFieldFilterChanged"\n              clear-filter="clearMetricFilter" />\n          </div>\n        </div>\n\n        <div class="card-container" ng-repeat="card in metricCards">\n          <ml-field-data-card\n            index-pattern="indexPattern"\n            query="searchQuery"\n            earliest="earliest"\n            latest="latest"\n            card="card">\n          </ml-field-data-card>\n        </div>\n\n      </div>\n\n      <div class="kuiPanel kuiVerticalRhythm datavisualizer-panel card-panel">\n        <div class="euiText">\n          <h2\n            class="kuiSubTitle kuiVerticalRhythm"\n            i18n-id="xpack.ml.datavisualizer.fieldsTitle"\n            i18n-default-message="Fields"\n          ></h2>\n        </div>\n\n        <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--responsive euiFlexGroup--wrap">\n          <div class="field-sort-controls euiFlexItem euiFlexItem--flexGrowZero">\n            <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">\n              <div ng-if="showAllFields === false" class="field-count-label euiFlexItem euiFlexItem--flexGrowZero">\n                <span\n                  i18n-id="xpack.ml.datavisualizer.showMFieldDescription"\n                  i18n-default-message="{wrappedFieldCardsCount} {fieldCardsCount, plural, one {field exists} other {fields exist}} in documents ({totalNonMetricFieldCount} in total)"\n                  i18n-values="{\n                      html_wrappedFieldCardsCount: \'<span class=\\\'field-emphasis\\\'>\' + fieldCards.length + \'</span>\',\n                      fieldCardsCount: fieldCards.length,\n                      html_totalNonMetricFieldCount: \'<span class=\\\'field-emphasis\\\'>\' + totalNonMetricFieldCount + \'</span>\'\n                  }"\n                ></span>\n              </div>\n\n\n              <div ng-if="showAllFields === true" class="field-count-label euiFlexItem euiFlexItem--flexGrowZero">\n                <span\n                  i18n-id="xpack.ml.datavisualizer.showAllFieldsDescription"\n                  i18n-default-message="{wrappedFieldCardsCount} {fieldCardsCount, plural, one {field} other {fields}} ({wrappedPopulatedNonMetricFieldCount} {populatedNonMetricFieldCount, plural, one {exists} other {exist}} in documents)"\n                  i18n-values="{\n                    html_wrappedFieldCardsCount: \'<span class=\\\'field-emphasis\\\'>\' + fieldCards.length + \'</span>\',\n                    fieldCardsCount: fieldCards.length,\n                    html_wrappedPopulatedNonMetricFieldCount: \'<span class=\\\'field-emphasis\\\'>\' + populatedNonMetricFieldCount +\'</span>\',\n                    populatedNonMetricFieldCount\n                  }"\n                ></span>\n              </div>\n\n              <div ng-hide="populatedNonMetricFieldCount === totalNonMetricFieldCount" class="field-group-input euiFlexItem euiFlexItem--flexGrowZero">\n                <input id="toggleAllFieldsCheckbox" type="checkbox" class="kuiCheckBox" ng-click="toggleAllFields()" ng-checked="showAllFields === true">\n                <label\n                  for="toggleAllFieldsCheckbox"\n                  i18n-id="xpack.ml.datavisualizer.showEmptyFieldsLabel"\n                  i18n-default-message="show empty fields"\n                ></label>\n              </div>\n            </div>\n          </div>\n          <div class="field-filter-controls euiFlexItem euiFlexItem--flexGrowZero">\n            <div class="euiFlexGroup euiFlexGroup--gutterSmall euiFlexGroup--responsive">\n              <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                <select class="kuiSelect type-input"\n                  ng-model="filterFieldType"\n                  ng-change="filterFieldTypeChanged(filterFieldType)"\n                  aria-label="{{ ::\'xpack.ml.datavisualizer.selectFieldTypesAriaLabel\' | i18n: {\n                    defaultMessage: \'Select field types\'\n                  } }}"\n                >\n                  <option\n                    value="*"\n                    i18n-id="xpack.ml.datavisualizer.allFieldsTypeOptionLabel"\n                    i18n-default-message="All field types"\n                  ></option>\n                  <option\n                    ng-repeat="type in indexedFieldTypes"\n                    value="{{type}}"\n                    i18n-id="xpack.ml.datavisualizer.typesOptionLabel"\n                    i18n-default-message="{type} types"\n                    i18n-values="{ type }"\n                  ></option>\n                </select>\n              </div>\n              <div class="euiFlexItem euiFlexItem--flexGrowZero">\n                <ml-form-filter-input\n                  filter="fieldFilter"\n                  filter-icon="fieldFilterIcon"\n                  filter-changed="fieldFilterChanged"\n                  clear-filter="clearFieldFilter" />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="card-container" ng-repeat="card in fieldCards">\n          <ml-field-data-card\n            index-pattern="indexPattern"\n            query="searchQuery"\n            earliest="earliest"\n            latest="latest"\n            card="card">\n          </ml-field-data-card>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-if="showSidebar" class="datavisualizer-sidebar">\n      <ng-include src="urlBasePath+\'/plugins/ml/datavisualizer/datavisualizer_sidebar.html\'"></ng-include>\n    </div>\n\n  </div>\n</ml-datavisualizer>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3009);__webpack_require__(3010);__webpack_require__(3012);__webpack_require__(3014);__webpack_require__(3015);__webpack_require__(3017);__webpack_require__(402);__webpack_require__(683)},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _d=_interopRequireDefault(__webpack_require__(27));var _moment=_interopRequireDefault(__webpack_require__(16));var _parse_interval=__webpack_require__(275);var _chart_utils=__webpack_require__(280);var _string_utils=__webpack_require__(67);var _ml_time_buckets=__webpack_require__(338);var _chart_tooltip_service=__webpack_require__(362);var _date_utils=__webpack_require__(279);var _modules=__webpack_require__(8);var _timefilter=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlDocumentCountChart",function(Private){function link(scope,element,attrs){var svgWidth=attrs.width?+attrs.width:400;var svgHeight=scope.height=attrs.height?+attrs.height:400;var margin={top:0,right:5,bottom:20,left:15};var chartWidth=svgWidth-(margin.left+margin.right);var chartHeight=svgHeight-(margin.top+margin.bottom);var xScale=null;var yScale=_d.default.scale.linear().range([chartHeight,0]);var xAxisTickFormat="YYYY-MM-DD HH:mm";var barChartGroup;var barWidth=5;var MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);scope.chartData=[];element.on("$destroy",function(){scope.$destroy()});function processChartData(){var bucketsData=_lodash.default.get(scope,["card","stats","documentCounts","buckets"],{});var chartData=[];_lodash.default.each(bucketsData,function(value,time){chartData.push({date:new Date(+time),time:+time,value:value})});scope.chartData=chartData}function render(){var chartElement=_d.default.select(element.get(0)).select(".content-wrapper");chartElement.selectAll("*").remove();if(scope.chartData===undefined){return}var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);var maxYVal=_d.default.max(scope.chartData,function(d){return d.value});yScale=yScale.domain([0,maxYVal]);var yAxis=_d.default.svg.axis().scale(yScale).orient("left").outerTickSize(0);var maxYAxisLabelWidth=(0,_string_utils.calculateTextWidth)(maxYVal,true,svg);margin.left=Math.max(maxYAxisLabelWidth+yAxis.tickPadding()+5,25);chartWidth=Math.max(svgWidth-margin.left-margin.right,0);var bounds=_timefilter.timefilter.getActiveBounds();xScale=_d.default.time.scale().domain([new Date(bounds.min.valueOf()),new Date(bounds.max.valueOf())]).range([0,chartWidth]);if(scope.chartData.length>0){var buckets=new MlTimeBuckets;var aggInterval=_lodash.default.get(scope,["card","stats","documentCounts","interval"]);buckets.setInterval(aggInterval);buckets.setBounds(bounds);xAxisTickFormat=buckets.getScaledDateFormat();var intervalMs=(0,_parse_interval.parseInterval)(aggInterval).asMilliseconds();barWidth=xScale(scope.chartData[0].time+intervalMs)-xScale(scope.chartData[0].time)}var xAxis=_d.default.svg.axis().scale(xScale).orient("bottom").outerTickSize(0).ticks((0,_chart_utils.numTicksForDateFormat)(chartWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});barChartGroup=svg.append("g").attr("class","bar-chart").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"));drawBarChartAxes(xAxis,yAxis);drawBarChartPaths()}function drawBarChartAxes(xAxis,yAxis){var axes=barChartGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(chartHeight,")")).call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawBarChartPaths(){barChartGroup.selectAll("bar").data(scope.chartData).enter().append("rect").attr("class","bar").attr("x",function(d){return xScale(d.time)}).attr("width",barWidth).attr("y",function(d){return yScale(d.value)}).attr("height",function(d){return chartHeight-yScale(d.value)}).on("mouseover",function(d){showChartTooltip(d,this)}).on("mousemove",function(d){showChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});function showChartTooltip(data,rect){var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(data.time);var contents=_i18n.i18n.translate("xpack.ml.fieldDataCard.documentCountChart.chartTooltip",{defaultMessage:"{formattedDate}{br}{hr}count: {dataValue}",values:{formattedDate:formattedDate,dataValue:data.value,br:"<br />",hr:"<hr />"}});var rectY=_d.default.select(rect).attr("y");var mouseY=+_d.default.mouse(rect)[1];_chart_tooltip_service.mlChartTooltipService.show(contents,rect,{x:5,y:mouseY-rectY})}}processChartData();render()}return{scope:false,link:link}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _modules=__webpack_require__(8);var _display_value=__webpack_require__(1381);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlDisplayValue",function(reactDirective){return reactDirective(_display_value.DisplayValue,undefined,{restrict:"E"})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DisplayValue=DisplayValue;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MAX_CHARS=12;function DisplayValue(_ref){var value=_ref.value;var length=String(value).length;var formattedValue;if(length<=MAX_CHARS){formattedValue=value}else{formattedValue=_react.default.createElement(_eui.EuiToolTip,{content:value,anchorClassName:"valueWrapper"},_react.default.createElement("span",null,value))}return formattedValue}},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _jquery=_interopRequireDefault(__webpack_require__(21));var _moment=_interopRequireDefault(__webpack_require__(16));var _chrome=_interopRequireDefault(__webpack_require__(9));var _field_data_card=_interopRequireDefault(__webpack_require__(3013));var _field_types=__webpack_require__(295);var _string_utils=__webpack_require__(67);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFieldDataCard",function(config){function link(scope,element){scope.ML_JOB_FIELD_TYPES=_field_types.ML_JOB_FIELD_TYPES;scope.mlEscape=_string_utils.mlEscape;if(scope.card.type===_field_types.ML_JOB_FIELD_TYPES.NUMBER){if(scope.card.fieldName){scope.$watch("card.stats",function(){var cardinality=_lodash.default.get(scope,["card","stats","cardinality"],0);scope.detailsMode=cardinality>100?"distribution":"top"});var cardinality=_lodash.default.get(scope,["card","stats","cardinality"],0);scope.detailsMode=cardinality>100?"distribution":"top"}(0,_jquery.default)(".ml-field-data-card-tooltip").remove();(0,_jquery.default)("body").append('<div class="ml-field-data-card-tooltip" style="opacity:0; display: none;">')}if(scope.card.type===_field_types.ML_JOB_FIELD_TYPES.DATE){scope.$watch("card.stats",function(){if(_lodash.default.has(scope,"card.stats.earliest")){scope.card.stats.earliest=new Date(scope.card.stats.earliest)}if(_lodash.default.has(scope,"card.stats.latest")){scope.card.stats.latest=new Date(scope.card.stats.latest)}},true)}scope.toMoment=function(datetime){return(0,_moment.default)(datetime).format(config.get("dateFormat"))};scope.getCardUrl=function(){var urlBasePath=_chrome.default.getBasePath();var baseCardPath="".concat(urlBasePath,"/plugins/ml/components/field_data_card/content_types");var cardType=scope.card.type;switch(cardType){case _field_types.ML_JOB_FIELD_TYPES.BOOLEAN:return"".concat(baseCardPath,"/card_boolean.html");case _field_types.ML_JOB_FIELD_TYPES.DATE:return"".concat(baseCardPath,"/card_date.html");case _field_types.ML_JOB_FIELD_TYPES.GEO_POINT:return"".concat(baseCardPath,"/card_geo_point.html");case _field_types.ML_JOB_FIELD_TYPES.IP:return"".concat(baseCardPath,"/card_ip.html");case _field_types.ML_JOB_FIELD_TYPES.KEYWORD:return"".concat(baseCardPath,"/card_keyword.html");case _field_types.ML_JOB_FIELD_TYPES.NUMBER:if(scope.card.fieldName){return"".concat(baseCardPath,"/card_number.html")}else{return"".concat(baseCardPath,"/card_document_count.html")}case _field_types.ML_JOB_FIELD_TYPES.TEXT:return"".concat(baseCardPath,"/card_text.html");default:return"".concat(baseCardPath,"/card_other.html")}};element.on("$destroy",function(){scope.$destroy()})}return{scope:{card:"=",indexPattern:"=",query:"=",earliest:"=",latest:"="},template:_field_data_card.default,link:link}}).filter("formatField",function(){return function(value,fieldFormat){return fieldFormat.convert(value,"text")}})},function(module,exports){module.exports='<div class="ml-field-data-card">\n  <ml-field-title-bar card="card" />\n\n  <div ng-if="card.loading === true" class="card-contents">\n    <ml-loading-indicator\n      label="{{:: \'xpack.ml.fieldDataCard.loadingLabel\' | i18n: { defaultMessage: \'Loading\' } }}"\n      is-loading="card.loading"\n      height="200"\n    />\n  </div>\n\n  <div ng-if="card.existsInDocs === false" class="card-contents">\n    <div\n      class="not-exist-message"\n      i18n-id="xpack.ml.fieldDataCard.fieldDoesNotAppearInDocumentsDescription"\n      i18n-default-message="{icon} This field does not appear in any documents for the selected time range"\n      i18n-values="{\n        html_icon: \'<i class=\\\'fa fa-exclamation-triangle\\\' aria-hidden=\\\'true\\\'></i>\',\n      }"\n    ></div>\n  </div>\n\n  <ng-include ng-if="card.loading === false" src="getCardUrl()"></ng-include>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _d=_interopRequireDefault(__webpack_require__(27));var _chart_utils=__webpack_require__(280);var _ordinal_suffix=__webpack_require__(1270);var _chart_tooltip_service=__webpack_require__(362);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlMetricDistributionChart",function(){function link(scope,element,attrs){var svgWidth=attrs.width?+attrs.width:400;var svgHeight=scope.height=attrs.height?+attrs.height:400;var margin={top:0,right:15,bottom:20,left:15};var infoLabelHeight=15;var chartWidth=svgWidth-(margin.left+margin.right);var chartHeight=svgHeight-(margin.top+margin.bottom+infoLabelHeight);var xScale=_d.default.scale.linear().range([0,chartWidth]);var yScale=_d.default.scale.linear().range([chartHeight,0]);var xAxisMin=0;var xAxisMax=1;var chartGroup;var distributionArea=_d.default.svg.area().x(function(d){return xScale(d.x)}).y0(function(){return yScale(0)}).y1(function(d){return yScale(d.y)});var MIN_BAR_WIDTH=3;element.on("$destroy",function(){scope.$destroy()});function processDistributionData(){var distributionData=_lodash.default.get(scope,["card","stats","distribution","percentiles"],[]);var chartData=[];if(distributionData.length===0){return chartData}var minX=distributionData[0].minValue;var maxX=distributionData[distributionData.length-1].maxValue;xAxisMin=minX;xAxisMax=maxX;if(maxX===minX){if(minX!==0){xAxisMin=0;xAxisMax=2*minX}else{xAxisMax=1}}var minBarWidth=MIN_BAR_WIDTH/chartWidth*(xAxisMax-xAxisMin);var processedData=[];var lastBar=undefined;_lodash.default.each(distributionData,function(data,index){if(index===0){var bar={x0:data.minValue,x1:Math.max(data.minValue+minBarWidth,data.maxValue),dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent};bar.y=data.percent/(bar.x1-bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth));bar.isMinWidth=data.maxValue<=data.minValue+minBarWidth;processedData.push(bar);lastBar=bar}else{if(lastBar.isMinWidth===false||data.maxValue>lastBar.x1){var _bar={x0:lastBar.x1,x1:Math.max(lastBar.x1+minBarWidth,data.maxValue),dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent};_bar.y=data.percent/(_bar.x1-_bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth));_bar.isMinWidth=data.maxValue<=lastBar.x1+minBarWidth;processedData.push(_bar);lastBar=_bar}else{lastBar.percent=lastBar.percent+data.percent;lastBar.y=lastBar.percent/(lastBar.x1-lastBar.x0);lastBar.dataMax=data.maxValue}}});if(maxX!==minX){xAxisMax=_lodash.default.last(processedData).x1}var barHeights=_lodash.default.pluck(processedData,"y");barHeights=barHeights.sort(function(a,b){return a-b});var maxBarHeight=0;var processedDataLength=processedData.length;if(Math.abs(processedDataLength%2)===1){maxBarHeight=20*barHeights[Math.floor(processedDataLength/2)]}else{maxBarHeight=20*(barHeights[Math.floor(processedDataLength/2)-1]+barHeights[Math.floor(processedDataLength/2)])/2}_lodash.default.each(processedData,function(data){data.y=Math.min(data.y,maxBarHeight)});scope.processedData=processedData;chartData.push({x:minX,y:0});_lodash.default.each(processedData,function(data){chartData.push({x:data.x0,y:data.y});chartData.push({x:data.x1,y:data.y})});chartData.push({x:processedData[processedData.length-1].x1,y:0});return chartData}function init(){scope.chartData=processDistributionData();var chartElement=_d.default.select(element.get(0)).select(".content-wrapper");chartElement.select("svg").remove();var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);var minPercentile=_lodash.default.get(scope,["card","stats","distribution","minPercentile"]);var maxPercentile=_lodash.default.get(scope,["card","stats","distribution","maxPercentile"]);var minPercent=(0,_ordinal_suffix.ordinalSuffix)(minPercentile);var maxPercent=(0,_ordinal_suffix.ordinalSuffix)(maxPercentile);svg.append("text").attr("x",chartWidth/2).attr("y",10).attr("class","info-text").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")")).text(_i18n.i18n.translate("xpack.ml.fieldDataCard.metricDistributionChart.displayingPercentilesLabel",{defaultMessage:"Displaying {minPercent} - {maxPercent} percentiles",values:{minPercent:minPercent,maxPercent:maxPercent}}));var translateTop=margin.top+infoLabelHeight;chartGroup=svg.append("g").attr("class","distribution-chart").attr("transform","translate(".concat(margin.left,", ").concat(translateTop,")"));var dataLength=scope.chartData.length;if(dataLength>0){xScale=xScale.domain([xAxisMin,xAxisMax]);var yMax=_d.default.max(scope.chartData,function(d){return d.y});yScale=yScale.domain([0,yMax])}}function drawAxes(){var axes=chartGroup.append("g").attr("class","axes");var xAxis=_d.default.svg.axis().scale(xScale).orient("bottom").outerTickSize(0).ticks((0,_chart_utils.numTicks)(chartWidth)).tickFormat(function(d){return scope.card.fieldFormat.convert(d,"text")});var yAxis=_d.default.svg.axis().scale(yScale).orient("left").outerTickSize(0).ticks(0);axes.append("g").attr("class","x axis").attr("transform","translate(0, ".concat(chartHeight,")")).call(xAxis);axes.append("g").attr("class","y axis").call(yAxis)}function drawDistributionArea(){var path=chartGroup.append("path");path.datum(scope.chartData).attr("class","area").attr("d",distributionArea).on("mouseover",showChartTooltip).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()}).on("mousemove",showChartTooltip);function showChartTooltip(){var xPos=_d.default.mouse(this)[0];var yPos=_d.default.mouse(this)[1];var xVal=xScale.invert(xPos);var processedDataIdx=0;for(var i=0;i<scope.processedData.length;i++){if(xVal<scope.processedData[i].x1){processedDataIdx=i;break}}var contents;var bar=scope.processedData[processedDataIdx];var minValFormatted=scope.card.fieldFormat.convert(bar.dataMin,"text");if(bar.dataMax>bar.dataMin){var maxValFormatted=scope.card.fieldFormat.convert(bar.dataMax,"text");contents=_i18n.i18n.translate("xpack.ml.fieldDataCard.metricDistributionChart.documentsBarPercentBetweenValuesDescription",{defaultMessage:"{barPercent}% of documents have{br}values between {minValFormatted} and {maxValFormatted}",values:{barPercent:bar.percent,minValFormatted:minValFormatted,maxValFormatted:maxValFormatted,br:"<br />"}})}else{contents=_i18n.i18n.translate("xpack.ml.fieldDataCard.metricDistributionChart.documentsBarPercentValueDescription",{defaultMessage:"{barPercent}% of documents have{br}a value of {minValFormatted}",values:{barPercent:bar.percent,minValFormatted:minValFormatted,br:"<br />"}})}contents="<div class='eui-textCenter'>".concat(contents,"</div>");if(path.length&&path[0].length){_chart_tooltip_service.mlChartTooltipService.show(contents,path[0][0],{x:xPos+5,y:yPos+10})}}}init();drawAxes();drawDistributionArea()}return{scope:false,link:link}})},function(module,exports,__webpack_require__){"use strict";var _top_values=_interopRequireDefault(__webpack_require__(3016));var _string_utils=__webpack_require__(67);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlTopValues",function(){return{restrict:"E",template:_top_values.default,link:function link(scope){scope.mlEscape=_string_utils.mlEscape}}})},function(module,exports){module.exports='<div ng-repeat="value in card.stats.topValues" class="top-value">\n  <div class="field-label"\n    tooltip-html-unsafe="{{mlEscape(value.key) | formatField:card.fieldFormat}}"\n    tooltip-append-to-body="true"\n    tooltip-placement="right">\n    {{value.key | formatField:card.fieldFormat}}\n  </div>\n  <div class="top-value-bar-holder">\n    <div ng-if="card.stats.isTopValuesSampled === false"\n      class="top-value-bar {{card.type}}"\n      ng-attr-style="width: {{ 100 * value.doc_count/card.stats.count }}%;"\n      tooltip-html-unsafe="{{ 100 * value.doc_count/card.stats.count >= 0.1 ? (100 * value.doc_count/card.stats.count | number:1): \'< 0.1\' }}%"\n      tooltip-append-to-body="true"\n      tooltip-placement="right">\n    </div>\n    <div ng-if="card.stats.isTopValuesSampled === true"\n      class="top-value-bar {{card.type}}"\n      ng-attr-style="width: {{ 100 * value.doc_count/card.stats.topValuesSampleSize }}%;"\n      tooltip-html-unsafe="{{ 100 * value.doc_count/card.stats.topValuesSampleSize >= 0.1 ? (100 * value.doc_count/card.stats.topValuesSampleSize | number:1): \'< 0.1\' }}%"\n      tooltip-append-to-body="true"\n      tooltip-placement="right">\n    </div>\n  </div>\n  <div ng-if="card.stats.isTopValuesSampled === false" class="count-label">{{value.doc_count}}</div>\n  <div ng-if="card.stats.isTopValuesSampled === true" class="count-label">\n    {{ 100 * value.doc_count/card.stats.topValuesSampleSize >= 0.1 ? (100 * value.doc_count/card.stats.topValuesSampleSize | number:1): \'< 0.1\' }}%\n  </div>\n</div>\n<div\n  ng-if="card.stats.isTopValuesSampled === true"\n  class="sampled-message euiText--small"\n  i18n-id="xpack.ml.fieldDataCard.calculatedFromSampleDescription"\n  i18n-default-message="Calculated from sample of {topValuesSamplerShardSize} documents per shard"\n  i18n-values="{\n    topValuesSamplerShardSize: card.stats.topValuesSamplerShardSize,\n  }"\n></div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3018)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _field_title_bar=__webpack_require__(3019);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlFieldTitleBar",function(){return{restrict:"E",replace:false,scope:{card:"="},link:function link(scope,element){scope.$watch("card",updateComponent);updateComponent();function updateComponent(){var props={card:scope.card};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_field_title_bar.FieldTitleBar,props)),element[0])}}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldTitleBar=FieldTitleBar;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _field_type_icon=__webpack_require__(402);var _field_types_utils=__webpack_require__(578);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function FieldTitleBar(_ref){var card=_ref.card;if(_typeof(card)!=="object"||card===null){return null}var fieldName=card.fieldName||_i18n.i18n.translate("xpack.ml.fieldTitleBar.documentCountLabel",{defaultMessage:"document count"});var cardTitleAriaLabel=[fieldName];var classNames=["ml-field-title-bar"];if(card.fieldName===undefined){classNames.push("document_count")}else if(card.isUnsupportedType===true){classNames.push("type-other")}else{classNames.push(card.type)}if(card.isUnsupportedType!==true){cardTitleAriaLabel.unshift((0,_field_types_utils.getMLJobTypeAriaLabel)(card.type))}return _react.default.createElement(_eui.EuiText,{className:classNames.join(" ")},_react.default.createElement(_field_type_icon.FieldTypeIcon,{type:card.type,tooltipEnabled:true,needsAria:false}),_react.default.createElement(_eui.EuiToolTip,{position:"left",content:fieldName},_react.default.createElement("div",{className:"field-name",tabIndex:"0","aria-label":"".concat(cardTitleAriaLabel.join(", "))},fieldName)))}FieldTitleBar.propTypes={card:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3021);__webpack_require__(581);__webpack_require__(3054);__webpack_require__(3087);__webpack_require__(3088);__webpack_require__(1392)},function(module,exports,__webpack_require__){"use strict";var _jquery=_interopRequireDefault(__webpack_require__(21));var _momentTimezone=_interopRequireDefault(__webpack_require__(224));__webpack_require__(676);__webpack_require__(1382);__webpack_require__(1385);var _explorer=_interopRequireDefault(__webpack_require__(3052));var _routes=_interopRequireDefault(__webpack_require__(19));var _explorer_utils=__webpack_require__(897);var _breadcrumbs=__webpack_require__(3053);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _index_utils=__webpack_require__(226);var _ml_time_buckets=__webpack_require__(338);var _explorer_dashboard_service=__webpack_require__(581);var _field_format_service=__webpack_require__(296);var _job_service=__webpack_require__(36);var _refresh_interval_watcher=__webpack_require__(1387);var _timefilter=__webpack_require__(22);var _explorer_constants=__webpack_require__(339);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}_routes.default.when("/explorer/?",{template:_explorer.default,k7Breadcrumbs:_breadcrumbs.getAnomalyExplorerBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,indexPatterns:_index_utils.loadIndexPatterns,jobs:_job_service.mlJobService.loadJobsWrapper}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlExplorerController",function($injector,$scope,$timeout,AppState,Private,config){$injector.get("mlCheckboxShowChartsService");$injector.get("mlSelectIntervalService");$injector.get("mlSelectLimitService");$injector.get("mlSelectSeverityService");var mlJobSelectService=$injector.get("mlJobSelectService");$scope.jobs=[];_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.enableAutoRefreshSelector();var tzConfig=config.get("dateFormat:tz");$scope.dateFormatTz=tzConfig!=="Browser"?tzConfig:_momentTimezone.default.tz.guess();$scope.MlTimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);var resizeTimeout=null;function jobSelectionUpdate(action,_ref){var fullJobs=_ref.fullJobs,filterData=_ref.filterData,selectedCells=_ref.selectedCells,selectedJobIds=_ref.selectedJobIds,swimlaneViewByFieldName=_ref.swimlaneViewByFieldName;var jobs=(0,_explorer_utils.createJobs)(fullJobs).map(function(job){job.selected=selectedJobIds.some(function(id){return job.id===id});return job});var selectedJobs=jobs.filter(function(job){return job.selected});function fieldFormatServiceCallback(){$scope.jobs=jobs;$scope.$applyAsync();var noJobsFound=$scope.jobs.length===0;_explorer_dashboard_service.explorer$.next({action:action,payload:{loading:false,noJobsFound:noJobsFound,selectedCells:selectedCells,selectedJobs:selectedJobs,swimlaneViewByFieldName:swimlaneViewByFieldName,filterData:filterData}});$scope.jobSelectionUpdateInProgress=false;$scope.$applyAsync()}_field_format_service.mlFieldFormatService.populateFormats(selectedJobIds,(0,_index_utils.getIndexPatterns)()).catch(function(err){console.log("Error populating field formats:",err)}).then(function(){fieldFormatServiceCallback()})}$scope.appState=new AppState({mlExplorerSwimlane:{},mlExplorerFilter:{}});function loadJobsListener(_ref2){var action=_ref2.action;if(action===_explorer_constants.EXPLORER_ACTION.LOAD_JOBS){if(_job_service.mlJobService.jobs.length>0){var selectedJobIds=mlJobSelectService.getValue().selection;var selectedCells;var filterData={};if($scope.appState.mlExplorerSwimlane.selectedType!==undefined){selectedCells={type:$scope.appState.mlExplorerSwimlane.selectedType,lanes:$scope.appState.mlExplorerSwimlane.selectedLanes,times:$scope.appState.mlExplorerSwimlane.selectedTimes,showTopFieldValues:$scope.appState.mlExplorerSwimlane.showTopFieldValues,viewByFieldName:$scope.appState.mlExplorerSwimlane.viewByFieldName}}if($scope.appState.mlExplorerFilter.influencersFilterQuery!==undefined){filterData={influencersFilterQuery:$scope.appState.mlExplorerFilter.influencersFilterQuery,filterActive:$scope.appState.mlExplorerFilter.filterActive,filteredFields:$scope.appState.mlExplorerFilter.filteredFields,queryString:$scope.appState.mlExplorerFilter.queryString}}jobSelectionUpdate(_explorer_constants.EXPLORER_ACTION.INITIALIZE,{filterData:filterData,fullJobs:_job_service.mlJobService.jobs,selectedCells:selectedCells,selectedJobIds:selectedJobIds,swimlaneViewByFieldName:$scope.appState.mlExplorerSwimlane.viewByFieldName})}else{_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.RELOAD,payload:{loading:false,noJobsFound:true}})}}}var explorerSubscriber=_explorer_dashboard_service.explorer$.subscribe(loadJobsListener);$scope.jobSelectionUpdateInProgress=false;var jobSelectServiceSub=mlJobSelectService.subscribe(function(_ref3){var selection=_ref3.selection;if(selection!==undefined){$scope.jobSelectionUpdateInProgress=true;jobSelectionUpdate(_explorer_constants.EXPLORER_ACTION.JOB_SELECTION_CHANGE,{fullJobs:_job_service.mlJobService.jobs,selectedJobIds:selection})}});$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",function(){if($scope.jobSelectionUpdateInProgress===false){_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.RELOAD})}});var refreshWatcher=Private(_refresh_interval_watcher.refreshIntervalWatcher);refreshWatcher.init(_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if($scope.jobSelectionUpdateInProgress===false){_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.RELOAD})}case 1:case"end":return _context.stop()}}},_callee)})));function jqueryRedrawOnResize(){if(resizeTimeout!==null){$timeout.cancel(resizeTimeout)}resizeTimeout=$timeout(redrawOnResize,100)}(0,_jquery.default)(window).resize(jqueryRedrawOnResize);var navListener=$scope.$on("globalNav:update",function(){$timeout(function(){redrawOnResize()},300)});function redrawOnResize(){if($scope.jobSelectionUpdateInProgress===false){_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.REDRAW})}}$scope.appStateHandler=function(action,payload){$scope.appState.fetch();if(action===_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION){delete $scope.appState.mlExplorerSwimlane.selectedType;delete $scope.appState.mlExplorerSwimlane.selectedLanes;delete $scope.appState.mlExplorerSwimlane.selectedTimes;delete $scope.appState.mlExplorerSwimlane.showTopFieldValues}if(action===_explorer_constants.APP_STATE_ACTION.SAVE_SELECTION){var swimlaneSelectedCells=payload.swimlaneSelectedCells;$scope.appState.mlExplorerSwimlane.selectedType=swimlaneSelectedCells.type;$scope.appState.mlExplorerSwimlane.selectedLanes=swimlaneSelectedCells.lanes;$scope.appState.mlExplorerSwimlane.selectedTimes=swimlaneSelectedCells.times;$scope.appState.mlExplorerSwimlane.showTopFieldValues=swimlaneSelectedCells.showTopFieldValues;$scope.appState.mlExplorerSwimlane.viewByFieldName=swimlaneSelectedCells.viewByFieldName}if(action===_explorer_constants.APP_STATE_ACTION.SAVE_SWIMLANE_VIEW_BY_FIELD_NAME){$scope.appState.mlExplorerSwimlane.viewByFieldName=payload.swimlaneViewByFieldName}if(action===_explorer_constants.APP_STATE_ACTION.SAVE_INFLUENCER_FILTER_SETTINGS){$scope.appState.mlExplorerFilter.influencersFilterQuery=payload.influencersFilterQuery;$scope.appState.mlExplorerFilter.filterActive=payload.filterActive;$scope.appState.mlExplorerFilter.filteredFields=payload.filteredFields;$scope.appState.mlExplorerFilter.queryString=payload.queryString}if(action===_explorer_constants.APP_STATE_ACTION.CLEAR_INFLUENCER_FILTER_SETTINGS){delete $scope.appState.mlExplorerFilter.influencersFilterQuery;delete $scope.appState.mlExplorerFilter.filterActive;delete $scope.appState.mlExplorerFilter.filteredFields;delete $scope.appState.mlExplorerFilter.queryString}$scope.appState.save();$scope.$applyAsync()};$scope.$on("$destroy",function(){explorerSubscriber.unsubscribe();jobSelectServiceSub.unsubscribe();refreshWatcher.cancel();(0,_jquery.default)(window).off("resize",jqueryRedrawOnResize);navListener()})})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _timefilter=__webpack_require__(22);var _anomalies_table=__webpack_require__(1383);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlAnomaliesTable",function($injector){var reactDirective=$injector.get("reactDirective");return reactDirective((0,_i18n.wrapInI18nContext)(_anomalies_table.AnomaliesTable),[["filter",{watchDepth:"reference"}],["tableData",{watchDepth:"reference"}]],{restrict:"E"},{timefilter:_timefilter.timefilter})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getColumns=getColumns;var _eui=__webpack_require__(1);var _react=_interopRequireDefault(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _date_utils=__webpack_require__(279);var _description_cell=__webpack_require__(3024);var _detector_cell=__webpack_require__(3026);var _entity_cell=__webpack_require__(894);var _influencers_cell=__webpack_require__(3028);var _links_menu=__webpack_require__(3029);var _check_privilege=__webpack_require__(39);var _field_format_service=__webpack_require__(296);var _anomaly_utils=__webpack_require__(293);var _format_value=__webpack_require__(437);var _anomalies_table_constants=__webpack_require__(895);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function renderTime(date,aggregationInterval){if(aggregationInterval==="hour"){return(0,_date_utils.formatHumanReadableDateTime)(date)}else if(aggregationInterval==="second"){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)}else{return(0,_date_utils.formatHumanReadableDate)(date)}}function showLinksMenuForItem(item){var canConfigureRules=(0,_anomaly_utils.isRuleSupported)(item)&&(0,_check_privilege.checkPermission)("canUpdateJob");return canConfigureRules||item.isTimeSeriesViewRecord||item.entityName==="mlcategory"||item.customUrls!==undefined}function getColumns(items,jobIds,examplesByJobId,isAggregatedData,interval,timefilter,showViewSeriesLink,showRuleEditorFlyout,itemIdToExpandedRowMap,toggleRow,filter,influencerFilter){var columns=[{name:"",render:function render(item){return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return toggleRow(item)},iconType:itemIdToExpandedRowMap[item.rowId]?"arrowDown":"arrowRight","aria-label":itemIdToExpandedRowMap[item.rowId]?_i18n.i18n.translate("xpack.ml.anomaliesTable.hideDetailsAriaLabel",{defaultMessage:"Hide details"}):_i18n.i18n.translate("xpack.ml.anomaliesTable.showDetailsAriaLabel",{defaultMessage:"Show details"}),"data-row-id":item.rowId})}},{field:"time",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.timeColumnName",{defaultMessage:"time"}),dataType:"date",render:function render(date){return renderTime(date,interval)},textOnly:true,sortable:true},{field:"severity",name:isAggregatedData===true?_i18n.i18n.translate("xpack.ml.anomaliesTable.maxSeverityColumnName",{defaultMessage:"max severity"}):_i18n.i18n.translate("xpack.ml.anomaliesTable.severityColumnName",{defaultMessage:"severity"}),render:function render(score){return _react.default.createElement(_eui.EuiHealth,{color:(0,_anomaly_utils.getSeverityColor)(score),compressed:"true"},score>=1?Math.floor(score):"< 1")},sortable:true},{field:"detector",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.detectorColumnName",{defaultMessage:"detector"}),render:function render(detectorDescription,item){return _react.default.createElement(_detector_cell.DetectorCell,{detectorDescription:detectorDescription,numberOfRules:item.rulesLength})},textOnly:true,sortable:true}];if(items.some(function(item){return item.entityValue!==undefined})){columns.push({field:"entityValue",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.entityValueColumnName",{defaultMessage:"found for"}),render:function render(entityValue,item){return _react.default.createElement(_entity_cell.EntityCell,{entityName:item.entityName,entityValue:entityValue,filter:filter,wrapText:true})},textOnly:true,sortable:true})}if(items.some(function(item){return item.influencers!==undefined})){columns.push({field:"influencers",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersColumnName",{defaultMessage:"influenced by"}),render:function render(influencers){return _react.default.createElement(_influencers_cell.InfluencersCell,{limit:_anomalies_table_constants.INFLUENCERS_LIMIT,influencers:influencers,influencerFilter:influencerFilter})},textOnly:true,sortable:true})}if(items.some(function(item){return item.actual!==undefined})){columns.push({field:"actualSort",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.actualSortColumnName",{defaultMessage:"actual"}),render:function render(actual,item){var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(item.jobId,item.source.detector_index);return(0,_format_value.formatValue)(item.actual,item.source.function,fieldFormat,item.source)},sortable:true})}if(items.some(function(item){return item.typical!==undefined})){columns.push({field:"typicalSort",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.typicalSortColumnName",{defaultMessage:"typical"}),render:function render(typical,item){var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(item.jobId,item.source.detector_index);return(0,_format_value.formatValue)(item.typical,item.source.function,fieldFormat,item.source)},sortable:true});var nonTimeOfDayOrWeek=items.some(function(item){var summaryRecFunc=item.source.function;return summaryRecFunc!=="time_of_day"&&summaryRecFunc!=="time_of_week"});if(nonTimeOfDayOrWeek===true){columns.push({field:"metricDescriptionSort",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.metricDescriptionSortColumnName",{defaultMessage:"description"}),render:function render(metricDescriptionSort,item){return _react.default.createElement(_description_cell.DescriptionCell,{actual:item.actual,typical:item.typical})},textOnly:true,sortable:true})}}if(jobIds&&jobIds.length>1){columns.push({field:"jobId",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.jobIdColumnName",{defaultMessage:"job ID"}),sortable:true})}var showExamples=items.some(function(item){return item.entityName==="mlcategory"});if(showExamples===true){columns.push({name:_i18n.i18n.translate("xpack.ml.anomaliesTable.categoryExamplesColumnName",{defaultMessage:"category examples"}),sortable:false,truncateText:true,render:function render(item){var examples=_lodash.default.get(examplesByJobId,[item.jobId,item.entityValue],[]);return _react.default.createElement(_eui.EuiLink,{className:"mlAnomalyCategoryExamples__link",onClick:function onClick(){return toggleRow(item,_anomalies_table_constants.ANOMALIES_TABLE_TABS.CATEGORY_EXAMPLES)}},examples.map(function(example,i){return _react.default.createElement("span",{key:"example".concat(i),className:"category-example"},example)}))},textOnly:true,width:"13%"})}var showLinks=showViewSeriesLink===true||items.some(function(item){return showLinksMenuForItem(item)});if(showLinks===true){columns.push({name:_i18n.i18n.translate("xpack.ml.anomaliesTable.actionsColumnName",{defaultMessage:"actions"}),render:function render(item){if(showLinksMenuForItem(item)===true){return _react.default.createElement(_links_menu.LinksMenu,{anomaly:item,showViewSeriesLink:showViewSeriesLink,isAggregatedData:isAggregatedData,interval:interval,timefilter:timefilter,showRuleEditorFlyout:showRuleEditorFlyout})}else{return null}},sortable:false})}return columns}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DescriptionCell=DescriptionCell;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _metric_change_description=__webpack_require__(3025);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DescriptionCell(_ref){var actual=_ref.actual,typical=_ref.typical;var _getMetricChangeDescr=(0,_metric_change_description.getMetricChangeDescription)(actual,typical),iconType=_getMetricChangeDescr.iconType,message=_getMetricChangeDescr.message;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},iconType!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:iconType,size:"s"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},message)))}DescriptionCell.propTypes={actual:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.number]),typical:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.number])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getMetricChangeDescription=getMetricChangeDescription;var _i18n=__webpack_require__(4);var _modules=__webpack_require__(8);var _module=_modules.uiModules.get("apps/ml");function getMetricChangeDescription(actualProp,typicalProp){if(actualProp===undefined||typicalProp===undefined){return{iconType:"empty",message:""}}var iconType;var message;var actual=actualProp;var typical=typicalProp;if(Array.isArray(actualProp)){if(actualProp.length===1){actual=actualProp[0]}else{return{iconType:"alert",message:_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})}}}if(Array.isArray(typicalProp)){if(typicalProp.length===1){typical=typicalProp[0]}}if(actual===typical){message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"})}else{var isHigher=actual>typical;iconType=isHigher?"sortUp":"sortDown";if(typical!==0&&actual!==0){var factor=isHigher?actual/typical:typical/actual;if(factor>1.5){if(factor<=100){message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(factor)}}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(factor)}})}else{message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"})}}else if(factor>=1.05){message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:factor.toPrecision(2)}}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:factor.toPrecision(2)}})}else{message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}}else{if(actual===0){message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"})}else{message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}}}return{iconType:iconType,message:message}}_module.filter("metricChangeDescription",function(){return function(actual,typical){var _getMetricChangeDescr=getMetricChangeDescription(actual,typical),iconType=_getMetricChangeDescr.iconType,message=_getMetricChangeDescr.message;switch(iconType){case"sortUp":return'<i class="fa fa-arrow-up"></i> '.concat(message);case"sortDown":return'<i class="fa fa-arrow-down"></i> '.concat(message);case"alert":return'<i class="fa fa-exclamation-triangle"></i> '.concat(message)}return message}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorCell=DetectorCell;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DetectorCell(_ref){var detectorDescription=_ref.detectorDescription,numberOfRules=_ref.numberOfRules;var rulesIcon;if(numberOfRules!==undefined&&numberOfRules>0){rulesIcon=_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.detectorCell.rulesConfiguredTooltip",defaultMessage:"rules have been configured for this detector"})},_react.default.createElement(_eui.EuiIcon,{type:"controlsHorizontal",className:"detector-rules-icon"}))}return _react.default.createElement(_react.default.Fragment,null,detectorDescription,rulesIcon)}DetectorCell.propTypes={detectorDescription:_propTypes.default.string.isRequired,numberOfRules:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EntityCell=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getAddFilter(_ref){var entityName=_ref.entityName,entityValue=_ref.entityValue,filter=_ref.filter;return _react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.addFilterTooltip",defaultMessage:"Add filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"xs",className:"filter-button",onClick:function onClick(){return filter(entityName,entityValue,"+")},iconType:"plusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.entityCell.addFilterAriaLabel",{defaultMessage:"Add filter"})}))}function getRemoveFilter(_ref2){var entityName=_ref2.entityName,entityValue=_ref2.entityValue,filter=_ref2.filter;return _react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.removeFilterTooltip",defaultMessage:"Remove filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"xs",className:"filter-button",onClick:function onClick(){return filter(entityName,entityValue,"-")},iconType:"minusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.entityCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))}var EntityCell=function EntityCell(_ref3){var entityName=_ref3.entityName,entityValue=_ref3.entityValue,filter=_ref3.filter,_ref3$wrapText=_ref3.wrapText,wrapText=_ref3$wrapText===void 0?false:_ref3$wrapText;var valueText=entityName!=="mlcategory"?entityValue:"mlcategory ".concat(entityValue);var textStyle={maxWidth:"100%"};var textWrapperClass=wrapText?"field-value-long":"field-value-short";var shouldDisplayIcons=filter!==undefined&&entityName!==undefined&&entityValue!==undefined;if(wrapText===true){return _react.default.createElement("div",null,_react.default.createElement("span",{className:textWrapperClass},valueText),shouldDisplayIcons&&_react.default.createElement(_react.default.Fragment,null,getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter}),getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter})))}else{return _react.default.createElement(_eui.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:textStyle},_react.default.createElement(_eui.EuiText,{size:"xs",className:textWrapperClass},valueText)),shouldDisplayIcons&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter})))))}};exports.EntityCell=EntityCell;EntityCell.propTypes={entityName:_propTypes.default.string,entityValue:_propTypes.default.any,filter:_propTypes.default.func,wrapText:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InfluencersCell=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _i18n=__webpack_require__(4);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var InfluencersCell=function(_Component){_inherits(InfluencersCell,_Component);function InfluencersCell(props){var _this;_classCallCheck(this,InfluencersCell);_this=_possibleConstructorReturn(this,_getPrototypeOf(InfluencersCell).call(this,props));_this.state={showAll:false};return _this}_createClass(InfluencersCell,[{key:"toggleAllInfluencers",value:function toggleAllInfluencers(){this.setState({showAll:!this.state.showAll})}},{key:"renderInfluencers",value:function renderInfluencers(influencers){var numberToDisplay=this.state.showAll===false?this.props.limit:influencers.length;var displayInfluencers=influencers.slice(0,numberToDisplay);var influencerFilter=this.props.influencerFilter;var othersCount=Math.max(influencers.length-numberToDisplay,0);if(othersCount===1){displayInfluencers.push(influencers[this.props.limit]);othersCount=0}var displayRows=displayInfluencers.map(function(influencer,index){return _react.default.createElement("div",{key:index},influencer.influencerFieldName,": ",influencer.influencerFieldValue,influencerFilter!==undefined&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.addFilterTooltip",defaultMessage:"Add filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"xs",className:"filter-button",onClick:function onClick(){return influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"+")},iconType:"plusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersCell.addFilterAriaLabel",{defaultMessage:"Add filter"})})),_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.removeFilterTooltip",defaultMessage:"Remove filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"xs",className:"filter-button",onClick:function onClick(){return influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"-")},iconType:"minusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))))});return _react.default.createElement(_react.default.Fragment,null,displayRows,this.renderOthers(influencers.length,othersCount))}},{key:"renderOthers",value:function renderOthers(totalCount,othersCount){var _this2=this;if(othersCount>0){return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.moreInfluencersLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}})))}else if(totalCount>this.props.limit+1){return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.showLessInfluencersLinkText",defaultMessage:"show less"})))}}},{key:"render",value:function render(){var recordInfluencers=this.props.influencers||[];var influencers=[];recordInfluencers.forEach(function(influencer){_lodash.default.each(influencer,function(influencerFieldValue,influencerFieldName){influencers.push({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue})})});return _react.default.createElement("div",null,this.renderInfluencers(influencers),this.renderOthers(influencers))}}]);return InfluencersCell}(_react.Component);exports.InfluencersCell=InfluencersCell;InfluencersCell.propTypes={influencerFilter:_propTypes.default.func,influencers:_propTypes.default.array,limit:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LinksMenu=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _moment=_interopRequireDefault(__webpack_require__(16));var _risonNode=_interopRequireDefault(__webpack_require__(239));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _chrome=_interopRequireDefault(__webpack_require__(9));var _notify=__webpack_require__(14);var _field_types=__webpack_require__(295);var _check_privilege=__webpack_require__(39);var _anomaly_utils=__webpack_require__(293);var _parse_interval=__webpack_require__(313);var _mapping_service=__webpack_require__(500);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _custom_url_utils=__webpack_require__(498);var _date_utils=__webpack_require__(279);var _index_utils=__webpack_require__(226);var _string_utils=__webpack_require__(67);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var LinksMenu=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(LinksMenu,_Component);function LinksMenu(props){var _this;_classCallCheck(this,LinksMenu);_this=_possibleConstructorReturn(this,_getPrototypeOf(LinksMenu).call(this,props));_defineProperty(_assertThisInitialized(_this),"openCustomUrl",function(customUrl){var _this$props=_this.props,anomaly=_this$props.anomaly,interval=_this$props.interval,isAggregatedData=_this$props.isAggregatedData,intl=_this$props.intl;console.log("Anomalies Table - open customUrl for record:",anomaly);var record=_lodash.default.cloneDeep(anomaly.source);var timestamp=record.timestamp;var configuredUrlValue=customUrl.url_value;var timeRangeInterval=(0,_parse_interval.parseInterval)(customUrl.time_range);if(configuredUrlValue.includes("$earliest$")){var earliestMoment=(0,_moment.default)(timestamp);if(timeRangeInterval!==null){earliestMoment.subtract(timeRangeInterval)}else{earliestMoment=(0,_moment.default)(timestamp).startOf(interval);if(interval==="hour"){earliestMoment.subtract(1,"h")}}record.earliest=earliestMoment.toISOString()}if(configuredUrlValue.includes("$latest$")){var latestMoment=(0,_moment.default)(timestamp).add(record.bucket_span,"s");if(timeRangeInterval!==null){latestMoment.add(timeRangeInterval)}else{if(isAggregatedData===true){latestMoment=(0,_moment.default)(timestamp).endOf(interval);if(interval==="hour"){latestMoment.add(1,"h")}}}record.latest=latestMoment.toISOString()}if((configuredUrlValue.includes("$mlcategoryterms$")||configuredUrlValue.includes("$mlcategoryregex$"))&&_lodash.default.has(record,"mlcategory")){var jobId=record.job_id;var categoryId=record.mlcategory[0];_ml_api_service.ml.results.getCategoryDefinition(jobId,categoryId).then(function(resp){var termsArray=resp.terms.split(" ").map(function(term){return"+".concat(term)});record.mlcategoryterms=termsArray.join(" ");record.mlcategoryregex=resp.regex;var urlPath=(0,_string_utils.replaceStringTokens)(customUrl.url_value,record,true);(0,_custom_url_utils.openCustomUrlWindow)(urlPath,customUrl)}).catch(function(resp){console.log("openCustomUrl(): error loading categoryDefinition:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.anomaliesTable.linksMenu.unableToOpenLinkErrorMessage",defaultMessage:"Unable to open link as an error occurred loading details on category ID {categoryId}"},{categoryId:categoryId}))})}else{var urlPath=(0,_custom_url_utils.getUrlForRecord)(customUrl,record);(0,_custom_url_utils.openCustomUrlWindow)(urlPath,customUrl)}});_defineProperty(_assertThisInitialized(_this),"viewSeries",function(){var record=_this.props.anomaly.source;var bounds=_this.props.timefilter.getActiveBounds();var from=bounds.min.toISOString();var to=bounds.max.toISOString();var recordTime=(0,_moment.default)(record.timestamp);var zoomFrom=recordTime.subtract(50*record.bucket_span,"s").toISOString();var zoomTo=recordTime.add(100*record.bucket_span,"s").toISOString();var entityCondition={};if(_lodash.default.has(record,"partition_field_value")){entityCondition[record.partition_field_name]=record.partition_field_value}if(_lodash.default.has(record,"over_field_value")){entityCondition[record.over_field_name]=record.over_field_value}if(_lodash.default.has(record,"by_field_value")){entityCondition[record.by_field_name]=record.by_field_value}var _g=_risonNode.default.encode({ml:{jobIds:[record.job_id]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var _a=_risonNode.default.encode({mlTimeSeriesExplorer:{zoom:{from:zoomFrom,to:zoomTo},detectorIndex:record.detector_index,entities:entityCondition},query:{query_string:{analyze_wildcard:true,query:"*"}}});var path="".concat(_chrome.default.getBasePath(),"/app/ml#/timeseriesexplorer");path+="?_g=".concat(_g,"&_a=").concat(encodeURIComponent(_a));window.open(path,"_blank")});_defineProperty(_assertThisInitialized(_this),"viewExamples",function(){var intl=_this.props.intl;var categoryId=_this.props.anomaly.entityValue;var record=_this.props.anomaly.source;var indexPatterns=(0,_index_utils.getIndexPatterns)();var job=_job_service.mlJobService.getJob(_this.props.anomaly.jobId);if(job===undefined){console.log("viewExamples(): no job found with ID: ".concat(_this.props.anomaly.jobId));_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.anomaliesTable.linksMenu.unableToViewExamplesErrorMessage",defaultMessage:"Unable to view examples as no details could be found for job ID {jobId}"},{jobId:_this.props.anomaly.jobId}));return}var categorizationFieldName=job.analysis_config.categorization_field_name;var datafeedIndices=job.datafeed_config.indices;var i=0;findFieldType(datafeedIndices[i]);function findFieldType(index){(0,_mapping_service.getFieldTypeFromMapping)(index,categorizationFieldName).then(function(resp){if(resp!==""){createAndOpenUrl(index,resp)}else{i++;if(i<datafeedIndices.length){findFieldType(datafeedIndices[i])}else{error()}}}).catch(function(){error()})}function createAndOpenUrl(index,categorizationFieldType){var indexPatternId=index;for(var j=0;j<indexPatterns.length;j++){if(indexPatterns[j].get("title")===index){indexPatternId=indexPatterns[j].id;break}}_ml_api_service.ml.results.getCategoryDefinition(record.job_id,categoryId).then(function(resp){var query=null;if(categorizationFieldType===_field_types.ES_FIELD_TYPES.KEYWORD){if(resp.regex){query="".concat(categorizationFieldName,":/").concat(resp.regex,"/")}}else{if(resp.terms){query="".concat(categorizationFieldName,":")+resp.terms.split(" ").join(" AND ".concat(categorizationFieldName,":"))}}var recordTime=(0,_moment.default)(record.timestamp);var from=recordTime.toISOString();var to=recordTime.add(record.bucket_span,"s").toISOString();var _g=_risonNode.default.encode({refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var appStateProps={index:indexPatternId,filters:[]};if(query!==null){appStateProps.query={query_string:{analyze_wildcard:true,query:query}}}var _a=_risonNode.default.encode(appStateProps);var path=_chrome.default.getBasePath();path+="/app/kibana#/discover";path+="?_g="+_g;path+="&_a="+encodeURIComponent(_a);window.open(path,"_blank")}).catch(function(resp){console.log("viewExamples(): error loading categoryDefinition:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.anomaliesTable.linksMenu.loadingDetailsErrorMessage",defaultMessage:"Unable to view examples as an error occurred loading details on category ID {categoryId}"},{categoryId:categoryId}))})}function error(){console.log("viewExamples(): error finding type of field ".concat(categorizationFieldName," in indices:"),datafeedIndices);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.anomaliesTable.linksMenu.noMappingCouldBeFoundErrorMessage",defaultMessage:"Unable to view examples of documents with mlcategory {categoryId} "+"as no mapping could be found for the categorization field {categorizationFieldName}"},{categoryId:categoryId,categorizationFieldName:categorizationFieldName}))}});_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){_this.setState(function(prevState){return{isPopoverOpen:!prevState.isPopoverOpen}})});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({isPopoverOpen:false})});_this.state={isPopoverOpen:false,toasts:[]};return _this}_createClass(LinksMenu,[{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,anomaly=_this$props2.anomaly,showViewSeriesLink=_this$props2.showViewSeriesLink,intl=_this$props2.intl;var canConfigureRules=(0,_anomaly_utils.isRuleSupported)(anomaly.source)&&(0,_check_privilege.checkPermission)("canUpdateJob");var button=_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"text",onClick:this.onButtonClick,iconType:"gear","aria-label":intl.formatMessage({id:"xpack.ml.anomaliesTable.linksMenu.selectActionAriaLabel",defaultMessage:"Select action for anomaly at {time}"},{time:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomaly.time)})});var items=[];if(anomaly.customUrls!==undefined){anomaly.customUrls.forEach(function(customUrl,index){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"custom_url_".concat(index),icon:"popout",onClick:function onClick(){_this2.closePopover();_this2.openCustomUrl(customUrl)}},customUrl.url_name))})}if(showViewSeriesLink===true&&anomaly.isTimeSeriesViewRecord===true){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"view_series",icon:"stats",onClick:function onClick(){_this2.closePopover();_this2.viewSeries()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewSeriesLabel",defaultMessage:"View series"})))}if(anomaly.entityName==="mlcategory"){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"view_examples",icon:"popout",onClick:function onClick(){_this2.closePopover();_this2.viewExamples()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"})))}if(canConfigureRules){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"create_rule",icon:"controlsHorizontal",onClick:function onClick(){_this2.closePopover();_this2.props.showRuleEditorFlyout(anomaly)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.configureRulesLabel",defaultMessage:"Configure rules"})))}return _react.default.createElement(_eui.EuiPopover,{id:"singlePanel",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},_react.default.createElement(_eui.EuiContextMenuPanel,{items:items}))}}]);return LinksMenu}(_react.Component),_defineProperty(_class,"propTypes",{anomaly:_propTypes.default.object.isRequired,showViewSeriesLink:_propTypes.default.bool,isAggregatedData:_propTypes.default.bool,interval:_propTypes.default.string,timefilter:_propTypes.default.object.isRequired,showRuleEditorFlyout:_propTypes.default.func}),_temp));exports.LinksMenu=LinksMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomalyDetails=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _date_utils=__webpack_require__(279);var _entity_cell=__webpack_require__(894);var _anomaly_utils=__webpack_require__(293);var _multi_bucket_impact=__webpack_require__(887);var _format_value=__webpack_require__(437);var _anomalies_table_constants=__webpack_require__(895);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TIME_FIELD_NAME="timestamp";function getFilterEntity(entityName,entityValue,filter){return _react.default.createElement(_entity_cell.EntityCell,{entityName:entityName,entityValue:entityValue,filter:filter})}function getDetailsItems(anomaly,examples,filter){var source=anomaly.source;var causes=[];var sourceCauses=source.causes||[];var singleCauseByFieldName=undefined;var singleCauseByFieldValue=undefined;if(sourceCauses.length===1){if(sourceCauses[0].by_field_name!==undefined){singleCauseByFieldName=sourceCauses[0].by_field_name;singleCauseByFieldValue=sourceCauses[0].by_field_value}}else{causes=sourceCauses.map(function(cause){var simplified=_lodash.default.pick(cause,"typical","actual","probability");simplified.entityName=_lodash.default.has(cause,"by_field_name")?cause.by_field_name:cause.over_field_name;simplified.entityValue=_lodash.default.has(cause,"by_field_value")?cause.by_field_value:cause.over_field_value;return simplified})}var items=[];if(source.partition_field_value!==undefined){items.push({title:source.partition_field_name,description:getFilterEntity(source.partition_field_name,source.partition_field_value,filter)})}if(source.by_field_value!==undefined){items.push({title:source.by_field_name,description:getFilterEntity(source.by_field_name,source.by_field_value,filter)})}if(singleCauseByFieldName!==undefined){items.push({title:singleCauseByFieldName,description:getFilterEntity(singleCauseByFieldName,singleCauseByFieldValue,filter)})}if(source.over_field_value!==undefined){items.push({title:source.over_field_name,description:getFilterEntity(source.over_field_name,source.over_field_value,filter)})}var anomalyTime=source[TIME_FIELD_NAME];var timeDesc="".concat((0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyTime));if(source.bucket_span!==undefined){var anomalyEndTime=anomalyTime+source.bucket_span*1e3;timeDesc=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyTimeRangeLabel",{defaultMessage:"{anomalyTime} to {anomalyEndTime}",values:{anomalyTime:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyTime),anomalyEndTime:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyEndTime)}})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.timeTitle",{defaultMessage:"time"}),description:timeDesc});items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.functionTitle",{defaultMessage:"function"}),description:source.function!=="metric"?source.function:source.function_description});if(source.field_name!==undefined){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.fieldNameTitle",{defaultMessage:"fieldName"}),description:source.field_name})}var functionDescription=source.function_description||"";if(anomaly.actual!==undefined&&(0,_anomaly_utils.showActualForFunction)(functionDescription)===true){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.actualTitle",{defaultMessage:"actual"}),description:(0,_format_value.formatValue)(anomaly.actual,source.function,undefined,source)})}if(anomaly.typical!==undefined&&(0,_anomaly_utils.showTypicalForFunction)(functionDescription)===true){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.typicalTitle",{defaultMessage:"typical"}),description:(0,_format_value.formatValue)(anomaly.typical,source.function,undefined,source)})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.jobIdTitle",{defaultMessage:"job ID"}),description:anomaly.jobId});if(source.multi_bucket_impact!==undefined&&source.multi_bucket_impact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.LOW){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multiBucketImpactTitle",{defaultMessage:"multi-bucket impact"}),description:(0,_anomaly_utils.getMultiBucketImpactLabel)(source.multi_bucket_impact)})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.probabilityTitle",{defaultMessage:"probability"}),description:source.probability});if(causes.length>1){causes.forEach(function(cause,index){var title=index===0?_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesTitle",{defaultMessage:"{causeEntityName} values",values:{causeEntityName:cause.entityName}}):"";var description=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesDescription",{defaultMessage:"{causeEntityValue} (actual {actualValue}, "+"typical {typicalValue}, probability {probabilityValue})",values:{causeEntityValue:cause.entityValue,actualValue:(0,_format_value.formatValue)(cause.actual,source.function),typicalValue:(0,_format_value.formatValue)(cause.typical,source.function),probabilityValue:cause.probability}});items.push({title:title,description:description})})}return items}function getInfluencersItems(anomalyInfluencers,influencerFilter,numToDisplay){var items=[];var _loop=function _loop(i){Object.keys(anomalyInfluencers[i]).forEach(function(influencerFieldName){var value=anomalyInfluencers[i][influencerFieldName];items.push({title:influencerFieldName,description:getFilterEntity(influencerFieldName,value,influencerFilter)})})};for(var i=0;i<numToDisplay;i++){_loop(i)}return items}var AnomalyDetails=function(_Component){_inherits(AnomalyDetails,_Component);function AnomalyDetails(props){var _this;_classCallCheck(this,AnomalyDetails);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnomalyDetails).call(this,props));_this.state={showAllInfluencers:false};if(_this.props.examples!==undefined&&_this.props.examples.length>0){_this.tabs=[{id:"Details",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detailsTitle",{defaultMessage:"Details"}),content:_react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{className:"ml-anomalies-table-details"},_this.renderDescription(),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_this.renderDetails(),_this.renderInfluencers()))},{id:"Category examples",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.categoryExamplesTitle",{defaultMessage:"Category examples"}),content:_react.default.createElement(_react.Fragment,null,_this.renderCategoryExamples())}]}return _this}_createClass(AnomalyDetails,[{key:"toggleAllInfluencers",value:function toggleAllInfluencers(){this.setState({showAllInfluencers:!this.state.showAllInfluencers})}},{key:"renderCategoryExamples",value:function renderCategoryExamples(){var _this$props=this.props,examples=_this$props.examples,definition=_this$props.definition;return _react.default.createElement(_eui.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"m",className:"mlAnomalyCategoryExamples"},definition!==undefined&&definition.terms&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{key:"example-terms"},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsTitle",{defaultMessage:"Terms"}))," ",_react.default.createElement(_eui.EuiIconTip,{"aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionTooltip",defaultMessage:"A space separated list of the common tokens that are matched in values of the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:_anomalies_table_constants.MAX_CHARS}})})),_react.default.createElement(_eui.EuiText,{size:"xs"},definition.terms)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"})),definition!==undefined&&definition.regex&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{key:"example-regex"},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexTitle",{defaultMessage:"Regex"}))," ",_react.default.createElement(_eui.EuiIconTip,{"aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionTooltip",defaultMessage:"The regular expression that is used to search for values that match the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:_anomalies_table_constants.MAX_CHARS}})})),_react.default.createElement(_eui.EuiText,{size:"xs"},definition.regex)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"})),examples.map(function(example,i){return _react.default.createElement(_eui.EuiFlexItem,{key:"example".concat(i)},i===0&&definition!==undefined&&_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("h4",null,_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.examplesTitle",{defaultMessage:"Examples"}))),_react.default.createElement("span",{className:"mlAnomalyCategoryExamples__item"},example))}))}},{key:"renderDescription",value:function renderDescription(){var anomaly=this.props.anomaly;var source=anomaly.source;var anomalyDescription=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyInLabel",{defaultMessage:"{anomalySeverity} anomaly in {anomalyDetector}",values:{anomalySeverity:(0,_anomaly_utils.getSeverity)(anomaly.severity).label,anomalyDetector:anomaly.detector}});if(anomaly.entityName!==undefined){anomalyDescription+=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.foundForLabel",{defaultMessage:" found for {anomalyEntityName} {anomalyEntityValue}",values:{anomalyEntityName:anomaly.entityName,anomalyEntityValue:anomaly.entityValue}})}if(source.partition_field_name!==undefined&&source.partition_field_name!==anomaly.entityName){anomalyDescription+=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detectedInLabel",{defaultMessage:" detected in {sourcePartitionFieldName} {sourcePartitionFieldValue}",values:{sourcePartitionFieldName:source.partition_field_name,sourcePartitionFieldValue:source.partition_field_value}})}var mvDescription=undefined;if(source.correlated_by_field_value!==undefined){mvDescription=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multivariateDescription",{defaultMessage:"multivariate correlations found in {sourceByFieldName}; "+"{sourceByFieldValue} is considered anomalous given {sourceCorrelatedByFieldValue}",values:{sourceByFieldName:source.by_field_name,sourceByFieldValue:source.by_field_value,sourceCorrelatedByFieldValue:source.correlated_by_field_value}})}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.descriptionTitle",defaultMessage:"Description"})),anomalyDescription),mvDescription!==undefined&&_react.default.createElement(_eui.EuiText,{size:"xs"},mvDescription))}},{key:"renderDetails",value:function renderDetails(){var detailItems=getDetailsItems(this.props.anomaly,this.props.examples,this.props.filter);var isInterimResult=_lodash.default.get(this.props.anomaly,"source.is_interim",false);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,{size:"xs"},this.props.isAggregatedData===true?_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.detailsOnHighestSeverityAnomalyTitle",defaultMessage:"Details on highest severity anomaly"})):_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDetailsTitle",defaultMessage:"Anomaly details"})),isInterimResult===true&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiIcon,{type:"alert"}),_react.default.createElement("span",{className:"interim-result"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.interimResultLabel",defaultMessage:"Interim result"})))),_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:detailItems,className:"anomaly-description-list"}))}},{key:"renderInfluencers",value:function renderInfluencers(){var _this2=this;var anomalyInfluencers=this.props.anomaly.influencers;var listItems=[];var othersCount=0;var numToDisplay=0;if(anomalyInfluencers!==undefined){numToDisplay=this.state.showAllInfluencers===true?anomalyInfluencers.length:Math.min(this.props.influencersLimit,anomalyInfluencers.length);othersCount=Math.max(anomalyInfluencers.length-numToDisplay,0);if(othersCount===1){numToDisplay++;othersCount=0}listItems=getInfluencersItems(anomalyInfluencers,this.props.influencerFilter,numToDisplay)}if(listItems.length>0){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.influencersTitle",defaultMessage:"Influencers"}))),_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:listItems,className:"anomaly-description-list"}),othersCount>0&&_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionListMoreLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}})),numToDisplay>this.props.influencersLimit+1&&_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionShowLessLinkText",defaultMessage:"show less"})))}}},{key:"render",value:function render(){var tabIndex=this.props.tabIndex;if(this.tabs!==undefined){return _react.default.createElement(_eui.EuiTabbedContent,{tabs:this.tabs,size:"s",initialSelectedTab:this.tabs[tabIndex],onTabClick:function onTabClick(){}})}else{return _react.default.createElement("div",{className:"ml-anomalies-table-details"},this.renderDescription(),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers())}}}]);return AnomalyDetails}(_react.Component);exports.AnomalyDetails=AnomalyDetails;_defineProperty(AnomalyDetails,"propTypes",{anomaly:_propTypes.default.object.isRequired,examples:_propTypes.default.array,definition:_propTypes.default.object,isAggregatedData:_propTypes.default.bool,filter:_propTypes.default.func,influencersLimit:_propTypes.default.number,influencerFilter:_propTypes.default.func,tabIndex:_propTypes.default.number.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"RuleEditorFlyout",{enumerable:true,get:function get(){return _rule_editor_flyout.RuleEditorFlyout}});var _rule_editor_flyout=__webpack_require__(3032)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RuleEditorFlyout=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _notify=__webpack_require__(14);var _detector_description_list=__webpack_require__(1384);var _actions_section=__webpack_require__(3034);var _check_privilege=__webpack_require__(39);var _conditions_section=__webpack_require__(3035);var _scope_section=__webpack_require__(3037);var _select_rule_action=__webpack_require__(3039);var _utils=__webpack_require__(502);var _detector_rule=__webpack_require__(435);var _job_utils=__webpack_require__(58);var _job_service=__webpack_require__(36);var _ml_api_service=__webpack_require__(24);var _metadata=__webpack_require__(241);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var docsUrl="https://www.elastic.co/guide/en/elastic-stack-overview/".concat(_metadata.metadata.branch,"/ml-rules.html");var RuleEditorFlyout=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(RuleEditorFlyout,_Component);function RuleEditorFlyout(props){var _this;_classCallCheck(this,RuleEditorFlyout);_this=_possibleConstructorReturn(this,_getPrototypeOf(RuleEditorFlyout).call(this,props));_defineProperty(_assertThisInitialized(_this),"showFlyout",function(anomaly){var ruleIndex=-1;var intl=_this.props.intl;var job=_job_service.mlJobService.getJob(anomaly.jobId);if(job===undefined){_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.unableToConfigureRulesNotificationMesssage",defaultMessage:"Unable to configure rules as an error occurred obtaining details for job ID {jobId}"},{jobId:anomaly.jobId}));_this.setState({job:job,isFlyoutVisible:false});return}_this.partitioningFieldNames=(0,_job_utils.getPartitioningFieldNames)(job,anomaly.detectorIndex);var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];if(detector.custom_rules===undefined){ruleIndex=0}var isConditionsEnabled=false;if(ruleIndex===0){isConditionsEnabled=_this.partitioningFieldNames.length===0}_this.setState({anomaly:anomaly,job:job,ruleIndex:ruleIndex,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:false,isFlyoutVisible:true});if(_this.partitioningFieldNames.length>0&&_this.canGetFilters){_ml_api_service.ml.filters.filters().then(function(filters){var filterListIds=filters.map(function(filter){return filter.filter_id});_this.setState({filterListIds:filterListIds})}).catch(function(resp){console.log("Error loading list of filters:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithLoadingFilterListsNotificationMesssage",defaultMessage:"Error loading the filter lists used in the rule scope"}))})}});_defineProperty(_assertThisInitialized(_this),"closeFlyout",function(){_this.setState({isFlyoutVisible:false})});_defineProperty(_assertThisInitialized(_this),"setEditRuleIndex",function(ruleIndex){var detectorIndex=_this.state.anomaly.detectorIndex;var detector=_this.state.job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules;var rule=rules===undefined||ruleIndex>=rules.length?(0,_utils.getNewRuleDefaults)():rules[ruleIndex];var isConditionsEnabled=_this.partitioningFieldNames.length===0||rule.conditions!==undefined&&rule.conditions.length>0;var isScopeEnabled=rule.scope!==undefined&&Object.keys(rule.scope).length>0;if(isScopeEnabled===true){Object.keys(rule.scope).forEach(function(field){rule.scope[field].enabled=true})}_this.setState({ruleIndex:ruleIndex,rule:rule,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:isScopeEnabled})});_defineProperty(_assertThisInitialized(_this),"onSkipResultChange",function(e){var checked=e.target.checked;_this.setState(function(prevState){var actions=_toConsumableArray(prevState.rule.actions);var idx=actions.indexOf(_detector_rule.ACTION.SKIP_RESULT);if(idx===-1&&checked){actions.push(_detector_rule.ACTION.SKIP_RESULT)}else if(idx>-1&&!checked){actions.splice(idx,1)}return{rule:_objectSpread({},prevState.rule,{actions:actions})}})});_defineProperty(_assertThisInitialized(_this),"onSkipModelUpdateChange",function(e){var checked=e.target.checked;_this.setState(function(prevState){var actions=_toConsumableArray(prevState.rule.actions);var idx=actions.indexOf(_detector_rule.ACTION.SKIP_MODEL_UPDATE);if(idx===-1&&checked){actions.push(_detector_rule.ACTION.SKIP_MODEL_UPDATE)}else if(idx>-1&&!checked){actions.splice(idx,1)}return{rule:_objectSpread({},prevState.rule,{actions:actions})}})});_defineProperty(_assertThisInitialized(_this),"onConditionsEnabledChange",function(e){var isConditionsEnabled=e.target.checked;_this.setState(function(prevState){var conditions;if(isConditionsEnabled===false){conditions=[]}else{conditions=[(0,_utils.getNewConditionDefaults)()]}return{rule:_objectSpread({},prevState.rule,{conditions:conditions}),isConditionsEnabled:isConditionsEnabled}})});_defineProperty(_assertThisInitialized(_this),"addCondition",function(){_this.setState(function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);conditions.push((0,_utils.getNewConditionDefaults)());return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}})});_defineProperty(_assertThisInitialized(_this),"updateCondition",function(index,appliesTo,operator,value){_this.setState(function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);if(index<conditions.length){conditions[index]={applies_to:appliesTo,operator:operator,value:value}}return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}})});_defineProperty(_assertThisInitialized(_this),"deleteCondition",function(index){_this.setState(function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);if(index<conditions.length){conditions.splice(index,1)}return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}})});_defineProperty(_assertThisInitialized(_this),"onScopeEnabledChange",function(e){var isScopeEnabled=e.target.checked;_this.setState(function(prevState){var rule=_objectSpread({},prevState.rule);if(isScopeEnabled===false){delete rule.scope}return{rule:rule,isScopeEnabled:isScopeEnabled}})});_defineProperty(_assertThisInitialized(_this),"updateScope",function(fieldName,filterId,filterType,enabled){_this.setState(function(prevState){var scope=_objectSpread({},prevState.rule.scope);if(scope===undefined){scope={}}scope[fieldName]={filter_id:filterId,filter_type:filterType,enabled:enabled};return{rule:_objectSpread({},prevState.rule,{scope:scope})}})});_defineProperty(_assertThisInitialized(_this),"saveEdit",function(){var _this$state=_this.state,rule=_this$state.rule,ruleIndex=_this$state.ruleIndex;_this.updateRuleAtIndex(ruleIndex,rule)});_defineProperty(_assertThisInitialized(_this),"updateRuleAtIndex",function(ruleIndex,editedRule){var intl=_this.props.intl;var _this$state2=_this.state,job=_this$state2.job,anomaly=_this$state2.anomaly;var jobId=job.job_id;var detectorIndex=anomaly.detectorIndex;(0,_utils.saveJobRule)(job,detectorIndex,ruleIndex,editedRule).then(function(resp){if(resp.success){_notify.toastNotifications.add({title:intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageTitle",defaultMessage:"Changes to {jobId} detector rules saved"},{jobId:jobId}),color:"success",iconType:"check",text:intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageDescription",defaultMessage:"Note that changes will take effect for new results only."})});_this.closeFlyout()}else{_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",defaultMessage:"Error saving changes to {jobId} detector rules"},{jobId:jobId}))}}).catch(function(error){console.error(error);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",defaultMessage:"Error saving changes to {jobId} detector rules"},{jobId:jobId}))})});_defineProperty(_assertThisInitialized(_this),"deleteRuleAtIndex",function(index){var intl=_this.props.intl;var _this$state3=_this.state,job=_this$state3.job,anomaly=_this$state3.anomaly;var jobId=job.job_id;var detectorIndex=anomaly.detectorIndex;(0,_utils.deleteJobRule)(job,detectorIndex,index).then(function(resp){if(resp.success){_notify.toastNotifications.addSuccess(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.ruleDeletedFromJobDetectorNotificationMessage",defaultMessage:"Rule deleted from {jobId} detector"},{jobId:jobId}));_this.closeFlyout()}else{_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",defaultMessage:"Error deleting rule from {jobId} detector"},{jobId:jobId}))}}).catch(function(error){console.error(error);var errorMessage=intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",defaultMessage:"Error deleting rule from {jobId} detector"},{jobId:jobId});if(error.message){errorMessage+=" : ".concat(error.message)}_notify.toastNotifications.addDanger(errorMessage)})});_defineProperty(_assertThisInitialized(_this),"addItemToFilterList",function(item,filterId,closeFlyoutOnAdd){var intl=_this.props.intl;(0,_utils.addItemToFilter)(item,filterId).then(function(){if(closeFlyoutOnAdd===true){_notify.toastNotifications.add({title:intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageTitle",defaultMessage:"Added {item} to {filterId}"},{item:item,filterId:filterId}),color:"success",iconType:"check",text:intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageDescription",defaultMessage:"Note that changes will take effect for new results only."})});_this.closeFlyout()}}).catch(function(error){console.log("Error adding ".concat(item," to filter ").concat(filterId,":"),error);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.errorWithAddingItemToFilterListNotificationMessage",defaultMessage:"An error occurred adding {item} to filter {filterId}"},{item:item,filterId:filterId}))})});_this.state={anomaly:{},job:{},ruleIndex:-1,rule:(0,_utils.getNewRuleDefaults)(),skipModelUpdate:false,isConditionsEnabled:false,isScopeEnabled:false,filterListIds:[],isFlyoutVisible:false};_this.partitioningFieldNames=[];_this.canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");return _this}_createClass(RuleEditorFlyout,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showFlyout)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"render",value:function render(){var intl=this.props.intl;var _this$state4=this.state,isFlyoutVisible=_this$state4.isFlyoutVisible,job=_this$state4.job,anomaly=_this$state4.anomaly,ruleIndex=_this$state4.ruleIndex,rule=_this$state4.rule,filterListIds=_this$state4.filterListIds,isConditionsEnabled=_this$state4.isConditionsEnabled,isScopeEnabled=_this$state4.isScopeEnabled;if(isFlyoutVisible===false){return null}var flyout;if(ruleIndex===-1){flyout=_react.default.createElement(_eui.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",{id:"flyoutTitle"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRulesTitle",defaultMessage:"Edit Rules"})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_select_rule_action.SelectRuleAction,{job:job,anomaly:anomaly,setEditRuleIndex:this.setEditRuleIndex,updateRuleAtIndex:this.updateRuleAtIndex,deleteRuleAtIndex:this.deleteRuleAtIndex,addItemToFilterList:this.addItemToFilterList})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))))))}else{var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules;var isCreate=rules===undefined||ruleIndex>=rules.length;var hasPartitioningFields=this.partitioningFieldNames&&this.partitioningFieldNames.length>0;var conditionSupported=_detector_rule.CONDITIONS_NOT_SUPPORTED_FUNCTIONS.indexOf(anomaly.source.function)===-1;var conditionsText=intl.formatMessage({id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsDescription",defaultMessage:"Add numeric conditions for when the rule applies. Multiple conditions are combined using AND."});flyout=_react.default.createElement(_eui.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",{id:"flyoutTitle"},isCreate===true?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.createRuleTitle",defaultMessage:"Create Rule"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRuleTitle",defaultMessage:"Edit Rule"})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_detector_description_list.DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription",defaultMessage:"Rules instruct anomaly detectors to change their behavior based on domain-specific knowledge that you provide. When you create a rule, you can specify conditions, scope, and actions. When the conditions of a rule are satisfied, its actions are triggered. {learnMoreLink}",values:{learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}}))),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.actionTitle",defaultMessage:"Action"}))),_react.default.createElement(_actions_section.ActionsSection,{actions:rule.actions,onSkipResultChange:this.onSkipResultChange,onSkipModelUpdateChange:this.onSkipModelUpdateChange}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsTitle",defaultMessage:"Conditions"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),conditionSupported===true?_react.default.createElement(_eui.EuiCheckbox,{id:"enable_conditions_checkbox",className:"scope-enable-checkbox",label:conditionsText,checked:isConditionsEnabled,onChange:this.onConditionsEnabledChange,disabled:!conditionSupported||!hasPartitioningFields}):_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsNotSupportedTitle",defaultMessage:"Conditions are not supported for detectors using the {functionName} function",values:{functionName:anomaly.source.function}}),iconType:"iInCircle"}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_conditions_section.ConditionsSection,{isEnabled:isConditionsEnabled,conditions:rule.conditions,addCondition:this.addCondition,updateCondition:this.updateCondition,deleteCondition:this.deleteCondition}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_scope_section.ScopeSection,{isEnabled:isScopeEnabled,onEnabledChange:this.onScopeEnabledChange,partitioningFieldNames:this.partitioningFieldNames,filterListIds:filterListIds,scope:rule.scope,updateScope:this.updateScope}),_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rerunJobTitle",defaultMessage:"Rerun job"}),color:"warning",iconType:"help"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.whenChangesTakeEffectDescription",defaultMessage:"Changes to rules take effect for new results only."})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.howToApplyChangesToExistingResultsDescription",defaultMessage:"To apply these changes to existing results you must clone and rerun the job. Note rerunning the job may take some time and should only be done once you have completed all your changes to the rules for this job."})))),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.saveEdit,isDisabled:!(0,_utils.isValidRule)(rule),fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return _react.default.createElement(_react.default.Fragment,null,flyout)}}]);return RuleEditorFlyout}(_react.Component),_defineProperty(_class,"propTypes",{setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired}),_temp));exports.RuleEditorFlyout=RuleEditorFlyout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorDescriptionList=DetectorDescriptionList;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _format_value=__webpack_require__(437);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DetectorDescriptionList(_ref){var job=_ref.job,detector=_ref.detector,anomaly=_ref.anomaly;var listItems=[{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:job.job_id},{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.detectorTitle",defaultMessage:"Detector"}),description:detector.detector_description}];if(anomaly.actual!==undefined){var actual=(0,_format_value.formatValue)(anomaly.actual,anomaly.source.function);var typical=(0,_format_value.formatValue)(anomaly.typical,anomaly.source.function);listItems.push({title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyTitle",defaultMessage:"Selected anomaly"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyDescription",defaultMessage:"actual {actual}, typical {typical}",values:{actual:actual,typical:typical}})})}return _react.default.createElement(_eui.EuiDescriptionList,{className:"rule-detector-description-list",type:"column",listItems:listItems})}DetectorDescriptionList.propTypes={job:_propTypes.default.object.isRequired,detector:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionsSection=ActionsSection;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _detector_rule=__webpack_require__(435);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ActionsSection(_ref){var actions=_ref.actions,onSkipResultChange=_ref.onSkipResultChange,onSkipModelUpdateChange=_ref.onSkipModelUpdateChange;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.chooseActionsDescription",defaultMessage:"Choose the action(s) to take when the rule matches an anomaly."}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"skip_result_cb",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipResultLabel",defaultMessage:"Skip result (recommended)"}),checked:actions.indexOf(_detector_rule.ACTION.SKIP_RESULT)>-1,onChange:onSkipResultChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.resultWillNotBeCreatedTooltip",defaultMessage:"The result will not be created."}),size:"s",position:"right"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"skip_model_update_cb",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipModelUpdateLabel",defaultMessage:"Skip model update"}),checked:actions.indexOf(_detector_rule.ACTION.SKIP_MODEL_UPDATE)>-1,onChange:onSkipModelUpdateChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.valueWillNotBeUsedToUpdateModelTooltip",defaultMessage:"The value for that series will not be used to update the model."}),size:"s",position:"right"}))))}ActionsSection.propTypes={actions:_propTypes.default.array.isRequired,onSkipResultChange:_propTypes.default.func.isRequired,onSkipModelUpdateChange:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConditionsSection=ConditionsSection;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _condition_expression=__webpack_require__(3036);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ConditionsSection(_ref){var isEnabled=_ref.isEnabled,conditions=_ref.conditions,addCondition=_ref.addCondition,updateCondition=_ref.updateCondition,deleteCondition=_ref.deleteCondition;if(isEnabled===false){return null}var expressions=[];if(conditions!==undefined){expressions=conditions.map(function(condition,index){return _react.default.createElement(_condition_expression.ConditionExpression,{key:index,index:index,appliesTo:condition.applies_to,operator:condition.operator,value:condition.value,updateCondition:updateCondition,deleteCondition:deleteCondition})})}return _react.default.createElement(_react.default.Fragment,null,expressions,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiButtonEmpty,{onClick:function onClick(){return addCondition()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionsSection.addNewConditionButtonLabel",defaultMessage:"Add new condition"})))}ConditionsSection.propTypes={isEnabled:_propTypes.default.bool.isRequired,conditions:_propTypes.default.array,addCondition:_propTypes.default.func.isRequired,updateCondition:_propTypes.default.func.isRequired,deleteCondition:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConditionExpression=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _detector_rule=__webpack_require__(435);var _utils=__webpack_require__(502);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var POPOVER_STYLE={zIndex:"200"};var ConditionExpression=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(ConditionExpression,_Component);function ConditionExpression(props){var _this;_classCallCheck(this,ConditionExpression);_this=_possibleConstructorReturn(this,_getPrototypeOf(ConditionExpression).call(this,props));_defineProperty(_assertThisInitialized(_this),"openAppliesTo",function(){_this.setState({isAppliesToOpen:true,isOperatorValueOpen:false})});_defineProperty(_assertThisInitialized(_this),"closeAppliesTo",function(){_this.setState({isAppliesToOpen:false})});_defineProperty(_assertThisInitialized(_this),"openOperatorValue",function(){_this.setState({isAppliesToOpen:false,isOperatorValueOpen:true})});_defineProperty(_assertThisInitialized(_this),"closeOperatorValue",function(){_this.setState({isOperatorValueOpen:false})});_defineProperty(_assertThisInitialized(_this),"changeAppliesTo",function(event){var _this$props=_this.props,index=_this$props.index,operator=_this$props.operator,value=_this$props.value,updateCondition=_this$props.updateCondition;updateCondition(index,event.target.value,operator,value)});_defineProperty(_assertThisInitialized(_this),"changeOperator",function(event){var _this$props2=_this.props,index=_this$props2.index,appliesTo=_this$props2.appliesTo,value=_this$props2.value,updateCondition=_this$props2.updateCondition;updateCondition(index,appliesTo,event.target.value,value)});_defineProperty(_assertThisInitialized(_this),"changeValue",function(event){var _this$props3=_this.props,index=_this$props3.index,appliesTo=_this$props3.appliesTo,operator=_this$props3.operator,updateCondition=_this$props3.updateCondition;updateCondition(index,appliesTo,operator,+event.target.value)});_this.state={isAppliesToOpen:false,isOperatorValueOpen:false};return _this}_createClass(ConditionExpression,[{key:"renderAppliesToPopover",value:function renderAppliesToPopover(){return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToPopoverTitle",defaultMessage:"When"})),_react.default.createElement("div",{className:"euiExpression",style:{width:200}},_react.default.createElement(_eui.EuiSelect,{value:this.props.appliesTo,onChange:this.changeAppliesTo,options:[{value:_detector_rule.APPLIES_TO.ACTUAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.ACTUAL)},{value:_detector_rule.APPLIES_TO.TYPICAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.TYPICAL)},{value:_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL)}]})))}},{key:"renderOperatorValuePopover",value:function renderOperatorValuePopover(){return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValuePopoverTitle",defaultMessage:"Is"})),_react.default.createElement("div",{className:"euiExpression"},_react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:450}},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:250}},_react.default.createElement(_eui.EuiSelect,{value:this.props.operator,onChange:this.changeOperator,options:[{value:_detector_rule.OPERATOR.LESS_THAN,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.LESS_THAN)},{value:_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL)},{value:_detector_rule.OPERATOR.GREATER_THAN,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.GREATER_THAN)},{value:_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL)}]})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:200}},_react.default.createElement(_eui.EuiFieldNumber,{value:+this.props.value,onChange:this.changeValue})))))}},{key:"render",value:function render(){var _this$props4=this.props,index=_this$props4.index,appliesTo=_this$props4.appliesTo,operator=_this$props4.operator,value=_this$props4.value,deleteCondition=_this$props4.deleteCondition;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"appliesToPopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToButtonLabel",defaultMessage:"when"}),value:(0,_utils.appliesToText)(appliesTo),isActive:this.state.isAppliesToOpen,onClick:this.openAppliesTo}),isOpen:this.state.isAppliesToOpen,closePopover:this.closeAppliesTo,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderAppliesToPopover())),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"operatorValuePopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValueButtonLabel",defaultMessage:"is {operator}",values:{operator:(0,_utils.operatorToText)(operator)}}),value:"".concat(value),isActive:this.state.isOperatorValueOpen,onClick:this.openOperatorValue}),isOpen:this.state.isOperatorValueOpen,closePopover:this.closeOperatorValue,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderOperatorValuePopover())),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"danger",onClick:function onClick(){return deleteCondition(index)},iconType:"trash","aria-label":this.props.intl.formatMessage({id:"xpack.ml.ruleEditor.conditionExpression.deleteConditionButtonAriaLabel",defaultMessage:"Delete condition"})})))}}]);return ConditionExpression}(_react.Component),_defineProperty(_class,"propTypes",{index:_propTypes.default.number.isRequired,appliesTo:_propTypes.default.oneOf([_detector_rule.APPLIES_TO.ACTUAL,_detector_rule.APPLIES_TO.TYPICAL,_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL]),operator:_propTypes.default.oneOf([_detector_rule.OPERATOR.LESS_THAN,_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL,_detector_rule.OPERATOR.GREATER_THAN,_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL]),value:_propTypes.default.number.isRequired,updateCondition:_propTypes.default.func.isRequired,deleteCondition:_propTypes.default.func.isRequired}),_temp));exports.ConditionExpression=ConditionExpression},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScopeSection=ScopeSection;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _scope_expression=__webpack_require__(3038);var _check_privilege=__webpack_require__(39);var _utils=__webpack_require__(502);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NoFilterListsCallOut(){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noFilterListsConfiguredTitle",defaultMessage:"No filter lists configured"}),iconType:"gear"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription",defaultMessage:"To configure scope, you must first use the {filterListsLink} settings page to create the list of values you want to include or exclude in the rule.",values:{filterListsLink:_react.default.createElement(_eui.EuiLink,{href:"#/settings/filter_lists"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription.filterListsLinkText",defaultMessage:"Filter Lists"}))}})))}function NoPermissionCallOut(){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noPermissionToViewFilterListsTitle",defaultMessage:"You do not have permission to view filter lists"}),iconType:"gear"})}function ScopeSection(_ref){var isEnabled=_ref.isEnabled,onEnabledChange=_ref.onEnabledChange,partitioningFieldNames=_ref.partitioningFieldNames,filterListIds=_ref.filterListIds,scope=_ref.scope,updateScope=_ref.updateScope;var canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");if(partitioningFieldNames===null||partitioningFieldNames.length===0){return null}var content;if(filterListIds.length>0){content=partitioningFieldNames.map(function(fieldName,index){var filterValues;if(scope!==undefined&&scope[fieldName]!==undefined){filterValues=scope[fieldName]}else{filterValues=(0,_utils.getScopeFieldDefaults)(filterListIds)}return _react.default.createElement(_scope_expression.ScopeExpression,{key:index,fieldName:fieldName,filterId:filterValues.filter_id,filterType:filterValues.filter_type,enabled:filterValues.enabled,filterListIds:filterListIds,updateScope:updateScope})})}else if(canGetFilters===false){content=_react.default.createElement(NoPermissionCallOut,null)}else{content=_react.default.createElement(NoFilterListsCallOut,null)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.scopeTitle",defaultMessage:"Scope"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiCheckbox,{id:"enable_scope_checkbox",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.addFilterListLabel",defaultMessage:"Add a filter list to limit where the rule applies."}),checked:isEnabled,onChange:onEnabledChange}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),isEnabled&&_react.default.createElement(_react.default.Fragment,null,content),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}))}ScopeSection.propTypes={isEnabled:_propTypes.default.bool.isRequired,onEnabledChange:_propTypes.default.func.isRequired,partitioningFieldNames:_propTypes.default.array.isRequired,filterListIds:_propTypes.default.array.isRequired,scope:_propTypes.default.object,updateScope:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScopeExpression=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _detector_rule=__webpack_require__(435);var _utils=__webpack_require__(502);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var POPOVER_STYLE={zIndex:"200"};function getFilterListOptions(filterListIds){return filterListIds.map(function(filterId){return{value:filterId,text:filterId}})}var ScopeExpression=function(_Component){_inherits(ScopeExpression,_Component);function ScopeExpression(props){var _this;_classCallCheck(this,ScopeExpression);_this=_possibleConstructorReturn(this,_getPrototypeOf(ScopeExpression).call(this,props));_defineProperty(_assertThisInitialized(_this),"openFilterList",function(){_this.setState({isFilterListOpen:true})});_defineProperty(_assertThisInitialized(_this),"closeFilterList",function(){_this.setState({isFilterListOpen:false})});_defineProperty(_assertThisInitialized(_this),"onChangeFilterType",function(event){var _this$props=_this.props,fieldName=_this$props.fieldName,filterId=_this$props.filterId,enabled=_this$props.enabled,updateScope=_this$props.updateScope;updateScope(fieldName,filterId,event.target.value,enabled)});_defineProperty(_assertThisInitialized(_this),"onChangeFilterId",function(event){var _this$props2=_this.props,fieldName=_this$props2.fieldName,filterType=_this$props2.filterType,enabled=_this$props2.enabled,updateScope=_this$props2.updateScope;updateScope(fieldName,event.target.value,filterType,enabled)});_defineProperty(_assertThisInitialized(_this),"onEnableChange",function(event){var _this$props3=_this.props,fieldName=_this$props3.fieldName,filterId=_this$props3.filterId,filterType=_this$props3.filterType,updateScope=_this$props3.updateScope;updateScope(fieldName,filterId,filterType,event.target.checked)});_this.state={isFilterListOpen:false};return _this}_createClass(ScopeExpression,[{key:"renderFilterListPopover",value:function renderFilterListPopover(){var _this$props4=this.props,filterId=_this$props4.filterId,filterType=_this$props4.filterType,filterListIds=_this$props4.filterListIds;return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypePopoverTitle",defaultMessage:"Is"})),_react.default.createElement("div",{className:"euiExpression"},_react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:450}},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:150}},_react.default.createElement(_eui.EuiSelect,{value:filterType,onChange:this.onChangeFilterType,options:[{value:_detector_rule.FILTER_TYPE.INCLUDE,text:(0,_utils.filterTypeToText)(_detector_rule.FILTER_TYPE.INCLUDE)},{value:_detector_rule.FILTER_TYPE.EXCLUDE,text:(0,_utils.filterTypeToText)(_detector_rule.FILTER_TYPE.EXCLUDE)}]})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:300}},_react.default.createElement(_eui.EuiSelect,{value:filterId,onChange:this.onChangeFilterId,options:getFilterListOptions(filterListIds)})))))}},{key:"render",value:function render(){var _this$props5=this.props,fieldName=_this$props5.fieldName,filterId=_this$props5.filterId,filterType=_this$props5.filterType,enabled=_this$props5.enabled,filterListIds=_this$props5.filterListIds;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"scope-field-checkbox"},_react.default.createElement(_eui.EuiCheckbox,{id:"scope_cb_".concat(fieldName),checked:enabled,onChange:this.onEnableChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiExpression,{className:"scope-field-button",description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFieldWhenLabel",defaultMessage:"when"}),value:fieldName,isActive:false,onClick:function onClick(event){return event.preventDefault()}})),filterListIds!==undefined&&filterListIds.length>0&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"operatorValuePopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypeButtonLabel",defaultMessage:"is {filterType}",values:{filterType:(0,_utils.filterTypeToText)(filterType)}}),value:filterId||"",isActive:this.state.isFilterListOpen,onClick:this.openFilterList}),isOpen:this.state.isFilterListOpen,closePopover:this.closeFilterList,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderFilterListPopover())))}}]);return ScopeExpression}(_react.Component);exports.ScopeExpression=ScopeExpression;ScopeExpression.propTypes={fieldName:_propTypes.default.string.isRequired,filterId:_propTypes.default.string,filterType:_propTypes.default.oneOf([_detector_rule.FILTER_TYPE.INCLUDE,_detector_rule.FILTER_TYPE.EXCLUDE]),enabled:_propTypes.default.bool.isRequired,filterListIds:_propTypes.default.array.isRequired,updateScope:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SelectRuleAction",{enumerable:true,get:function get(){return _select_rule_action.SelectRuleAction}});var _select_rule_action=__webpack_require__(3040)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectRuleAction=SelectRuleAction;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _detector_description_list=__webpack_require__(1384);var _rule_action_panel=__webpack_require__(3041);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SelectRuleAction(_ref){var job=_ref.job,anomaly=_ref.anomaly,setEditRuleIndex=_ref.setEditRuleIndex,updateRuleAtIndex=_ref.updateRuleAtIndex,deleteRuleAtIndex=_ref.deleteRuleAtIndex,addItemToFilterList=_ref.addItemToFilterList;var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules||[];var ruleActionPanels;if(rules.length>0){ruleActionPanels=rules.map(function(rule,index){return _react.default.createElement(_react.default.Fragment,{key:"rule_panel_".concat(index)},_react.default.createElement(_rule_action_panel.RuleActionPanel,{job:job,ruleIndex:index,anomaly:anomaly,setEditRuleIndex:setEditRuleIndex,updateRuleAtIndex:updateRuleAtIndex,deleteRuleAtIndex:deleteRuleAtIndex,addItemToFilterList:addItemToFilterList}),_react.default.createElement(_eui.EuiSpacer,{size:"l"}))})}return _react.default.createElement("div",{className:"select-rule-action"},rules.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_detector_description_list.DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),ruleActionPanels,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,{style:{display:"inline"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.orText",defaultMessage:"or "}))),_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setEditRuleIndex(rules.length)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.createRuleLinkText",defaultMessage:"create a rule"})))}SelectRuleAction.propTypes={job:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired,setEditRuleIndex:_propTypes.default.func.isRequired,updateRuleAtIndex:_propTypes.default.func.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RuleActionPanel=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _lodash=__webpack_require__(3);var _add_to_filter_list_link=__webpack_require__(3042);var _delete_rule_modal=__webpack_require__(3043);var _edit_condition_link=__webpack_require__(3044);var _utils=__webpack_require__(502);var _ml_api_service=__webpack_require__(24);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var RuleActionPanel=function(_Component){_inherits(RuleActionPanel,_Component);function RuleActionPanel(props){var _this;_classCallCheck(this,RuleActionPanel);_this=_possibleConstructorReturn(this,_getPrototypeOf(RuleActionPanel).call(this,props));_defineProperty(_assertThisInitialized(_this),"getEditRuleLink",function(){var _this$props=_this.props,ruleIndex=_this$props.ruleIndex,setEditRuleIndex=_this$props.setEditRuleIndex;return _react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setEditRuleIndex(ruleIndex)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.editRuleLinkText",defaultMessage:"Edit rule"}))});_defineProperty(_assertThisInitialized(_this),"getDeleteRuleLink",function(){var _this$props2=_this.props,ruleIndex=_this$props2.ruleIndex,deleteRuleAtIndex=_this$props2.deleteRuleAtIndex;return _react.default.createElement(_delete_rule_modal.DeleteRuleModal,{ruleIndex:ruleIndex,deleteRuleAtIndex:deleteRuleAtIndex})});_defineProperty(_assertThisInitialized(_this),"getQuickEditConditionLink",function(){var conditions=_this.rule.conditions;var link=null;if(_this.rule.conditions!==undefined&&conditions.length===1){link=_react.default.createElement(_edit_condition_link.EditConditionLink,{conditionIndex:0,conditionValue:conditions[0].value,appliesTo:conditions[0].applies_to,anomaly:_this.props.anomaly,updateConditionValue:_this.updateConditionValue})}return link});_defineProperty(_assertThisInitialized(_this),"getQuickAddToFilterListLink",function(){var _this$props3=_this.props,anomaly=_this$props3.anomaly,addItemToFilterList=_this$props3.addItemToFilterList;var scope=_this.rule.scope;var partitionFieldName=Object.keys(scope)[0];var partitionFieldValue=anomaly.source[partitionFieldName];var filterId=scope[partitionFieldName].filter_id;return _react.default.createElement(_add_to_filter_list_link.AddToFilterListLink,{fieldValue:partitionFieldValue[0],filterId:filterId,addItemToFilterList:addItemToFilterList})});_defineProperty(_assertThisInitialized(_this),"updateConditionValue",function(conditionIndex,value){var _this$props4=_this.props,job=_this$props4.job,anomaly=_this$props4.anomaly,ruleIndex=_this$props4.ruleIndex,updateRuleAtIndex=_this$props4.updateRuleAtIndex;var detector=job.analysis_config.detectors[anomaly.detectorIndex];var editedRule=(0,_lodash.cloneDeep)(detector.custom_rules[ruleIndex]);var conditions=editedRule.conditions;if(conditionIndex<conditions.length){conditions[conditionIndex].value=value}updateRuleAtIndex(ruleIndex,editedRule)});var _this$props5=_this.props,_job=_this$props5.job,_anomaly=_this$props5.anomaly,_ruleIndex=_this$props5.ruleIndex;var _detector=_job.analysis_config.detectors[_anomaly.detectorIndex];var rules=_detector.custom_rules;if(rules!==undefined&&_ruleIndex<rules.length){_this.rule=rules[_ruleIndex]}_this.state={showAddToFilterListLink:false};return _this}_createClass(RuleActionPanel,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var scope=this.rule.scope;if(scope!==undefined&&Object.keys(scope).length===1){var partitionFieldName=Object.keys(scope)[0];var partitionFieldValue=this.props.anomaly.source[partitionFieldName];if(scope[partitionFieldName]!==undefined&&partitionFieldValue!==undefined&&partitionFieldValue.length===1&&partitionFieldValue[0].length>0){var filterId=scope[partitionFieldName].filter_id;_ml_api_service.ml.filters.filters({filterId:filterId}).then(function(filter){var filterItems=filter.items;if(filterItems.indexOf(partitionFieldValue[0])===-1){_this2.setState({showAddToFilterListLink:true})}}).catch(function(resp){console.log("Error loading filter ".concat(filterId,":"),resp)})}}}},{key:"render",value:function render(){if(this.rule===undefined){return null}var descriptionListItems=[{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.ruleTitle",defaultMessage:"rule"}),description:(0,_utils.buildRuleDescription)(this.rule,this.props.anomaly)},{title:"",description:this.getEditRuleLink()},{title:"",description:this.getDeleteRuleLink()}];var quickConditionLink=this.getQuickEditConditionLink();if(quickConditionLink!==null){descriptionListItems.splice(1,0,{title:"",description:quickConditionLink})}if(this.state.showAddToFilterListLink===true){var quickAddToFilterListLink=this.getQuickAddToFilterListLink();descriptionListItems.splice(descriptionListItems.length-2,0,{title:"",description:quickAddToFilterListLink})}descriptionListItems[1].title="actions";return _react.default.createElement(_eui.EuiPanel,{paddingSize:"m",className:"select-rule-action-panel"},_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:descriptionListItems}))}}]);return RuleActionPanel}(_react.Component);exports.RuleActionPanel=RuleActionPanel;RuleActionPanel.propTypes={job:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired,ruleIndex:_propTypes.default.number.isRequired,setEditRuleIndex:_propTypes.default.func.isRequired,updateRuleAtIndex:_propTypes.default.func.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddToFilterListLink=AddToFilterListLink;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AddToFilterListLink(_ref){var fieldValue=_ref.fieldValue,filterId=_ref.filterId,addItemToFilterList=_ref.addItemToFilterList;return _react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return addItemToFilterList(fieldValue,filterId,true)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.addValueToFilterListLinkText",defaultMessage:"Add {fieldValue} to {filterId}",values:{fieldValue:fieldValue,filterId:filterId}}))}AddToFilterListLink.propTypes={fieldValue:_propTypes.default.string.isRequired,filterId:_propTypes.default.string.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DeleteRuleModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DeleteRuleModal=function(_Component){_inherits(DeleteRuleModal,_Component);function DeleteRuleModal(props){var _this;_classCallCheck(this,DeleteRuleModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(DeleteRuleModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"deleteRule",function(){var _this$props=_this.props,ruleIndex=_this$props.ruleIndex,deleteRuleAtIndex=_this$props.deleteRuleAtIndex;deleteRuleAtIndex(ruleIndex);_this.closeModal()});_defineProperty(_assertThisInitialized(_this),"closeModal",function(){_this.setState({isModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"showModal",function(){_this.setState({isModalVisible:true})});_this.state={isModalVisible:false};return _this}_createClass(DeleteRuleModal,[{key:"render",value:function render(){var _this2=this;var modal;if(this.state.isModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleTitle",defaultMessage:"Delete rule"}),onCancel:this.closeModal,onConfirm:this.deleteRule,buttonColor:"danger",cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleDescription",defaultMessage:"Are you sure you want to delete this rule?"}))))}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiLink,{color:"danger",onClick:function onClick(){return _this2.showModal()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleLinkText",defaultMessage:"Delete rule"})),modal)}}]);return DeleteRuleModal}(_react.Component);exports.DeleteRuleModal=DeleteRuleModal;DeleteRuleModal.propTypes={ruleIndex:_propTypes.default.number.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditConditionLink=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _detector_rule=__webpack_require__(435);var _format_value=__webpack_require__(437);var _utils=__webpack_require__(502);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditConditionLink=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(EditConditionLink,_Component);function EditConditionLink(props){var _this;_classCallCheck(this,EditConditionLink);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditConditionLink).call(this,props));_defineProperty(_assertThisInitialized(_this),"onChangeValue",function(event){var enteredValue=event.target.value;_this.setState({value:enteredValue!==""?+enteredValue:""})});_defineProperty(_assertThisInitialized(_this),"onUpdateClick",function(){var _this$props=_this.props,conditionIndex=_this$props.conditionIndex,updateConditionValue=_this$props.updateConditionValue;updateConditionValue(conditionIndex,_this.state.value)});var value="";var anomaly=_this.props.anomaly;var anomalyValue=(0,_utils.getAppliesToValueFromAnomaly)(anomaly,props.appliesTo);if(anomalyValue!==undefined){value=+(0,_format_value.formatValue)(anomalyValue,anomaly.source.function)}_this.state={value:value};return _this}_createClass(EditConditionLink,[{key:"render",value:function render(){var _this2=this;var intl=this.props.intl;var value=this.state.value;return _react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateRuleConditionFromText",defaultMessage:"Update rule condition from {conditionValue} to",values:{conditionValue:this.props.conditionValue}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"condition-edit-value-field"},_react.default.createElement(_eui.EuiFieldNumber,{placeholder:intl.formatMessage({id:"xpack.ml.ruleEditor.editConditionLink.enterValuePlaceholder",defaultMessage:"Enter value"}),compressed:true,value:value,onChange:this.onChangeValue,"aria-label":intl.formatMessage({id:"xpack.ml.ruleEditor.editConditionLink.enterNumericValueForConditionAriaLabel",defaultMessage:"Enter numeric value for condition"})})),value!==""&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLink,{size:"s",onClick:function onClick(){return _this2.onUpdateClick()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateLinkText",defaultMessage:"Update"}))))}}]);return EditConditionLink}(_react.Component),_defineProperty(_class,"propTypes",{conditionIndex:_propTypes.default.number.isRequired,conditionValue:_propTypes.default.number.isRequired,appliesTo:_propTypes.default.oneOf([_detector_rule.APPLIES_TO.ACTUAL,_detector_rule.APPLIES_TO.TYPICAL,_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL]),anomaly:_propTypes.default.object.isRequired,updateConditionValue:_propTypes.default.func.isRequired}),_temp));exports.EditConditionLink=EditConditionLink},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3046)},function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(8);var _app_state_utils=__webpack_require__(686);var _checkbox_showcharts=__webpack_require__(1386);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.service("mlCheckboxShowChartsService",function(AppState,$rootScope){(0,_app_state_utils.subscribeAppStateToObservable)(AppState,"mlShowCharts",_checkbox_showcharts.showCharts$,function(){return $rootScope.$applyAsync()})})},function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(252)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3049)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _modules=__webpack_require__(8);var _app_state_utils=__webpack_require__(686);var _select_interval=__webpack_require__(896);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.service("mlSelectIntervalService",function(AppState,$rootScope){(0,_app_state_utils.subscribeAppStateToObservable)(AppState,"mlSelectInterval",_select_interval.interval$,function(){return $rootScope.$applyAsync()})}).directive("mlSelectInterval",function($injector){var reactDirective=$injector.get("reactDirective");return reactDirective(_select_interval.SelectInterval,undefined,{restrict:"E"})})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3051)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _app_state_utils=__webpack_require__(686);var _select_severity=__webpack_require__(401);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.service("mlSelectSeverityService",function(AppState,$rootScope){(0,_app_state_utils.subscribeAppStateToObservable)(AppState,"mlSelectSeverity",_select_severity.severity$,function(){return $rootScope.$applyAsync()})}).directive("mlSelectSeverity",function($injector){var reactDirective=$injector.get("reactDirective");return reactDirective((0,_i18n.wrapInI18nContext)(_select_severity.SelectSeverity),undefined,{restrict:"E"})})},function(module,exports){module.exports='<ml-nav-menu name="explorer"></ml-nav-menu>\n<ml-chart-tooltip></ml-chart-tooltip>\n<div class="ml-explorer" ng-controller="MlExplorerController">\n\n  <ml-job-selector-react-wrapper />\n\n  <ml-explorer-react-wrapper />\n</div>\n'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getAnomalyExplorerBreadcrumbs=getAnomalyExplorerBreadcrumbs;var _breadcrumbs=__webpack_require__(432);function getAnomalyExplorerBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _explorer=__webpack_require__(3055);var _modules=__webpack_require__(8);var _i18n=__webpack_require__(15);var _explorer_utils=__webpack_require__(897);var _explorer_constants=__webpack_require__(339);var _explorer_dashboard_service=__webpack_require__(581);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlExplorerReactWrapper",function(){function link(scope,element){_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_explorer.Explorer,(0,_explorer_utils.mapScopeToProps)(scope))),element[0]);_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.LOAD_JOBS});element.on("$destroy",function(){_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}return{scope:false,link:link}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Explorer=void 0;var _lodash=_interopRequireDefault(__webpack_require__(3));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _dragselect=_interopRequireDefault(__webpack_require__(3056));var _operators=__webpack_require__(48);var _eui=__webpack_require__(1);var _annotations_service=__webpack_require__(496);var _annotation_flyout=__webpack_require__(883);var _annotations_table=__webpack_require__(676);var _components=__webpack_require__(3057);var _explorer_swimlane=__webpack_require__(3064);var _kql_filter_bar=__webpack_require__(3065);var _date_utils=__webpack_require__(279);var _ml_time_buckets=__webpack_require__(338);var _influencers_list=__webpack_require__(3075);var _explorer_dashboard_service=__webpack_require__(581);var _results_service=__webpack_require__(436);var _loading_indicator=__webpack_require__(898);var _checkbox_showcharts=__webpack_require__(1386);var _select_interval=__webpack_require__(896);var _select_limit=__webpack_require__(1389);var _select_severity=__webpack_require__(401);var _observable_utils=__webpack_require__(434);var _utils=__webpack_require__(1388);var _explorer_utils=__webpack_require__(897);var _explorer_charts_container_service=__webpack_require__(3078);var _legacy_utils=__webpack_require__(1391);var _explorer_constants=__webpack_require__(339);var _index_patterns=__webpack_require__(497);var _explorer_charts_container=__webpack_require__(3080);var _anomalies_table=__webpack_require__(1383);var _timefilter=__webpack_require__(22);var _notify=__webpack_require__(14);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getExplorerDefaultState(){return{annotationsData:[],anomalyChartRecords:[],chartsData:(0,_explorer_charts_container_service.getDefaultChartsData)(),filterActive:false,filteredFields:[],filterPlaceHolder:undefined,indexPattern:{title:_index_patterns.ML_RESULTS_INDEX_PATTERN,fields:[]},influencersFilterQuery:undefined,hasResults:false,influencers:{},isAndOperator:false,loading:true,noInfluencersConfigured:true,noJobsFound:true,overallSwimlaneData:[],queryString:"",selectedCells:null,selectedJobs:null,swimlaneViewByFieldName:undefined,tableData:{},tableQueryString:"",viewByLoadedForTimeFormatted:null,viewBySwimlaneData:(0,_explorer_utils.getDefaultViewBySwimlaneData)(),viewBySwimlaneDataLoading:false,viewBySwimlaneOptions:[]}}function mapSwimlaneOptionsToEuiOptions(options){return options.map(function(option){return{value:option,text:option}})}var Explorer=(0,_react2.injectI18n)((0,_observable_utils.injectObservablesAsProps)({annotationsRefresh:_annotations_service.annotationsRefresh$,explorer:_explorer_dashboard_service.explorer$,showCharts:_checkbox_showcharts.showCharts$,swimlaneLimit:_select_limit.limit$.pipe((0,_operators.map)(function(d){return d.val})),tableInterval:_select_interval.interval$.pipe((0,_operators.map)(function(d){return d.val})),tableSeverity:_select_severity.severity$.pipe((0,_operators.map)(function(d){return d.val}))},(_temp=_class=function(_React$Component){_inherits(Explorer,_React$Component);function Explorer(){var _getPrototypeOf2;var _this;_classCallCheck(this,Explorer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Explorer)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"state",getExplorerDefaultState());_defineProperty(_assertThisInitialized(_this),"disableDragSelectOnMouseLeave",true);_defineProperty(_assertThisInitialized(_this),"skipCellClicks",true);_defineProperty(_assertThisInitialized(_this),"updateCharts",function(){});_defineProperty(_assertThisInitialized(_this),"dragSelect",new _dragselect.default({selectables:document.getElementsByClassName("sl-cell"),callback:function callback(elements){if(elements.length>1&&!_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){elements=[elements[0]]}if(elements.length>0){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.NEW_SELECTION,elements:elements})}this.disableDragSelectOnMouseLeave=true},onDragStart:function onDragStart(){if(_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.DRAG_START});this.disableDragSelectOnMouseLeave=false}},onElementSelect:function onElementSelect(){if(_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.ELEMENT_SELECT})}}}));_defineProperty(_assertThisInitialized(_this),"swimlaneRenderDoneListener",function(){_this.dragSelect.clearSelection();_this.dragSelect.setSelectables(document.getElementsByClassName("sl-cell"))});_defineProperty(_assertThisInitialized(_this),"previousSwimlaneLimit",_select_limit.limit$.getValue().val);_defineProperty(_assertThisInitialized(_this),"previousTableInterval",_select_interval.interval$.getValue().val);_defineProperty(_assertThisInitialized(_this),"previousTableSeverity",_select_severity.severity$.getValue().val);_defineProperty(_assertThisInitialized(_this),"loadOverallDataPreviousArgs",null);_defineProperty(_assertThisInitialized(_this),"loadOverallDataPreviousData",null);_defineProperty(_assertThisInitialized(_this),"loadViewBySwimlanePreviousArgs",null);_defineProperty(_assertThisInitialized(_this),"loadViewBySwimlanePreviousData",null);_defineProperty(_assertThisInitialized(_this),"topFieldsPreviousArgs",null);_defineProperty(_assertThisInitialized(_this),"topFieldsPreviousData",null);_defineProperty(_assertThisInitialized(_this),"anomaliesTablePreviousArgs",null);_defineProperty(_assertThisInitialized(_this),"anomaliesTablePreviousData",null);_defineProperty(_assertThisInitialized(_this),"annotationsTablePreviousArgs",null);_defineProperty(_assertThisInitialized(_this),"annotationsTablePreviousData",null);_defineProperty(_assertThisInitialized(_this),"viewByChangeHandler",function(e){return _this.setSwimlaneViewBy(e.target.value)});_defineProperty(_assertThisInitialized(_this),"setSwimlaneViewBy",function(swimlaneViewByFieldName){var maskAll=false;if(_this.state.influencersFilterQuery!==undefined){maskAll=swimlaneViewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL||_this.state.filteredFields.includes(swimlaneViewByFieldName)===false}_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_SWIMLANE_VIEW_BY_FIELD_NAME,{swimlaneViewByFieldName:swimlaneViewByFieldName});_this.setState({swimlaneViewByFieldName:swimlaneViewByFieldName,maskAll:maskAll},function(){_this.updateExplorer(_objectSpread({swimlaneViewByFieldName:swimlaneViewByFieldName},(0,_explorer_utils.getClearedSelectedAnomaliesState)()),false)})});_defineProperty(_assertThisInitialized(_this),"onSwimlaneEnterHandler",function(){return _this.setSwimlaneSelectActive(true)});_defineProperty(_assertThisInitialized(_this),"onSwimlaneLeaveHandler",function(){return _this.setSwimlaneSelectActive(false)});_defineProperty(_assertThisInitialized(_this),"setSwimlaneSelectActive",function(active){if(!active&&_this.disableDragSelectOnMouseLeave){_this.dragSelect.clearSelection();_this.dragSelect.stop();return}_this.dragSelect.start()});_defineProperty(_assertThisInitialized(_this),"swimlaneCellClickQueue",[]);_defineProperty(_assertThisInitialized(_this),"swimlaneCellClick",function(swimlaneSelectedCells){if(_this.skipCellClicks===true){_this.swimlaneCellClickQueue.push(swimlaneSelectedCells);return}if(Object.keys(swimlaneSelectedCells).length===0){_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);var stateUpdate=(0,_explorer_utils.getClearedSelectedAnomaliesState)();_this.updateExplorer(stateUpdate,false)}else{swimlaneSelectedCells.showTopFieldValues=false;var currentSwimlaneType=_lodash.default.get(_this.state,"selectedCells.type");var currentShowTopFieldValues=_lodash.default.get(_this.state,"selectedCells.showTopFieldValues",false);var newSwimlaneType=_lodash.default.get(swimlaneSelectedCells,"type");if(currentSwimlaneType===_explorer_constants.SWIMLANE_TYPE.OVERALL&&newSwimlaneType===_explorer_constants.SWIMLANE_TYPE.VIEW_BY||newSwimlaneType===_explorer_constants.SWIMLANE_TYPE.OVERALL||currentShowTopFieldValues===true){swimlaneSelectedCells.showTopFieldValues=true}_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_SELECTION,{swimlaneSelectedCells:swimlaneSelectedCells});_this.updateExplorer({selectedCells:swimlaneSelectedCells},false)}});_defineProperty(_assertThisInitialized(_this),"applyFilter",function(fieldName,fieldValue,action){var newQueryString="";var queryString=_this.state.queryString;var operator="and ";var sanitizedFieldName=(0,_utils.escapeParens)(fieldName);var sanitizedFieldValue=(0,_utils.escapeDoubleQuotes)(fieldValue);if(action===_explorer_constants.FILTER_ACTION.ADD){var queryPattern=(0,_utils.getQueryPattern)(fieldName,fieldValue);if(queryString.match(queryPattern)!==null){return}newQueryString="".concat(queryString?"".concat(queryString," ").concat(operator):"").concat(sanitizedFieldName,':"').concat(sanitizedFieldValue,'"')}else if(action===_explorer_constants.FILTER_ACTION.REMOVE){if(_this.state.filterActive===false){return}else{newQueryString=(0,_utils.removeFilterFromQueryString)(_this.state.queryString,sanitizedFieldName,sanitizedFieldValue)}}try{var queryValues=(0,_utils.getKqlQueryValues)("".concat(newQueryString),_this.state.indexPattern);_this.applyInfluencersFilterQuery(queryValues)}catch(e){console.log("Invalid kuery syntax",e);_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}});_defineProperty(_assertThisInitialized(_this),"applyInfluencersFilterQuery",function(_ref){var influencersFilterQuery=_ref.influencersFilterQuery,isAndOperator=_ref.isAndOperator,filteredFields=_ref.filteredFields,queryString=_ref.queryString,tableQueryString=_ref.tableQueryString;var _this$state=_this.state,selectedCells=_this$state.selectedCells,swimlaneViewByFieldName=_this$state.swimlaneViewByFieldName,viewBySwimlaneOptions=_this$state.viewBySwimlaneOptions;var selectedViewByFieldName=swimlaneViewByFieldName;if(influencersFilterQuery.match_all&&Object.keys(influencersFilterQuery.match_all).length===0){_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_INFLUENCER_FILTER_SETTINGS);_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);var stateUpdate=_objectSpread({filterActive:false,filteredFields:[],influencersFilterQuery:undefined,isAndOperator:false,maskAll:false,queryString:"",tableQueryString:""},(0,_explorer_utils.getClearedSelectedAnomaliesState)());_this.updateExplorer(stateUpdate,false)}else{if(isAndOperator&&selectedCells===null){selectedViewByFieldName=_explorer_constants.VIEW_BY_JOB_LABEL;_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_SWIMLANE_VIEW_BY_FIELD_NAME,{swimlaneViewByFieldName:selectedViewByFieldName})}else{for(var i=0;i<filteredFields.length;i++){if(viewBySwimlaneOptions.includes(filteredFields[i])&&(selectedCells===null||selectedCells&&selectedCells.type==="overall")){selectedViewByFieldName=filteredFields[i];_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_SWIMLANE_VIEW_BY_FIELD_NAME,{swimlaneViewByFieldName:selectedViewByFieldName});break}}}_this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_INFLUENCER_FILTER_SETTINGS,{influencersFilterQuery:influencersFilterQuery,filterActive:true,filteredFields:filteredFields,queryString:queryString,tableQueryString:tableQueryString,isAndOperator:isAndOperator});_this.updateExplorer({filterActive:true,filteredFields:filteredFields,influencersFilterQuery:influencersFilterQuery,isAndOperator:isAndOperator,queryString:queryString,tableQueryString:tableQueryString,maskAll:selectedViewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL||filteredFields.includes(selectedViewByFieldName)===false,swimlaneViewByFieldName:selectedViewByFieldName},false)}});return _this}_createClass(Explorer,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this.updateCharts=(0,_explorer_charts_container_service.explorerChartsContainerServiceFactory)(function(data){_this2.setState({chartsData:_objectSpread({},(0,_explorer_charts_container_service.getDefaultChartsData)(),{chartsPerRow:data.chartsPerRow,seriesToPlot:data.seriesToPlot,tooManyBuckets:!!data.tooManyBuckets})})})}},{key:"componentDidUpdate",value:function(){var _componentDidUpdate=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this3=this;var _this$props$explorer,action,payload,noJobsFound,selectedCells,selectedJobs,swimlaneViewByFieldName,filterData,currentSelectedCells,currentSwimlaneViewByFieldName,stateUpdate,indexPattern,_selectedJobs,_stateUpdate,noFilterState,_indexPattern;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.props.explorer!==undefined&&this.props.explorer.action!==_explorer_constants.EXPLORER_ACTION.IDLE)){_context.next=41;break}_explorer_dashboard_service.explorer$.next({action:_explorer_constants.EXPLORER_ACTION.IDLE});_this$props$explorer=this.props.explorer,action=_this$props$explorer.action,payload=_this$props$explorer.payload;if(!(action===_explorer_constants.EXPLORER_ACTION.INITIALIZE)){_context.next=16;break}noJobsFound=payload.noJobsFound,selectedCells=payload.selectedCells,selectedJobs=payload.selectedJobs,swimlaneViewByFieldName=payload.swimlaneViewByFieldName,filterData=payload.filterData;currentSelectedCells=this.state.selectedCells;currentSwimlaneViewByFieldName=this.state.swimlaneViewByFieldName;if(swimlaneViewByFieldName!==undefined){currentSwimlaneViewByFieldName=swimlaneViewByFieldName}if(selectedCells!==undefined&&currentSelectedCells===null){currentSelectedCells=selectedCells}stateUpdate={noInfluencersConfigured:(0,_explorer_utils.getInfluencers)(selectedJobs).length===0,noJobsFound:noJobsFound,selectedCells:currentSelectedCells,selectedJobs:selectedJobs,swimlaneViewByFieldName:currentSwimlaneViewByFieldName};if(filterData.influencersFilterQuery!==undefined){Object.assign(stateUpdate,_objectSpread({},filterData))}_context.next=13;return this.getIndexPattern(selectedJobs);case 13:indexPattern=_context.sent;stateUpdate.indexPattern=indexPattern;this.updateExplorer(stateUpdate,true);case 16:if(!(action===_explorer_constants.EXPLORER_ACTION.JOB_SELECTION_CHANGE)){_context.next=37;break}_selectedJobs=payload.selectedJobs;_stateUpdate={noInfluencersConfigured:(0,_explorer_utils.getInfluencers)(_selectedJobs).length===0,selectedJobs:_selectedJobs};this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);Object.assign(_stateUpdate,(0,_explorer_utils.getClearedSelectedAnomaliesState)());if(!(_stateUpdate.noInfluencersConfigured===true)){_context.next=27;break}this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_INFLUENCER_FILTER_SETTINGS);noFilterState={filterActive:false,filteredFields:[],influencersFilterQuery:undefined,maskAll:false,queryString:"",tableQueryString:""};Object.assign(_stateUpdate,noFilterState);_context.next=31;break;case 27:_context.next=29;return this.getIndexPattern(_selectedJobs);case 29:_indexPattern=_context.sent;_stateUpdate.indexPattern=_indexPattern;case 31:if(!(_selectedJobs.length>1)){_context.next=36;break}this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.SAVE_SWIMLANE_VIEW_BY_FIELD_NAME,{swimlaneViewByFieldName:_explorer_constants.VIEW_BY_JOB_LABEL});_stateUpdate.swimlaneViewByFieldName=_explorer_constants.VIEW_BY_JOB_LABEL;this.setState({swimlaneViewByFieldName:_explorer_constants.VIEW_BY_JOB_LABEL},function(){_this3.updateExplorer(_stateUpdate,true)});return _context.abrupt("return");case 36:this.updateExplorer(_stateUpdate,true);case 37:if(action===_explorer_constants.EXPLORER_ACTION.RELOAD){this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);this.updateExplorer(_objectSpread({},payload,(0,_explorer_utils.getClearedSelectedAnomaliesState)()),true)}if(action===_explorer_constants.EXPLORER_ACTION.REDRAW){this.updateExplorer({},false)}_context.next=42;break;case 41:if(this.previousSwimlaneLimit!==this.props.swimlaneLimit){this.previousSwimlaneLimit=this.props.swimlaneLimit;this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);this.updateExplorer((0,_explorer_utils.getClearedSelectedAnomaliesState)(),false)}else if(this.previousTableInterval!==this.props.tableInterval){this.previousTableInterval=this.props.tableInterval;this.updateExplorer()}else if(this.previousTableSeverity!==this.props.tableSeverity){this.previousTableSeverity=this.props.tableSeverity;this.updateExplorer()}else if(this.props.annotationsRefresh===true){_annotations_service.annotationsRefresh$.next(false);this.annotationsTablePreviousArgs=null;this.annotationsTablePreviousData=null;this.updateExplorer()}case 42:case"end":return _context.stop()}}},_callee,this)}));function componentDidUpdate(){return _componentDidUpdate.apply(this,arguments)}return componentDidUpdate}()},{key:"getIndexPattern",value:function(){var _getIndexPattern=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(selectedJobs){var indexPattern,influencers;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:indexPattern=this.state.indexPattern;influencers=(0,_explorer_utils.getInfluencers)(selectedJobs);indexPattern.fields=influencers.map(function(influencer){return{name:influencer,type:"string",aggregatable:true,searchable:true}});return _context2.abrupt("return",indexPattern);case 4:case"end":return _context2.stop()}}},_callee2,this)}));function getIndexPattern(_x){return _getIndexPattern.apply(this,arguments)}return getIndexPattern}()},{key:"getSwimlaneBucketInterval",value:function getSwimlaneBucketInterval(selectedJobs){var MlTimeBuckets=this.props.MlTimeBuckets;var swimlaneWidth=(0,_legacy_utils.getSwimlaneContainerWidth)(this.state.noInfluencersConfigured);var bounds=_timefilter.timefilter.getActiveBounds();var buckets=new MlTimeBuckets;buckets.setInterval("auto");buckets.setBounds(bounds);var intervalSeconds=buckets.getInterval().asSeconds();var timerangeSeconds=(bounds.max.valueOf()-bounds.min.valueOf())/1e3;var numBuckets=parseInt(timerangeSeconds/intervalSeconds);var cellWidth=Math.floor(swimlaneWidth/numBuckets*100)/100;if(cellWidth<8){buckets.setInterval(intervalSeconds*2+"s")}var maxBucketSpanSeconds=selectedJobs.reduce(function(memo,job){return Math.max(memo,job.bucketSpanSeconds)},0);if(maxBucketSpanSeconds>intervalSeconds){buckets.setInterval(maxBucketSpanSeconds+"s");buckets.setBounds(bounds)}return buckets.getInterval()}},{key:"loadOverallData",value:function loadOverallData(selectedJobs,interval,bounds){var _this4=this;var showLoadingIndicator=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;return new Promise(function(resolve){if(selectedJobs===null){resolve({loading:false,hasResuts:false});return}var compareArgs={selectedJobs:selectedJobs,intervalAsSeconds:interval.asSeconds(),boundsMin:bounds.min.valueOf(),boundsMax:bounds.max.valueOf()};if(_lodash.default.isEqual(compareArgs,_this4.loadOverallDataPreviousArgs)){var overallSwimlaneData=_this4.loadOverallDataPreviousData;var hasResults=overallSwimlaneData.points&&overallSwimlaneData.points.length>0;resolve({hasResults:hasResults,loading:false,overallSwimlaneData:overallSwimlaneData});return}if(showLoadingIndicator){_this4.setState({hasResults:false,loading:true})}var searchBounds=(0,_ml_time_buckets.getBoundsRoundedToInterval)(bounds,interval,false);var selectedJobIds=selectedJobs.map(function(d){return d.id});var overallBucketsBounds=(0,_ml_time_buckets.getBoundsRoundedToInterval)(bounds,interval,true);_results_service.mlResultsService.getOverallBucketScores(selectedJobIds,1,overallBucketsBounds.min.valueOf(),overallBucketsBounds.max.valueOf(),interval.asSeconds()+"s").then(function(resp){_this4.skipCellClicks=false;var overallSwimlaneData=(0,_explorer_utils.processOverallResults)(resp.results,searchBounds,interval.asSeconds());_this4.loadOverallDataPreviousArgs=compareArgs;_this4.loadOverallDataPreviousData=overallSwimlaneData;console.log("Explorer overall swimlane data set:",overallSwimlaneData);var hasResults=overallSwimlaneData.points&&overallSwimlaneData.points.length>0;resolve({hasResults:hasResults,loading:false,overallSwimlaneData:overallSwimlaneData})})})}},{key:"loadViewBySwimlane",value:function loadViewBySwimlane(fieldValues,overallSwimlaneData,selectedJobs,swimlaneViewByFieldName,influencersFilterQuery){var _this5=this;var swimlaneLimit=this.props.swimlaneLimit;var compareArgs={fieldValues:fieldValues,overallSwimlaneData:overallSwimlaneData,selectedJobs:selectedJobs,swimlaneLimit:swimlaneLimit,swimlaneViewByFieldName:swimlaneViewByFieldName,interval:this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),influencersFilterQuery:influencersFilterQuery};return new Promise(function(resolve){_this5.skipCellClicks=true;if(_lodash.default.isEqual(compareArgs,_this5.loadViewBySwimlanePreviousArgs)){_this5.skipCellClicks=false;resolve({viewBySwimlaneData:_this5.loadViewBySwimlanePreviousData,viewBySwimlaneDataLoading:false});return}_this5.setState({viewBySwimlaneData:(0,_explorer_utils.getDefaultViewBySwimlaneData)(),viewBySwimlaneDataLoading:true});var finish=function finish(resp){_this5.skipCellClicks=false;if(resp!==undefined){var viewBySwimlaneData=(0,_explorer_utils.processViewByResults)(resp.results,fieldValues,overallSwimlaneData,swimlaneViewByFieldName,_this5.getSwimlaneBucketInterval(selectedJobs).asSeconds());_this5.loadViewBySwimlanePreviousArgs=compareArgs;_this5.loadViewBySwimlanePreviousData=viewBySwimlaneData;console.log("Explorer view by swimlane data set:",viewBySwimlaneData);resolve({viewBySwimlaneData:viewBySwimlaneData,viewBySwimlaneDataLoading:false})}else{resolve({viewBySwimlaneDataLoading:false})}};if(selectedJobs===undefined||swimlaneViewByFieldName===undefined){finish();return}else{var bounds=_timefilter.timefilter.getActiveBounds();var searchBounds=(0,_ml_time_buckets.getBoundsRoundedToInterval)(bounds,_this5.getSwimlaneBucketInterval(selectedJobs),false);var selectedJobIds=selectedJobs.map(function(d){return d.id});var interval="".concat(_this5.getSwimlaneBucketInterval(selectedJobs).asSeconds(),"s");if(swimlaneViewByFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){_results_service.mlResultsService.getInfluencerValueMaxScoreByTime(selectedJobIds,swimlaneViewByFieldName,fieldValues,searchBounds.min.valueOf(),searchBounds.max.valueOf(),interval,swimlaneLimit,influencersFilterQuery).then(finish)}else{var jobIds=fieldValues!==undefined&&fieldValues.length>0?fieldValues:selectedJobIds;_results_service.mlResultsService.getScoresByBucket(jobIds,searchBounds.min.valueOf(),searchBounds.max.valueOf(),interval,swimlaneLimit).then(finish)}}})}},{key:"loadViewByTopFieldValuesForSelectedTime",value:function loadViewByTopFieldValuesForSelectedTime(earliestMs,latestMs,selectedJobs,swimlaneViewByFieldName){var _this6=this;var selectedJobIds=selectedJobs.map(function(d){return d.id});var swimlaneLimit=this.props.swimlaneLimit;var compareArgs={earliestMs:earliestMs,latestMs:latestMs,selectedJobIds:selectedJobIds,swimlaneLimit:swimlaneLimit,swimlaneViewByFieldName:swimlaneViewByFieldName,interval:this.getSwimlaneBucketInterval(selectedJobs).asSeconds()};return new Promise(function(resolve){if(_lodash.default.isEqual(compareArgs,_this6.topFieldsPreviousArgs)){resolve(_this6.topFieldsPreviousData);return}_this6.topFieldsPreviousArgs=compareArgs;if(swimlaneViewByFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){_results_service.mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,swimlaneLimit).then(function(resp){if(resp.influencers[swimlaneViewByFieldName]===undefined){_this6.topFieldsPreviousData=[];resolve([])}var topFieldValues=[];var topInfluencers=resp.influencers[swimlaneViewByFieldName];topInfluencers.forEach(function(influencerData){if(influencerData.maxAnomalyScore>0){topFieldValues.push(influencerData.influencerFieldValue)}});_this6.topFieldsPreviousData=topFieldValues;resolve(topFieldValues)})}else{_results_service.mlResultsService.getScoresByBucket(selectedJobIds,earliestMs,latestMs,_this6.getSwimlaneBucketInterval(selectedJobs).asSeconds()+"s",swimlaneLimit).then(function(resp){var topFieldValues=Object.keys(resp.results);_this6.topFieldsPreviousData=topFieldValues;resolve(topFieldValues)})}})}},{key:"updateExplorer",value:function(){var _updateExplorer=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var stateUpdate,showOverallLoadingIndicator,_this$state$stateUpda,filterActive,filteredFields,influencersFilterQuery,isAndOperator,noInfluencersConfigured,noJobsFound,selectedCells,selectedJobs,swimlaneViewByFieldName,latestSelectedCells,dateFormatTz,jobIds,bounds,timerange,overallSwimlaneData,annotationsTableCompareArgs,viewBySwimlaneOptions,topFieldValues,viewBySwimlaneData,clearSelection,selectionInfluencers,influencerName,updatedAnomalyChartRecords,_this$props,tableInterval,tableSeverity,anomaliesTableCompareArgs,tableData,_args3=arguments;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:stateUpdate=_args3.length>0&&_args3[0]!==undefined?_args3[0]:{};showOverallLoadingIndicator=_args3.length>1&&_args3[1]!==undefined?_args3[1]:true;_this$state$stateUpda=_objectSpread({},this.state,stateUpdate),filterActive=_this$state$stateUpda.filterActive,filteredFields=_this$state$stateUpda.filteredFields,influencersFilterQuery=_this$state$stateUpda.influencersFilterQuery,isAndOperator=_this$state$stateUpda.isAndOperator,noInfluencersConfigured=_this$state$stateUpda.noInfluencersConfigured,noJobsFound=_this$state$stateUpda.noJobsFound,selectedCells=_this$state$stateUpda.selectedCells,selectedJobs=_this$state$stateUpda.selectedJobs,swimlaneViewByFieldName=_this$state$stateUpda.swimlaneViewByFieldName;this.skipCellClicks=false;if(!noJobsFound){_context3.next=7;break}this.setState(stateUpdate);return _context3.abrupt("return");case 7:if(!(this.swimlaneCellClickQueue.length>0)){_context3.next=13;break}this.setState(stateUpdate);latestSelectedCells=this.swimlaneCellClickQueue.pop();this.swimlaneCellClickQueue.length=0;this.swimlaneCellClick(latestSelectedCells);return _context3.abrupt("return");case 13:dateFormatTz=this.props.dateFormatTz;jobIds=selectedCells!==null&&selectedCells.viewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL?selectedCells.lanes:selectedJobs.map(function(d){return d.id});bounds=_timefilter.timefilter.getActiveBounds();timerange=(0,_explorer_utils.getSelectionTimeRange)(selectedCells,this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),bounds);_context3.t0=Object;_context3.t1=stateUpdate;_context3.next=21;return this.loadOverallData(selectedJobs,this.getSwimlaneBucketInterval(selectedJobs),bounds,showOverallLoadingIndicator);case 21:_context3.t2=_context3.sent;_context3.t0.assign.call(_context3.t0,_context3.t1,_context3.t2);overallSwimlaneData=stateUpdate.overallSwimlaneData;annotationsTableCompareArgs={selectedCells:selectedCells,selectedJobs:selectedJobs,interval:this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),boundsMin:bounds.min.valueOf(),boundsMax:bounds.max.valueOf()};if(!_lodash.default.isEqual(annotationsTableCompareArgs,this.annotationsTablePreviousArgs)){_context3.next=29;break}stateUpdate.annotationsData=this.annotationsTablePreviousData;_context3.next=33;break;case 29:this.annotationsTablePreviousArgs=annotationsTableCompareArgs;_context3.next=32;return(0,_explorer_utils.loadAnnotationsTableData)(selectedCells,selectedJobs,this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),bounds);case 32:stateUpdate.annotationsData=this.annotationsTablePreviousData=_context3.sent;case 33:viewBySwimlaneOptions=(0,_explorer_utils.getViewBySwimlaneOptions)({currentSwimlaneViewByFieldName:swimlaneViewByFieldName,filterActive:filterActive,filteredFields:filteredFields,isAndOperator:isAndOperator,selectedJobs:selectedJobs,selectedCells:selectedCells});Object.assign(stateUpdate,viewBySwimlaneOptions);if(!(selectedCells!==null&&selectedCells.showTopFieldValues===true)){_context3.next=48;break}_context3.next=38;return this.loadViewByTopFieldValuesForSelectedTime(timerange.earliestMs,timerange.latestMs,selectedJobs,viewBySwimlaneOptions.swimlaneViewByFieldName);case 38:topFieldValues=_context3.sent;_context3.t3=Object;_context3.t4=stateUpdate;_context3.next=43;return this.loadViewBySwimlane(topFieldValues,overallSwimlaneData,selectedJobs,viewBySwimlaneOptions.swimlaneViewByFieldName,influencersFilterQuery);case 43:_context3.t5=_context3.sent;_context3.t6={viewByLoadedForTimeFormatted:(0,_date_utils.formatHumanReadableDateTime)(timerange.earliestMs)};_context3.t3.assign.call(_context3.t3,_context3.t4,_context3.t5,_context3.t6);_context3.next=55;break;case 48:_context3.t7=Object;_context3.t8=stateUpdate;_context3.t9=viewBySwimlaneOptions;_context3.next=53;return this.loadViewBySwimlane([],overallSwimlaneData,selectedJobs,viewBySwimlaneOptions.swimlaneViewByFieldName,influencersFilterQuery);case 53:_context3.t10=_context3.sent;_context3.t7.assign.call(_context3.t7,_context3.t8,_context3.t9,_context3.t10);case 55:viewBySwimlaneData=stateUpdate.viewBySwimlaneData;clearSelection=false;if(selectedCells!==null&&selectedCells.type===_explorer_constants.SWIMLANE_TYPE.VIEW_BY){clearSelection=filterActive===false&&!selectedCells.lanes.some(function(lane){return viewBySwimlaneData.points.some(function(point){return point.laneLabel===lane&&point.time===selectedCells.times[0]})})}if(clearSelection===true){this.props.appStateHandler(_explorer_constants.APP_STATE_ACTION.CLEAR_SELECTION);Object.assign(stateUpdate,(0,_explorer_utils.getClearedSelectedAnomaliesState)())}selectionInfluencers=(0,_explorer_utils.getSelectionInfluencers)(selectedCells,viewBySwimlaneOptions.swimlaneViewByFieldName);if(!(selectionInfluencers.length===0)){_context3.next=64;break}_context3.next=63;return(0,_explorer_utils.loadTopInfluencers)(jobIds,timerange.earliestMs,timerange.latestMs,noInfluencersConfigured);case 63:stateUpdate.influencers=_context3.sent;case 64:if(!(stateUpdate.influencers!==undefined&&!noInfluencersConfigured)){_context3.next=73;break}_context3.t11=regeneratorRuntime.keys(stateUpdate.influencers);case 66:if((_context3.t12=_context3.t11()).done){_context3.next=73;break}influencerName=_context3.t12.value;if(!(stateUpdate.influencers[influencerName][0]&&stateUpdate.influencers[influencerName][0].influencerFieldValue)){_context3.next=71;break}stateUpdate.filterPlaceHolder="".concat(influencerName," : ").concat(stateUpdate.influencers[influencerName][0].influencerFieldValue);return _context3.abrupt("break",73);case 71:_context3.next=66;break;case 73:_context3.next=75;return(0,_explorer_utils.loadDataForCharts)(jobIds,timerange.earliestMs,timerange.latestMs,selectionInfluencers,selectedCells,influencersFilterQuery);case 75:updatedAnomalyChartRecords=_context3.sent;if(!((selectionInfluencers.length>0||influencersFilterQuery!==undefined)&&updatedAnomalyChartRecords!==undefined)){_context3.next=80;break}_context3.next=79;return(0,_explorer_utils.getFilteredTopInfluencers)(jobIds,timerange.earliestMs,timerange.latestMs,updatedAnomalyChartRecords,selectionInfluencers,noInfluencersConfigured,influencersFilterQuery);case 79:stateUpdate.influencers=_context3.sent;case 80:stateUpdate.anomalyChartRecords=updatedAnomalyChartRecords||[];this.setState(stateUpdate);if(selectedCells!==null){this.updateCharts(stateUpdate.anomalyChartRecords,timerange.earliestMs,timerange.latestMs)}else{this.updateCharts([],timerange.earliestMs,timerange.latestMs)}_this$props=this.props,tableInterval=_this$props.tableInterval,tableSeverity=_this$props.tableSeverity;anomaliesTableCompareArgs={selectedCells:selectedCells,selectedJobs:selectedJobs,dateFormatTz:dateFormatTz,interval:this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),boundsMin:bounds.min.valueOf(),boundsMax:bounds.max.valueOf(),swimlaneViewByFieldName:viewBySwimlaneOptions.swimlaneViewByFieldName,tableInterval:tableInterval,tableSeverity:tableSeverity,influencersFilterQuery:influencersFilterQuery};if(!_lodash.default.isEqual(anomaliesTableCompareArgs,this.anomaliesTablePreviousArgs)){_context3.next=89;break}this.setState(this.anomaliesTablePreviousData);_context3.next=94;break;case 89:this.anomaliesTablePreviousArgs=anomaliesTableCompareArgs;_context3.next=92;return(0,_explorer_utils.loadAnomaliesTableData)(selectedCells,selectedJobs,dateFormatTz,this.getSwimlaneBucketInterval(selectedJobs).asSeconds(),bounds,viewBySwimlaneOptions.swimlaneViewByFieldName,tableInterval,tableSeverity,influencersFilterQuery);case 92:tableData=this.anomaliesTablePreviousData=_context3.sent;this.setState({tableData:tableData});case 94:case"end":return _context3.stop()}}},_callee3,this)}));function updateExplorer(){return _updateExplorer.apply(this,arguments)}return updateExplorer}()},{key:"render",value:function render(){var _this$props2=this.props,intl=_this$props2.intl,MlTimeBuckets=_this$props2.MlTimeBuckets;var _this$state2=this.state,annotationsData=_this$state2.annotationsData,anomalyChartRecords=_this$state2.anomalyChartRecords,chartsData=_this$state2.chartsData,filterActive=_this$state2.filterActive,filterPlaceHolder=_this$state2.filterPlaceHolder,indexPattern=_this$state2.indexPattern,maskAll=_this$state2.maskAll,influencers=_this$state2.influencers,hasResults=_this$state2.hasResults,noInfluencersConfigured=_this$state2.noInfluencersConfigured,noJobsFound=_this$state2.noJobsFound,overallSwimlaneData=_this$state2.overallSwimlaneData,queryString=_this$state2.queryString,selectedCells=_this$state2.selectedCells,swimlaneViewByFieldName=_this$state2.swimlaneViewByFieldName,tableData=_this$state2.tableData,tableQueryString=_this$state2.tableQueryString,viewByLoadedForTimeFormatted=_this$state2.viewByLoadedForTimeFormatted,viewBySwimlaneData=_this$state2.viewBySwimlaneData,viewBySwimlaneDataLoading=_this$state2.viewBySwimlaneDataLoading,viewBySwimlaneOptions=_this$state2.viewBySwimlaneOptions;var loading=this.props.loading||this.state.loading;var swimlaneWidth=(0,_legacy_utils.getSwimlaneContainerWidth)(noInfluencersConfigured);if(loading===true){return _react.default.createElement(_loading_indicator.LoadingIndicator,{label:intl.formatMessage({id:"xpack.ml.explorer.loadingLabel",defaultMessage:"Loading"})})}if(noJobsFound){return _react.default.createElement(_components.ExplorerNoJobsFound,null)}if(noJobsFound&&hasResults===false){return _react.default.createElement(_components.ExplorerNoResultsFound,null)}var mainColumnWidthClassName=noInfluencersConfigured===true?"col-xs-12":"col-xs-10";var mainColumnClasses="column ".concat(mainColumnWidthClassName);var showViewBySwimlane=viewBySwimlaneData!==null&&viewBySwimlaneData.laneLabels&&viewBySwimlaneData.laneLabels.length>0;return _react.default.createElement("div",{className:"results-container"},noInfluencersConfigured===false&&influencers!==undefined&&_react.default.createElement("div",{className:"mlAnomalyExplorer__filterBar"},_react.default.createElement(_kql_filter_bar.KqlFilterBar,{indexPattern:indexPattern,onSubmit:this.applyInfluencersFilterQuery,initialValue:queryString,placeholder:filterPlaceHolder,valueExternal:tableQueryString})),noInfluencersConfigured&&_react.default.createElement("div",{className:"no-influencers-warning"},_react.default.createElement(_eui.EuiIconTip,{content:intl.formatMessage({id:"xpack.ml.explorer.noConfiguredInfluencersTooltip",defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),noInfluencersConfigured===false&&_react.default.createElement("div",{className:"column col-xs-2 euiText"},_react.default.createElement("span",{className:"panel-title"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top Influencers"})),_react.default.createElement(_influencers_list.InfluencersList,{influencers:influencers,influencerFilter:this.applyFilter})),_react.default.createElement("div",{className:mainColumnClasses},_react.default.createElement("span",{className:"panel-title euiText"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"})),_react.default.createElement("div",{className:"ml-explorer-swimlane euiText",onMouseEnter:this.onSwimlaneEnterHandler,onMouseLeave:this.onSwimlaneLeaveHandler},_react.default.createElement(_explorer_swimlane.ExplorerSwimlane,{chartWidth:swimlaneWidth,filterActive:filterActive,maskAll:maskAll,MlTimeBuckets:MlTimeBuckets,swimlaneCellClick:this.swimlaneCellClick,swimlaneData:overallSwimlaneData,swimlaneType:_explorer_constants.SWIMLANE_TYPE.OVERALL,selection:selectedCells,swimlaneRenderDoneListener:this.swimlaneRenderDoneListener})),viewBySwimlaneOptions.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:true},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:intl.formatMessage({id:"xpack.ml.explorer.viewByLabel",defaultMessage:"View by"})},_react.default.createElement(_eui.EuiSelect,{id:"selectViewBy",options:mapSwimlaneOptionsToEuiOptions(viewBySwimlaneOptions),value:swimlaneViewByFieldName,onChange:this.viewByChangeHandler}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:intl.formatMessage({id:"xpack.ml.explorer.limitLabel",defaultMessage:"Limit"})},_react.default.createElement(_select_limit.SelectLimit,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{alignSelf:"center"}},_react.default.createElement(_eui.EuiFormRow,{label:"​"},_react.default.createElement("div",{className:"panel-sub-title"},viewByLoadedForTimeFormatted&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:viewByLoadedForTimeFormatted}}),viewByLoadedForTimeFormatted===undefined&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),filterActive===true&&swimlaneViewByFieldName==="job ID"&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"}))))),showViewBySwimlane&&_react.default.createElement("div",{className:"ml-explorer-swimlane euiText",onMouseEnter:this.onSwimlaneEnterHandler,onMouseLeave:this.onSwimlaneLeaveHandler},_react.default.createElement(_explorer_swimlane.ExplorerSwimlane,{chartWidth:swimlaneWidth,filterActive:filterActive,maskAll:maskAll,MlTimeBuckets:MlTimeBuckets,swimlaneCellClick:this.swimlaneCellClick,swimlaneData:viewBySwimlaneData,swimlaneType:_explorer_constants.SWIMLANE_TYPE.VIEW_BY,selection:selectedCells,swimlaneRenderDoneListener:this.swimlaneRenderDoneListener})),viewBySwimlaneDataLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,null),!showViewBySwimlane&&!viewBySwimlaneDataLoading&&swimlaneViewByFieldName!==null&&_react.default.createElement(_components.ExplorerNoInfluencersFound,{swimlaneViewByFieldName:swimlaneViewByFieldName,showFilterMessage:filterActive===true})),annotationsData.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("span",{className:"panel-title euiText"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations"})),_react.default.createElement(_annotations_table.AnnotationsTable,{annotations:annotationsData,drillDown:true,numberBadge:false}),_react.default.createElement(_annotation_flyout.AnnotationFlyout,null),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement("span",{className:"panel-title euiText"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"})),_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:true,className:"ml-anomalies-controls"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:intl.formatMessage({id:"xpack.ml.explorer.severityThresholdLabel",defaultMessage:"Severity threshold"})},_react.default.createElement(_select_severity.SelectSeverity,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:intl.formatMessage({id:"xpack.ml.explorer.intervalLabel",defaultMessage:"Interval"})},_react.default.createElement(_select_interval.SelectInterval,null))),anomalyChartRecords.length>0&&selectedCells!==null&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{alignSelf:"center"}},_react.default.createElement(_eui.EuiFormRow,{label:"​"},_react.default.createElement(_checkbox_showcharts.CheckboxShowCharts,null)))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",{className:"euiText explorer-charts"},this.props.showCharts&&_react.default.createElement(_explorer_charts_container.ExplorerChartsContainer,chartsData)),_react.default.createElement(_anomalies_table.AnomaliesTable,{tableData:tableData,timefilter:_timefilter.timefilter,influencerFilter:this.applyFilter})))}}]);return Explorer}(_react.default.Component),_defineProperty(_class,"propTypes",{appStateHandler:_propTypes.default.func.isRequired,dateFormatTz:_propTypes.default.string.isRequired,MlTimeBuckets:_propTypes.default.func.isRequired}),_temp)));exports.Explorer=Explorer},function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3301)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _explorer_no_influencers_found=__webpack_require__(3058);Object.keys(_explorer_no_influencers_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_influencers_found[key]}})});var _explorer_no_jobs_found=__webpack_require__(3060);Object.keys(_explorer_no_jobs_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_jobs_found[key]}})});var _explorer_no_results_found=__webpack_require__(3062);Object.keys(_explorer_no_results_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_results_found[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _explorer_no_influencers_found=__webpack_require__(3059);Object.keys(_explorer_no_influencers_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_influencers_found[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoInfluencersFound=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoInfluencersFound=function ExplorerNoInfluencersFound(_ref){var swimlaneViewByFieldName=_ref.swimlaneViewByFieldName,_ref$showFilterMessag=_ref.showFilterMessage,showFilterMessage=_ref$showFilterMessag===void 0?false:_ref$showFilterMessag;return _react.default.createElement(_eui.EuiEmptyPrompt,{titleSize:"xs",title:_react.default.createElement("h2",null,showFilterMessage===false&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitle",defaultMessage:"No {swimlaneViewByFieldName} influencers found",values:{swimlaneViewByFieldName:swimlaneViewByFieldName}}),showFilterMessage===true&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitleFilterMessage",defaultMessage:"No {swimlaneViewByFieldName} influencers found for specified filter",values:{swimlaneViewByFieldName:swimlaneViewByFieldName}}))})};exports.ExplorerNoInfluencersFound=ExplorerNoInfluencersFound;ExplorerNoInfluencersFound.propTypes={swimlaneViewByFieldName:_propTypes.default.string.isRequired,showFilterMessage:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _explorer_no_jobs_found=__webpack_require__(3061);Object.keys(_explorer_no_jobs_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_jobs_found[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoJobsFound=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoJobsFound=function ExplorerNoJobsFound(){return _react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"alert",title:_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noJobsFoundLabel",defaultMessage:"No jobs found"})),actions:_react.default.createElement(_eui.EuiButton,{color:"primary",fill:true,href:"ml#/jobs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.createNewJobLinkText",defaultMessage:"Create new job"}))})};exports.ExplorerNoJobsFound=ExplorerNoJobsFound},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _explorer_no_results_found=__webpack_require__(3063);Object.keys(_explorer_no_results_found).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_no_results_found[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoResultsFound=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoResultsFound=function ExplorerNoResultsFound(){return _react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"iInCircle",title:_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noResultsFoundLabel",defaultMessage:"No results found"})),body:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.tryWideningTimeSelectionLabel",defaultMessage:"Try widening the time selection or moving further back in time"})))})};exports.ExplorerNoResultsFound=ExplorerNoResultsFound},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerSwimlane=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _d=_interopRequireDefault(__webpack_require__(27));var _moment=_interopRequireDefault(__webpack_require__(16));var _date_utils=__webpack_require__(279);var _chart_utils=__webpack_require__(280);var _anomaly_utils=__webpack_require__(293);var _string_utils=__webpack_require__(67);var _chart_tooltip_service=__webpack_require__(362);var _explorer_dashboard_service=__webpack_require__(581);var _explorer_constants=__webpack_require__(339);var _react2=__webpack_require__(5);var _i18n=__webpack_require__(4);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SCSS={mlDragselectDragging:"mlDragselectDragging",mlHideRangeSelection:"mlHideRangeSelection"};var ExplorerSwimlane=(0,_react2.injectI18n)((_temp=_class=function(_React$Component){_inherits(ExplorerSwimlane,_React$Component);function ExplorerSwimlane(){var _getPrototypeOf2;var _this;_classCallCheck(this,ExplorerSwimlane);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ExplorerSwimlane)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"cellMouseoverActive",true);_defineProperty(_assertThisInitialized(_this),"dragSelectSubscriber",null);return _this}_createClass(ExplorerSwimlane,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var previousSelectedData=null;this.dragSelectSubscriber=_explorer_dashboard_service.dragSelect$.subscribe(function(_ref){var action=_ref.action,_ref$elements=_ref.elements,elements=_ref$elements===void 0?[]:_ref$elements;var element=_d.default.select(_this2.rootNode.parentNode);var swimlaneType=_this2.props.swimlaneType;if(action===_explorer_constants.DRAG_SELECT_ACTION.NEW_SELECTION&&elements.length>0){var firstSelectedCell=_d.default.select(elements[0]).node().__clickData__;if(typeof firstSelectedCell!=="undefined"&&swimlaneType===firstSelectedCell.swimlaneType){var selectedData=elements.reduce(function(d,e){var cell=_d.default.select(e).node().__clickData__;d.bucketScore=Math.max(d.bucketScore,cell.bucketScore);d.laneLabels.push(cell.laneLabel);d.times.push(cell.time);return d},{bucketScore:0,laneLabels:[],times:[]});selectedData.laneLabels=_lodash.default.uniq(selectedData.laneLabels);selectedData.times=_lodash.default.uniq(selectedData.times);if(_lodash.default.isEqual(selectedData,previousSelectedData)===false){_this2.selectCell(elements,selectedData);previousSelectedData=selectedData}}_this2.cellMouseoverActive=true}else if(action===_explorer_constants.DRAG_SELECT_ACTION.ELEMENT_SELECT){element.classed(SCSS.mlDragselectDragging,true);return}else if(action===_explorer_constants.DRAG_SELECT_ACTION.DRAG_START){_this2.cellMouseoverActive=false;return}previousSelectedData=null;element.classed(SCSS.mlDragselectDragging,false);elements.map(function(e){return _d.default.select(e).classed("ds-selected",false)})});this.renderSwimlane()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderSwimlane()}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.dragSelectSubscriber!==null){this.dragSelectSubscriber.unsubscribe()}var element=_d.default.select(this.rootNode);element.html("")}},{key:"selectCell",value:function selectCell(cellsToSelect,_ref2){var laneLabels=_ref2.laneLabels,bucketScore=_ref2.bucketScore,times=_ref2.times;var _this$props=this.props,selection=_this$props.selection,swimlaneCellClick=_this$props.swimlaneCellClick,swimlaneData=_this$props.swimlaneData,swimlaneType=_this$props.swimlaneType;var triggerNewSelection=false;if(cellsToSelect.length>1||bucketScore>0){triggerNewSelection=true}var oldSelection={selectedType:selection&&selection.type,selectedLanes:selection&&selection.lanes,selectedTimes:selection&&selection.times};var newSelection={selectedType:swimlaneType,selectedLanes:laneLabels,selectedTimes:_d.default.extent(times)};if(_lodash.default.isEqual(oldSelection,newSelection)){triggerNewSelection=false}if(triggerNewSelection===false){swimlaneCellClick({});return}var selectedCells={viewByFieldName:swimlaneData.fieldName,lanes:laneLabels,times:_d.default.extent(times),type:swimlaneType};swimlaneCellClick(selectedCells)}},{key:"highlightOverall",value:function highlightOverall(times){var overallSwimlane=_d.default.select(".ml-swimlane-overall");times.forEach(function(time){var overallCell=overallSwimlane.selectAll('div[data-time="'.concat(time,'"]')).selectAll(".sl-cell-inner,.sl-cell-inner-dragselect");overallCell.classed("sl-cell-inner-selected",true)})}},{key:"highlightSelection",value:function highlightSelection(cellsToSelect,laneLabels,times){var swimlaneType=this.props.swimlaneType;var wrapper=_d.default.selectAll(".ml-explorer-swimlane");wrapper.selectAll(".lane-label").classed("lane-label-masked",true);wrapper.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true);wrapper.selectAll(".sl-cell-inner.sl-cell-inner-selected,.sl-cell-inner-dragselect.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);_d.default.selectAll(cellsToSelect).selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",false).classed("sl-cell-inner-selected",true);var rootParent=_d.default.select(this.rootNode.parentNode);rootParent.selectAll(".lane-label").classed("lane-label-masked",function(){return laneLabels.indexOf(_d.default.select(this).text())===-1});if(swimlaneType==="viewBy"){this.highlightOverall(times)}}},{key:"maskIrrelevantSwimlanes",value:function maskIrrelevantSwimlanes(maskAll){if(maskAll===true){var allSwimlanes=_d.default.selectAll(".ml-explorer-swimlane");allSwimlanes.selectAll(".lane-label").classed("lane-label-masked",true);allSwimlanes.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true)}else{var overallSwimlane=_d.default.select(".ml-swimlane-overall");overallSwimlane.selectAll(".lane-label").classed("lane-label-masked",true);overallSwimlane.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true)}}},{key:"clearSelection",value:function clearSelection(){var wrapper=_d.default.selectAll(".ml-explorer-swimlane");wrapper.selectAll(".lane-label").classed("lane-label-masked",false);wrapper.selectAll(".sl-cell-inner").classed("sl-cell-inner-masked",false);wrapper.selectAll(".sl-cell-inner.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);wrapper.selectAll(".sl-cell-inner-dragselect.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);wrapper.selectAll(".ds-selected").classed("sl-cell-inner-selected",false)}},{key:"renderSwimlane",value:function renderSwimlane(){var element=_d.default.select(this.rootNode.parentNode);if(!_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){element.classed(SCSS.mlHideRangeSelection,true)}var cellMouseoverActive=this.cellMouseoverActive;var _this$props2=this.props,chartWidth=_this$props2.chartWidth,filterActive=_this$props2.filterActive,maskAll=_this$props2.maskAll,MlTimeBuckets=_this$props2.MlTimeBuckets,swimlaneCellClick=_this$props2.swimlaneCellClick,swimlaneData=_this$props2.swimlaneData,swimlaneType=_this$props2.swimlaneType,selection=_this$props2.selection,intl=_this$props2.intl;var lanes=swimlaneData.laneLabels,startTime=swimlaneData.earliest,endTime=swimlaneData.latest,stepSecs=swimlaneData.interval,points=swimlaneData.points;function colorScore(value){return(0,_anomaly_utils.getSeverityColor)(value)}var numBuckets=parseInt((endTime-startTime)/stepSecs);var cellHeight=30;var height=(lanes.length+1)*cellHeight-10;var laneLabelWidth=170;element.style("height","".concat(height+20,"px"));var swimlanes=element.select(".ml-swimlanes");swimlanes.html("");var cellWidth=Math.floor(chartWidth/numBuckets*100)/100;var xAxisWidth=cellWidth*numBuckets;var xAxisScale=_d.default.time.scale().domain([new Date(startTime*1e3),new Date(endTime*1e3)]).range([0,xAxisWidth]);var timeBuckets=new MlTimeBuckets;timeBuckets.setInterval("".concat(stepSecs,"s"));var xAxisTickFormat=timeBuckets.getScaledDateFormat();function cellMouseOverFactory(time,i){return function(lane){var bucketScore=getBucketScore(lane,time);if(bucketScore!==0){cellMouseover(this,lane,bucketScore,i,time)}}}function cellMouseover(target,laneLabel,bucketScore,index,time){if(bucketScore===undefined||cellMouseoverActive===false){return}var displayScore=bucketScore>1?parseInt(bucketScore):"< 1";var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(time*1e3);var contents="".concat(formattedDate,"<br/><hr/>");if(swimlaneData.fieldName!==undefined){contents+="".concat((0,_string_utils.mlEscape)(swimlaneData.fieldName),": ").concat((0,_string_utils.mlEscape)(laneLabel),"<br/><hr/>")}contents+=intl.formatMessage({id:"xpack.ml.explorer.swimlane.maxAnomalyScoreLabel",defaultMessage:"Max anomaly score: {displayScore}"},{displayScore:displayScore});var offsets=target.className==="sl-cell-inner"?{x:0,y:0}:{x:2,y:1};_chart_tooltip_service.mlChartTooltipService.show(contents,target,{x:target.offsetWidth-offsets.x,y:10+offsets.y})}function cellMouseleave(){_chart_tooltip_service.mlChartTooltipService.hide()}var d3Lanes=swimlanes.selectAll(".lane").data(lanes);var d3LanesEnter=d3Lanes.enter().append("div").classed("lane",true);d3LanesEnter.append("div").classed("lane-label",true).style("width","".concat(laneLabelWidth,"px")).html(function(label){var showFilterContext=filterActive===true&&label==="Overall";if(showFilterContext){return _i18n.i18n.translate("xpack.ml.explorer.overallSwimlaneUnfilteredLabel",{defaultMessage:"{label} (unfiltered)",values:{label:(0,_string_utils.mlEscape)(label)}})}else{return(0,_string_utils.mlEscape)(label)}}).on("click",function(){if(selection&&typeof selection.lanes!=="undefined"){swimlaneCellClick({})}}).each(function(){if(swimlaneData.fieldName!==undefined){_d.default.select(this).attr("tooltip-html-unsafe",function(label){return"".concat((0,_string_utils.mlEscape)(swimlaneData.fieldName),": ").concat((0,_string_utils.mlEscape)(label))}).attr("tooltip-placement","right").attr("aria-label",function(label){return"".concat((0,_string_utils.mlEscape)(swimlaneData.fieldName),": ").concat((0,_string_utils.mlEscape)(label))})}});var cellsContainer=d3LanesEnter.append("div").classed("cells-container",true);function getBucketScore(lane,time){var bucketScore=0;var point=points.find(function(p){return p.value>0&&p.laneLabel===lane&&p.time===time});if(typeof point!=="undefined"){bucketScore=point.value}return bucketScore}var time=startTime;Array(numBuckets||0).fill(null).forEach(function(v,i){var cell=cellsContainer.append("div").classed("sl-cell",true).style("width","".concat(cellWidth,"px")).attr("data-lane-label",function(label){return(0,_string_utils.mlEscape)(label)}).attr("data-time",time).attr("data-bucket-score",function(lane){return getBucketScore(lane,time)}).on("mouseover",cellMouseOverFactory(time,i)).on("mouseleave",cellMouseleave).each(function(laneLabel){this.__clickData__={bucketScore:getBucketScore(laneLabel,time),laneLabel:laneLabel,swimlaneType:swimlaneType,time:time}});cell.append("div").each(function(lane){var el=_d.default.select(this);var color="none";var bucketScore=0;var point=points.find(function(p){return p.value>0&&p.laneLabel===lane&&p.time===time});if(typeof point!=="undefined"){bucketScore=point.value;color=colorScore(bucketScore);el.classed("sl-cell-inner",true).style("background-color",color)}else{el.classed("sl-cell-inner-dragselect",true)}});time+=stepSecs});var laneTimes=swimlanes.selectAll(".time-tick-labels").data(["x-axis"]).enter().append("div").classed("time-tick-labels",true);var svgHeight=25;var svg=laneTimes.append("svg").attr("width",chartWidth).attr("height",svgHeight);var xAxis=_d.default.svg.axis().scale(xAxisScale).ticks((0,_chart_utils.numTicksForDateFormat)(chartWidth,xAxisTickFormat)).tickFormat(function(tick){return(0,_moment.default)(tick).format(xAxisTickFormat)});var gAxis=svg.append("g").attr("class","x axis").call(xAxis);var overlapCheck=0;gAxis.selectAll("g.tick").each(function(){var tick=_d.default.select(this);var xTransform=_d.default.transform(tick.attr("transform")).translate[0];var tickWidth=tick.select("text").node().getBBox().width;var xMinOffset=xTransform-tickWidth/2;var xMaxOffset=xTransform+tickWidth/2;if(xMinOffset<overlapCheck){tick.remove()}else{overlapCheck=xTransform+tickWidth/2}if(xMaxOffset>chartWidth){tick.remove()}});var selectionState=selection;var selectedType=_lodash.default.get(selectionState,"type",undefined);var selectionViewByFieldName=_lodash.default.get(selectionState,"viewByFieldName","");if(swimlaneType!==selectedType&&selectedType!==undefined){element.selectAll(".lane-label").classed("lane-label-masked",true);element.selectAll(".sl-cell-inner").classed("sl-cell-inner-masked",true)}this.props.swimlaneRenderDoneListener();if((swimlaneType!==selectedType||swimlaneData.fieldName!==undefined&&swimlaneData.fieldName!==selectionViewByFieldName)&&filterActive===false){return}var cellsToSelect=[];var selectedLanes=_lodash.default.get(selectionState,"lanes",[]);var selectedTimes=_lodash.default.get(selectionState,"times",[]);var selectedTimeExtent=_d.default.extent(selectedTimes);selectedLanes.forEach(function(selectedLane){if(lanes.indexOf(selectedLane)>-1&&selectedTimeExtent[0]>=startTime&&selectedTimeExtent[1]<=endTime){var swimlaneElements=element.select(".ml-swimlanes");var laneCells=swimlaneElements.selectAll('div[data-lane-label="'.concat((0,_string_utils.mlEscape)(selectedLane),'"]'));laneCells.each(function(){var cell=_d.default.select(this);var cellTime=cell.attr("data-time");if(cellTime>=selectedTimeExtent[0]&&cellTime<=selectedTimeExtent[1]){cellsToSelect.push(cell.node())}})}});var selectedMaxBucketScore=cellsToSelect.reduce(function(maxBucketScore,cell){return Math.max(maxBucketScore,+_d.default.select(cell).attr("data-bucket-score")||0)},0);if(cellsToSelect.length>1||selectedMaxBucketScore>0){this.highlightSelection(cellsToSelect,selectedLanes,selectedTimes)}else if(filterActive===true){if(selectedTimes){this.highlightOverall(selectedTimes)}this.maskIrrelevantSwimlanes(maskAll)}else{this.clearSelection()}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var swimlaneType=this.props.swimlaneType;return _react.default.createElement("div",{className:"ml-swimlanes ml-swimlane-".concat(swimlaneType),ref:this.setRef.bind(this)})}}]);return ExplorerSwimlane}(_react.default.Component),_defineProperty(_class,"propTypes",{chartWidth:_propTypes.default.number.isRequired,filterActive:_propTypes.default.bool,maskAll:_propTypes.default.bool,MlTimeBuckets:_propTypes.default.func.isRequired,swimlaneCellClick:_propTypes.default.func.isRequired,swimlaneData:_propTypes.default.shape({laneLabels:_propTypes.default.array.isRequired}).isRequired,swimlaneType:_propTypes.default.string.isRequired,selection:_propTypes.default.object,swimlaneRenderDoneListener:_propTypes.default.func.isRequired}),_temp));exports.ExplorerSwimlane=ExplorerSwimlane},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"KqlFilterBar",{enumerable:true,get:function get(){return _kql_filter_bar.KqlFilterBar}});var _kql_filter_bar=__webpack_require__(3066)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.KqlFilterBar=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _lodash=__webpack_require__(3);var _filter_bar=__webpack_require__(3067);var _eui=__webpack_require__(1);var _i18n=__webpack_require__(4);var _metadata=__webpack_require__(241);var _utils=__webpack_require__(1388);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getErrorWithLink(errorMessage){return _react.default.createElement(_eui.EuiText,null,"".concat(errorMessage," Input must be valid "),_react.default.createElement(_eui.EuiLink,{href:"https://www.elastic.co/guide/en/kibana/".concat(_metadata.metadata.branch,"/kuery-query.html"),target:"_blank"},"Kibana Query Language")," (KQL) syntax.")}var KqlFilterBar=function(_Component){_inherits(KqlFilterBar,_Component);function KqlFilterBar(){var _getPrototypeOf2;var _this;_classCallCheck(this,KqlFilterBar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(KqlFilterBar)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"state",{error:null,suggestions:[],isLoadingSuggestions:false,isLoadingIndexPattern:true});_defineProperty(_assertThisInitialized(_this),"onChange",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(inputValue,selectionStart){var indexPattern,currentRequest,boolFilter,suggestions,errorMessage;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:indexPattern=_this.props.indexPattern;_this.setState({error:null,suggestions:[],isLoadingSuggestions:true});currentRequest=(0,_lodash.uniqueId)();_this.currentRequest=currentRequest;boolFilter=[];_context.prev=5;_context.next=8;return(0,_utils.getSuggestions)(inputValue,selectionStart,indexPattern,boolFilter);case 8:suggestions=_context.sent;if(!(currentRequest!==_this.currentRequest)){_context.next=11;break}return _context.abrupt("return");case 11:_this.setState({suggestions:suggestions,isLoadingSuggestions:false});_context.next=19;break;case 14:_context.prev=14;_context.t0=_context["catch"](5);console.error("Error while fetching suggestions",_context.t0);errorMessage=_i18n.i18n.translate("xpack.ml.explorer.fetchingSuggestionsErrorMessage",{defaultMessage:"Error while fetching suggestions"});_this.setState({isLoadingSuggestions:false,error:_context.t0.message?_context.t0.message:errorMessage});case 19:case"end":return _context.stop()}}},_callee,null,[[5,14]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"onSubmit",function(inputValue){var indexPattern=_this.props.indexPattern;var onSubmit=_this.props.onSubmit;try{var kqlQueryValues=(0,_utils.getKqlQueryValues)(inputValue,indexPattern);onSubmit(kqlQueryValues)}catch(e){console.log("Invalid kuery syntax",e);var errorWithLink=getErrorWithLink(e.message);var errorMessage=_i18n.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessage",{defaultMessage:"Invalid kuery syntax"});_this.setState({error:e.message?errorWithLink:errorMessage})}});return _this}_createClass(KqlFilterBar,[{key:"render",value:function render(){var error=this.state.error;var _this$props=this.props,initialValue=_this$props.initialValue,placeholder=_this$props.placeholder,valueExternal=_this$props.valueExternal;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_filter_bar.FilterBar,{disabled:false,isLoading:this.state.isLoadingSuggestions,initialValue:initialValue||"",onChange:this.onChange,placeholder:placeholder,onSubmit:this.onSubmit,suggestions:this.state.suggestions,valueExternal:valueExternal}),error&&_react.default.createElement(_eui.EuiCallOut,{color:"danger"},error))}}]);return KqlFilterBar}(_react.Component);exports.KqlFilterBar=KqlFilterBar;KqlFilterBar.propTypes={indexPattern:_propTypes.default.object.isRequired,initialValue:_propTypes.default.string,onSubmit:_propTypes.default.func.isRequired,placeholder:_propTypes.default.string,valueExternal:_propTypes.default.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FilterBar",{enumerable:true,get:function get(){return _filter_bar.FilterBar}});var _filter_bar=__webpack_require__(3068)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterBar=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _suggestions=__webpack_require__(3069);var _click_outside=__webpack_require__(3073);var _eui=__webpack_require__(1);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FilterBar=function(_Component){_inherits(FilterBar,_Component);function FilterBar(){var _getPrototypeOf2;var _this;_classCallCheck(this,FilterBar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(FilterBar)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"state",{isSuggestionsVisible:false,index:null,value:"",inputIsPristine:true});_defineProperty(_assertThisInitialized(_this),"incrementIndex",function(currentIndex){var nextIndex=currentIndex+1;if(currentIndex===null||nextIndex>=_this.props.suggestions.length){nextIndex=0}_this.setState({index:nextIndex})});_defineProperty(_assertThisInitialized(_this),"decrementIndex",function(currentIndex){var previousIndex=currentIndex-1;if(previousIndex<0){previousIndex=null}_this.setState({index:previousIndex})});_defineProperty(_assertThisInitialized(_this),"onKeyUp",function(event){var selectionStart=event.target.selectionStart;var value=_this.state.value;switch(event.keyCode){case _eui.keyCodes.LEFT:case _eui.keyCodes.RIGHT:_this.setState({isSuggestionsVisible:true});_this.props.onChange(value,selectionStart);break}});_defineProperty(_assertThisInitialized(_this),"onKeyDown",function(event){var _this$state=_this.state,isSuggestionsVisible=_this$state.isSuggestionsVisible,index=_this$state.index,value=_this$state.value;switch(event.keyCode){case _eui.keyCodes.DOWN:event.preventDefault();if(isSuggestionsVisible){_this.incrementIndex(index)}else{_this.setState({isSuggestionsVisible:true,index:0})}break;case _eui.keyCodes.UP:event.preventDefault();if(isSuggestionsVisible){_this.decrementIndex(index)}break;case _eui.keyCodes.ENTER:event.preventDefault();if(isSuggestionsVisible&&_this.props.suggestions[index]){_this.selectSuggestion(_this.props.suggestions[index])}else{_this.setState({isSuggestionsVisible:false});_this.props.onSubmit(value)}break;case _eui.keyCodes.ESC:event.preventDefault();_this.setState({isSuggestionsVisible:false});break;case _eui.keyCodes.TAB:_this.setState({isSuggestionsVisible:false});break}});_defineProperty(_assertThisInitialized(_this),"selectSuggestion",function(suggestion){var nextInputValue=_this.state.value.substr(0,suggestion.start)+suggestion.text+_this.state.value.substr(suggestion.end);_this.setState({value:nextInputValue,index:null});_this.props.onChange(nextInputValue,nextInputValue.length)});_defineProperty(_assertThisInitialized(_this),"onClickOutside",function(){_this.setState({isSuggestionsVisible:false})});_defineProperty(_assertThisInitialized(_this),"onChangeInputValue",function(event){var _event$target=event.target,value=_event$target.value,selectionStart=_event$target.selectionStart;var hasValue=Boolean(value.trim());_this.setState({value:value,inputIsPristine:false,isSuggestionsVisible:hasValue,index:null});if(!hasValue){_this.props.onSubmit(value)}_this.props.onChange(value,selectionStart)});_defineProperty(_assertThisInitialized(_this),"onClickInput",function(event){var selectionStart=event.target.selectionStart;_this.props.onChange(_this.state.value,selectionStart)});_defineProperty(_assertThisInitialized(_this),"onClickSuggestion",function(suggestion){_this.selectSuggestion(suggestion);_this.inputRef.focus()});_defineProperty(_assertThisInitialized(_this),"onMouseEnterSuggestion",function(index){_this.setState({index:index})});_defineProperty(_assertThisInitialized(_this),"onSubmit",function(){_this.props.onSubmit(_this.state.value);_this.setState({isSuggestionsVisible:false})});return _this}_createClass(FilterBar,[{key:"componentDidUpdate",value:function componentDidUpdate(oldProps){var newProps=this.props;if(oldProps.valueExternal!==newProps.valueExternal){this.setState({value:newProps.valueExternal,index:null})}}},{key:"render",value:function render(){var _this2=this;var disabled=this.props.disabled;var value=this.state.value;return _react.default.createElement(_click_outside.ClickOutside,{onClickOutside:this.onClickOutside,style:{position:"relative"}},_react.default.createElement("div",{style:{position:"relative"}},_react.default.createElement(_eui.EuiFieldSearch,{fullWidth:true,style:{backgroundImage:"none"},placeholder:_i18n.i18n.translate("xpack.ml.explorer.kueryBar.filterPlaceholder",{defaultMessage:"Filter by influencer fields… (E.g. {queryExample})",values:{queryExample:"".concat(this.props.placeholder)}}),inputRef:function inputRef(node){if(node){_this2.inputRef=node}},disabled:disabled,value:value,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onChange:this.onChangeInputValue,onClick:this.onClickInput,autoComplete:"off",spellCheck:false}),this.props.isLoading&&_react.default.createElement(_eui.EuiProgress,{size:"xs",color:"accent",position:"absolute",style:{bottom:0,top:"initial"}})),_react.default.createElement(_suggestions.Suggestions,{show:this.state.isSuggestionsVisible,suggestions:this.props.suggestions,index:this.state.index,onClick:this.onClickSuggestion,onMouseEnter:this.onMouseEnterSuggestion}))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){if(state.inputIsPristine&&props.initialValue){return{value:props.initialValue}}return null}}]);return FilterBar}(_react.Component);exports.FilterBar=FilterBar;FilterBar.propTypes={initialValue:_propTypes.default.string,isLoading:_propTypes.default.bool,disabled:_propTypes.default.bool,onChange:_propTypes.default.func.isRequired,placeholder:_propTypes.default.string,onSubmit:_propTypes.default.func.isRequired,valueExternal:_propTypes.default.string,suggestions:_propTypes.default.array.isRequired};FilterBar.defaultProps={isLoading:false,disabled:false,placeholder:"tag : engineering OR tag : marketing",suggestions:[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Suggestions",{enumerable:true,get:function get(){return _suggestions.Suggestions}});var _suggestions=__webpack_require__(3070)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Suggestions=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _styledComponents=_interopRequireDefault(__webpack_require__(13));var _suggestion=__webpack_require__(3071);var _polished=__webpack_require__(232);var _eui_theme_light=_interopRequireDefault(__webpack_require__(41));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _templateObject(){var data=_taggedTemplateLiteral(["\n  width: 100%;\n  border: 1px solid ",";\n  border-radius: ",";\n  box-shadow: 0px "," ","\n    ",";\n  position: absolute;\n  background: #fff;\n  z-index: 10;\n  left: 0;\n  max-height: ","px;\n  overflow: scroll;\n"]);_templateObject=function _templateObject(){return data};return data}function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0)}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var List=_styledComponents.default.ul(_templateObject(),_eui_theme_light.default.euiColorLightShade,_eui_theme_light.default.euiSizeXS,_eui_theme_light.default.euiSizeXS,_eui_theme_light.default.euiSizeXL,(0,_polished.rgba)(_eui_theme_light.default.euiTextColor,.1),_eui_theme_light.default.euiSize*20);var Suggestions=function(_Component){_inherits(Suggestions,_Component);function Suggestions(){var _getPrototypeOf2;var _this;_classCallCheck(this,Suggestions);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Suggestions)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"childNodes",[]);_defineProperty(_assertThisInitialized(_this),"scrollIntoView",function(){var parent=_this.parentNode;var child=_this.childNodes[_this.props.index];if(_this.props.index==null||!parent||!child){return}var scrollTop=Math.max(Math.min(parent.scrollTop,child.offsetTop),child.offsetTop+child.offsetHeight-parent.offsetHeight);parent.scrollTop=scrollTop});return _this}_createClass(Suggestions,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){if(prevProps.index!==this.props.index){this.scrollIntoView()}}},{key:"render",value:function render(){var _this2=this;if(!this.props.show||this.props.suggestions.length===0){return null}var suggestions=this.props.suggestions.map(function(suggestion,index){var key="".concat(suggestion,"_").concat(index);return _react.default.createElement(_suggestion.Suggestion,{innerRef:function innerRef(node){return _this2.childNodes[index]=node},selected:index===_this2.props.index,suggestion:suggestion,onClick:_this2.props.onClick,onMouseEnter:function onMouseEnter(){return _this2.props.onMouseEnter(index)},key:key})});return _react.default.createElement(List,{innerRef:function innerRef(node){return _this2.parentNode=node}},suggestions)}}]);return Suggestions}(_react.Component);exports.Suggestions=Suggestions;Suggestions.propTypes={index:_propTypes.default.number,onClick:_propTypes.default.func.isRequired,onMouseEnter:_propTypes.default.func.isRequired,show:_propTypes.default.bool,suggestions:_propTypes.default.array.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Suggestion",{enumerable:true,get:function get(){return _suggestion.Suggestion}});var _suggestion=__webpack_require__(3072)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Suggestion=void 0;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _styledComponents=_interopRequireDefault(__webpack_require__(13));var _eui=__webpack_require__(1);var _polished=__webpack_require__(232);var _eui_theme_light=_interopRequireDefault(__webpack_require__(41));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _templateObject4(){var data=_taggedTemplateLiteral(["\n  flex: 0 0 ","px;\n  color: ",";\n  padding: 0 ",";\n"]);_templateObject4=function _templateObject4(){return data};return data}function _templateObject3(){var data=_taggedTemplateLiteral(["\n  flex: 0 0 ",";\n  background: ",";\n  color: ",";\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  line-height: ",";\n"]);_templateObject3=function _templateObject3(){return data};return data}function _templateObject2(){var data=_taggedTemplateLiteral(["\n  font-size: ",";\n  height: ",";\n  align-items: center;\n  display: flex;\n  background: ",";\n  cursor: pointer;\n  border-radius: ",";\n\n  "," {\n    p span {\n      background: ",";\n    }\n  }\n"]);_templateObject2=function _templateObject2(){return data};return data}function _templateObject(){var data=_taggedTemplateLiteral(["\n  color: ",";\n\n  p {\n    display: inline;\n\n    span {\n      font-family: ",";\n      color: ",";\n      padding: 0 ",";\n      display: inline-block;\n    }\n  }\n"]);_templateObject=function _templateObject(){return data};return data}function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0)}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function getIconColor(type){switch(type){case"field":return _eui_theme_light.default.euiColorVis7;case"value":return _eui_theme_light.default.euiColorVis0;case"operator":return _eui_theme_light.default.euiColorVis1;case"conjunction":return _eui_theme_light.default.euiColorVis3;case"recentSearch":return _eui_theme_light.default.euiColorMediumShade}}var Description=_styledComponents.default.div(_templateObject(),_eui_theme_light.default.euiColorDarkShade,_eui_theme_light.default.euiFontFamily,_eui_theme_light.default.euiColorFullShade,_eui_theme_light.default.euiSizeXS);var ListItem=_styledComponents.default.li(_templateObject2(),_eui_theme_light.default.euiFontSizeXS,_eui_theme_light.default.euiSizeXL,function(props){return props.selected?_eui_theme_light.default.euiColorLightestShade:"initial"},_eui_theme_light.default.euiSizeXS,Description,function(props){return props.selected?_eui_theme_light.default.euiColorEmptyShade:_eui_theme_light.default.euiColorLightestShade});var Icon=_styledComponents.default.div(_templateObject3(),_eui_theme_light.default.euiSizeXL,function(props){return(0,_polished.tint)(.1,getIconColor(props.type))},function(props){return getIconColor(props.type)},_eui_theme_light.default.euiSizeXL);var TextValue=_styledComponents.default.div(_templateObject4(),_eui_theme_light.default.euiSize*16,_eui_theme_light.default.euiColorDarkestShade,_eui_theme_light.default.euiSizeS);function getEuiIconType(type){switch(type){case"field":return"kqlField";case"value":return"kqlValue";case"recentSearch":return"search";case"conjunction":return"kqlSelector";case"operator":return"kqlOperand";default:throw new Error("Unknown type",type)}}var Suggestion=function Suggestion(props){return _react.default.createElement(ListItem,{innerRef:props.innerRef,selected:props.selected,onClick:function onClick(){return props.onClick(props.suggestion)},onMouseEnter:props.onMouseEnter},_react.default.createElement(Icon,{type:props.suggestion.type},_react.default.createElement(_eui.EuiIcon,{type:getEuiIconType(props.suggestion.type)})),_react.default.createElement(TextValue,null,props.suggestion.text),_react.default.createElement(Description,null,props.suggestion.description))};exports.Suggestion=Suggestion;Suggestion.propTypes={onClick:_propTypes.default.func.isRequired,onMouseEnter:_propTypes.default.func.isRequired,selected:_propTypes.default.bool,suggestion:_propTypes.default.object.isRequired,innerRef:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ClickOutside",{enumerable:true,get:function get(){return _click_outside.ClickOutside}});var _click_outside=__webpack_require__(3074)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ClickOutside=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var ClickOutside=function(_Component){_inherits(ClickOutside,_Component);function ClickOutside(){var _getPrototypeOf2;var _this;_classCallCheck(this,ClickOutside);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ClickOutside)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"setNodeRef",function(node){_this.nodeRef=node});_defineProperty(_assertThisInitialized(_this),"onClick",function(event){if(_this.nodeRef&&!_this.nodeRef.contains(event.target)){_this.props.onClickOutside()}});return _this}_createClass(ClickOutside,[{key:"componentDidMount",value:function componentDidMount(){document.addEventListener("mousedown",this.onClick)}},{key:"componentWillUnmount",value:function componentWillUnmount(){document.removeEventListener("mousedown",this.onClick)}},{key:"render",value:function render(){var _this$props=this.props,style=_this$props.style,children=_this$props.children;return _react.default.createElement("div",{ref:this.setNodeRef,style:style},children)}}]);return ClickOutside}(_react.Component);exports.ClickOutside=ClickOutside;ClickOutside.propTypes={onClickOutside:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _influencers_list=__webpack_require__(3076);Object.keys(_influencers_list).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _influencers_list[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InfluencersList=InfluencersList;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _abbreviate_whole_number=__webpack_require__(3077);var _anomaly_utils=__webpack_require__(293);var _entity_cell=__webpack_require__(894);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getTooltipContent(maxScoreLabel,totalScoreLabel){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:maxScoreLabel}})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:totalScoreLabel}})))}function Influencer(_ref){var influencerFieldName=_ref.influencerFieldName,influencerFilter=_ref.influencerFilter,valueData=_ref.valueData;var maxScorePrecise=valueData.maxAnomalyScore;var maxScore=parseInt(maxScorePrecise);var maxScoreLabel=maxScore!==0?maxScore:"< 1";var severity=(0,_anomaly_utils.getSeverity)(maxScore);var totalScore=parseInt(valueData.sumAnomalyScore);var totalScoreLabel=totalScore!==0?totalScore:"< 1";var barScore=maxScore!==0?maxScore:1;var barStyle={width:"".concat(barScore,"%")};var tooltipContent=getTooltipContent(maxScoreLabel,totalScoreLabel);return _react.default.createElement("div",null,_react.default.createElement("div",{className:"field-label"},influencerFieldName!=="mlcategory"?_react.default.createElement(_entity_cell.EntityCell,{entityName:influencerFieldName,entityValue:valueData.influencerFieldValue,filter:influencerFilter}):_react.default.createElement("div",{className:"field-value"},"mlcategory ",valueData.influencerFieldValue)),_react.default.createElement("div",{className:"progress ".concat(severity.id),value:"{valueData.maxAnomalyScore}",max:"100"},_react.default.createElement("div",{className:"progress-bar-holder"},_react.default.createElement("div",{className:"progress-bar",style:barStyle})),_react.default.createElement("div",{className:"score-label"},_react.default.createElement(_eui.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:"".concat(influencerFieldName,": ").concat(valueData.influencerFieldValue),content:tooltipContent},_react.default.createElement("span",null,maxScoreLabel)))),_react.default.createElement("div",{className:"total-score-label"},_react.default.createElement(_eui.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:"".concat(influencerFieldName,": ").concat(valueData.influencerFieldValue),content:tooltipContent},_react.default.createElement("span",null,totalScore>0?(0,_abbreviate_whole_number.abbreviateWholeNumber)(totalScore,4):totalScoreLabel))))}Influencer.propTypes={influencerFieldName:_propTypes.default.string.isRequired,influencerFilter:_propTypes.default.func,valueData:_propTypes.default.object.isRequired};function InfluencersByName(_ref2){var influencerFieldName=_ref2.influencerFieldName,influencerFilter=_ref2.influencerFilter,fieldValues=_ref2.fieldValues;var influencerValues=fieldValues.map(function(valueData){return _react.default.createElement(Influencer,{key:valueData.influencerFieldValue,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,valueData:valueData})});return _react.default.createElement(_react.default.Fragment,{key:influencerFieldName},_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("h4",null,influencerFieldName)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),influencerValues)}InfluencersByName.propTypes={influencerFieldName:_propTypes.default.string.isRequired,influencerFilter:_propTypes.default.func,fieldValues:_propTypes.default.array.isRequired};function InfluencersList(_ref3){var influencers=_ref3.influencers,influencerFilter=_ref3.influencerFilter;if(influencers===undefined||Object.keys(influencers).length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))))}var influencersByName=Object.keys(influencers).map(function(influencerFieldName){return _react.default.createElement(InfluencersByName,{key:influencerFieldName,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,fieldValues:influencers[influencerFieldName]})});return _react.default.createElement("div",{className:"ml-influencers-list"},influencersByName)}InfluencersList.propTypes={influencers:_propTypes.default.object,influencerFilter:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.abbreviateWholeNumber=abbreviateWholeNumber;var _numeral=_interopRequireDefault(__webpack_require__(217));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function abbreviateWholeNumber(value){var maxDigits=arguments.length>1&&arguments[1]!==undefined?arguments[1]:3;if(Math.abs(value)<Math.pow(10,maxDigits)){return value}else{return(0,_numeral.default)(value).format("0a")}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDefaultChartsData=getDefaultChartsData;exports.explorerChartsContainerServiceFactory=explorerChartsContainerServiceFactory;var _lodash=_interopRequireDefault(__webpack_require__(3));var _explorer_chart_config_builder=__webpack_require__(3079);var _chart_utils=__webpack_require__(280);var _anomaly_utils=__webpack_require__(293);var _job_utils=__webpack_require__(58);var _results_service=__webpack_require__(436);var _job_service=__webpack_require__(36);var _select_severity=__webpack_require__(401);var _legacy_utils=__webpack_require__(1391);var _explorer_constants=__webpack_require__(339);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getDefaultChartsData(){return{chartsPerRow:1,seriesToPlot:[],tooManyBuckets:false,timeFieldName:"timestamp"}}function explorerChartsContainerServiceFactory(callback){var CHART_MAX_POINTS=500;var ANOMALIES_MAX_RESULTS=500;var MAX_SCHEDULED_EVENTS=10;var ML_TIME_FIELD_NAME="timestamp";var USE_OVERALL_CHART_LIMITS=false;var MAX_CHARTS_PER_ROW=4;callback(getDefaultChartsData());var requestCount=0;var anomalyDataChange=function anomalyDataChange(anomalyRecords,earliestMs,latestMs){var newRequestCount=++requestCount;requestCount=newRequestCount;var data=getDefaultChartsData();var threshold=_select_severity.severity$.getValue();var filteredRecords=anomalyRecords.filter(function(record){return Number(record.record_score)>=threshold.val});var allSeriesRecords=processRecordsForDisplay(filteredRecords);var chartsContainerWidth=(0,_legacy_utils.getChartContainerWidth)();var chartsPerRow=Math.min(Math.max(Math.floor(chartsContainerWidth/550),1),MAX_CHARTS_PER_ROW);if(allSeriesRecords.length===1){chartsPerRow=1}data.chartsPerRow=chartsPerRow;var maxSeriesToPlot=Math.max(chartsPerRow*2,6);var recordsToPlot=allSeriesRecords.slice(0,maxSeriesToPlot);var seriesConfigs=recordsToPlot.map(_explorer_chart_config_builder.buildConfig);data.tooManyBuckets=false;var chartWidth=Math.floor(chartsContainerWidth/chartsPerRow);var _calculateChartRange=calculateChartRange(seriesConfigs,earliestMs,latestMs,chartWidth,recordsToPlot,data.timeFieldName),chartRange=_calculateChartRange.chartRange,tooManyBuckets=_calculateChartRange.tooManyBuckets;data.tooManyBuckets=tooManyBuckets;data.seriesToPlot=seriesConfigs.map(function(config){return _objectSpread({},config,{loading:true,chartData:null})});callback(data);function getMetricData(config,range){var jobId=config.jobId,detectorIndex=config.detectorIndex,entityFields=config.entityFields,interval=config.interval;var job=_job_service.mlJobService.getJob(jobId);var useSourceData=(0,_job_utils.isSourceDataChartableForDetector)(job,detectorIndex);if(useSourceData===true){var datafeedQuery=_lodash.default.get(config,"datafeedConfig.query",null);return _results_service.mlResultsService.getMetricData(config.datafeedConfig.indices,config.entityFields,datafeedQuery,config.metricFunction,config.metricFieldName,config.timeField,range.min,range.max,config.interval)}else{var criteriaFields=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});if(partitionEntity!==undefined){criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}}if(_lodash.default.has(detector,"over_field_name")){var overEntity=_lodash.default.find(entityFields,{fieldName:detector.over_field_name});if(overEntity!==undefined){criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}}if(_lodash.default.has(detector,"by_field_name")){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});if(byEntity!==undefined){criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}}return new Promise(function(resolve,reject){var obj={success:true,results:{}};return _results_service.mlResultsService.getModelPlotOutput(jobId,detectorIndex,criteriaFields,range.min,range.max,interval).then(function(resp){var results=resp.results;Object.keys(results).forEach(function(time){obj.results[time]=results[time].actual});resolve(obj)}).catch(function(resp){reject(resp)})})}}function getRecordsForCriteria(config,range){var criteria=[];criteria.push({fieldName:"detector_index",fieldValue:config.detectorIndex});criteria=criteria.concat(config.entityFields);return _results_service.mlResultsService.getRecordsForCriteria([config.jobId],criteria,0,range.min,range.max,ANOMALIES_MAX_RESULTS)}function getScheduledEvents(config,range){return _results_service.mlResultsService.getScheduledEventsByBucket([config.jobId],range.min,range.max,config.interval,1,MAX_SCHEDULED_EVENTS)}function getEventDistribution(config,range){var chartType=(0,_chart_utils.getChartType)(config);var splitField;var filterField=null;if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){splitField=config.entityFields.find(function(f){return f.fieldType==="by"});filterField=config.entityFields.find(function(f){return f.fieldType==="partition"})}else if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){splitField=config.entityFields.find(function(f){return f.fieldType==="over"});filterField=config.entityFields.find(function(f){return f.fieldType==="partition"})}var datafeedQuery=_lodash.default.get(config,"datafeedConfig.query",null);return _results_service.mlResultsService.getEventDistributionData(config.datafeedConfig.indices,splitField,filterField,datafeedQuery,config.metricFunction,config.metricFieldName,config.timeField,range.min,range.max,config.interval)}var seriesPromises=seriesConfigs.map(function(seriesConfig){return Promise.all([getMetricData(seriesConfig,chartRange),getRecordsForCriteria(seriesConfig,chartRange),getScheduledEvents(seriesConfig,chartRange),getEventDistribution(seriesConfig,chartRange)])});function processChartData(response,seriesIndex){var metricData=response[0].results;var records=response[1].records;var jobId=seriesConfigs[seriesIndex].jobId;var scheduledEvents=response[2].events[jobId];var eventDistribution=response[3];var chartType=(0,_chart_utils.getChartType)(seriesConfigs[seriesIndex]);if(metricData===undefined||_lodash.default.keys(metricData).length===0){return[]}records.sort(function(recordA,recordB){return recordA[ML_TIME_FIELD_NAME]-recordB[ML_TIME_FIELD_NAME]});var chartData;if(eventDistribution.length>0&&records.length>0){var filterField=records[0].by_field_value||records[0].over_field_value;chartData=eventDistribution.filter(function(d){return d.entity!==filterField});_lodash.default.map(metricData,function(value,time){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&value>0||chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&value!==null){chartData.push({date:+time,value:value,entity:filterField})}})}else{chartData=_lodash.default.map(metricData,function(value,time){return{date:+time,value:value}})}var chartDataForPointSearch=getChartDataForPointSearch(chartData,records[0],chartType);_lodash.default.each(records,function(record){var recordTime=record[ML_TIME_FIELD_NAME];var chartPoint=findChartPointForTime(chartDataForPointSearch,recordTime);if(chartPoint===undefined){chartPoint={date:new Date(recordTime),value:null};chartData.push(chartPoint)}chartPoint.anomalyScore=record.record_score;if(record.actual!==undefined){chartPoint.actual=record.actual;chartPoint.typical=record.typical}else{var causes=_lodash.default.get(record,"causes",[]);if(causes.length>0){chartPoint.byFieldName=record.by_field_name;chartPoint.numberOfCauses=causes.length;if(causes.length===1){var cause=_lodash.default.first(record.causes);chartPoint.actual=cause.actual;chartPoint.typical=cause.typical}}}if(record.multi_bucket_impact!==undefined){chartPoint.multiBucketImpact=record.multi_bucket_impact}});if(scheduledEvents!==undefined){_lodash.default.each(scheduledEvents,function(events,time){var chartPoint=findChartPointForTime(chartDataForPointSearch,Number(time));if(chartPoint!==undefined){chartPoint.scheduledEvents=events}})}return chartData}function getChartDataForPointSearch(chartData,record,chartType){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return chartData.filter(function(d){return d.entity===(record&&(record.by_field_value||record.over_field_value))})}return chartData}function findChartPointForTime(chartData,time){return chartData.find(function(point){return point.date===time})}Promise.all(seriesPromises).then(function(response){if(newRequestCount<requestCount){return}var processedData=response.map(processChartData);var allDataPoints=_lodash.default.reduce(processedData,function(datapoints,series){_lodash.default.each(series,function(d){return datapoints.push(d)});return datapoints},[]);var overallChartLimits=(0,_chart_utils.chartLimits)(allDataPoints);data.seriesToPlot=response.map(function(d,i){return _objectSpread({},seriesConfigs[i],{loading:false,chartData:processedData[i],plotEarliest:chartRange.min,plotLatest:chartRange.max,selectedEarliest:earliestMs,selectedLatest:latestMs,chartLimits:USE_OVERALL_CHART_LIMITS?overallChartLimits:(0,_chart_utils.chartLimits)(processedData[i])})});callback(data)}).catch(function(error){console.error(error)})};function processRecordsForDisplay(anomalyRecords){if(anomalyRecords.length===0){return[]}var aggregatedData={};_lodash.default.each(anomalyRecords,function(record){var job=_job_service.mlJobService.getJob(record.job_id);var isChartable=(0,_job_utils.isSourceDataChartableForDetector)(job,record.detector_index);if(isChartable===false){var entityFields=(0,_anomaly_utils.getEntityFieldList)(record);isChartable=(0,_job_utils.isModelPlotEnabled)(job,record.detector_index,entityFields)}if(isChartable===false){return}var jobId=record.job_id;if(aggregatedData[jobId]===undefined){aggregatedData[jobId]={}}var detectorsForJob=aggregatedData[jobId];var detectorIndex=record.detector_index;if(detectorsForJob[detectorIndex]===undefined){detectorsForJob[detectorIndex]={}}var firstFieldName=record.partition_field_name||record.by_field_name||record.over_field_name;var firstFieldValue=record.partition_field_value||record.by_field_value||record.over_field_value;if(firstFieldName!==undefined){var groupsForDetector=detectorsForJob[detectorIndex];if(groupsForDetector[firstFieldName]===undefined){groupsForDetector[firstFieldName]={}}var valuesForGroup=groupsForDetector[firstFieldName];if(valuesForGroup[firstFieldValue]===undefined){valuesForGroup[firstFieldValue]={}}var dataForGroupValue=valuesForGroup[firstFieldValue];var isSecondSplit=false;if(record.partition_field_name!==undefined){var splitFieldName=record.over_field_name||record.by_field_name;if(splitFieldName!==undefined){isSecondSplit=true}}if(isSecondSplit===false){if(dataForGroupValue.maxScoreRecord===undefined){dataForGroupValue.maxScore=record.record_score;dataForGroupValue.maxScoreRecord=record}else{if(record.record_score>dataForGroupValue.maxScore){dataForGroupValue.maxScore=record.record_score;dataForGroupValue.maxScoreRecord=record}}}else{var secondFieldName=record.over_field_name||record.by_field_name;var secondFieldValue=record.over_field_value||record.by_field_value;if(dataForGroupValue[secondFieldName]===undefined){dataForGroupValue[secondFieldName]={}}var splitsForGroup=dataForGroupValue[secondFieldName];if(splitsForGroup[secondFieldValue]===undefined){splitsForGroup[secondFieldValue]={}}var dataForSplitValue=splitsForGroup[secondFieldValue];if(dataForSplitValue.maxScoreRecord===undefined){dataForSplitValue.maxScore=record.record_score;dataForSplitValue.maxScoreRecord=record}else{if(record.record_score>dataForSplitValue.maxScore){dataForSplitValue.maxScore=record.record_score;dataForSplitValue.maxScoreRecord=record}}}}else{var dataForDetector=detectorsForJob[detectorIndex];if(dataForDetector.maxScoreRecord===undefined){dataForDetector.maxScore=record.record_score;dataForDetector.maxScoreRecord=record}else{if(record.record_score>dataForDetector.maxScore){dataForDetector.maxScore=record.record_score;dataForDetector.maxScoreRecord=record}}}});console.log("explorer charts aggregatedData is:",aggregatedData);var recordsForSeries=[];_lodash.default.each(aggregatedData,function(detectorsForJob){_lodash.default.each(detectorsForJob,function(groupsForDetector){if(groupsForDetector.maxScoreRecord!==undefined){recordsForSeries.push(groupsForDetector.maxScoreRecord)}else{_lodash.default.each(groupsForDetector,function(valuesForGroup){_lodash.default.each(valuesForGroup,function(dataForGroupValue){if(dataForGroupValue.maxScoreRecord!==undefined){recordsForSeries.push(dataForGroupValue.maxScoreRecord)}else{_lodash.default.each(dataForGroupValue,function(splitsForGroup){_lodash.default.each(splitsForGroup,function(dataForSplitValue){recordsForSeries.push(dataForSplitValue.maxScoreRecord)})})}})})}})});recordsForSeries=_lodash.default.sortBy(recordsForSeries,"record_score").reverse();return recordsForSeries}function calculateChartRange(seriesConfigs,earliestMs,latestMs,chartWidth,recordsToPlot,timeFieldName){var tooManyBuckets=false;var midpointMs=Math.ceil((earliestMs+latestMs)/2);var maxBucketSpanMs=Math.max.apply(null,_lodash.default.pluck(seriesConfigs,"bucketSpanSeconds"))*1e3;var pointsToPlotFullSelection=Math.ceil((latestMs-earliestMs)/maxBucketSpanMs);var optimumPointSpacing=5;var optimumNumPoints=chartWidth/optimumPointSpacing;var plotPoints=Math.max(optimumNumPoints,pointsToPlotFullSelection);var halfPoints=Math.ceil(plotPoints/2);var chartRange={min:midpointMs-halfPoints*maxBucketSpanMs,max:midpointMs+halfPoints*maxBucketSpanMs};if(plotPoints>CHART_MAX_POINTS){tooManyBuckets=true;var maxTimeSpan=maxBucketSpanMs*CHART_MAX_POINTS;var minMs=recordsToPlot[0][timeFieldName];var maxMs=recordsToPlot[0][timeFieldName];_lodash.default.each(recordsToPlot,function(record){var diffMs=maxMs-minMs;if(diffMs<maxTimeSpan){var recordTime=record[timeFieldName];if(recordTime<minMs){if(maxMs-recordTime<=maxTimeSpan){minMs=recordTime}}if(recordTime>maxMs){if(recordTime-minMs<=maxTimeSpan){maxMs=recordTime}}}});if(maxMs-minMs<maxTimeSpan){minMs=Math.max(earliestMs,minMs-maxTimeSpan);maxMs=Math.min(latestMs,maxMs+maxTimeSpan)}chartRange={min:minMs,max:maxMs}}return{chartRange:chartRange,tooManyBuckets:tooManyBuckets}}return anomalyDataChange}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildConfig=buildConfig;var _lodash=_interopRequireDefault(__webpack_require__(3));var _parse_interval=__webpack_require__(275);var _anomaly_utils=__webpack_require__(293);var _chart_config_builder=__webpack_require__(1390);var _job_service=__webpack_require__(36);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildConfig(record){var job=_job_service.mlJobService.getJob(record.job_id);var detectorIndex=record.detector_index;var config=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);config.functionDescription=record.function_description;config.bucketSpanSeconds=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span).asSeconds();config.detectorLabel=record.function;if(_lodash.default.has(_job_service.mlJobService.detectorsByJob,record.job_id)&&detectorIndex<_job_service.mlJobService.detectorsByJob[record.job_id].length){config.detectorLabel=_job_service.mlJobService.detectorsByJob[record.job_id][detectorIndex].detector_description}else{if(record.field_name!==undefined){config.detectorLabel+=" ".concat(config.fieldName)}}if(record.field_name!==undefined){config.fieldName=record.field_name;config.metricFieldName=record.field_name}config.entityFields=(0,_anomaly_utils.getEntityFieldList)(record);var functionLabel=config.metricFunction;if(config.metricFieldName!==undefined){functionLabel+=" ".concat(config.metricFieldName)}config.infoTooltip={jobId:record.job_id,aggregationInterval:config.interval,chartFunction:functionLabel,entityFields:config.entityFields.map(function(f){return{fieldName:f.fieldName,fieldValue:f.fieldValue}})};return config}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartsContainer=void 0;var _jquery=_interopRequireDefault(__webpack_require__(21));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _chart_utils=__webpack_require__(280);var _explorer_chart_distribution=__webpack_require__(3081);var _explorer_chart_single_metric=__webpack_require__(3082);var _explorer_chart_label=__webpack_require__(3083);var _explorer_constants=__webpack_require__(339);var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var textTooManyBuckets=_i18n.i18n.translate("xpack.ml.explorer.charts.tooManyBucketsDescription",{defaultMessage:"This selection contains too many buckets to be displayed."+"The dashboard is best viewed over a shorter time range."});var textViewButton=_i18n.i18n.translate("xpack.ml.explorer.charts.openInSingleMetricViewerButtonLabel",{defaultMessage:"Open in Single Metric Viewer"});function getChartId(series){var jobId=series.jobId,detectorLabel=series.detectorLabel,entityFields=series.entityFields;var entities=entityFields.map(function(ef){return"".concat(ef.fieldName,"/").concat(ef.fieldValue)}).join(",");var id="".concat(jobId,"_").concat(detectorLabel,"_").concat(entities);return id}function ExplorerChartContainer(_ref){var series=_ref.series,tooManyBuckets=_ref.tooManyBuckets,wrapLabel=_ref.wrapLabel;var detectorLabel=series.detectorLabel,entityFields=series.entityFields;var chartType=(0,_chart_utils.getChartType)(series);var DetectorLabel=_react.default.createElement(_react.default.Fragment,null,detectorLabel);if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){var byField=series.entityFields.find(function(d){return d.fieldType==="by"});if(typeof byField!=="undefined"){DetectorLabel=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.charts.detectorLabel",defaultMessage:'{detectorLabel}{br}y-axis event distribution split by "{fieldName}"',values:{detectorLabel:detectorLabel,br:_react.default.createElement("br",null),fieldName:byField.fieldName}}));wrapLabel=true}}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_explorer_chart_label.ExplorerChartLabel,{detectorLabel:DetectorLabel,entityFields:entityFields,infoTooltip:_objectSpread({},series.infoTooltip,{chartType:chartType}),wrapLabel:wrapLabel})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("div",{className:"ml-explorer-chart-icons"},tooManyBuckets&&_react.default.createElement("span",{className:"ml-explorer-chart-icon"},_react.default.createElement(_eui.EuiIconTip,{content:textTooManyBuckets,position:"top",size:"s",type:"alert",color:"warning"})),_react.default.createElement(_eui.EuiToolTip,{position:"top",content:textViewButton},_react.default.createElement(_eui.EuiButtonEmpty,{iconSide:"right",iconType:"stats",size:"xs",onClick:function onClick(){return window.open((0,_chart_utils.getExploreSeriesLink)(series),"_blank")}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.charts.viewLabel",defaultMessage:"View"})))))),function(){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return _react.default.createElement(_explorer_chart_distribution.ExplorerChartDistribution,{tooManyBuckets:tooManyBuckets,seriesConfig:series})}return _react.default.createElement(_explorer_chart_single_metric.ExplorerChartSingleMetric,{tooManyBuckets:tooManyBuckets,seriesConfig:series})}())}var ExplorerChartsContainer=function(_React$Component){_inherits(ExplorerChartsContainer,_React$Component);function ExplorerChartsContainer(){_classCallCheck(this,ExplorerChartsContainer);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartsContainer).apply(this,arguments))}_createClass(ExplorerChartsContainer,[{key:"componentDidMount",value:function componentDidMount(){(0,_jquery.default)(".ml-explorer-charts-tooltip").remove();(0,_jquery.default)("body").append('<div class="ml-explorer-tooltip ml-explorer-charts-tooltip" style="opacity:0; display: none;">')}},{key:"componentWillUnmount",value:function componentWillUnmount(){(0,_jquery.default)(".ml-explorer-charts-tooltip").remove()}},{key:"render",value:function render(){var _this$props=this.props,chartsPerRow=_this$props.chartsPerRow,seriesToPlot=_this$props.seriesToPlot,tooManyBuckets=_this$props.tooManyBuckets;var chartsWidth=chartsPerRow===1?"calc(100% - 20px)":"auto";var chartsColumns=chartsPerRow===1?0:chartsPerRow;var wrapLabel=seriesToPlot.some(function(series){return(0,_chart_utils.isLabelLengthAboveThreshold)(series)});return _react.default.createElement(_eui.EuiFlexGrid,{columns:chartsColumns},seriesToPlot.length>0&&seriesToPlot.map(function(series){return _react.default.createElement(_eui.EuiFlexItem,{key:getChartId(series),className:"ml-explorer-chart-container",style:{minWidth:chartsWidth}},_react.default.createElement(ExplorerChartContainer,{series:series,tooManyBuckets:tooManyBuckets,wrapLabel:wrapLabel}))}))}}]);return ExplorerChartsContainer}(_react.default.Component);exports.ExplorerChartsContainer=ExplorerChartsContainer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartDistribution=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _d=_interopRequireDefault(__webpack_require__(27));var _jquery=_interopRequireDefault(__webpack_require__(21));var _moment=_interopRequireDefault(__webpack_require__(16));var _date_utils=__webpack_require__(279);var _format_value=__webpack_require__(437);var _anomaly_utils=__webpack_require__(293);var _chart_utils=__webpack_require__(280);var _time_buckets=__webpack_require__(312);var _loading_indicator=__webpack_require__(898);var _string_utils=__webpack_require__(67);var _field_format_service=__webpack_require__(296);var _chart_tooltip_service=__webpack_require__(362);var _select_severity=__webpack_require__(401);var _explorer_constants=__webpack_require__(339);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CONTENT_WRAPPER_HEIGHT=215;var Y_AXIS_LABEL_THRESHOLD=10;var ExplorerChartDistribution=(0,_react2.injectI18n)((_temp=_class=function(_React$Component){_inherits(ExplorerChartDistribution,_React$Component);function ExplorerChartDistribution(){_classCallCheck(this,ExplorerChartDistribution);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartDistribution).apply(this,arguments))}_createClass(ExplorerChartDistribution,[{key:"componentDidMount",value:function componentDidMount(){this.renderChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderChart()}},{key:"renderChart",value:function renderChart(){var _this$props=this.props,tooManyBuckets=_this$props.tooManyBuckets,intl=_this$props.intl;var element=this.rootNode;var config=this.props.seriesConfig;if(typeof config==="undefined"||Array.isArray(config.chartData)===false){return}var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(config.jobId,config.detectorIndex);var vizWidth=0;var chartHeight=170;var LINE_CHART_ANOMALY_RADIUS=7;var SCHEDULED_EVENT_MARKER_HEIGHT=5;var chartType=(0,_chart_utils.getChartType)(config);var margin={top:10,right:0,bottom:30,left:0};if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){margin.left=60}var lineChartXScale=null;var lineChartYScale=null;var lineChartGroup;var lineChartValuesLine=null;var CHART_Y_ATTRIBUTE=chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION?"entity":"value";var highlight=config.chartData.find(function(d){return d.anomalyScore!==undefined});highlight=highlight&&highlight.entity;var filteredChartData=init(config);drawRareChart(filteredChartData);function init(_ref){var chartData=_ref.chartData;var $el=(0,_jquery.default)(".ml-explorer-chart");var chartElement=_d.default.select(element).select(".content-wrapper");chartElement.select("svg").remove();var svgWidth=$el.width();var svgHeight=chartHeight+margin.top+margin.bottom;var svg=chartElement.append("svg").classed("ml-explorer-chart-svg",true).attr("width",svgWidth).attr("height",svgHeight);var categoryLimit=30;var scaleCategories=_d.default.nest().key(function(d){return d.entity}).entries(chartData).sort(function(a,b){return b.values.length-a.values.length}).filter(function(d,i){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){return i<categoryLimit||d.key===highlight}return true}).map(function(d){return d.key});chartData=chartData.filter(function(d){return scaleCategories.includes(d.entity)});if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){var focusData=chartData.filter(function(d){return d.entity===highlight}).map(function(d){return d.value});var focusExtent=_d.default.extent(focusData);chartData=chartData.filter(function(d){return d.value<=focusExtent[1]});lineChartYScale=_d.default.scale.linear().range([chartHeight,0]).domain([0,focusExtent[1]]).nice()}else if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){var rowMargin=5;lineChartYScale=_d.default.scale.ordinal().rangePoints([rowMargin,chartHeight-rowMargin]).domain(scaleCategories)}else{throw"chartType '".concat(chartType,"' not supported")}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");var tempLabelTextData=chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION?lineChartYScale.ticks():scaleCategories;tempLabelText.selectAll("text.temp.axis").data(tempLabelTextData).enter().append("text").text(function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return lineChartYScale.tickFormat()(d)}return d}}).each(function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)}).remove();_d.default.select(".temp-axis-label").remove();if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&scaleCategories.length<=Y_AXIS_LABEL_THRESHOLD){margin.left=Math.max(maxYAxisLabelWidth,40)}vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]);lineChartValuesLine=_d.default.svg.line().x(function(d){return lineChartXScale(d.date)}).y(function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])}).defined(function(d){return d.value!==null});lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")");return chartData}function drawRareChart(data){lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawRareChartAxes();drawRareChartHighlightedSpan();drawRareChartDots(data,lineChartGroup,lineChartValuesLine);drawRareChartMarkers(data)}function drawRareChartAxes(){var timeBuckets=new _time_buckets.TimeBuckets;var bounds={min:(0,_moment.default)(config.plotEarliest),max:(0,_moment.default)(config.plotLatest)};timeBuckets.setBounds(bounds);timeBuckets.setInterval("auto");var xAxisTickFormat=timeBuckets.getScaledDateFormat();var tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest);var interval=config.selectedLatest-config.selectedEarliest+1;var tickValues=(0,_chart_utils.getTickValues)(tickValuesStart,interval,config.plotEarliest,config.plotLatest);var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-chartHeight).outerTickSize(0).tickPadding(10).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});if(tooManyBuckets===false){xAxis.tickValues(tickValues)}else{xAxis.ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat))}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);if(fieldFormat!==undefined){yAxis.tickFormat(function(d){return fieldFormat.convert(d,"text")})}var axes=lineChartGroup.append("g");var gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){axes.select(".y").selectAll("text").each(function(d){_d.default.select(this).classed("ml-explorer-chart-axis-emphasis",d===highlight)})}if(tooManyBuckets===false){(0,_chart_utils.removeLabelOverlap)(gAxis,tickValuesStart,interval,vizWidth)}}function drawRareChartDots(dotsData,rareChartGroup,rareChartValuesLine){var radius=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1.5;var dotGroup=rareChartGroup.select(".values-dots").empty()?rareChartGroup.append("g").classed("values-dots",true):rareChartGroup.select(".values-dots");var dots=dotGroup.selectAll("circle").data(dotsData);dots.enter().append("circle").classed("values-dots-circle",true).classed("values-dots-circle-blur",function(d){return d.entity!==highlight}).attr("r",function(d){return d.entity===highlight?radius*1.5:radius});dots.attr("cx",rareChartValuesLine.x()).attr("cy",rareChartValuesLine.y());dots.exit().remove()}function drawRareChartHighlightedSpan(){var rectStart=Math.max(config.selectedEarliest,config.plotEarliest);var rectEnd=Math.min(config.selectedLatest,config.plotLatest);var rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",chartHeight-4)}function drawRareChartMarkers(data){var dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter(function(d){return d.value!==null}));dots.exit().remove();dots.enter().append("circle").attr("r",LINE_CHART_ANOMALY_RADIUS).on("mouseover",function(d){showLineChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});var threshold=_select_severity.severity$.getValue();dots.attr("cx",function(d){return lineChartXScale(d.date)}).attr("cy",function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])}).attr("class",function(d){var markerClass="metric-value";if(_lodash.default.has(d,"anomalyScore")&&Number(d.anomalyScore)>=threshold.val){markerClass+=" anomaly-marker ";markerClass+=(0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id}return markerClass});var scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter(function(d){return d.scheduledEvents!==undefined}));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",LINE_CHART_ANOMALY_RADIUS*2).attr("height",SCHEDULED_EVENT_MARKER_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",function(d){return lineChartXScale(d.date)-LINE_CHART_ANOMALY_RADIUS}).attr("y",function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])-SCHEDULED_EVENT_MARKER_HEIGHT/2})}function showLineChartTooltip(marker,circle){var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(marker.date);var contents="".concat(formattedDate,"<br/><hr/>");if(_lodash.default.has(marker,"entity")){contents+="<div>".concat(marker.entity,"</div>")}if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";contents+=intl.formatMessage({id:"xpack.ml.explorer.distributionChart.anomalyScoreLabel",defaultMessage:"anomaly score: {displayScore}"},{displayScore:displayScore});if(chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){contents+=intl.formatMessage({id:"xpack.ml.explorer.distributionChart.valueLabel",defaultMessage:"{br}value: {value}"},{br:"<br />",value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat)});if(typeof marker.numberOfCauses==="undefined"||marker.numberOfCauses===1){contents+=intl.formatMessage({id:"xpack.ml.explorer.distributionChart.typicalLabel",defaultMessage:"{br}typical: {typicalValue}"},{br:"<br />",typicalValue:(0,_format_value.formatValue)(marker.typical,config.functionDescription,fieldFormat)})}if(typeof marker.byFieldName!=="undefined"&&_lodash.default.has(marker,"numberOfCauses")){var numberOfCauses=marker.numberOfCauses;var byFieldName=(0,_string_utils.mlEscape)(marker.byFieldName);contents+=intl.formatMessage({id:"xpack.ml.explorer.distributionChart.unusualByFieldValuesLabel",defaultMessage:"{br} { numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}"},{br:"<br />",numberOfCauses:numberOfCauses,byFieldName:byFieldName,plusSign:numberOfCauses<10?"":"+"})}}}else if(chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){contents+=intl.formatMessage({id:"xpack.ml.explorer.distributionChart.valueWithoutAnomalyScoreLabel",defaultMessage:"value: {value}"},{value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat)})}if(_lodash.default.has(marker,"scheduledEvents")){contents+="<div><hr/>"+intl.formatMessage({id:"xpack.ml.explorer.distributionChart.scheduledEventsLabel",defaultMessage:"Scheduled events:{br}{scheduledEventsValue}"},{br:"<br />",scheduledEventsValue:marker.scheduledEvents.map(_string_utils.mlEscape).join("<br/>")})+"</div>"}_chart_tooltip_service.mlChartTooltipService.show(contents,circle,{x:LINE_CHART_ANOMALY_RADIUS*2,y:0})}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var seriesConfig=this.props.seriesConfig;if(typeof seriesConfig==="undefined"){return null}var isLoading=seriesConfig.loading;return _react.default.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,{height:CONTENT_WRAPPER_HEIGHT}),!isLoading&&_react.default.createElement("div",{className:"content-wrapper"}))}}]);return ExplorerChartDistribution}(_react.default.Component),_defineProperty(_class,"propTypes",{seriesConfig:_propTypes.default.object}),_temp));exports.ExplorerChartDistribution=ExplorerChartDistribution},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartSingleMetric=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _d=_interopRequireDefault(__webpack_require__(27));var _jquery=_interopRequireDefault(__webpack_require__(21));var _moment=_interopRequireDefault(__webpack_require__(16));var _date_utils=__webpack_require__(279);var _format_value=__webpack_require__(437);var _anomaly_utils=__webpack_require__(293);var _chart_utils=__webpack_require__(280);var _time_buckets=__webpack_require__(312);var _loading_indicator=__webpack_require__(898);var _string_utils=__webpack_require__(67);var _field_format_service=__webpack_require__(296);var _chart_tooltip_service=__webpack_require__(362);var _select_severity=__webpack_require__(401);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CONTENT_WRAPPER_HEIGHT=215;var CONTENT_WRAPPER_CLASS="ml-explorer-chart-content-wrapper";var ExplorerChartSingleMetric=(0,_react2.injectI18n)((_temp=_class=function(_React$Component){_inherits(ExplorerChartSingleMetric,_React$Component);function ExplorerChartSingleMetric(){_classCallCheck(this,ExplorerChartSingleMetric);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartSingleMetric).apply(this,arguments))}_createClass(ExplorerChartSingleMetric,[{key:"componentDidMount",value:function componentDidMount(){this.renderChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderChart()}},{key:"renderChart",value:function renderChart(){var _this$props=this.props,tooManyBuckets=_this$props.tooManyBuckets,intl=_this$props.intl;var element=this.rootNode;var config=this.props.seriesConfig;if(typeof config==="undefined"||Array.isArray(config.chartData)===false){return}var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(config.jobId,config.detectorIndex);var vizWidth=0;var chartHeight=170;var margin={top:10,right:0,bottom:30,left:60};var lineChartXScale=null;var lineChartYScale=null;var lineChartGroup;var lineChartValuesLine=null;init(config.chartLimits);drawLineChart(config.chartData);function init(chartLimits){var $el=(0,_jquery.default)(".ml-explorer-chart");var chartElement=_d.default.select(element).select(".".concat(CONTENT_WRAPPER_CLASS));chartElement.select("svg").remove();var svgWidth=$el.width();var svgHeight=chartHeight+margin.top+margin.bottom;var svg=chartElement.append("svg").classed("ml-explorer-chart-svg",true).attr("width",svgWidth).attr("height",svgHeight);lineChartYScale=_d.default.scale.linear().range([chartHeight,0]).domain([chartLimits.min,chartLimits.max]).nice();var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");tempLabelText.selectAll("text.temp.axis").data(lineChartYScale.ticks()).enter().append("text").text(function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{return lineChartYScale.tickFormat()(d)}}).each(function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)}).remove();_d.default.select(".temp-axis-label").remove();margin.left=Math.max(maxYAxisLabelWidth,40);vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]);lineChartValuesLine=_d.default.svg.line().x(function(d){return lineChartXScale(d.date)}).y(function(d){return lineChartYScale(d.value)}).defined(function(d){return d.value!==null});lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")")}function drawLineChart(data){lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawLineChartAxes();drawLineChartHighlightedSpan();drawLineChartPaths(data);(0,_chart_utils.drawLineChartDots)(data,lineChartGroup,lineChartValuesLine);drawLineChartMarkers(data)}function drawLineChartAxes(){var timeBuckets=new _time_buckets.TimeBuckets;var bounds={min:(0,_moment.default)(config.plotEarliest),max:(0,_moment.default)(config.plotLatest)};timeBuckets.setBounds(bounds);timeBuckets.setInterval("auto");var xAxisTickFormat=timeBuckets.getScaledDateFormat();var tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest);var interval=config.selectedLatest-config.selectedEarliest+1;var tickValues=(0,_chart_utils.getTickValues)(tickValuesStart,interval,config.plotEarliest,config.plotLatest);var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-chartHeight).outerTickSize(0).tickPadding(10).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});if(tooManyBuckets===false){xAxis.tickValues(tickValues)}else{xAxis.ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat))}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);if(fieldFormat!==undefined){yAxis.tickFormat(function(d){return fieldFormat.convert(d,"text")})}var axes=lineChartGroup.append("g");var gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);if(tooManyBuckets===false){(0,_chart_utils.removeLabelOverlap)(gAxis,tickValuesStart,interval,vizWidth)}}function drawLineChartHighlightedSpan(){var rectStart=Math.max(config.selectedEarliest,config.plotEarliest);var rectEnd=Math.min(config.selectedLatest,config.plotLatest);var rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",chartHeight-4)}function drawLineChartPaths(data){lineChartGroup.append("path").attr("class","values-line").attr("d",lineChartValuesLine(data))}function drawLineChartMarkers(data){var dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter(function(d){return(d.value!==null||typeof d.anomalyScore==="number")&&!(0,_chart_utils.showMultiBucketAnomalyMarker)(d)}));dots.exit().remove();dots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",function(d){showLineChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});var threshold=_select_severity.severity$.getValue();dots.attr("cx",function(d){return lineChartXScale(d.date)}).attr("cy",function(d){return lineChartYScale(d.value)}).attr("class",function(d){var markerClass="metric-value";if(_lodash.default.has(d,"anomalyScore")&&Number(d.anomalyScore)>=threshold.val){markerClass+=" anomaly-marker ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}return markerClass});var multiBucketMarkers=lineChartGroup.select(".chart-markers").selectAll(".multi-bucket").data(data.filter(function(d){return d.anomalyScore!==null&&(0,_chart_utils.showMultiBucketAnomalyMarker)(d)===true}));multiBucketMarkers.exit().remove();multiBucketMarkers.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).attr("transform",function(d){return"translate(".concat(lineChartXScale(d.date),", ").concat(lineChartYScale(d.value),")")}).attr("class",function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}).on("mouseover",function(d){showLineChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});var scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter(function(d){return d.scheduledEvents!==undefined}));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",_chart_utils.LINE_CHART_ANOMALY_RADIUS*2).attr("height",_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",function(d){return lineChartXScale(d.date)-_chart_utils.LINE_CHART_ANOMALY_RADIUS}).attr("y",function(d){return lineChartYScale(d.value)-_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT/2})}function showLineChartTooltip(marker,circle){var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(marker.date);var contents=formattedDate+"<br/><hr/>";if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.anomalyScoreLabel",defaultMessage:"anomaly score: {displayScore}"},{displayScore:displayScore});if((0,_chart_utils.showMultiBucketAnomalyTooltip)(marker)===true){contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.multiBucketImpactLabel",defaultMessage:"{br}multi-bucket impact: {multiBucketImpactLabel}"},{br:"<br />",multiBucketImpactLabel:(0,_anomaly_utils.getMultiBucketImpactLabel)(marker.multiBucketImpact)})}if(_lodash.default.has(marker,"actual")&&config.functionDescription!=="rare"){contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.actualLabel",defaultMessage:"{br}actual: {actualValue}"},{br:"<br />",actualValue:(0,_format_value.formatValue)(marker.actual,config.functionDescription,fieldFormat)});contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.typicalLabel",defaultMessage:"{br}typical: {typicalValue}"},{br:"<br />",typicalValue:(0,_format_value.formatValue)(marker.typical,config.functionDescription,fieldFormat)})}else{contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.valueLabel",defaultMessage:"{br}value: {value}"},{br:"<br />",value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat)});if(_lodash.default.has(marker,"byFieldName")&&_lodash.default.has(marker,"numberOfCauses")){var numberOfCauses=marker.numberOfCauses;var byFieldName=(0,_string_utils.mlEscape)(marker.byFieldName);intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.unusualByFieldValuesLabel",defaultMessage:"{br} { numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}"},{br:"<br />",numberOfCauses:numberOfCauses,byFieldName:byFieldName,plusSign:numberOfCauses<10?"":"+"})}}}else{contents+=intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.valueWithoutAnomalyScoreLabel",defaultMessage:"value: {value}"},{value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat)})}if(_lodash.default.has(marker,"scheduledEvents")){contents+="<br/><hr/>"+intl.formatMessage({id:"xpack.ml.explorer.singleMetricChart.scheduledEventsLabel",defaultMessage:"Scheduled events:{br}{scheduledEventsValue}"},{br:"<br />",scheduledEventsValue:marker.scheduledEvents.map(_string_utils.mlEscape).join("<br/>")})}_chart_tooltip_service.mlChartTooltipService.show(contents,circle,{x:_chart_utils.LINE_CHART_ANOMALY_RADIUS*2,y:0})}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var seriesConfig=this.props.seriesConfig;if(typeof seriesConfig==="undefined"){return null}var isLoading=seriesConfig.loading;return _react.default.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,{height:CONTENT_WRAPPER_HEIGHT}),!isLoading&&_react.default.createElement("div",{className:CONTENT_WRAPPER_CLASS}))}}]);return ExplorerChartSingleMetric}(_react.default.Component),_defineProperty(_class,"propTypes",{tooManyBuckets:_propTypes.default.bool,seriesConfig:_propTypes.default.object}),_temp));exports.ExplorerChartSingleMetric=ExplorerChartSingleMetric},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _explorer_chart_label=__webpack_require__(3084);Object.keys(_explorer_chart_label).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer_chart_label[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartLabel=ExplorerChartLabel;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _explorer_chart_label_badge=__webpack_require__(3085);var _explorer_chart_info_tooltip=__webpack_require__(3086);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExplorerChartLabel(_ref){var detectorLabel=_ref.detectorLabel,entityFields=_ref.entityFields,infoTooltip=_ref.infoTooltip,_ref$wrapLabel=_ref.wrapLabel,wrapLabel=_ref$wrapLabel===void 0?false:_ref$wrapLabel;var labelSeparator=wrapLabel===true||entityFields.length===0||detectorLabel.length===0?_react.default.createElement(_react.default.Fragment,null," "):_react.default.createElement(_react.default.Fragment,null," – ");var entityFieldBadges=entityFields.map(function(entity){return _react.default.createElement(_explorer_chart_label_badge.ExplorerChartLabelBadge,{entity:entity,key:"".concat(entity.fieldName," ").concat(entity.fieldValue)})});var infoIcon=_react.default.createElement("span",{className:"ml-explorer-chart-info-icon"},_react.default.createElement(_eui.EuiIconTip,{className:"ml-explorer-chart-eui-icon-tip",content:_react.default.createElement(_explorer_chart_info_tooltip.ExplorerChartInfoTooltip,infoTooltip),position:"top",size:"s"}));return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("span",{className:"ml-explorer-chart-label"},_react.default.createElement("span",{className:"ml-explorer-chart-label-detector"},detectorLabel,labelSeparator),wrapLabel&&infoIcon,!wrapLabel&&_react.default.createElement(_react.default.Fragment,null,entityFieldBadges," ",infoIcon)),wrapLabel&&_react.default.createElement("span",{className:"ml-explorer-chart-label-badges"},entityFieldBadges))}ExplorerChartLabel.propTypes={detectorLabel:_propTypes.default.object.isRequired,entityFields:_propTypes.default.arrayOf(_explorer_chart_label_badge.ExplorerChartLabelBadge.propTypes.entity),infoTooltip:_propTypes.default.object.isRequired,wrapLabel:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartLabelBadge=ExplorerChartLabelBadge;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExplorerChartLabelBadge(_ref){var entity=_ref.entity;return _react.default.createElement("span",{className:"ml-explorer-chart-label-badge"},_react.default.createElement(_eui.EuiBadge,{color:"hollow",className:"ml-reset-font-weight"},entity.fieldName," ",_react.default.createElement("strong",null,entity.fieldValue)))}ExplorerChartLabelBadge.propTypes={entity:_propTypes.default.shape({fieldName:_propTypes.default.string.isRequired,fieldValue:_propTypes.default.string.isRequired})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartInfoTooltip=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _explorer_constants=__webpack_require__(339);var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _CHART_DESCRIPTION;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CHART_DESCRIPTION=(_CHART_DESCRIPTION={},_defineProperty(_CHART_DESCRIPTION,_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION,_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartEventDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of occurrences over time for a sample of {byFieldValuesParam} with"+" more frequent event types at the top and rarer ones at the bottom.",values:{byFieldValuesParam:"by_field_values"}})),_defineProperty(_CHART_DESCRIPTION,_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION,_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartPopulationDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of values over time for a sample of {overFieldValuesParam}.",values:{overFieldValuesParam:"over_field_values"}})),_CHART_DESCRIPTION);function TooltipDefinitionList(_ref){var toolTipData=_ref.toolTipData;return _react.default.createElement("dl",{className:"mlDescriptionList"},toolTipData.map(function(_ref2){var title=_ref2.title,description=_ref2.description;return _react.default.createElement(_react.default.Fragment,{key:"".concat(title," ").concat(description)},_react.default.createElement("dt",{className:"mlDescriptionList__title"},title),_react.default.createElement("dd",{className:"mlDescriptionList__description"},description))}))}var ExplorerChartInfoTooltip=(0,_react2.injectI18n)(function ExplorerChartInfoTooltip(_ref3){var jobId=_ref3.jobId,aggregationInterval=_ref3.aggregationInterval,chartFunction=_ref3.chartFunction,chartType=_ref3.chartType,_ref3$entityFields=_ref3.entityFields,entityFields=_ref3$entityFields===void 0?[]:_ref3$entityFields,intl=_ref3.intl;var chartDescription=CHART_DESCRIPTION[chartType];var toolTipData=[{title:intl.formatMessage({id:"xpack.ml.explorer.charts.infoTooltip.jobIdTitle",defaultMessage:"job ID"}),description:jobId},{title:intl.formatMessage({id:"xpack.ml.explorer.charts.infoTooltip.aggregationIntervalTitle",defaultMessage:"aggregation interval"}),description:aggregationInterval},{title:intl.formatMessage({id:"xpack.ml.explorer.charts.infoTooltip.chartFunctionTitle",defaultMessage:"chart function"}),description:chartFunction}];entityFields.forEach(function(entityField){toolTipData.push({title:entityField.fieldName,description:entityField.fieldValue})});return _react.default.createElement("div",{className:"ml-explorer-chart-info-tooltip"},_react.default.createElement(TooltipDefinitionList,{toolTipData:toolTipData}),chartDescription&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"ml-explorer-chart-description"},chartDescription)))});exports.ExplorerChartInfoTooltip=ExplorerChartInfoTooltip;ExplorerChartInfoTooltip.WrappedComponent.propTypes={jobId:_propTypes.default.string.isRequired,aggregationInterval:_propTypes.default.string,chartFunction:_propTypes.default.string,entityFields:_propTypes.default.array}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(683)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3089)},function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(8);var _app_state_utils=__webpack_require__(686);var _select_limit=__webpack_require__(1389);var _module=_modules.uiModules.get("apps/ml");_module.service("mlSelectLimitService",function(AppState,$rootScope){(0,_app_state_utils.subscribeAppStateToObservable)(AppState,"mlSelectLimit",_select_limit.limit$,function(){return $rootScope.$applyAsync()})})},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _lodash=_interopRequireDefault(__webpack_require__(3));var _job_selector=__webpack_require__(3091);var _job_select_service_utils=__webpack_require__(900);var _rxjs=__webpack_require__(30);var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlJobSelectorReactWrapper",function(globalState,config,mlJobSelectService){function link(scope,element,attrs){var _getSelectedJobIds=(0,_job_select_service_utils.getSelectedJobIds)(globalState),jobIds=_getSelectedJobIds.jobIds,selectedGroups=_getSelectedJobIds.selectedGroups;var oldSelectedJobIds=mlJobSelectService.getValue().selection;if(jobIds&&!_lodash.default.isEqual(oldSelectedJobIds,jobIds)){mlJobSelectService.next({selection:jobIds,groups:selectedGroups})}var props={config:config,globalState:globalState,jobSelectService:mlJobSelectService,selectedJobIds:jobIds,selectedGroups:selectedGroups,timeseriesOnly:attrs.timeseriesonly,singleSelection:attrs.singleselection};_reactDom.default.render(_react.default.createElement(_job_selector.JobSelector,props),element[0]);element.on("$destroy",function(){_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}return{scope:false,link:link}}).service("mlJobSelectService",function(globalState){var _getSelectedJobIds2=(0,_job_select_service_utils.getSelectedJobIds)(globalState),jobIds=_getSelectedJobIds2.jobIds,selectedGroups=_getSelectedJobIds2.selectedGroups;return new _rxjs.BehaviorSubject({selection:jobIds,groups:selectedGroups,resetSelection:false})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelector=JobSelector;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _moment=_interopRequireDefault(__webpack_require__(16));var _ml_api_service=__webpack_require__(24);var _job_selector_table=__webpack_require__(3092);var _id_badges=__webpack_require__(3099);var _new_selection_id_badges=__webpack_require__(3101);var _timefilter=__webpack_require__(22);var _job_select_service_utils=__webpack_require__(900);var _notify=__webpack_require__(14);var _eui=__webpack_require__(1);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function mergeSelection(jobIds,groupObjs,singleSelection){if(singleSelection){return jobIds}var selectedIds=[];var alreadySelected=[];groupObjs.forEach(function(group){selectedIds.push(group.groupId);alreadySelected.push.apply(alreadySelected,_toConsumableArray(group.jobIds))});jobIds.forEach(function(jobId){if(alreadySelected.includes(jobId)===false){selectedIds.push(jobId)}});return selectedIds}function getInitialGroupsMap(selectedGroups){var map={};if(selectedGroups.length){selectedGroups.forEach(function(group){map[group.groupId]=group.jobIds})}return map}var BADGE_LIMIT=10;var DEFAULT_GANTT_BAR_WIDTH=299;function JobSelector(_ref){var config=_ref.config,globalState=_ref.globalState,jobSelectService=_ref.jobSelectService,selectedJobIds=_ref.selectedJobIds,selectedGroups=_ref.selectedGroups,singleSelection=_ref.singleSelection,timeseriesOnly=_ref.timeseriesOnly;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),jobs=_useState2[0],setJobs=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),groups=_useState4[0],setGroups=_useState4[1];var _useState5=(0,_react.useState)({groupsMap:getInitialGroupsMap(selectedGroups),jobsMap:{}}),_useState6=_slicedToArray(_useState5,2),maps=_useState6[0],setMaps=_useState6[1];var _useState7=(0,_react.useState)(mergeSelection(selectedJobIds,selectedGroups,singleSelection)),_useState8=_slicedToArray(_useState7,2),selectedIds=_useState8[0],setSelectedIds=_useState8[1];var _useState9=(0,_react.useState)(mergeSelection(selectedJobIds,selectedGroups,singleSelection)),_useState10=_slicedToArray(_useState9,2),newSelection=_useState10[0],setNewSelection=_useState10[1];var _useState11=(0,_react.useState)(false),_useState12=_slicedToArray(_useState11,2),showAllBadges=_useState12[0],setShowAllBadges=_useState12[1];var _useState13=(0,_react.useState)(false),_useState14=_slicedToArray(_useState13,2),showAllBarBadges=_useState14[0],setShowAllBarBadges=_useState14[1];var _useState15=(0,_react.useState)(true),_useState16=_slicedToArray(_useState15,2),applyTimeRange=_useState16[0],setApplyTimeRange=_useState16[1];var _useState17=(0,_react.useState)(false),_useState18=_slicedToArray(_useState17,2),isFlyoutVisible=_useState18[0],setIsFlyoutVisible=_useState18[1];var _useState19=(0,_react.useState)(DEFAULT_GANTT_BAR_WIDTH),_useState20=_slicedToArray(_useState19,2),ganttBarWidth=_useState20[0],setGanttBarWidth=_useState20[1];var flyoutEl=(0,_react.useRef)(null);(0,_react.useEffect)(function(){var subscription=jobSelectService.subscribe(function(_ref2){var selection=_ref2.selection,resetSelection=_ref2.resetSelection;if(resetSelection===true){setSelectedIds(selection)}});return function cleanup(){subscription.unsubscribe()}},[]);(0,_react.useEffect)(function(){setNewSelection(selectedIds)},[isFlyoutVisible]);var handleResize=(0,_react.useCallback)(function(){if(jobs.length>0&&flyoutEl&&flyoutEl.current&&flyoutEl.current.flyout){var tzConfig=config.get("dateFormat:tz");var dateFormatTz=tzConfig!=="Browser"?tzConfig:_moment.default.tz.guess();var tableHeaderCols=flyoutEl.current.flyout.querySelectorAll("table thead th");var derivedWidth=tableHeaderCols[tableHeaderCols.length-1].offsetWidth-16;var normalizedJobs=(0,_job_select_service_utils.normalizeTimes)(jobs,dateFormatTz,derivedWidth);setJobs(normalizedJobs);var _getGroupsFromJobs=(0,_job_select_service_utils.getGroupsFromJobs)(normalizedJobs),updatedGroups=_getGroupsFromJobs.groups;setGroups(updatedGroups);setGanttBarWidth(derivedWidth)}},[config,jobs]);(0,_react.useEffect)(function(){window.addEventListener("resize",handleResize);return function(){window.removeEventListener("resize",handleResize)}},[handleResize]);(0,_react.useEffect)(function(){handleResize()},[handleResize,jobs]);function closeFlyout(){setIsFlyoutVisible(false)}function showFlyout(){setIsFlyoutVisible(true)}function handleJobSelectionClick(){showFlyout();var tzConfig=config.get("dateFormat:tz");var dateFormatTz=tzConfig!=="Browser"?tzConfig:_moment.default.tz.guess();_ml_api_service.ml.jobs.jobsWithTimerange(dateFormatTz).then(function(resp){var normalizedJobs=(0,_job_select_service_utils.normalizeTimes)(resp.jobs,dateFormatTz,DEFAULT_GANTT_BAR_WIDTH);var _getGroupsFromJobs2=(0,_job_select_service_utils.getGroupsFromJobs)(normalizedJobs),groupsWithTimerange=_getGroupsFromJobs2.groups,groupsMap=_getGroupsFromJobs2.groupsMap;setJobs(normalizedJobs);setGroups(groupsWithTimerange);setMaps({groupsMap:groupsMap,jobsMap:resp.jobsMap})}).catch(function(err){console.log("Error fetching jobs",err);_notify.toastNotifications.addDanger({title:_i18n.i18n.translate("xpack.ml.jobSelector.jobFetchErrorMessage",{defaultMessage:"An error occurred fetching jobs. Refresh and try again."})})})}function handleNewSelection(_ref3){var selectionFromTable=_ref3.selectionFromTable;setNewSelection(selectionFromTable)}function applySelection(){closeFlyout();var allNewSelection=[];var groupSelection=[];newSelection.forEach(function(id){if(maps.groupsMap[id]!==undefined){allNewSelection.push.apply(allNewSelection,_toConsumableArray(maps.groupsMap[id]));groupSelection.push({groupId:id,jobIds:maps.groupsMap[id]})}else{allNewSelection.push(id)}});var allNewSelectionUnique=Array.from(new Set(allNewSelection));setSelectedIds(newSelection);setNewSelection([]);applyTimeRangeFromSelection(allNewSelectionUnique);jobSelectService.next({selection:allNewSelectionUnique});(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:allNewSelectionUnique,selectedGroups:groupSelection})}function applyTimeRangeFromSelection(selection){if(applyTimeRange&&jobs.length>0){var times=[];jobs.forEach(function(job){if(selection.includes(job.job_id)){if(job.timeRange.from!==undefined){times.push(job.timeRange.from)}if(job.timeRange.to!==undefined){times.push(job.timeRange.to)}}});if(times.length){var min=Math.min.apply(Math,times);var max=Math.max.apply(Math,times);_timefilter.timefilter.setTime({from:(0,_moment.default)(min).toISOString(),to:(0,_moment.default)(max).toISOString()})}}}function toggleTimerangeSwitch(){setApplyTimeRange(!applyTimeRange)}function removeId(id){setNewSelection(newSelection.filter(function(item){return item!==id}))}function clearSelection(){setNewSelection([])}function renderJobSelectionBar(){return _react.default.createElement(_eui.EuiFlexGroup,{responsive:false,gutterSize:"xs",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,responsive:false,gutterSize:"xs",alignItems:"center"},_react.default.createElement(_id_badges.IdBadges,{limit:BADGE_LIMIT,maps:maps,onLinkClick:function onLinkClick(){return setShowAllBarBadges(!showAllBarBadges)},selectedIds:selectedIds,showAllBarBadges:showAllBarBadges}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"xs",iconType:"pencil",onClick:handleJobSelectionClick},_i18n.i18n.translate("xpack.ml.jobSelector.jobSelectionButton",{defaultMessage:"Edit job selection"}))))}function renderFlyout(){if(isFlyoutVisible){return _react.default.createElement(_eui.EuiFlyout,{ref:flyoutEl,onClose:closeFlyout,"aria-labelledby":"jobSelectorFlyout",size:"l"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h2",{id:"flyoutTitle"},_i18n.i18n.translate("xpack.ml.jobSelector.flyoutTitle",{defaultMessage:"Job selection"})))),_react.default.createElement(_eui.EuiFlyoutBody,{className:"mlJobSelectorFlyoutBody"},_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,responsive:false,gutterSize:"xs",alignItems:"center"},_react.default.createElement(_new_selection_id_badges.NewSelectionIdBadges,{limit:BADGE_LIMIT,maps:maps,newSelection:newSelection,onDeleteClick:removeId,onLinkClick:function onLinkClick(){return setShowAllBadges(!showAllBadges)},showAllBadges:showAllBadges}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},!singleSelection&&newSelection.length>0&&_react.default.createElement(_eui.EuiButtonEmpty,{onClick:clearSelection,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.clearAllFlyoutButton",{defaultMessage:"Clear all"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSwitch,{label:_i18n.i18n.translate("xpack.ml.jobSelector.applyTimerangeSwitchLabel",{defaultMessage:"Apply timerange"}),checked:applyTimeRange,onChange:toggleTimerangeSwitch}))))),_react.default.createElement(_job_selector_table.JobSelectorTable,{jobs:jobs,ganttBarWidth:ganttBarWidth,groupsList:groups,onSelection:handleNewSelection,selectedIds:newSelection,singleSelection:singleSelection,timeseriesOnly:timeseriesOnly})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:applySelection,fill:true,isDisabled:newSelection.length===0},_i18n.i18n.translate("xpack.ml.jobSelector.applyFlyoutButton",{defaultMessage:"Apply"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:closeFlyout},_i18n.i18n.translate("xpack.ml.jobSelector.closeFlyoutButton",{defaultMessage:"Close"}))))))}}return _react.default.createElement("div",{className:"mlJobSelectorBar"},selectedIds.length>0&&renderJobSelectionBar(),renderFlyout())}JobSelector.propTypes={globalState:_propTypes.PropTypes.object,jobSelectService:_propTypes.PropTypes.object,selectedJobIds:_propTypes.PropTypes.array,singleSelection:_propTypes.PropTypes.string,timeseriesOnly:_propTypes.PropTypes.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobSelectorTable",{enumerable:true,get:function get(){return _job_selector_table.JobSelectorTable}});var _job_selector_table=__webpack_require__(3093)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelectorTable=JobSelectorTable;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _custom_selection_table=__webpack_require__(3094);var _job_selector_badge=__webpack_require__(899);var _timerange_bar=__webpack_require__(3097);var _eui=__webpack_require__(1);var _services=__webpack_require__(576);var _i18n=__webpack_require__(4);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JOB_FILTER_FIELDS=["job_id","groups"];var GROUP_FILTER_FIELDS=["id"];function JobSelectorTable(_ref){var ganttBarWidth=_ref.ganttBarWidth,groupsList=_ref.groupsList,jobs=_ref.jobs,onSelection=_ref.onSelection,selectedIds=_ref.selectedIds,singleSelection=_ref.singleSelection,timeseriesOnly=_ref.timeseriesOnly;var _useState=(0,_react.useState)(),_useState2=_slicedToArray(_useState,2),sortableProperties=_useState2[0],setSortableProperties=_useState2[1];var _useState3=(0,_react.useState)("Jobs"),_useState4=_slicedToArray(_useState3,2),currentTab=_useState4[0],setCurrentTab=_useState4[1];(0,_react.useEffect)(function(){var sortablePropertyItems=[];var defaultSortProperty="job_id";if(currentTab==="Jobs"||singleSelection){sortablePropertyItems=[{name:"job_id",getValue:function getValue(item){return item.job_id.toLowerCase()},isAscending:true},{name:"groups",getValue:function getValue(item){return item.groups&&item.groups[0]?item.groups[0].toLowerCase():""},isAscending:true}]}else if(currentTab==="Groups"){defaultSortProperty="id";sortablePropertyItems=[{name:"id",getValue:function getValue(item){return item.id.toLowerCase()},isAscending:true}]}var sortableProps=new _services.SortableProperties(sortablePropertyItems,defaultSortProperty);setSortableProperties(sortableProps)},[jobs,currentTab]);var tabs=[{id:"Jobs",name:_i18n.i18n.translate("xpack.ml.jobSelector.jobsTab",{defaultMessage:"Jobs"}),content:renderJobsTable()},{id:"Groups",name:_i18n.i18n.translate("xpack.ml.jobSelector.groupsTab",{defaultMessage:"Groups"}),content:renderGroupsTable()}];function getGroupOptions(){return groupsList.map(function(g){return{value:g.id,view:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{key:g.id,grow:false},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:g.id,isGroup:true})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_i18n.i18n.translate("xpack.ml.jobSelector.filterBar.jobGroupTitle",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:g.jobIds.length}}))))}})}function renderJobsTable(){var columns=[{id:"checkbox",isCheckbox:true,textOnly:false,width:"24px"},{label:"job ID",id:"job_id",isSortable:true,alignment:_services.LEFT_ALIGNMENT},{id:"groups",label:"groups",isSortable:true,alignment:_services.LEFT_ALIGNMENT,render:function render(_ref2){var _ref2$groups=_ref2.groups,groups=_ref2$groups===void 0?[]:_ref2$groups;return groups.map(function(group){return _react.default.createElement(_job_selector_badge.JobSelectorBadge,{key:"".concat(group,"-key"),id:group,isGroup:true})})}},{label:"time range",id:"timerange",alignment:_services.LEFT_ALIGNMENT,render:function render(_ref3){var _ref3$timeRange=_ref3.timeRange,timeRange=_ref3$timeRange===void 0?{}:_ref3$timeRange,isRunning=_ref3.isRunning;return _react.default.createElement(_timerange_bar.TimeRangeBar,{timerange:timeRange,isRunning:isRunning,ganttBarWidth:ganttBarWidth})}}];var filters=[{type:"field_value_selection",field:"groups",name:_i18n.i18n.translate("xpack.ml.jobSelector.filterBar.groupLabel",{defaultMessage:"Group"}),loadingMessage:"Loading...",noOptionsMessage:"No groups found.",multiSelect:"or",cache:1e4,options:getGroupOptions()}];return _react.default.createElement(_custom_selection_table.CustomSelectionTable,{columns:columns,filters:filters,filterDefaultFields:!singleSelection?JOB_FILTER_FIELDS:undefined,items:jobs,onTableChange:function onTableChange(selectionFromTable){return onSelection({selectionFromTable:selectionFromTable})},selectedIds:selectedIds,singleSelection:singleSelection,sortableProperties:sortableProperties,timeseriesOnly:timeseriesOnly})}function renderGroupsTable(){var groupColumns=[{id:"checkbox",isCheckbox:true,textOnly:false,width:"24px"},{label:"group ID",id:"id",isSortable:true,alignment:_services.LEFT_ALIGNMENT,render:function render(_ref4){var id=_ref4.id;return _react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:id,isGroup:true})}},{id:"jobs in group",label:"jobs in group",isSortable:false,alignment:_services.CENTER_ALIGNMENT,render:function render(_ref5){var _ref5$jobIds=_ref5.jobIds,jobIds=_ref5$jobIds===void 0?[]:_ref5$jobIds;return jobIds.length}},{label:"time range",id:"timerange",alignment:_services.LEFT_ALIGNMENT,render:function render(_ref6){var _ref6$timeRange=_ref6.timeRange,timeRange=_ref6$timeRange===void 0?{}:_ref6$timeRange;return _react.default.createElement(_timerange_bar.TimeRangeBar,{timerange:timeRange,ganttBarWidth:ganttBarWidth})}}];return _react.default.createElement(_custom_selection_table.CustomSelectionTable,{columns:groupColumns,filterDefaultFields:!singleSelection?GROUP_FILTER_FIELDS:undefined,items:groupsList,onTableChange:function onTableChange(selectionFromTable){return onSelection({selectionFromTable:selectionFromTable})},selectedIds:selectedIds,sortableProperties:sortableProperties})}function renderTabs(){return _react.default.createElement(_eui.EuiTabbedContent,{size:"s",tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(tab){setCurrentTab(tab.id)}})}return _react.default.createElement(_react.Fragment,null,jobs.length===0&&_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}),jobs.length!==0&&singleSelection==="true"&&renderJobsTable(),jobs.length!==0&&singleSelection===undefined&&renderTabs())}JobSelectorTable.propTypes={ganttBarWidth:_propTypes.PropTypes.number.isRequired,groupsList:_propTypes.PropTypes.array,jobs:_propTypes.PropTypes.array,onSelection:_propTypes.PropTypes.func.isRequired,selectedIds:_propTypes.PropTypes.array.isRequired,singleSelection:_propTypes.PropTypes.string,timeseriesOnly:_propTypes.PropTypes.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CustomSelectionTable",{enumerable:true,get:function get(){return _custom_selection_table.CustomSelectionTable}});var _custom_selection_table=__webpack_require__(3095)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomSelectionTable=CustomSelectionTable;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _services=__webpack_require__(576);var _i18n=__webpack_require__(4);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JOBS_PER_PAGE=20;function getError(error){if(error!==null){return _i18n.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:error.message}})}return""}function CustomSelectionTable(_ref){var columns=_ref.columns,filterDefaultFields=_ref.filterDefaultFields,filters=_ref.filters,items=_ref.items,onTableChange=_ref.onTableChange,selectedIds=_ref.selectedIds,singleSelection=_ref.singleSelection,sortableProperties=_ref.sortableProperties,timeseriesOnly=_ref.timeseriesOnly;var _useState=(0,_react.useState)(getCurrentlySelectedItemIdsMap()),_useState2=_slicedToArray(_useState,2),itemIdToSelectedMap=_useState2[0],setItemIdToSelectedMap=_useState2[1];var _useState3=(0,_react.useState)(items),_useState4=_slicedToArray(_useState3,2),currentItems=_useState4[0],setCurrentItems=_useState4[1];var _useState5=(0,_react.useState)(selectedIds),_useState6=_slicedToArray(_useState5,2),lastSelected=_useState6[0],setLastSelected=_useState6[1];var _useState7=(0,_react.useState)(""),_useState8=_slicedToArray(_useState7,2),sortedColumn=_useState8[0],setSortedColumn=_useState8[1];var _useState9=(0,_react.useState)(),_useState10=_slicedToArray(_useState9,2),pager=_useState10[0],setPager=_useState10[1];var _useState11=(0,_react.useState)({itemsPerPage:JOBS_PER_PAGE,firstItemIndex:0,lastItemIndex:1}),_useState12=_slicedToArray(_useState11,2),pagerSettings=_useState12[0],setPagerSettings=_useState12[1];var _useState13=(0,_react.useState)(_eui.EuiSearchBar.Query.MATCH_ALL),_useState14=_slicedToArray(_useState13,2),query=_useState14[0],setQuery=_useState14[1];var _useState15=(0,_react.useState)(null),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];(0,_react.useEffect)(function(){setCurrentItems(items);handleQueryChange({query:query})},[items]);(0,_react.useEffect)(function(){setItemIdToSelectedMap(getCurrentlySelectedItemIdsMap())},[selectedIds]);(0,_react.useEffect)(function(){var tablePager=new _services.Pager(currentItems.length,JOBS_PER_PAGE);setPagerSettings({itemsPerPage:JOBS_PER_PAGE,firstItemIndex:tablePager.getFirstItemIndex(),lastItemIndex:tablePager.getLastItemIndex()});setPager(tablePager)},[currentItems]);function getCurrentlySelectedItemIdsMap(){var selectedIdsMap={all:false};selectedIds.forEach(function(id){selectedIdsMap[id]=true});return selectedIdsMap}function handleSingleSelectionTableChange(itemId){onTableChange([itemId])}function handleTableChange(_ref2){var isSelected=_ref2.isSelected,itemId=_ref2.itemId;var selectedMapIds=Object.getOwnPropertyNames(itemIdToSelectedMap);var currentItemIds=currentItems.map(function(item){return item.id});var currentSelected=selectedMapIds.filter(function(id){return itemIdToSelectedMap[id]===true&&id!==itemId});if(itemId!=="all"){if(isSelected===true){currentSelected.push(itemId)}}else{if(isSelected===false){currentSelected=currentSelected.filter(function(id){return currentItemIds.includes(id)===false})}else{currentSelected=[].concat(_toConsumableArray(currentSelected),_toConsumableArray(currentItemIds));currentSelected=_toConsumableArray(new Set(currentSelected))}}onTableChange(currentSelected)}function handleChangeItemsPerPage(itemsPerPage){pager.setItemsPerPage(itemsPerPage);setPagerSettings(_objectSpread({},pagerSettings,{itemsPerPage:itemsPerPage,firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()}))}function handlePageChange(pageIndex){pager.goToPageIndex(pageIndex);setPagerSettings(_objectSpread({},pagerSettings,{firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()}))}function handleQueryChange(_ref3){var incomingQuery=_ref3.query,newError=_ref3.error;if(newError){setError(newError)}else{var queriedItems=_eui.EuiSearchBar.Query.execute(incomingQuery,items,{defaultFields:filterDefaultFields});setError(null);setCurrentItems(queriedItems);setQuery(incomingQuery)}}function isItemSelected(itemId){return itemIdToSelectedMap[itemId]===true}function areAllItemsSelected(){var indexOfUnselectedItem=currentItems.findIndex(function(item){return!isItemSelected(item.id)});return indexOfUnselectedItem===-1}function renderSelectAll(mobile){var selectAll=_i18n.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return _react.default.createElement(_eui.EuiCheckbox,{id:"selectAllCheckbox",label:mobile?selectAll:null,checked:areAllItemsSelected(),onChange:toggleAll,type:mobile?null:"inList"})}function toggleItem(itemId){if(singleSelection){var _objectSpread2;var lastId=lastSelected[0];setItemIdToSelectedMap(_objectSpread({},itemIdToSelectedMap,(_objectSpread2={},_defineProperty(_objectSpread2,lastId,false),_defineProperty(_objectSpread2,itemId,true),_objectSpread2)));handleSingleSelectionTableChange(itemId);setLastSelected([itemId])}else{var isSelected=!isItemSelected(itemId);setItemIdToSelectedMap(_objectSpread({},itemIdToSelectedMap,_defineProperty({},itemId,isSelected)));handleTableChange({isSelected:isSelected,itemId:itemId})}}function toggleAll(){var allSelected=areAllItemsSelected()||itemIdToSelectedMap.all===true;var newItemIdToSelectedMap={};currentItems.forEach(function(item){return newItemIdToSelectedMap[item.id]=!allSelected});setItemIdToSelectedMap(newItemIdToSelectedMap);handleTableChange({isSelected:!allSelected,itemId:"all"})}function onSort(prop){sortableProperties.sortOn(prop);var sortedItems=sortableProperties.sortItems(currentItems);setCurrentItems(sortedItems);setSortedColumn(prop)}function renderHeaderCells(){var headers=[];columns.forEach(function(column,columnIndex){if(column.isCheckbox&&!singleSelection){headers.push(_react.default.createElement(_eui.EuiTableHeaderCellCheckbox,{key:column.id,width:column.width},renderSelectAll()))}else{headers.push(_react.default.createElement(_eui.EuiTableHeaderCell,{key:column.id,align:columns[columnIndex].alignment,width:column.width,onSort:column.isSortable?function(){return onSort(column.id)}:undefined,isSorted:sortedColumn===column.id,isSortAscending:sortableProperties?sortableProperties.isAscendingByName(column.id):true,mobileOptions:column.mobileOptions},column.label))}});return headers.length?headers:null}function renderRows(){var renderRow=function renderRow(item){var cells=columns.map(function(column){var cell=item[column.id];var child;if(column.isCheckbox){return _react.default.createElement(_eui.EuiTableRowCellCheckbox,{key:column.id},!singleSelection&&_react.default.createElement(_eui.EuiCheckbox,{id:"".concat(item.id,"-checkbox"),"data-testid":"".concat(item.id,"-checkbox"),checked:isItemSelected(item.id),onChange:function onChange(){return toggleItem(item.id)},type:"inList"}),singleSelection&&_react.default.createElement(_eui.EuiRadio,{id:item.id,"data-testid":"".concat(item.id,"-radio-button"),checked:isItemSelected(item.id),onChange:function onChange(){return toggleItem(item.id)},disabled:timeseriesOnly&&item.isSingleMetricViewerJob===false}))}if(column.render){child=column.render(item)}else{child=cell}return _react.default.createElement(_eui.EuiTableRowCell,{key:column.id,align:column.alignment,truncateText:cell&&cell.truncateText,textOnly:cell?cell.textOnly:true,mobileOptions:_objectSpread({header:column.label},column.mobileOptions)},child)});return _react.default.createElement(_eui.EuiTableRow,{key:item.id,isSelected:isItemSelected(item.id),isSelectable:true,hasActions:true},cells)};var rows=[];for(var itemIndex=pagerSettings.firstItemIndex;itemIndex<=pagerSettings.lastItemIndex;itemIndex++){var item=currentItems[itemIndex];if(item===undefined){break}rows.push(renderRow(item))}return rows}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSearchBar,{defaultQuery:query,box:{incremental:true,placeholder:_i18n.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:filters,onChange:handleQueryChange}),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,isInvalid:error!==null,error:getError(error),style:{maxHeight:"0px"}},_react.default.createElement(_react.Fragment,null)))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiTableHeaderMobile,null,_react.default.createElement(_eui.EuiFlexGroup,{responsive:false,justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},renderSelectAll(true)))),_react.default.createElement(_eui.EuiTable,null,_react.default.createElement(_eui.EuiTableHeader,null,renderHeaderCells()),_react.default.createElement(_eui.EuiTableBody,null,renderRows())),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),pager!==undefined&&_react.default.createElement(_eui.EuiTablePagination,{activePage:pager.getCurrentPageIndex(),itemsPerPage:pagerSettings.itemsPerPage,itemsPerPageOptions:[10,JOBS_PER_PAGE,50],pageCount:pager.getTotalPages(),onChangeItemsPerPage:handleChangeItemsPerPage,onChangePage:function onChangePage(pageIndex){return handlePageChange(pageIndex)}}))}CustomSelectionTable.propTypes={columns:_propTypes.PropTypes.array.isRequired,filterDefaultFields:_propTypes.PropTypes.array,filters:_propTypes.PropTypes.array,items:_propTypes.PropTypes.array.isRequired,onTableChange:_propTypes.PropTypes.func.isRequired,selectedId:_propTypes.PropTypes.array,singleSelection:_propTypes.PropTypes.string,sortableProperties:_propTypes.PropTypes.object,timeseriesOnly:_propTypes.PropTypes.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelectorBadge=JobSelectorBadge;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _group_color_utils=__webpack_require__(1351);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function JobSelectorBadge(_ref){var icon=_ref.icon,id=_ref.id,_ref$isGroup=_ref.isGroup,isGroup=_ref$isGroup===void 0?false:_ref$isGroup,numJobs=_ref.numJobs,removeId=_ref.removeId;var color=isGroup?(0,_group_color_utils.tabColor)(id):"hollow";var props={color:color};var jobCount;if(icon===true){props=_objectSpread({},props,{iconType:"cross",iconSide:"right",onClick:function onClick(){return removeId(id)},onClickAriaLabel:"Remove id"})}if(numJobs!==undefined){jobCount=_i18n.i18n.translate("xpack.ml.jobSelector.selectedGroupJobs",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:numJobs}})}return _react.default.createElement(_eui.EuiBadge,_extends({key:"".concat(id,"-id")},props),"".concat(id).concat(jobCount?jobCount:""))}JobSelectorBadge.propTypes={icon:_propTypes.PropTypes.bool,id:_propTypes.PropTypes.string.isRequired,isGroup:_propTypes.PropTypes.bool,numJobs:_propTypes.PropTypes.number,removeId:_propTypes.PropTypes.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeRangeBar",{enumerable:true,get:function get(){return _timerange_bar.TimeRangeBar}});var _timerange_bar=__webpack_require__(3098)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeRangeBar=TimeRangeBar;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function TimeRangeBar(_ref){var isRunning=_ref.isRunning,timerange=_ref.timerange,ganttBarWidth=_ref.ganttBarWidth;var style={width:timerange.widthPx,marginLeft:timerange.fromPx};var className="mlJobSelector__ganttBar".concat(isRunning?" mlJobSelector__ganttBarRunning":"");return _react.default.createElement(_eui.EuiToolTip,{position:"top",content:timerange.label},_react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{className:"mlJobSelector__ganttBarBackEdge"},_react.default.createElement("div",{className:"mlJobSelector__ganttBarDashed",style:{width:"".concat(ganttBarWidth,"px")}})),_react.default.createElement("div",{style:style,className:className})))}TimeRangeBar.propTypes={ganttBarWidth:_propTypes.PropTypes.number,isRunning:_propTypes.PropTypes.bool,timerange:_propTypes.PropTypes.shape({widthPx:_propTypes.PropTypes.number,label:_propTypes.PropTypes.string,fromPx:_propTypes.PropTypes.number})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"IdBadges",{enumerable:true,get:function get(){return _id_badges.IdBadges}});var _id_badges=__webpack_require__(3100)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IdBadges=IdBadges;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _job_selector_badge=__webpack_require__(899);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function IdBadges(_ref){var limit=_ref.limit,maps=_ref.maps,onLinkClick=_ref.onLinkClick,selectedIds=_ref.selectedIds,showAllBarBadges=_ref.showAllBarBadges;var badges=[];var currentGroups=[];for(var i=0;i<selectedIds.length;i++){var currentId=selectedIds[i];if(maps.groupsMap[currentId]!==undefined){currentGroups.push(currentId);badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:currentId},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:currentId,isGroup:true,numJobs:maps.groupsMap[currentId].length})))}else{continue}}for(var _i=0;_i<selectedIds.length;_i++){var _currentId=selectedIds[_i];if(maps.groupsMap[_currentId]===undefined){var jobGroups=maps.jobsMap[_currentId]||[];if(jobGroups.some(function(g){return currentGroups.includes(g)})===false){badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:_currentId},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:_currentId})))}else{continue}}else{continue}}if(showAllBarBadges||badges.length<=limit){if(badges.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.hideBarBadges",{defaultMessage:"Hide"}))))}return badges}else{var overFlow=badges.length-limit;badges.splice(limit);badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.showBarBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:overFlow}}))));return badges}}IdBadges.propTypes={limit:_propTypes.PropTypes.number,maps:_propTypes.PropTypes.shape({jobsMap:_propTypes.PropTypes.object,groupsMap:_propTypes.PropTypes.object}),onLinkClick:_propTypes.PropTypes.func,selectedIds:_propTypes.PropTypes.array,showAllBarBadges:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewSelectionIdBadges",{enumerable:true,get:function get(){return _new_selection_id_badges.NewSelectionIdBadges}});var _new_selection_id_badges=__webpack_require__(3102)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewSelectionIdBadges=NewSelectionIdBadges;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _job_selector_badge=__webpack_require__(899);var _i18n=__webpack_require__(4);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NewSelectionIdBadges(_ref){var limit=_ref.limit,maps=_ref.maps,newSelection=_ref.newSelection,onDeleteClick=_ref.onDeleteClick,onLinkClick=_ref.onLinkClick,showAllBadges=_ref.showAllBadges;var badges=[];for(var i=0;i<newSelection.length;i++){if(i>=limit&&showAllBadges===false){break}badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:newSelection[i]},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:newSelection[i],icon:true,isGroup:maps.groupsMap[newSelection[i]]!==undefined,removeId:onDeleteClick})))}if(showAllBadges===false&&newSelection.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.showFlyoutBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:newSelection.length-limit}}))))}else if(showAllBadges===true&&newSelection.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"hide-badges-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.hideFlyoutBadges",{defaultMessage:"Hide"}))))}return badges}NewSelectionIdBadges.propTypes={limit:_propTypes.PropTypes.number,maps:_propTypes.PropTypes.shape({jobsMap:_propTypes.PropTypes.object,groupsMap:_propTypes.PropTypes.object}),newSelection:_propTypes.PropTypes.array,onDeleteClick:_propTypes.PropTypes.func,onLinkClick:_propTypes.PropTypes.func,showAllBadges:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3104);__webpack_require__(3113);__webpack_require__(3119);__webpack_require__(1396);__webpack_require__(1392);__webpack_require__(683)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3105)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _timefilter=__webpack_require__(22);var _modules=__webpack_require__(8);var _forecasting_modal=__webpack_require__(1393);var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlForecastingModal",function($injector){var reactDirective=$injector.get("reactDirective");return reactDirective((0,_i18n.wrapInI18nContext)(_forecasting_modal.ForecastingModal),Object.keys(_forecasting_modal.ForecastingModal.WrappedComponent.propTypes||{}),{restrict:"E"},{timefilter:_timefilter.timefilter})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Modal=Modal;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _message_call_out=__webpack_require__(3107);var _forecasts_list=__webpack_require__(3109);var _run_controls=__webpack_require__(3110);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Modal(props){return _react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:props.close,maxWidth:860},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingTitle",defaultMessage:"Forecasting"}))),_react.default.createElement(_eui.EuiModalBody,null,props.messages.map(function(message,i){return _react.default.createElement(_react.default.Fragment,{key:i},_react.default.createElement(_message_call_out.MessageCallOut,message),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}),props.forecasts.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_forecasts_list.ForecastsList,{forecasts:props.forecasts,viewForecast:props.viewForecast}),_react.default.createElement(_eui.EuiSpacer,null)),_react.default.createElement(_run_controls.RunControls,props)),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:props.close,size:"s"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closeButtonLabel",defaultMessage:"Close"})))))}Modal.propType={job:_propTypes.default.object,forecasts:_propTypes.default.array,close:_propTypes.default.func.isRequired,viewForecast:_propTypes.default.func.isRequired,runForecast:_propTypes.default.func.isRequired,newForecastDuration:_propTypes.default.string,isNewForecastDurationValid:_propTypes.default.bool,newForecastDurationErrors:_propTypes.default.array,onNewForecastDurationChange:_propTypes.default.func.isRequired,isForecastRequested:_propTypes.default.bool,forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number,messages:_propTypes.default.array}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MessageCallOut",{enumerable:true,get:function get(){return _message_call_out.MessageCallOut}});var _message_call_out=__webpack_require__(3108)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MessageCallOut=MessageCallOut;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(6));var _eui=__webpack_require__(1);var _message_levels=__webpack_require__(1394);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function getCallOutAttributes(message,status){switch(status){case _message_levels.MESSAGE_LEVEL.ERROR:return{title:message,iconType:"cross",color:"danger"};case _message_levels.MESSAGE_LEVEL.WARNING:return{title:message,iconType:"alert",color:"warning"};case _message_levels.MESSAGE_LEVEL.SUCCESS:return{title:message,iconType:"check",color:"success"};case _message_levels.MESSAGE_LEVEL.INFO:return{title:message,iconType:"iInCircle",color:"primary"}}}function MessageCallOut(_ref){var message=_ref.message,status=_ref.status,rest=_objectWithoutProperties(_ref,["message","status"]);return _react.default.createElement(_eui.EuiCallOut,_extends({size:"s"},getCallOutAttributes(message,status),rest))}MessageCallOut.propTypes={message:_propTypes.default.string,status:_propTypes.default.oneOf([_message_levels.MESSAGE_LEVEL.ERROR,_message_levels.MESSAGE_LEVEL.WARNING,_message_levels.MESSAGE_LEVEL.SUCCESS,_message_levels.MESSAGE_LEVEL.INFO])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastsList=ForecastsList;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _date_utils=__webpack_require__(279);var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getColumns(viewForecast){return[{field:"forecast_create_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.createdColumnName",{defaultMessage:"Created"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{field:"forecast_start_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{field:"forecast_end_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.toColumnName",{defaultMessage:"To"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewColumnName",{defaultMessage:"View"}),width:"60px",render:function render(forecast){var viewForecastAriaLabel=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewForecastAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:(0,_date_utils.formatHumanReadableDateTimeSeconds)(forecast.forecast_create_timestamp)}});return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return viewForecast(forecast.forecast_id)},iconType:"stats","aria-label":viewForecastAriaLabel})}}]}function ForecastsList(_ref){var forecasts=_ref.forecasts,viewForecast=_ref.viewForecast;return _react.default.createElement(_eui.EuiText,null,_react.default.createElement("h3",{"aria-describedby":"ml_aria_description_forecasting_modal_view_list",style:{display:"inline",paddingRight:"5px"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.previousForecastsTitle",defaultMessage:"Previous forecasts"})),_react.default.createElement(_eui.EuiToolTip,{position:"right",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.listsOfFiveRecentlyRunForecastsTooltip",defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},_react.default.createElement(_eui.EuiIcon,{type:"questionInCircle",size:"s"})),_react.default.createElement(_eui.EuiInMemoryTable,{items:forecasts,columns:getColumns(viewForecast),pagination:false}))}ForecastsList.propType={forecasts:_propTypes.default.array,viewForecast:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RunControls=RunControls;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _states=__webpack_require__(573);var _forecasting_modal=__webpack_require__(1393);var _forecast_progress=__webpack_require__(3111);var _check_ml_nodes=__webpack_require__(71);var _check_privilege=__webpack_require__(39);var _i18n=__webpack_require__(4);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getRunInputDisabledState(job,isForecastRequested){if((0,_check_ml_nodes.mlNodesAvailable)()===false){return{isDisabled:true,isDisabledToolTipText:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.noMLNodesAvailableTooltip",{defaultMessage:"There are no ML nodes available."})}}if((0,_check_privilege.checkPermission)("canForecastJob")===false){return{isDisabled:true,isDisabledToolTipText:(0,_check_privilege.createPermissionFailureMessage)("canForecastJob")}}if(job.state!==_states.JOB_STATE.OPENED&&job.state!==_states.JOB_STATE.CLOSED){return{isDisabled:true,isDisabledToolTipText:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.forecastsCanNotBeRunOnJobsTooltip",{defaultMessage:"Forecasts cannot be run on {jobState} jobs",values:{jobState:job.state}})}}return{isDisabled:isForecastRequested}}function RunControls(_ref){var job=_ref.job,newForecastDuration=_ref.newForecastDuration,isNewForecastDurationValid=_ref.isNewForecastDurationValid,newForecastDurationErrors=_ref.newForecastDurationErrors,onNewForecastDurationChange=_ref.onNewForecastDurationChange,runForecast=_ref.runForecast,isForecastRequested=_ref.isForecastRequested,forecastProgress=_ref.forecastProgress,jobOpeningState=_ref.jobOpeningState,jobClosingState=_ref.jobClosingState;var disabledState=getRunInputDisabledState(job,isForecastRequested);var durationInput=_react.default.createElement(_eui.EuiFieldText,{name:"forecastDuration",value:newForecastDuration,disabled:disabledState.isDisabled,isInvalid:!isNewForecastDurationValid,onChange:onNewForecastDurationChange,fullWidth:true});var runButton=_react.default.createElement(_eui.EuiButton,{onClick:runForecast,isDisabled:disabledState.isDisabled||!isNewForecastDurationValid},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runButtonLabel",defaultMessage:"Run"}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runNewForecastTitle",defaultMessage:"Run a new forecast"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.durationLabel",defaultMessage:"Duration"}),fullWidth:true,isInvalid:!isNewForecastDurationValid,error:newForecastDurationErrors,helpText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.forecastMaximumLengthHelpText",defaultMessage:"Length of forecast, up to a maximum of {maximumForecastDurationDays} days. Use s for seconds, m for minutes, h for hours, d for days, w for weeks.",values:{maximumForecastDurationDays:_forecasting_modal.FORECAST_DURATION_MAX_DAYS}})},disabledState.isDisabledToolTipText===undefined?durationInput:_react.default.createElement(_eui.EuiToolTip,{position:"right",content:disabledState.isDisabledToolTipText},durationInput))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true},disabledState.isDisabledToolTipText===undefined?runButton:_react.default.createElement(_eui.EuiToolTip,{position:"left",content:disabledState.isDisabledToolTipText},runButton))))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),isForecastRequested===true&&_react.default.createElement(_forecast_progress.ForecastProgress,{forecastProgress:forecastProgress,jobOpeningState:jobOpeningState,jobClosingState:jobClosingState}))}RunControls.propType={job:_propTypes.default.object,newForecastDuration:_propTypes.default.string,isNewForecastDurationValid:_propTypes.default.bool,newForecastDurationErrors:_propTypes.default.array,onNewForecastDurationChange:_propTypes.default.func.isRequired,runForecast:_propTypes.default.func.isRequired,isForecastRequested:_propTypes.default.bool,forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastProgress=ForecastProgress;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _progress_icon=__webpack_require__(3112);var _progress_states=__webpack_require__(901);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ForecastProgress(_ref){var forecastProgress=_ref.forecastProgress,jobOpeningState=_ref.jobOpeningState,jobClosingState=_ref.jobClosingState;return _react.default.createElement("div",null,jobOpeningState!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.openingJobTitle",defaultMessage:"Opening job…"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:jobOpeningState}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"})),forecastProgress!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.runningForecastTitle",defaultMessage:"Running forecast…"})))),forecastProgress>=0&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiToolTip,{position:"top",content:forecastProgress+"%"},_react.default.createElement(_eui.EuiProgress,{size:"l",value:forecastProgress,max:100}))),forecastProgress===_progress_states.PROGRESS_STATES.ERROR&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:_progress_states.PROGRESS_STATES.ERROR}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"})),jobClosingState!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closingJobTitle",defaultMessage:"Closing job…"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:jobClosingState})))))}ForecastProgress.propType={forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ProgressIcon=ProgressIcon;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _progress_states=__webpack_require__(901);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ProgressIcon(_ref){var state=_ref.state;if(state===_progress_states.PROGRESS_STATES.WAITING){return _react.default.createElement(_eui.EuiLoadingSpinner,{size:"m"})}else if(state===_progress_states.PROGRESS_STATES.DONE){return _react.default.createElement(_eui.EuiIcon,{type:"check",size:"m",color:"primary"})}else if(state===_progress_states.PROGRESS_STATES.ERROR){return _react.default.createElement(_eui.EuiIcon,{type:"cross",size:"m",color:"danger"})}}ProgressIcon.propTypes={state:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _timeseries_chart=__webpack_require__(3114);var _angular=_interopRequireDefault(__webpack_require__(26));var _timefilter=__webpack_require__(22);var _resize_checker=__webpack_require__(438);var _modules=__webpack_require__(8);var _i18n=__webpack_require__(15);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlTimeseriesChart",function($timeout){function link(scope,element){var svgWidth=_angular.default.element(".results-container").width();function contextChartSelected(selection){scope.$root.$broadcast("contextChartSelected",selection)}function renderReactComponent(){var renderFocusChartOnly=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;svgWidth=Math.max(_angular.default.element(".results-container").width(),0);var props={annotationsEnabled:scope.annotationsEnabled,autoZoomDuration:scope.autoZoomDuration,contextAggregationInterval:scope.contextAggregationInterval,contextChartData:scope.contextChartData,contextForecastData:scope.contextForecastData,contextChartSelected:contextChartSelected,detectorIndex:scope.detectorIndex,focusAnnotationData:scope.focusAnnotationData,focusChartData:scope.focusChartData,focusForecastData:scope.focusForecastData,focusAggregationInterval:scope.focusAggregationInterval,modelPlotEnabled:scope.modelPlotEnabled,refresh:scope.refresh,renderFocusChartOnly:renderFocusChartOnly,selectedJob:scope.selectedJob,showAnnotations:scope.showAnnotations,showForecast:scope.showForecast,showModelBounds:scope.showModelBounds,svgWidth:svgWidth,swimlaneData:scope.swimlaneData,timefilter:_timefilter.timefilter,zoomFrom:scope.zoomFrom,zoomTo:scope.zoomTo};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_timeseries_chart.TimeseriesChart,props)),element[0])}renderReactComponent();scope.$on("render",function(){$timeout(function(){renderReactComponent()})});function renderFocusChart(){renderReactComponent(true)}scope.$watchCollection("focusForecastData",renderFocusChart);scope.$watchCollection("focusChartData",renderFocusChart);scope.$watchGroup(["showModelBounds","showForecast"],renderFocusChart);scope.$watch("annotationsEnabled",renderReactComponent);if(scope.annotationsEnabled){scope.$watchCollection("focusAnnotationData",renderFocusChart);scope.$watch("showAnnotations",renderFocusChart)}var resizeChecker=new _resize_checker.ResizeChecker(_angular.default.element(".ml-timeseries-chart"));resizeChecker.on("resize",function(){scope.$evalAsync(function(){renderReactComponent()})});element.on("$destroy",function(){resizeChecker.destroy();_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}return{scope:{annotationsEnabled:"=",selectedJob:"=",detectorIndex:"=",modelPlotEnabled:"=",contextChartData:"=",contextForecastData:"=",contextChartAnomalyData:"=",focusChartData:"=",swimlaneData:"=",focusAnnotationData:"=",focusForecastData:"=",contextAggregationInterval:"=",focusAggregationInterval:"=",zoomFrom:"=",zoomTo:"=",autoZoomDuration:"=",refresh:"=",showAnnotations:"=",showModelBounds:"=",showForecast:"="},link:link}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeseriesChart=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _lodash=_interopRequireDefault(__webpack_require__(3));var _d=_interopRequireDefault(__webpack_require__(27));var _moment=_interopRequireDefault(__webpack_require__(16));var _anomaly_utils=__webpack_require__(293);var _annotations_service=__webpack_require__(496);var _observable_utils=__webpack_require__(434);var _format_value=__webpack_require__(437);var _chart_utils=__webpack_require__(280);var _date_utils=__webpack_require__(279);var _time_buckets=__webpack_require__(312);var _table_service=__webpack_require__(881);var _context_chart_mask=__webpack_require__(3115);var _timeseriesexplorer_utils=__webpack_require__(1395);var _string_utils=__webpack_require__(67);var _field_format_service=__webpack_require__(296);var _chart_tooltip_service=__webpack_require__(362);var _timeseries_chart_annotations=__webpack_require__(3117);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var focusZoomPanelHeight=25;var focusChartHeight=310;var focusHeight=focusZoomPanelHeight+focusChartHeight;var contextChartHeight=60;var contextChartLineTopMargin=3;var chartSpacing=25;var swimlaneHeight=30;var margin={top:20,right:10,bottom:15,left:40};var ZOOM_INTERVAL_OPTIONS=[{duration:_moment.default.duration(1,"h"),label:"1h"},{duration:_moment.default.duration(12,"h"),label:"12h"},{duration:_moment.default.duration(1,"d"),label:"1d"},{duration:_moment.default.duration(1,"w"),label:"1w"},{duration:_moment.default.duration(2,"w"),label:"2w"},{duration:_moment.default.duration(1,"M"),label:"1M"}];var anomalyColorScale=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);var anomalyGrayScale=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);function getSvgHeight(){return focusHeight+contextChartHeight+swimlaneHeight+chartSpacing+margin.top+margin.bottom}var TimeseriesChartIntl=(0,_react2.injectI18n)((_temp=_class=function(_React$Component){_inherits(TimeseriesChart,_React$Component);function TimeseriesChart(){var _getPrototypeOf2;var _this;_classCallCheck(this,TimeseriesChart);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(TimeseriesChart)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"rowMouseenterSubscriber",null);_defineProperty(_assertThisInitialized(_this),"rowMouseleaveSubscriber",null);return _this}_createClass(TimeseriesChart,[{key:"componentWillUnmount",value:function componentWillUnmount(){var element=_d.default.select(this.rootNode);element.html("");if(this.rowMouseenterSubscriber!==null){this.rowMouseenterSubscriber.unsubscribe()}if(this.rowMouseleaveSubscriber!==null){this.rowMouseleaveSubscriber.unsubscribe()}}},{key:"componentDidMount",value:function componentDidMount(){var _this$props=this.props,annotationsEnabled=_this$props.annotationsEnabled,svgWidth=_this$props.svgWidth;this.vizWidth=svgWidth-margin.left-margin.right;var vizWidth=this.vizWidth;this.focusXScale=_d.default.time.scale().range([0,vizWidth]);this.focusYScale=_d.default.scale.linear().range([focusHeight,focusZoomPanelHeight]);var focusXScale=this.focusXScale;var focusYScale=this.focusYScale;this.focusXAxis=_d.default.svg.axis().scale(focusXScale).orient("bottom").innerTickSize(-focusChartHeight).outerTickSize(0).tickPadding(10);this.focusYAxis=_d.default.svg.axis().scale(focusYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);this.focusValuesLine=_d.default.svg.line().x(function(d){return focusXScale(d.date)}).y(function(d){return focusYScale(d.value)}).defined(function(d){return d.value!==null});this.focusBoundedArea=_d.default.svg.area().x(function(d){return focusXScale(d.date)||1}).y0(function(d){return focusYScale(d.upper)}).y1(function(d){return focusYScale(d.lower)}).defined(function(d){return d.lower!==null&&d.upper!==null});this.contextXScale=_d.default.time.scale().range([0,vizWidth]);this.contextYScale=_d.default.scale.linear().range([contextChartHeight,contextChartLineTopMargin]);this.fieldFormat=undefined;if(annotationsEnabled){this.annotateBrush=_timeseries_chart_annotations.getAnnotationBrush.call(this)}this.brush=_d.default.svg.brush();this.mask=undefined;var highlightFocusChartAnomaly=this.highlightFocusChartAnomaly.bind(this);var boundHighlightFocusChartAnnotation=_timeseries_chart_annotations.highlightFocusChartAnnotation.bind(this);function tableRecordMousenterListener(_ref){var record=_ref.record,_ref$type=_ref.type,type=_ref$type===void 0?"anomaly":_ref$type;if(type==="anomaly"){highlightFocusChartAnomaly(record)}else if(type==="annotation"){boundHighlightFocusChartAnnotation(record)}}var unhighlightFocusChartAnomaly=this.unhighlightFocusChartAnomaly.bind(this);var boundUnhighlightFocusChartAnnotation=_timeseries_chart_annotations.unhighlightFocusChartAnnotation.bind(this);function tableRecordMouseleaveListener(_ref2){var record=_ref2.record,_ref2$type=_ref2.type,type=_ref2$type===void 0?"anomaly":_ref2$type;if(type==="anomaly"){unhighlightFocusChartAnomaly(record)}else{boundUnhighlightFocusChartAnnotation(record)}}this.rowMouseenterSubscriber=_table_service.mlTableService.rowMouseenter$.subscribe(tableRecordMousenterListener);this.rowMouseleaveSubscriber=_table_service.mlTableService.rowMouseleave$.subscribe(tableRecordMouseleaveListener);this.renderChart();this.drawContextChartSelection();this.renderFocusChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this.props.renderFocusChartOnly===false){this.renderChart();this.drawContextChartSelection()}this.renderFocusChart();if(this.props.annotationsEnabled&&this.props.annotation===null){var chartElement=_d.default.select(this.rootNode);chartElement.select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}}},{key:"renderChart",value:function renderChart(){var _this$props2=this.props,annotationsEnabled=_this$props2.annotationsEnabled,contextChartData=_this$props2.contextChartData,contextForecastData=_this$props2.contextForecastData,detectorIndex=_this$props2.detectorIndex,modelPlotEnabled=_this$props2.modelPlotEnabled,selectedJob=_this$props2.selectedJob,svgWidth=_this$props2.svgWidth;var createFocusChart=this.createFocusChart.bind(this);var drawContextElements=this.drawContextElements.bind(this);var focusXScale=this.focusXScale;var focusYAxis=this.focusYAxis;var focusYScale=this.focusYScale;var svgHeight=getSvgHeight();var chartElement=_d.default.select(this.rootNode);chartElement.selectAll("*").remove();if(typeof selectedJob!=="undefined"){this.fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(selectedJob.job_id,detectorIndex)}else{return}if(contextChartData===undefined){return}var fieldFormat=this.fieldFormat;var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);var contextDataMin;var contextDataMax;if(modelPlotEnabled===true||contextForecastData!==undefined&&contextForecastData.length>0){var combinedData=contextForecastData===undefined?contextChartData:contextChartData.concat(contextForecastData);contextDataMin=_d.default.min(combinedData,function(d){return Math.min(d.value,d.lower)});contextDataMax=_d.default.max(combinedData,function(d){return Math.max(d.value,d.upper)})}else{contextDataMin=_d.default.min(contextChartData,function(d){return d.value});contextDataMax=_d.default.max(contextChartData,function(d){return d.value})}var ceiledMax=contextDataMax>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMax)))):contextDataMax;var flooredMin=contextDataMin>=0?contextDataMin:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMin))));focusYScale.domain([flooredMin,ceiledMax]);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");tempLabelText.selectAll("text.temp.axis").data(focusYScale.ticks()).enter().append("text").text(function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{return focusYScale.tickFormat()(d)}}).each(function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+focusYAxis.tickPadding(),maxYAxisLabelWidth)}).remove();_d.default.select(".temp-axis-label").remove();margin.left=Math.max(maxYAxisLabelWidth,40);this.vizWidth=Math.max(svgWidth-margin.left-margin.right,0);focusXScale.range([0,this.vizWidth]);focusYAxis.innerTickSize(-this.vizWidth);var focus=svg.append("g").attr("class","focus-chart").attr("transform","translate("+margin.left+","+margin.top+")");var context=svg.append("g").attr("class","context-chart").attr("transform","translate("+margin.left+","+(focusHeight+margin.top+chartSpacing)+")");if(annotationsEnabled){var annotationsMask=svg.append("defs").append("mask").attr("id",_timeseries_chart_annotations.ANNOTATION_MASK_ID);annotationsMask.append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",focusHeight).style("fill","white")}createFocusChart(focus,this.vizWidth,focusHeight);drawContextElements(context,this.vizWidth,contextChartHeight,swimlaneHeight)}},{key:"drawContextChartSelection",value:function drawContextChartSelection(){var _this$props3=this.props,contextChartData=_this$props3.contextChartData,contextChartSelected=_this$props3.contextChartSelected,contextForecastData=_this$props3.contextForecastData,zoomFrom=_this$props3.zoomFrom,zoomTo=_this$props3.zoomTo;if(contextChartData===undefined){return}var setContextBrushExtent=this.setContextBrushExtent.bind(this);var focusLoadFrom;var focusLoadTo;var contextXMin=this.contextXScale.domain()[0].getTime();var contextXMax=this.contextXScale.domain()[1].getTime();var combinedData=contextChartData;if(contextForecastData!==undefined){combinedData=combinedData.concat(contextForecastData)}if(zoomFrom){focusLoadFrom=zoomFrom.getTime()}else{focusLoadFrom=_lodash.default.reduce(combinedData,function(memo,point){return Math.min(memo,point.date.getTime())},new Date(2099,12,31).getTime())}focusLoadFrom=Math.max(focusLoadFrom,contextXMin);if(zoomTo){focusLoadTo=zoomTo.getTime()}else{focusLoadTo=_lodash.default.reduce(combinedData,function(memo,point){return Math.max(memo,point.date.getTime())},0)}focusLoadTo=Math.min(focusLoadTo,contextXMax);if(focusLoadFrom!==contextXMin||focusLoadTo!==contextXMax){setContextBrushExtent(new Date(focusLoadFrom),new Date(focusLoadTo),true)}else{this.setBrushVisibility(false);var selectedBounds=this.contextXScale.domain();this.selectedBounds={min:(0,_moment.default)(new Date(selectedBounds[0])),max:(0,_moment.default)(selectedBounds[1])};contextChartSelected({from:selectedBounds[0],to:selectedBounds[1]})}}},{key:"createFocusChart",value:function createFocusChart(fcsGroup,fcsWidth,fcsHeight){var _this$props4=this.props,annotationsEnabled=_this$props4.annotationsEnabled,contextForecastData=_this$props4.contextForecastData;var zoomGroup=fcsGroup.append("g").attr("class","focus-zoom");zoomGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",focusZoomPanelHeight).attr("class","chart-border");this.createZoomInfoElements(zoomGroup,fcsWidth);if(annotationsEnabled){var annotateBrush=this.annotateBrush.bind(this);fcsGroup.append("g").attr("class","mlAnnotationBrush").call(annotateBrush).selectAll("rect").attr("x",0).attr("y",focusZoomPanelHeight).attr("height",focusChartHeight);fcsGroup.append("g").classed("mlAnnotations",true)}fcsGroup.append("rect").attr("x",0).attr("y",focusZoomPanelHeight).attr("width",fcsWidth).attr("height",focusChartHeight).attr("class","chart-border");var xAxisBg=fcsGroup.append("g").attr("class","x-axis-background");xAxisBg.append("rect").attr("x",0).attr("y",fcsHeight).attr("width",fcsWidth).attr("height",chartSpacing);xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight).attr("x2",0).attr("y2",fcsHeight+chartSpacing);xAxisBg.append("line").attr("x1",fcsWidth).attr("y1",fcsHeight).attr("x2",fcsWidth).attr("y2",fcsHeight+chartSpacing);xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight+chartSpacing).attr("x2",fcsWidth).attr("y2",fcsHeight+chartSpacing);var axes=fcsGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+fcsHeight+")");axes.append("g").attr("class","y axis");fcsGroup.append("path").attr("class","area bounds");fcsGroup.append("path").attr("class","values-line");fcsGroup.append("g").attr("class","focus-chart-markers");if(contextForecastData){fcsGroup.append("path").attr("class","area forecast");fcsGroup.append("path").attr("class","values-line forecast");fcsGroup.append("g").attr("class","focus-chart-markers forecast")}fcsGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",fcsHeight+24).attr("class","chart-border chart-border-highlight")}},{key:"renderFocusChart",value:function renderFocusChart(){var _this2=this;var _this$props5=this.props,annotationsEnabled=_this$props5.annotationsEnabled,focusAggregationInterval=_this$props5.focusAggregationInterval,focusAnnotationData=_this$props5.focusAnnotationData,focusChartData=_this$props5.focusChartData,focusForecastData=_this$props5.focusForecastData,modelPlotEnabled=_this$props5.modelPlotEnabled,selectedJob=_this$props5.selectedJob,showAnnotations=_this$props5.showAnnotations,showForecast=_this$props5.showForecast,showModelBounds=_this$props5.showModelBounds,intl=_this$props5.intl;if(focusChartData===undefined){return}var data=focusChartData;var contextYScale=this.contextYScale;var showFocusChartTooltip=this.showFocusChartTooltip.bind(this);var focusChart=_d.default.select(".focus-chart");var focusAggInt=focusAggregationInterval.expression;var bucketSpan=selectedJob.analysis_config.bucket_span;var chartElement=_d.default.select(this.rootNode);chartElement.select(".zoom-aggregation-interval").text(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})"},{focusAggInt:focusAggInt,bucketSpan:bucketSpan}));var bounds=this.selectedBounds;if(typeof bounds==="undefined"){return}var aggMs=focusAggregationInterval.asMilliseconds();var earliest=(0,_moment.default)(Math.floor(bounds.min.valueOf()/aggMs)*aggMs);var latest=(0,_moment.default)(Math.ceil(bounds.max.valueOf()/aggMs)*aggMs);this.focusXScale.domain([earliest.toDate(),latest.toDate()]);if(focusChartData.length>0||focusForecastData!==undefined&&focusForecastData.length>0){if(this.fieldFormat!==undefined){this.focusYAxis.tickFormat(function(d){return _this2.fieldFormat.convert(d,"text")})}else{this.focusYAxis.tickFormat(null)}var yMin=0;var yMax=0;var combinedData=data;if(focusForecastData!==undefined&&focusForecastData.length>0){combinedData=data.concat(focusForecastData)}yMin=_d.default.min(combinedData,function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}return d.lower!==undefined?Math.min(metricValue,d.lower):metricValue});yMax=_d.default.max(combinedData,function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}return d.upper!==undefined?Math.max(metricValue,d.upper):metricValue});if(yMax===yMin){if(this.contextYScale.domain()[0]!==contextYScale.domain()[1]&&yMin>=contextYScale.domain()[0]&&yMax<=contextYScale.domain()[1]){yMin=contextYScale.domain()[0];yMax=contextYScale.domain()[1]}else{yMin-=yMin*.05;yMax+=yMax*.05}}if(annotationsEnabled&&focusAnnotationData&&focusAnnotationData.length>0){var levels=(0,_timeseries_chart_annotations.getAnnotationLevels)(focusAnnotationData);var maxLevel=_d.default.max(Object.keys(levels).map(function(key){return levels[key]}));yMax=yMax*(1+(maxLevel+1)/5)}this.focusYScale.domain([yMin,yMax])}else{this.focusYScale.domain([0,10]);this.focusYAxis.tickFormat("")}var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");timeBuckets.setBounds(bounds);var xAxisTickFormat=timeBuckets.getScaledDateFormat();focusChart.select(".x.axis").call(this.focusXAxis.ticks((0,_chart_utils.numTicksForDateFormat)(this.vizWidth),xAxisTickFormat).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)}));focusChart.select(".y.axis").call(this.focusYAxis);(0,_chart_utils.filterAxisLabels)(focusChart.select(".x.axis"),this.vizWidth);if(modelPlotEnabled===true){focusChart.select(".area.bounds").attr("d",this.focusBoundedArea(data)).classed("hidden",!showModelBounds)}if(annotationsEnabled){(0,_timeseries_chart_annotations.renderAnnotations)(focusChart,focusAnnotationData,focusZoomPanelHeight,focusChartHeight,this.focusXScale,showAnnotations,showFocusChartTooltip);focusChart.select(".mlAnnotationBrush").style("display",showAnnotations?null:"none")}focusChart.select(".values-line").attr("d",this.focusValuesLine(data));(0,_chart_utils.drawLineChartDots)(data,focusChart,this.focusValuesLine);var dots=_d.default.select(".focus-chart-markers").selectAll(".metric-value").data(data.filter(function(d){return(d.value!==null||typeof d.anomalyScore==="number")&&!(0,_chart_utils.showMultiBucketAnomalyMarker)(d)}));dots.exit().remove();dots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",function(d){showFocusChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});dots.attr("cx",function(d){return _this2.focusXScale(d.date)}).attr("cy",function(d){return _this2.focusYScale(d.value)}).attr("class",function(d){var markerClass="metric-value";if(_lodash.default.has(d,"anomalyScore")){markerClass+=" anomaly-marker ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}return markerClass});var multiBucketMarkers=_d.default.select(".focus-chart-markers").selectAll(".multi-bucket").data(data.filter(function(d){return d.anomalyScore!==null&&(0,_chart_utils.showMultiBucketAnomalyMarker)(d)===true}));multiBucketMarkers.exit().remove();multiBucketMarkers.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).on("mouseover",function(d){showFocusChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});multiBucketMarkers.attr("transform",function(d){return"translate(".concat(_this2.focusXScale(d.date),", ").concat(_this2.focusYScale(d.value),")")}).attr("class",function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)});var scheduledEventMarkers=_d.default.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(data.filter(function(d){return d.scheduledEvents!==undefined}));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",_chart_utils.LINE_CHART_ANOMALY_RADIUS*2).attr("height",_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",function(d){return _this2.focusXScale(d.date)-_chart_utils.LINE_CHART_ANOMALY_RADIUS}).attr("y",function(d){return _this2.focusYScale(d.value)-3});if(focusForecastData!==undefined){focusChart.select(".area.forecast").attr("d",this.focusBoundedArea(focusForecastData)).classed("hidden",!showForecast);focusChart.select(".values-line.forecast").attr("d",this.focusValuesLine(focusForecastData)).classed("hidden",!showForecast);var forecastDots=_d.default.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(focusForecastData);forecastDots.exit().remove();forecastDots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",function(d){showFocusChartTooltip(d,this)}).on("mouseout",function(){return _chart_tooltip_service.mlChartTooltipService.hide()});forecastDots.attr("cx",function(d){return _this2.focusXScale(d.date)}).attr("cy",function(d){return _this2.focusYScale(d.value)}).attr("class","metric-value").classed("hidden",!showForecast)}}},{key:"createZoomInfoElements",value:function createZoomInfoElements(zoomGroup,fcsWidth){var _this$props6=this.props,autoZoomDuration=_this$props6.autoZoomDuration,modelPlotEnabled=_this$props6.modelPlotEnabled,timefilter=_this$props6.timefilter,intl=_this$props6.intl;var setZoomInterval=this.setZoomInterval.bind(this);var bounds=timefilter.getActiveBounds();var boundsSecs=bounds.max.unix()-bounds.min.unix();var minSecs=10/this.vizWidth*boundsSecs;var xPos=10;var zoomLabel=zoomGroup.append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",defaultMessage:"Zoom:"}));var zoomOptions=[{durationMs:autoZoomDuration,label:"auto"}];_lodash.default.each(ZOOM_INTERVAL_OPTIONS,function(option){if(option.duration.asSeconds()>minSecs&&option.duration.asSeconds()<boundsSecs){zoomOptions.push({durationMs:option.duration.asMilliseconds(),label:option.label})}});xPos+=zoomLabel.node().getBBox().width+4;_lodash.default.each(zoomOptions,function(option){var text=zoomGroup.append("a").attr("data-ms",option.durationMs).attr("href","").append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(option.label);xPos+=text.node().getBBox().width+4});zoomGroup.append("text").attr("x",xPos+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",defaultMessage:"(aggregation interval: , bucket span: )"}));if(modelPlotEnabled===false){var modelPlotLabel=zoomGroup.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",defaultMessage:"Model bounds are not available"}));modelPlotLabel.attr("x",fcsWidth-(modelPlotLabel.node().getBBox().width+10))}var chartElement=_d.default.select(this.rootNode);chartElement.selectAll(".focus-zoom a").on("click",function(){_d.default.event.preventDefault();setZoomInterval(_d.default.select(this).attr("data-ms"))})}},{key:"drawContextElements",value:function drawContextElements(cxtGroup,cxtWidth,cxtChartHeight,swlHeight){var _this3=this;var _this$props7=this.props,contextChartData=_this$props7.contextChartData,contextForecastData=_this$props7.contextForecastData,modelPlotEnabled=_this$props7.modelPlotEnabled,timefilter=_this$props7.timefilter;var data=contextChartData;var calculateContextXAxisDomain=this.calculateContextXAxisDomain.bind(this);var drawContextBrush=this.drawContextBrush.bind(this);var drawSwimlane=this.drawSwimlane.bind(this);this.contextXScale=_d.default.time.scale().range([0,cxtWidth]).domain(calculateContextXAxisDomain());var combinedData=contextForecastData===undefined?data:data.concat(contextForecastData);var valuesRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};_lodash.default.each(combinedData,function(item){valuesRange.min=Math.min(item.value,valuesRange.min);valuesRange.max=Math.max(item.value,valuesRange.max)});var dataMin=valuesRange.min;var dataMax=valuesRange.max;var chartLimits={min:dataMin,max:dataMax};if(modelPlotEnabled===true||contextForecastData!==undefined&&contextForecastData.length>0){var boundsRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};_lodash.default.each(combinedData,function(item){boundsRange.min=Math.min(item.lower,boundsRange.min);boundsRange.max=Math.max(item.upper,boundsRange.max)});dataMin=Math.min(dataMin,boundsRange.min);dataMax=Math.max(dataMax,boundsRange.max);if(valuesRange.max-valuesRange.min<.5*(dataMax-dataMin)){if(valuesRange.min>dataMin){chartLimits.min=valuesRange.min-.5*(valuesRange.max-valuesRange.min)}if(valuesRange.max<dataMax){chartLimits.max=valuesRange.max+.5*(valuesRange.max-valuesRange.min)}}}this.contextYScale=_d.default.scale.linear().range([cxtChartHeight,contextChartLineTopMargin]).domain([chartLimits.min,chartLimits.max]);var borders=cxtGroup.append("g").attr("class","axis");borders.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",cxtChartHeight+swlHeight);borders.append("line").attr("x1",cxtWidth).attr("y1",0).attr("x2",cxtWidth).attr("y2",cxtChartHeight+swlHeight);var bounds=timefilter.getActiveBounds();var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");timeBuckets.setBounds(bounds);var xAxisTickFormat=timeBuckets.getScaledDateFormat();var xAxis=_d.default.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-cxtChartHeight).outerTickSize(0).tickPadding(0).ticks((0,_chart_utils.numTicksForDateFormat)(cxtWidth,xAxisTickFormat)).tickFormat(function(d){return(0,_moment.default)(d).format(xAxisTickFormat)});cxtGroup.datum(data);var contextBoundsArea=_d.default.svg.area().x(function(d){return _this3.contextXScale(d.date)}).y0(function(d){return _this3.contextYScale(Math.min(chartLimits.max,Math.max(d.lower,chartLimits.min)))}).y1(function(d){return _this3.contextYScale(Math.max(chartLimits.min,Math.min(d.upper,chartLimits.max)))}).defined(function(d){return d.lower!==null&&d.upper!==null});if(modelPlotEnabled===true){cxtGroup.append("path").datum(data).attr("class","area context").attr("d",contextBoundsArea)}var contextValuesLine=_d.default.svg.line().x(function(d){return _this3.contextXScale(d.date)}).y(function(d){return _this3.contextYScale(d.value)}).defined(function(d){return d.value!==null});cxtGroup.append("path").datum(data).attr("class","values-line").attr("d",contextValuesLine);(0,_chart_utils.drawLineChartDots)(data,cxtGroup,contextValuesLine,1);if(contextForecastData!==undefined){cxtGroup.append("path").datum(contextForecastData).attr("class","area forecast").attr("d",contextBoundsArea);cxtGroup.append("path").datum(contextForecastData).attr("class","values-line forecast").attr("d",contextValuesLine)}var swimlane=cxtGroup.append("g").attr("class","swimlane").attr("transform","translate(0,"+cxtChartHeight+")");drawSwimlane(swimlane,cxtWidth,swlHeight);this.mask=new _context_chart_mask.ContextChartMask(cxtGroup,contextChartData,modelPlotEnabled,swlHeight).x(this.contextXScale).y(this.contextYScale);cxtGroup.append("g").attr("class","x axis context-chart-axis").call(xAxis);cxtGroup.selectAll(".x.context-chart-axis text").attr("dy",cxtChartHeight-5);(0,_chart_utils.filterAxisLabels)(cxtGroup.selectAll(".x.context-chart-axis"),cxtWidth);drawContextBrush(cxtGroup)}},{key:"drawContextBrush",value:function drawContextBrush(contextGroup){var contextChartSelected=this.props.contextChartSelected;var brush=this.brush;var contextXScale=this.contextXScale;var setBrushVisibility=this.setBrushVisibility.bind(this);var mask=this.mask;brush.x(contextXScale).on("brush",brushing).on("brushend",brushed);contextGroup.append("g").attr("class","x brush").call(brush).selectAll("rect").attr("y",-1).attr("height",contextChartHeight+swimlaneHeight+1);contextGroup.selectAll(".w rect").attr("x",-10).attr("width",10);contextGroup.selectAll(".e rect").attr("x",0).attr("width",10);var topBorder=contextGroup.append("rect").attr("class","top-border").attr("y",-2).attr("height",contextChartLineTopMargin);var leftHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").html('<div class="brush-handle-inner brush-handle-inner-left"><i class="fa fa-caret-left"></i></div>');var rightHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").html('<div class="brush-handle-inner brush-handle-inner-right"><i class="fa fa-caret-right"></i></div>');setBrushVisibility(!brush.empty());function showBrush(show){if(show===true){var brushExtent=brush.extent();mask.reveal(brushExtent);leftHandle.attr("x",contextXScale(brushExtent[0])-10);rightHandle.attr("x",contextXScale(brushExtent[1])+0);topBorder.attr("x",contextXScale(brushExtent[0])+1);topBorder.attr("width",contextXScale(brushExtent[1])-contextXScale(brushExtent[0])-2)}setBrushVisibility(show)}function brushing(){var isEmpty=brush.empty();showBrush(!isEmpty)}var that=this;function brushed(){var isEmpty=brush.empty();showBrush(!isEmpty);var selectedBounds=isEmpty?contextXScale.domain():brush.extent();var selectionMin=selectedBounds[0].getTime();var selectionMax=selectedBounds[1].getTime();contextGroup.selectAll(".swimlane-cell").style("fill",function(d){var cellMs=d.date.getTime();if(cellMs<selectionMin||cellMs>selectionMax){return anomalyGrayScale(d.score)}else{return anomalyColorScale(d.score)}});that.selectedBounds={min:(0,_moment.default)(selectionMin),max:(0,_moment.default)(selectionMax)};contextChartSelected({from:selectedBounds[0],to:selectedBounds[1]})}}},{key:"setBrushVisibility",value:function setBrushVisibility(show){var mask=this.mask;if(mask!==undefined){var visibility=show?"visible":"hidden";mask.style("visibility",visibility);_d.default.selectAll(".brush").style("visibility",visibility);var brushHandles=_d.default.selectAll(".brush-handle-inner");brushHandles.style("visibility",visibility);var topBorder=_d.default.selectAll(".top-border");topBorder.style("visibility",visibility);var border=_d.default.selectAll(".chart-border-highlight");border.style("visibility",visibility)}}},{key:"drawSwimlane",value:function drawSwimlane(swlGroup,swlWidth,swlHeight){var _this$props8=this.props,contextAggregationInterval=_this$props8.contextAggregationInterval,swimlaneData=_this$props8.swimlaneData;var calculateContextXAxisDomain=this.calculateContextXAxisDomain.bind(this);var data=swimlaneData;if(typeof data==="undefined"){return}var xAxisDomain=calculateContextXAxisDomain();var x=_d.default.time.scale().range([0,swlWidth]).domain(xAxisDomain);var y=_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var xAxis=_d.default.svg.axis().scale(x).orient("bottom").innerTickSize(-swlHeight).outerTickSize(0);var yAxis=_d.default.svg.axis().scale(y).orient("left").tickValues(y.domain()).innerTickSize(-swlWidth).outerTickSize(0);var axes=swlGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+swlHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);var earliest=xAxisDomain[0].getTime();var latest=xAxisDomain[1].getTime();var swimlaneAggMs=contextAggregationInterval.asMilliseconds();var cellWidth=swlWidth/((latest-earliest)/swimlaneAggMs);if(cellWidth<1){cellWidth=1}var cells=swlGroup.append("g").attr("class","swimlane-cells").selectAll("rect").data(data);cells.enter().append("rect").attr("x",function(d){return x(d.date)}).attr("y",0).attr("rx",0).attr("ry",0).attr("class",function(d){return d.score>0?"swimlane-cell":"swimlane-cell-hidden"}).attr("width",cellWidth).attr("height",swlHeight).style("fill",function(d){return anomalyColorScale(d.score)})}},{key:"calculateContextXAxisDomain",value:function calculateContextXAxisDomain(){var _this$props9=this.props,contextAggregationInterval=_this$props9.contextAggregationInterval,swimlaneData=_this$props9.swimlaneData,timefilter=_this$props9.timefilter;var bounds=timefilter.getActiveBounds();var earliest=bounds.min.valueOf();if(swimlaneData!==undefined&&swimlaneData.length>0){earliest=Math.min(_lodash.default.first(swimlaneData).date.getTime(),bounds.min.valueOf())}var contextAggMs=contextAggregationInterval.asMilliseconds();var earliestMs=Math.floor(earliest/contextAggMs)*contextAggMs;var latestMs=Math.ceil(bounds.max.valueOf()/contextAggMs)*contextAggMs;return[new Date(earliestMs),new Date(latestMs)]}},{key:"setContextBrushExtent",value:function setContextBrushExtent(from,to,fireEvent){var brush=this.brush;brush.extent([from,to]);brush(_d.default.select(".brush"));if(fireEvent){brush.event(_d.default.select(".brush"))}}},{key:"setZoomInterval",value:function setZoomInterval(ms){var _this$props10=this.props,timefilter=_this$props10.timefilter,zoomTo=_this$props10.zoomTo;var setContextBrushExtent=this.setContextBrushExtent.bind(this);var bounds=timefilter.getActiveBounds();var minBoundsMs=bounds.min.valueOf();var maxBoundsMs=bounds.max.valueOf();var millis=+ms;var to=zoomTo.getTime();var from=to-millis;if(from<minBoundsMs){from=minBoundsMs;to=Math.min(minBoundsMs+millis,maxBoundsMs)}setContextBrushExtent(new Date(from),new Date(to),true)}},{key:"showFocusChartTooltip",value:function showFocusChartTooltip(marker,circle){var _this$props11=this.props,annotationsEnabled=_this$props11.annotationsEnabled,modelPlotEnabled=_this$props11.modelPlotEnabled,intl=_this$props11.intl;var fieldFormat=this.fieldFormat;var formattedDate=(0,_date_utils.formatHumanReadableDateTimeSeconds)(marker.date);var contents=formattedDate+"<br/><hr/>";if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",defaultMessage:"anomaly score: {displayScore}{br}"},{displayScore:displayScore,br:"<br />"});if((0,_chart_utils.showMultiBucketAnomalyTooltip)(marker)===true){contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketImpactLabel",defaultMessage:"multi-bucket impact: {multiBucketImpactLabel}{br}"},{br:"<br />",multiBucketImpactLabel:(0,_anomaly_utils.getMultiBucketImpactLabel)(marker.multiBucketImpact)})}if(modelPlotEnabled===false){if(_lodash.default.has(marker,"actual")&&marker.function!=="rare"){contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",defaultMessage:"actual: {actualValue}"},{actualValue:(0,_format_value.formatValue)(marker.actual,marker.function,fieldFormat)});contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",defaultMessage:"{br}typical: {typicalValue}"},{br:"<br />",typicalValue:(0,_format_value.formatValue)(marker.typical,marker.function,fieldFormat)})}else{contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",defaultMessage:"value: {value}"},{value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat)});if(_lodash.default.has(marker,"byFieldName")&&_lodash.default.has(marker,"numberOfCauses")){var numberOfCauses=marker.numberOfCauses;var byFieldName=(0,_string_utils.mlEscape)(marker.byFieldName);contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",defaultMessage:"{br} {numberOfCauses}{plusSign} unusual {byFieldName} values"},{br:"<br />",numberOfCauses:numberOfCauses,byFieldName:byFieldName,plusSign:numberOfCauses<10?"":"+"})}}}else{contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.valueLabel",defaultMessage:"value: {value}"},{value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat)});contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",defaultMessage:"{br}upper bounds: {upperBoundsValue}"},{br:"<br />",upperBoundsValue:(0,_format_value.formatValue)(marker.upper,marker.function,fieldFormat)});contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",defaultMessage:"{br}lower bounds: {lowerBoundsValue}"},{br:"<br />",lowerBoundsValue:(0,_format_value.formatValue)(marker.lower,marker.function,fieldFormat)})}}else{if(_lodash.default.get(marker,"isForecast",false)===true){contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",defaultMessage:"prediction: {predictionValue}"},{predictionValue:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat)})}else{contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",defaultMessage:"value: {value}"},{value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat)})}if(modelPlotEnabled===true){contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",defaultMessage:"{br}upper bounds: {upperBoundsValue}"},{br:"<br />",upperBoundsValue:(0,_format_value.formatValue)(marker.upper,marker.function,fieldFormat)});contents+=intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",defaultMessage:"{br}lower bounds: {lowerBoundsValue}"},{br:"<br />",lowerBoundsValue:(0,_format_value.formatValue)(marker.lower,marker.function,fieldFormat)})}}if(_lodash.default.has(marker,"scheduledEvents")){contents+="<br/><hr/>"+intl.formatMessage({id:"xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",defaultMessage:"Scheduled events:{br}{scheduledEventsValue}"},{br:"<br />",scheduledEventsValue:marker.scheduledEvents.map(_string_utils.mlEscape).join("<br/>")})}if(annotationsEnabled&&_lodash.default.has(marker,"annotation")){contents=(0,_string_utils.mlEscape)(marker.annotation);contents+="<br />".concat((0,_moment.default)(marker.timestamp).format("MMMM Do YYYY, HH:mm"));if(typeof marker.end_timestamp!=="undefined"){contents+=" - ".concat((0,_moment.default)(marker.end_timestamp).format("MMMM Do YYYY, HH:mm"))}}_chart_tooltip_service.mlChartTooltipService.show(contents,circle,{x:_chart_utils.LINE_CHART_ANOMALY_RADIUS*2,y:0})}},{key:"highlightFocusChartAnomaly",value:function highlightFocusChartAnomaly(record){var _this$props12=this.props,focusChartData=_this$props12.focusChartData,focusAggregationInterval=_this$props12.focusAggregationInterval;var focusXScale=this.focusXScale;var focusYScale=this.focusYScale;var showFocusChartTooltip=this.showFocusChartTooltip.bind(this);var anomalyTime=record.source.timestamp;var markerToSelect=(0,_timeseriesexplorer_utils.findChartPointForAnomalyTime)(focusChartData,anomalyTime,focusAggregationInterval);if(markerToSelect!==undefined){var selectedMarker=_d.default.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([markerToSelect]);if((0,_chart_utils.showMultiBucketAnomalyMarker)(markerToSelect)===true){selectedMarker.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).attr("transform",function(d){return"translate(".concat(focusXScale(d.date),", ").concat(focusYScale(d.value),")")}).attr("class",function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id," highlighted")})}else{selectedMarker.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).attr("cx",function(d){return focusXScale(d.date)}).attr("cy",function(d){return focusYScale(d.value)}).attr("class",function(d){return"anomaly-marker metric-value ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id," highlighted")})}var chartElement=_d.default.select(this.rootNode);var anomalyMarker=chartElement.selectAll(".focus-chart-markers .anomaly-marker.highlighted");if(anomalyMarker.length){showFocusChartTooltip(markerToSelect,anomalyMarker[0][0])}}}},{key:"unhighlightFocusChartAnomaly",value:function unhighlightFocusChartAnomaly(){_d.default.select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove();_chart_tooltip_service.mlChartTooltipService.hide()}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){return _react.default.createElement("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)})}}]);return TimeseriesChart}(_react.default.Component),_defineProperty(_class,"propTypes",{annotationsEnabled:_propTypes.default.bool,annotation:_propTypes.default.object,autoZoomDuration:_propTypes.default.number,contextAggregationInterval:_propTypes.default.object,contextChartData:_propTypes.default.array,contextForecastData:_propTypes.default.array,contextChartSelected:_propTypes.default.func.isRequired,detectorIndex:_propTypes.default.string,focusAggregationInterval:_propTypes.default.object,focusAnnotationData:_propTypes.default.array,focusChartData:_propTypes.default.array,focusForecastData:_propTypes.default.array,modelPlotEnabled:_propTypes.default.bool.isRequired,renderFocusChartOnly:_propTypes.default.bool.isRequired,selectedJob:_propTypes.default.object,showForecast:_propTypes.default.bool.isRequired,showModelBounds:_propTypes.default.bool.isRequired,svgWidth:_propTypes.default.number.isRequired,swimlaneData:_propTypes.default.array,timefilter:_propTypes.default.object.isRequired,zoomFrom:_propTypes.default.object,zoomTo:_propTypes.default.object}),_temp));var TimeseriesChart=(0,_observable_utils.injectObservablesAsProps)({annotation:_annotations_service.annotation$},TimeseriesChartIntl);exports.TimeseriesChart=TimeseriesChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _context_chart_mask=__webpack_require__(3116);Object.keys(_context_chart_mask).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _context_chart_mask[key]}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ContextChartMask=ContextChartMask;var _d=_interopRequireDefault(__webpack_require__(27));var _chart_utils=__webpack_require__(280);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ContextChartMask(contextGroup,data,drawBounds,swimlaneHeight){this.contextGroup=contextGroup;this.data=data;this.drawBounds=drawBounds;this.swimlaneHeight=swimlaneHeight;this.mask=this.contextGroup.append("g").attr("class","mask");this.leftGroup=this.mask.append("g").attr("class","left-mask");this.rightGroup=this.mask.append("g").attr("class","right-mask");this.leftPolygon=this.leftGroup.append("polygon");this.rightPolygon=this.rightGroup.append("polygon");if(this.drawBounds===true){this.leftGroup.append("path").attr("class","left area bounds");this.rightGroup.append("path").attr("class","right area bounds")}this.leftGroup.append("path").attr("class","left values-line");this.rightGroup.append("path").attr("class","right values-line");this._x=null;this._y=null}ContextChartMask.prototype.style=function(prop,val){this.leftGroup.style(prop,val);this.rightGroup.style(prop,val);return this};ContextChartMask.prototype.x=function(f){if(f==null){return this._x}this._x=f;return this};ContextChartMask.prototype.y=function(f){if(f==null){return this._y}this._y=f;return this};ContextChartMask.prototype.redraw=function(){var yDomain=this._y.domain();var minY=yDomain[0];var maxY=yDomain[1];var xDomain=this._x.domain();var minX=xDomain[0];var maxX=xDomain[1];var that=this;var leftData=this.data.filter(function(d){return d.date<that.from});var rightData=this.data.filter(function(d){return d.date>that.to});if(this.drawBounds===true){var boundedArea=_d.default.svg.area().x(function(d){return that._x(d.date)||1}).y0(function(d){return that._y(Math.min(maxY,Math.max(d.lower,minY)))}).y1(function(d){return that._y(Math.max(minY,Math.min(d.upper,maxY)))}).defined(function(d){return d.lower!==null&&d.upper!==null});this.leftGroup.select(".left.area.bounds").attr("d",boundedArea(leftData));this.rightGroup.select(".right.area.bounds").attr("d",boundedArea(rightData))}var valuesLine=_d.default.svg.line().x(function(d){return that._x(d.date)}).y(function(d){return that._y(d.value)}).defined(function(d){return d.value!==null});this.leftGroup.select(".left.values-line").attr("d",valuesLine(leftData));(0,_chart_utils.drawLineChartDots)(leftData,this.leftGroup,valuesLine,1);this.rightGroup.select(".right.values-line").attr("d",valuesLine(rightData));(0,_chart_utils.drawLineChartDots)(rightData,this.rightGroup,valuesLine,1);var leftPoly={l:this._x(minX),t:this._y(minY)+this.swimlaneHeight,r:this._x(this.from),b:0};var rightPoly={l:this._x(this.to),t:this._y(minY)+this.swimlaneHeight,r:this._x(maxX),b:0};this.leftPolygon.attr("points",""+leftPoly.l+","+leftPoly.t+"  "+leftPoly.r+","+leftPoly.t+"  "+leftPoly.r+","+leftPoly.b+"  "+leftPoly.l+","+leftPoly.b);this.rightPolygon.attr("points",""+rightPoly.l+","+rightPoly.t+"  "+rightPoly.r+","+rightPoly.t+"  "+rightPoly.r+","+rightPoly.b+"  "+rightPoly.l+","+rightPoly.b);return this};ContextChartMask.prototype.reveal=function(extent){this.from=extent[0];this.to=extent[1];this.redraw();return this}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(2);var d3_1=tslib_1.__importDefault(__webpack_require__(27));var moment_1=tslib_1.__importDefault(__webpack_require__(16));var annotations_1=__webpack_require__(1354);var chart_tooltip_service_1=__webpack_require__(362);var annotations_service_1=__webpack_require__(496);exports.ANNOTATION_MASK_ID="mlAnnotationMask";function getAnnotationBrush(){var focusXScale=this.focusXScale;var annotateBrush=d3_1.default.svg.brush().x(focusXScale).on("brushend",brushend.bind(this));function brushend(){var selectedJob=this.props.selectedJob;var extent=annotateBrush.extent();var timestamp=extent[0].getTime();var endTimestamp=extent[1].getTime();if(timestamp===endTimestamp){annotations_service_1.annotation$.next(null);return}var annotation={timestamp:timestamp,end_timestamp:endTimestamp,annotation:"",job_id:selectedJob.job_id,type:annotations_1.ANNOTATION_TYPE.ANNOTATION};annotations_service_1.annotation$.next(annotation)}return annotateBrush}exports.getAnnotationBrush=getAnnotationBrush;function getAnnotationLevels(focusAnnotationData){var levels={};focusAnnotationData.forEach(function(d,i){if(d.key!==undefined){var longerAnnotations=focusAnnotationData.filter(function(d2,i2){return i2<i});levels[d.key]=longerAnnotations.reduce(function(level,d2){if(d.end_timestamp===undefined||d2.end_timestamp===undefined||d2.key===undefined){return level}if(d2.timestamp<d.timestamp&&d2.end_timestamp<d.timestamp||d2.timestamp>d.end_timestamp&&d2.end_timestamp>d.end_timestamp){return level}return levels[d2.key]+1},0)}});return levels}exports.getAnnotationLevels=getAnnotationLevels;var ANNOTATION_DEFAULT_LEVEL=1;var ANNOTATION_LEVEL_HEIGHT=28;var ANNOTATION_UPPER_RECT_MARGIN=0;var ANNOTATION_UPPER_TEXT_MARGIN=-7;var ANNOTATION_MIN_WIDTH=2;var ANNOTATION_RECT_BORDER_RADIUS=2;var ANNOTATION_TEXT_VERTICAL_OFFSET=26;var ANNOTATION_TEXT_RECT_VERTICAL_OFFSET=12;var ANNOTATION_TEXT_RECT_WIDTH=24;var ANNOTATION_TEXT_RECT_HEIGHT=20;function renderAnnotations(focusChart,focusAnnotationData,focusZoomPanelHeight,focusChartHeight,focusXScale,showAnnotations,showFocusChartTooltip){var upperRectMargin=ANNOTATION_UPPER_RECT_MARGIN;var upperTextMargin=ANNOTATION_UPPER_TEXT_MARGIN;var durations={};focusAnnotationData.forEach(function(d){if(d.key!==undefined){var duration=(d.end_timestamp||0)-d.timestamp;durations[d.key]=duration}});focusAnnotationData.sort(function(a,b){if(a.key===undefined||b.key===undefined){return 0}return durations[b.key]-durations[a.key]});var levelHeight=ANNOTATION_LEVEL_HEIGHT;var levels=getAnnotationLevels(focusAnnotationData);var annotations=focusChart.select(".mlAnnotations").selectAll("g.mlAnnotation").data(focusAnnotationData||[],function(d){return d._id||""});annotations.enter().append("g").classed("mlAnnotation",true);var rects=annotations.selectAll(".mlAnnotationRect").data(function(d){return[d]});rects.enter().append("rect").attr("rx",ANNOTATION_RECT_BORDER_RADIUS).attr("ry",ANNOTATION_RECT_BORDER_RADIUS).classed("mlAnnotationRect",true).attr("mask","url(#".concat(exports.ANNOTATION_MASK_ID,")")).on("mouseover",function(d){showFocusChartTooltip(d,this)}).on("mouseout",function(){return chart_tooltip_service_1.mlChartTooltipService.hide()}).on("click",function(d){annotations_service_1.annotation$.next(null);annotations_service_1.annotation$.next(d)});rects.attr("x",function(d){var date=moment_1.default(d.timestamp);return focusXScale(date)}).attr("y",function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+1+upperRectMargin+level*levelHeight}).attr("height",function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusChartHeight-2-upperRectMargin-level*levelHeight}).attr("width",function(d){var s=focusXScale(moment_1.default(d.timestamp))+1;var e=typeof d.end_timestamp!=="undefined"?focusXScale(moment_1.default(d.end_timestamp))-1:s+ANNOTATION_MIN_WIDTH;var width=Math.max(ANNOTATION_MIN_WIDTH,e-s);return width});rects.exit().remove();var textRects=annotations.selectAll(".mlAnnotationTextRect").data(function(d){return[d]});var texts=annotations.selectAll(".mlAnnotationText").data(function(d){return[d]});textRects.enter().append("rect").classed("mlAnnotationTextRect",true).attr("width",ANNOTATION_TEXT_RECT_WIDTH).attr("height",ANNOTATION_TEXT_RECT_HEIGHT).attr("rx",ANNOTATION_RECT_BORDER_RADIUS).attr("ry",ANNOTATION_RECT_BORDER_RADIUS);texts.enter().append("text").classed("mlAnnotationText",true);function labelXOffset(ts){var earliestMs=focusXScale.domain()[0];var latestMs=focusXScale.domain()[1];var date=moment_1.default(ts);var minX=Math.max(focusXScale(earliestMs),focusXScale(date));var maxOffset=32;return Math.min(focusXScale(latestMs)-maxOffset,minX)}texts.attr("x",function(d){var leftInnerOffset=17;return labelXOffset(d.timestamp)+leftInnerOffset}).attr("y",function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+upperTextMargin+ANNOTATION_TEXT_VERTICAL_OFFSET+level*levelHeight}).text(function(d){return d.key});textRects.attr("x",function(d){var leftInnerOffset=5;return labelXOffset(d.timestamp)+leftInnerOffset}).attr("y",function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+upperTextMargin+ANNOTATION_TEXT_RECT_VERTICAL_OFFSET+level*levelHeight});textRects.exit().remove();texts.exit().remove();annotations.classed("mlAnnotationHidden",!showAnnotations);annotations.exit().remove()}exports.renderAnnotations=renderAnnotations;function highlightFocusChartAnnotation(annotation){var annotations=d3_1.default.selectAll(".mlAnnotation");annotations.each(function(d){var element=d3_1.default.select(this);if(d._id===annotation._id){element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",true)}else{element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",true);element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",true);element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",true)}})}exports.highlightFocusChartAnnotation=highlightFocusChartAnnotation;function unhighlightFocusChartAnnotation(){var annotations=d3_1.default.selectAll(".mlAnnotation");annotations.each(function(){var element=d3_1.default.select(this);element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",false);element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",false).classed("mlAnnotationRect-isBlur",false);element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",false)})}exports.unhighlightFocusChartAnnotation=unhighlightFocusChartAnnotation},,function(module,exports,__webpack_require__){"use strict";var _lodash=_interopRequireDefault(__webpack_require__(3));var _i18n=__webpack_require__(4);var _momentTimezone=_interopRequireDefault(__webpack_require__(224));__webpack_require__(3120);__webpack_require__(676);__webpack_require__(1382);__webpack_require__(1385);var _notify=__webpack_require__(14);var _routes=_interopRequireDefault(__webpack_require__(19));var _timefilter=__webpack_require__(22);var _parse_interval=__webpack_require__(275);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _job_utils=__webpack_require__(58);var _index_utils=__webpack_require__(226);var _breadcrumbs=__webpack_require__(3121);var _timeseriesexplorer_utils=__webpack_require__(1395);var _refresh_interval_watcher=__webpack_require__(1387);var _ml_time_buckets=__webpack_require__(338);var _results_service=__webpack_require__(436);var _timeseriesexplorer=_interopRequireDefault(__webpack_require__(3122));var _check_ml_nodes=__webpack_require__(71);var _ml_api_service=__webpack_require__(24);var _job_service=__webpack_require__(36);var _field_format_service=__webpack_require__(296);var _forecast_service=__webpack_require__(884);var _timeseries_search_service=__webpack_require__(1396);var _search=__webpack_require__(882);var _annotations_service=__webpack_require__(496);var _select_interval=__webpack_require__(896);var _select_severity=__webpack_require__(401);var _job_select_service_utils=__webpack_require__(900);var _chrome=_interopRequireDefault(__webpack_require__(9));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var mlAnnotationsEnabled=_chrome.default.getInjected("mlAnnotationsEnabled",false);_routes.default.when("/timeseriesexplorer/?",{template:_timeseriesexplorer.default,k7Breadcrumbs:_breadcrumbs.getSingleMetricViewerBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,indexPatterns:_index_utils.loadIndexPatterns,mlNodeCount:_check_ml_nodes.getMlNodeCount,jobs:_job_service.mlJobService.loadJobsWrapper}});var _module=_modules.uiModules.get("apps/ml");_module.controller("MlTimeSeriesExplorerController",function($injector,$scope,$timeout,Private,AppState,config,globalState){$injector.get("mlSelectIntervalService");$injector.get("mlSelectSeverityService");var mlJobSelectService=$injector.get("mlJobSelectService");$scope.timeFieldName="timestamp";_timefilter.timefilter.enableTimeRangeSelector();_timefilter.timefilter.enableAutoRefreshSelector();var CHARTS_POINT_TARGET=500;var MAX_SCHEDULED_EVENTS=10;var TimeBuckets=Private(_ml_time_buckets.IntervalHelperProvider);$scope.jobPickerSelections=[];$scope.selectedJob;$scope.detectors=[];$scope.loading=true;$scope.loadCounter=0;$scope.hasResults=false;$scope.dataNotChartable=false;$scope.anomalyRecords=[];$scope.modelPlotEnabled=false;$scope.showModelBounds=true;$scope.showModelBoundsCheckbox=false;$scope.showAnnotations=mlAnnotationsEnabled;$scope.showAnnotationsCheckbox=mlAnnotationsEnabled;$scope.showForecast=true;$scope.showForecastCheckbox=false;$scope.focusAnnotationData=[];var tzConfig=config.get("dateFormat:tz");var dateFormatTz=tzConfig!=="Browser"?tzConfig:_momentTimezone.default.tz.guess();$scope.permissions={canForecastJob:(0,_check_privilege.checkPermission)("canForecastJob")};$scope.initializeVis=function(){var stateDefaults={mlTimeSeriesExplorer:{}};$scope.appState=new AppState(stateDefaults);$scope.jobs=[];if(_job_service.mlJobService.jobs.length>0){$scope.jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var timeSeriesJobIds=$scope.jobs.map(function(j){return j.id});var _getSelectedJobIds=(0,_job_select_service_utils.getSelectedJobIds)(globalState),selectedJobIds=_getSelectedJobIds.jobIds;var invalidIds=_lodash.default.difference(selectedJobIds,timeSeriesJobIds);selectedJobIds=_lodash.default.without.apply(_lodash.default,[selectedJobIds].concat(_toConsumableArray(invalidIds)));if(invalidIds.length>0){var warningText=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:invalidIds.length,invalidIds:invalidIds}});if(selectedJobIds.length===0&&timeSeriesJobIds.length>0){warningText+=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})}_notify.toastNotifications.addWarning(warningText)}if(selectedJobIds.length>1){if(selectedJobIds.length>1){_notify.toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"}));(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:[selectedJobIds[0]]});mlJobSelectService.next({selection:[selectedJobIds[0]],resetSelection:true})}else{if(selectedJobIds.length>0){_notify.toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"}));(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:[selectedJobIds[0]]});mlJobSelectService.next({selection:[selectedJobIds[0]],resetSelection:true})}else if($scope.jobs.length>0){(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:[$scope.jobs[0].id]});mlJobSelectService.next({selection:[$scope.jobs[0].id],resetSelection:true})}else{$scope.loading=false}}}else if(invalidIds.length>0&&selectedJobIds.length>0){(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:[selectedJobIds[0]]});mlJobSelectService.next({selection:[selectedJobIds[0]],resetSelection:true})}else if(selectedJobIds.length>0){loadForJobId(selectedJobIds[0])}else{if(selectedJobIds.length===0&&$scope.jobs.length>0){(0,_job_select_service_utils.setGlobalState)(globalState,{selectedIds:[$scope.jobs[0].id]});mlJobSelectService.next({selection:[$scope.jobs[0].id],resetSelection:true})}else{$scope.loading=false}}}else{$scope.loading=false}$scope.$applyAsync()};$scope.refresh=function(){if($scope.selectedJob===undefined){return}$scope.loading=true;$scope.hasResults=false;$scope.dataNotChartable=false;delete $scope.chartDetails;delete $scope.contextChartData;delete $scope.focusChartData;delete $scope.contextForecastData;delete $scope.focusForecastData;$scope.loadCounter++;var awaitingCount=3;function finish(counterVar){awaitingCount--;if(awaitingCount===0&&counterVar===$scope.loadCounter){if($scope.contextChartData&&$scope.contextChartData.length||$scope.contextForecastData&&$scope.contextForecastData.length){$scope.hasResults=true}else{$scope.hasResults=false}$scope.loading=false;if($scope.contextChartData.length){var focusRange=calculateInitialFocusRange();$scope.zoomFrom=focusRange[0];$scope.zoomTo=focusRange[1]}if($scope.contextChartData&&$scope.contextChartData.length||$scope.contextForecastData&&$scope.contextForecastData.length){$timeout(function(){$scope.$broadcast("render")},0)}else{$scope.$applyAsync()}}}var bounds=_timefilter.timefilter.getActiveBounds();var detectorIndex=+$scope.detectorId;$scope.modelPlotEnabled=(0,_job_utils.isModelPlotEnabled)($scope.selectedJob,detectorIndex,$scope.entities);var nonBlankEntities=_lodash.default.filter($scope.entities,function(entity){return entity.fieldValue.length>0});$scope.criteriaFields=[{fieldName:"detector_index",fieldValue:detectorIndex}].concat(nonBlankEntities);if($scope.modelPlotEnabled===false&&(0,_job_utils.isSourceDataChartableForDetector)($scope.selectedJob,detectorIndex)===false&&nonBlankEntities.length>0){$scope.hasResults=false;$scope.loading=false;$scope.dataNotChartable=true;$scope.$applyAsync();return}$scope.contextAggregationInterval=calculateAggregationInterval(bounds,CHARTS_POINT_TARGET,CHARTS_POINT_TARGET);console.log("aggregationInterval for context data (s):",$scope.contextAggregationInterval.asSeconds());var searchBounds=(0,_ml_time_buckets.getBoundsRoundedToInterval)(bounds,$scope.contextAggregationInterval,false);var counter=$scope.loadCounter;_timeseries_search_service.mlTimeSeriesSearchService.getMetricData($scope.selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.contextAggregationInterval.expression).then(function(resp){var fullRangeChartData=(0,_timeseriesexplorer_utils.processMetricPlotResults)(resp.results,$scope.modelPlotEnabled);$scope.contextChartData=fullRangeChartData;console.log("Time series explorer context chart data set:",$scope.contextChartData);finish(counter)}).catch(function(resp){console.log("Time series explorer - error getting metric data from elasticsearch:",resp)});_results_service.mlResultsService.getRecordMaxScoreByTime($scope.selectedJob.job_id,$scope.criteriaFields,searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.contextAggregationInterval.expression).then(function(resp){var fullRangeRecordScoreData=(0,_timeseriesexplorer_utils.processRecordScoreResults)(resp.results);$scope.swimlaneData=fullRangeRecordScoreData;console.log("Time series explorer swimlane anomalies data set:",$scope.swimlaneData);finish(counter)}).catch(function(resp){console.log("Time series explorer - error getting bucket anomaly scores from elasticsearch:",resp)});_timeseries_search_service.mlTimeSeriesSearchService.getChartDetails($scope.selectedJob,detectorIndex,$scope.entities,searchBounds.min.valueOf(),searchBounds.max.valueOf()).then(function(resp){$scope.chartDetails=resp.results;finish(counter)}).catch(function(resp){console.log("Time series explorer - error getting entity counts from elasticsearch:",resp)});var forecastId=_lodash.default.get($scope,"appState.mlTimeSeriesExplorer.forecastId");if(forecastId!==undefined){awaitingCount++;var aggType=undefined;var detector=$scope.selectedJob.analysis_config.detectors[detectorIndex];var esAgg=(0,_job_utils.mlFunctionToESAggregation)(detector.function);if($scope.modelPlotEnabled===false&&(esAgg==="sum"||esAgg==="count")){aggType={avg:"sum",max:"sum",min:"sum"}}_forecast_service.mlForecastService.getForecastData($scope.selectedJob,detectorIndex,forecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.contextAggregationInterval.expression,aggType).then(function(resp){$scope.contextForecastData=(0,_timeseriesexplorer_utils.processForecastResults)(resp.results);finish(counter)}).catch(function(resp){console.log("Time series explorer - error loading data for forecast ID ".concat(forecastId),resp)})}loadEntityValues()};$scope.refreshFocusData=function(fromDate,toDate){var awaitingCount=4;var refreshFocusData={};function finish(){awaitingCount--;if(awaitingCount===0){refreshFocusData.focusChartData=(0,_timeseriesexplorer_utils.processDataForFocusAnomalies)(refreshFocusData.focusChartData,refreshFocusData.anomalyRecords,$scope.timeFieldName,$scope.focusAggregationInterval,$scope.modelPlotEnabled);refreshFocusData.focusChartData=(0,_timeseriesexplorer_utils.processScheduledEventsForChart)(refreshFocusData.focusChartData,refreshFocusData.scheduledEvents);$scope.$evalAsync(function(){$scope=Object.assign($scope,refreshFocusData);console.log("Time series explorer focus chart data set:",$scope.focusChartData);$scope.loading=false;if(mlAnnotationsEnabled===false){$scope.showAnnotationsCheckbox=false}})}}var detectorIndex=+$scope.detectorId;var nonBlankEntities=_lodash.default.filter($scope.entities,function(entity){return entity.fieldValue.length>0});var bounds={min:(0,_momentTimezone.default)(fromDate),max:(0,_momentTimezone.default)(toDate)};$scope.focusAggregationInterval=calculateAggregationInterval(bounds,CHARTS_POINT_TARGET,CHARTS_POINT_TARGET);var searchBounds=(0,_ml_time_buckets.getBoundsRoundedToInterval)(bounds,$scope.focusAggregationInterval,false);_timeseries_search_service.mlTimeSeriesSearchService.getMetricData($scope.selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.focusAggregationInterval.expression).then(function(resp){refreshFocusData.focusChartData=(0,_timeseriesexplorer_utils.processMetricPlotResults)(resp.results,$scope.modelPlotEnabled);$scope.showModelBoundsCheckbox=$scope.modelPlotEnabled===true&&refreshFocusData.focusChartData.length>0;finish()}).catch(function(resp){console.log("Time series explorer - error getting metric data from elasticsearch:",resp)});_results_service.mlResultsService.getRecordsForCriteria([$scope.selectedJob.job_id],$scope.criteriaFields,0,searchBounds.min.valueOf(),searchBounds.max.valueOf(),_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE).then(function(resp){refreshFocusData.anomalyRecords=_lodash.default.chain(resp.records).sortBy(function(record){return record[$scope.timeFieldName]}).reverse().value();console.log("Time series explorer anomalies:",refreshFocusData.anomalyRecords);finish()});_results_service.mlResultsService.getScheduledEventsByBucket([$scope.selectedJob.job_id],searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.focusAggregationInterval.expression,1,MAX_SCHEDULED_EVENTS).then(function(resp){refreshFocusData.scheduledEvents=resp.events[$scope.selectedJob.job_id];finish()}).catch(function(resp){console.log("Time series explorer - error getting scheduled events from elasticsearch:",resp)});if(mlAnnotationsEnabled){_ml_api_service.ml.annotations.getAnnotations({jobIds:[$scope.selectedJob.job_id],earliestMs:searchBounds.min.valueOf(),latestMs:searchBounds.max.valueOf(),maxAnnotations:_search.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE}).then(function(resp){refreshFocusData.focusAnnotationData=[];if(Array.isArray(resp.annotations[$scope.selectedJob.job_id])){refreshFocusData.focusAnnotationData=resp.annotations[$scope.selectedJob.job_id].sort(function(a,b){return a.timestamp-b.timestamp}).map(function(d,i){d.key=String.fromCharCode(65+i);return d})}finish()}).catch(function(){refreshFocusData.focusAnnotationData=[];mlAnnotationsEnabled=false;finish()})}else{finish()}var forecastId=_lodash.default.get($scope,"appState.mlTimeSeriesExplorer.forecastId");if(forecastId!==undefined){awaitingCount++;var aggType=undefined;var detector=$scope.selectedJob.analysis_config.detectors[detectorIndex];var esAgg=(0,_job_utils.mlFunctionToESAggregation)(detector.function);if($scope.modelPlotEnabled===false&&(esAgg==="sum"||esAgg==="count")){aggType={avg:"sum",max:"sum",min:"sum"}}_forecast_service.mlForecastService.getForecastData($scope.selectedJob,detectorIndex,forecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),$scope.focusAggregationInterval.expression,aggType).then(function(resp){refreshFocusData.focusForecastData=(0,_timeseriesexplorer_utils.processForecastResults)(resp.results);refreshFocusData.showForecastCheckbox=refreshFocusData.focusForecastData.length>0;finish()}).catch(function(resp){console.log("Time series explorer - error loading data for forecast ID ".concat(forecastId),resp)})}loadAnomaliesTableData(searchBounds.min.valueOf(),searchBounds.max.valueOf())};$scope.saveSeriesPropertiesAndRefresh=function(){$scope.appState.mlTimeSeriesExplorer.detectorIndex=+$scope.detectorId;$scope.appState.mlTimeSeriesExplorer.entities={};_lodash.default.each($scope.entities,function(entity){$scope.appState.mlTimeSeriesExplorer.entities[entity.fieldName]=entity.fieldValue});$scope.appState.save();$scope.refresh()};$scope.filter=function(field,value,operator){var entity=_lodash.default.find($scope.entities,{fieldName:field});if(entity!==undefined){if(operator==="+"&&entity.fieldValue!==value){entity.fieldValue=value;$scope.saveSeriesPropertiesAndRefresh()}else if(operator==="-"&&entity.fieldValue===value){entity.fieldValue="";$scope.saveSeriesPropertiesAndRefresh()}}};$scope.loadForForecastId=function(forecastId){_forecast_service.mlForecastService.getForecastDateRange($scope.selectedJob,forecastId).then(function(resp){var bounds=_timefilter.timefilter.getActiveBounds();var earliest=(0,_momentTimezone.default)(resp.earliest||_timefilter.timefilter.getTime().from);var latest=(0,_momentTimezone.default)(resp.latest||_timefilter.timefilter.getTime().to);$scope.appState.mlTimeSeriesExplorer.forecastId=forecastId;var earliestDataDate=_lodash.default.first($scope.contextChartData).date;var zoomLatestMs=Math.min(earliest+$scope.autoZoomDuration/2,latest.valueOf());var zoomEarliestMs=Math.max(zoomLatestMs-$scope.autoZoomDuration,earliestDataDate.getTime());var zoomState={from:(0,_momentTimezone.default)(zoomEarliestMs).toISOString(),to:(0,_momentTimezone.default)(zoomLatestMs).toISOString()};$scope.appState.mlTimeSeriesExplorer.zoom=zoomState;$scope.appState.save();$scope.showForecast=true;if(earliest.isBefore(bounds.min)||latest.isAfter(bounds.max)){var earliestMs=Math.min(earliest.valueOf(),bounds.min.valueOf());var latestMs=Math.max(latest.valueOf(),bounds.max.valueOf());_timefilter.timefilter.setTime({from:(0,_momentTimezone.default)(earliestMs).toISOString(),to:(0,_momentTimezone.default)(latestMs).toISOString()})}else{$scope.refresh()}}).catch(function(resp){console.log("Time series explorer - error loading time range of forecast from elasticsearch:",resp)})};$scope.detectorIndexChanged=function(){updateControlsForDetector();loadEntityValues()};$scope.toggleShowModelBounds=function(){$timeout(function(){$scope.showModelBounds=!$scope.showModelBounds},0)};if(mlAnnotationsEnabled){$scope.toggleShowAnnotations=function(){$timeout(function(){$scope.showAnnotations=!$scope.showAnnotations},0)}}$scope.toggleShowForecast=function(){$timeout(function(){$scope.showForecast=!$scope.showForecast},0)};$scope.$listenAndDigestAsync(_timefilter.timefilter,"fetch",$scope.refresh);var refreshWatcher=Private(_refresh_interval_watcher.refreshIntervalWatcher);refreshWatcher.init(function(){$scope.refresh()});var tableControlsListener=function tableControlsListener(){if($scope.zoomFrom!==undefined&&$scope.zoomTo!==undefined){loadAnomaliesTableData($scope.zoomFrom.getTime(),$scope.zoomTo.getTime())}};var intervalSub=_select_interval.interval$.subscribe(tableControlsListener);var severitySub=_select_severity.severity$.subscribe(tableControlsListener);var annotationsRefreshSub=_annotations_service.annotationsRefresh$.subscribe($scope.refresh);var jobSelectServiceSub=mlJobSelectService.subscribe(function(_ref){var selection=_ref.selection;if(selection.length>0&&$scope.appState!==undefined){delete $scope.appState.mlTimeSeriesExplorer.detectorIndex;delete $scope.appState.mlTimeSeriesExplorer.entities;delete $scope.appState.mlTimeSeriesExplorer.forecastId;$scope.appState.save();$scope.showForecastCheckbox=false;loadForJobId(selection[0])}});$scope.$on("$destroy",function(){refreshWatcher.cancel();intervalSub.unsubscribe();severitySub.unsubscribe();annotationsRefreshSub.unsubscribe();jobSelectServiceSub.unsubscribe()});$scope.$on("contextChartSelected",function(event,selection){if(($scope.contextChartData===undefined||$scope.contextChartData.length===0)&&($scope.contextForecastData===undefined||$scope.contextForecastData.length===0)){return}var defaultRange=calculateDefaultFocusRange();if((selection.from.getTime()!==defaultRange[0].getTime()||selection.to.getTime()!==defaultRange[1].getTime())&&isNaN(Date.parse(selection.from))===false&&isNaN(Date.parse(selection.to))===false){var zoomState={from:selection.from.toISOString(),to:selection.to.toISOString()};$scope.appState.mlTimeSeriesExplorer.zoom=zoomState}else{delete $scope.appState.mlTimeSeriesExplorer.zoom}$scope.appState.save();if($scope.focusChartData===undefined||$scope.zoomFrom.getTime()!==selection.from.getTime()||$scope.zoomTo.getTime()!==selection.to.getTime()){$scope.refreshFocusData(selection.from,selection.to)}$scope.zoomFrom=selection.from;$scope.zoomTo=selection.to});function loadForJobId(jobId){var jobPickerSelectedJob=_lodash.default.find($scope.jobs,{id:jobId});if(jobPickerSelectedJob===undefined){var newJobs=[];_lodash.default.each(_job_service.mlJobService.jobs,function(job){if((0,_job_utils.isTimeSeriesViewJob)(job)===true){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);newJobs.push({id:job.job_id,selected:false,bucketSpanSeconds:bucketSpan.asSeconds()})}});$scope.jobs=newJobs;jobPickerSelectedJob=_lodash.default.find(newJobs,{id:jobId})}$scope.selectedJob=_job_service.mlJobService.getJob(jobId);$scope.jobPickerSelections=[jobPickerSelectedJob];var jobDetectors=$scope.selectedJob.analysis_config.detectors;var viewableDetectors=[];_lodash.default.each(jobDetectors,function(dtr,index){if((0,_job_utils.isTimeSeriesViewDetector)($scope.selectedJob,index)){viewableDetectors.push({index:""+index,detector_description:dtr.detector_description})}});$scope.detectors=viewableDetectors;var appStateDtrIdx=$scope.appState.mlTimeSeriesExplorer.detectorIndex;var detectorIndex=appStateDtrIdx!==undefined?appStateDtrIdx:+viewableDetectors[0].index;if(_lodash.default.find(viewableDetectors,{index:""+detectorIndex})===undefined){var warningText=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.requestedDetectorIndexNotValidWarningMessage",{defaultMessage:"Requested detector index {detectorIndex} is not valid for job {jobId}",values:{detectorIndex:detectorIndex,jobId:$scope.selectedJob.job_id}});_notify.toastNotifications.addWarning(warningText);detectorIndex=+viewableDetectors[0].index;$scope.appState.mlTimeSeriesExplorer.detectorIndex=detectorIndex;$scope.appState.save()}$scope.detectorId=""+detectorIndex;updateControlsForDetector();_field_format_service.mlFieldFormatService.populateFormats([jobId],(0,_index_utils.getIndexPatterns)()).catch(function(err){console.log("Error populating field formats:",err)}).then(function(){$scope.refresh()})}function loadAnomaliesTableData(earliestMs,latestMs){_ml_api_service.ml.results.getAnomaliesTableData([$scope.selectedJob.job_id],$scope.criteriaFields,[],_select_interval.interval$.getValue().val,_select_severity.severity$.getValue().val,earliestMs,latestMs,dateFormatTz,_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE).then(function(resp){var anomalies=resp.anomalies;var detectorsByJob=_job_service.mlJobService.detectorsByJob;anomalies.forEach(function(anomaly){var jobId=anomaly.jobId;var detector=_lodash.default.get(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=_lodash.default.get(detector,["detector_description"],anomaly.source.function_description);var customRules=detector.custom_rules;if(customRules!==undefined){anomaly.rulesLength=customRules.length}if(_lodash.default.has(_job_service.mlJobService.customUrlsByJob,jobId)){anomaly.customUrls=_job_service.mlJobService.customUrlsByJob[jobId]}});$scope.$evalAsync(function(){$scope.tableData={anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:false}})}).catch(function(resp){console.log("Time series explorer - error loading data for anomalies table:",resp)})}function updateControlsForDetector(){var detectorIndex=+$scope.detectorId;var detector=$scope.selectedJob.analysis_config.detectors[detectorIndex];var entities=[];var entitiesState=$scope.appState.mlTimeSeriesExplorer.entities||{};var partitionFieldName=_lodash.default.get(detector,"partition_field_name");var overFieldName=_lodash.default.get(detector,"over_field_name");var byFieldName=_lodash.default.get(detector,"by_field_name");if(partitionFieldName!==undefined){var partitionFieldValue=_lodash.default.get(entitiesState,partitionFieldName,"");entities.push({fieldName:partitionFieldName,fieldValue:partitionFieldValue})}if(overFieldName!==undefined){var overFieldValue=_lodash.default.get(entitiesState,overFieldName,"");entities.push({fieldName:overFieldName,fieldValue:overFieldValue})}if(byFieldName!==undefined&&overFieldName===undefined){var byFieldValue=_lodash.default.get(entitiesState,byFieldName,"");entities.push({fieldName:byFieldName,fieldValue:byFieldValue})}$scope.entities=entities}function loadEntityValues(){var bounds=_timefilter.timefilter.getActiveBounds();var detectorIndex=+$scope.detectorId;_results_service.mlResultsService.getRecordsForCriteria([$scope.selectedJob.job_id],[{fieldName:"detector_index",fieldValue:detectorIndex}],0,bounds.min.valueOf(),bounds.max.valueOf(),_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE).then(function(resp){if(resp.records&&resp.records.length>0){var firstRec=resp.records[0];_lodash.default.each($scope.entities,function(entity){if(firstRec.partition_field_name===entity.fieldName){entity.fieldValues=_lodash.default.chain(resp.records).pluck("partition_field_value").uniq().value()}if(firstRec.over_field_name===entity.fieldName){entity.fieldValues=_lodash.default.chain(resp.records).pluck("over_field_value").uniq().value()}if(firstRec.by_field_name===entity.fieldName){entity.fieldValues=_lodash.default.chain(resp.records).pluck("by_field_value").uniq().value()}});$scope.$applyAsync()}})}function calculateInitialFocusRange(){var zoomState=$scope.appState.mlTimeSeriesExplorer.zoom;if(zoomState!==undefined){$scope.autoZoomDuration=getAutoZoomDuration();var zoomFrom=(0,_momentTimezone.default)(zoomState.from,"YYYY-MM-DDTHH:mm:ss.SSSZ",true);var zoomTo=(0,_momentTimezone.default)(zoomState.to,"YYYY-MM-DDTHH:mm:ss.SSSZ",true);var aggIntervalMs=$scope.contextAggregationInterval.asMilliseconds();var bounds=_timefilter.timefilter.getActiveBounds();var earliest=bounds.min;var latest=(0,_momentTimezone.default)(bounds.max).add(aggIntervalMs,"ms");if(zoomFrom.isValid()&&zoomTo.isValid&&zoomTo.isAfter(zoomFrom)&&zoomFrom.isBetween(earliest,latest,null,"[]")&&zoomTo.isBetween(earliest,latest,null,"[]")){return[zoomFrom.toDate(),zoomTo.toDate()]}}return calculateDefaultFocusRange()}function calculateDefaultFocusRange(){$scope.autoZoomDuration=getAutoZoomDuration();var isForecastData=$scope.contextForecastData!==undefined&&$scope.contextForecastData.length>0;var combinedData=isForecastData===false?$scope.contextChartData:$scope.contextChartData.concat($scope.contextForecastData);var earliestDataDate=_lodash.default.first(combinedData).date;var latestDataDate=_lodash.default.last(combinedData).date;var rangeEarliestMs;var rangeLatestMs;if(isForecastData===true){var earliestForecastDataDate=_lodash.default.first($scope.contextForecastData).date;var latestForecastDataDate=_lodash.default.last($scope.contextForecastData).date;rangeLatestMs=Math.min(earliestForecastDataDate.getTime()+$scope.autoZoomDuration/2,latestForecastDataDate.getTime());rangeEarliestMs=Math.max(rangeLatestMs-$scope.autoZoomDuration,earliestDataDate.getTime())}else{rangeLatestMs=latestDataDate.getTime()+$scope.contextAggregationInterval.asMilliseconds();rangeEarliestMs=Math.max(earliestDataDate.getTime(),rangeLatestMs-$scope.autoZoomDuration)}return[new Date(rangeEarliestMs),new Date(rangeLatestMs)]}function calculateAggregationInterval(bounds,bucketsTarget){var barTarget=bucketsTarget!==undefined?bucketsTarget:100;var maxBars=Math.floor(1.1*barTarget);var buckets=new TimeBuckets;buckets.setInterval("auto");buckets.setBounds(bounds);buckets.setBarTarget(Math.floor(barTarget));buckets.setMaxBars(maxBars);var bucketSpanSeconds=_lodash.default.find($scope.jobs,{id:$scope.selectedJob.job_id}).bucketSpanSeconds;var aggInterval=buckets.getIntervalToNearestMultiple(bucketSpanSeconds);var secs=aggInterval.asSeconds();if(secs<bucketSpanSeconds){buckets.setInterval(bucketSpanSeconds+"s");aggInterval=buckets.getInterval()}console.log("calculateAggregationInterval() barTarget,maxBars,returning:",bucketsTarget,maxBars,bounds.max.diff(bounds.min)/aggInterval.asMilliseconds());return aggInterval}function getAutoZoomDuration(){var bucketSpanSeconds=_lodash.default.find($scope.jobs,{id:$scope.selectedJob.job_id}).bucketSpanSeconds;var autoZoomDuration=bucketSpanSeconds*1e3*(CHARTS_POINT_TARGET-1);var maxBars=Math.floor(1.1*CHARTS_POINT_TARGET);var buckets=new TimeBuckets;buckets.setInterval("auto");buckets.setBarTarget(Math.floor(CHARTS_POINT_TARGET));buckets.setMaxBars(maxBars);var nowMs=(new Date).getTime();var max=(0,_momentTimezone.default)(nowMs);var min=(0,_momentTimezone.default)(nowMs-autoZoomDuration);buckets.setBounds({min:min,max:max});var calculatedInterval=buckets.getIntervalToNearestMultiple(bucketSpanSeconds);var calculatedIntervalSecs=calculatedInterval.asSeconds();if(calculatedIntervalSecs!==bucketSpanSeconds){autoZoomDuration=autoZoomDuration*(bucketSpanSeconds/calculatedIntervalSecs)}return autoZoomDuration}$scope.initializeVis()})},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _index=__webpack_require__(883);__webpack_require__(26);var _modules=__webpack_require__(8);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlAnnotationFlyout",function(){function link(scope,element){_reactDom.default.render(_react.default.createElement(_react2.I18nProvider,null,_react.default.createElement(_index.AnnotationFlyout)),element[0]);element.on("$destroy",function(){_reactDom.default.unmountComponentAtNode(element[0]);scope.$destroy()})}return{scope:false,link:link}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSingleMetricViewerBreadcrumbs=getSingleMetricViewerBreadcrumbs;var _breadcrumbs=__webpack_require__(432);function getSingleMetricViewerBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}},function(module,exports){module.exports='<ml-nav-menu name="timeseriesexplorer"></ml-nav-menu>\n<ml-chart-tooltip></ml-chart-tooltip>\n<div class="ml-time-series-explorer" ng-controller="MlTimeSeriesExplorerController">\n\n  <ml-job-selector-react-wrapper timeseriesonly="true" singleselection="true" />\n\n  <div class="no-results-container" ng-if="jobs.length === 0 && loading === false">\n    <div class="no-results">\n      <div\n        i18n-id="xpack.ml.timeSeriesExplorer.noSingleMetricJobsFoundLabel"\n        i18n-default-message="{icon} No single metric jobs found"\n        i18n-values="{ html_icon: \'<i class=\\\'fa fa-exclamation-triangle\\\'></i>\' }">\n      </div>\n      <div>\n        <a\n          href="ml#/jobs"\n          i18n-id="xpack.ml.timeSeriesExplorer.createNewSingleMetricJobLinkText"\n          i18n-default-message="Create new single metric job"\n        ></a></div>\n    </div>\n  </div>\n\n  <div class="series-controls" ng-show="jobs.length > 0">\n    <label\n      for="selectDetector"\n      class="kuiLabel"\n      i18n-id="xpack.ml.timeSeriesExplorer.detectorLabel"\n      i18n-default-message="Detector:"\n    ></label>\n    <select id="selectDetector" class="kuiSelect kuiSelect--large" ng-model="detectorId" ng-change="detectorIndexChanged()">\n      <option ng-repeat="detector in detectors track by detector.index" value="{{detector.index}}">{{detector.detector_description}}</option>\n    </select>\n\n    <div class="entity-controls" ng-repeat="entity in entities">\n      <datalist id="{{entity.fieldName}}_datalist">\n        <option ng-repeat="value in entity.fieldValues">{{value}}</option>\n      </datalist>\n\n      <label for="select{{entity.fieldName}}" class="kuiLabel">{{entity.fieldName}}:</label>\n      <input id="select{{entity.fieldName}}" class="kuiTextInput entity-input"\n        ng-class="{ \'entity-input-blank\': entity.fieldValue.length === 0 }"\n        ng-model="entity.fieldValue" ng-model-options="{ updateOn: \'blur\' }"\n        placeholder="{{ ::\'xpack.ml.timeSeriesExplorer.enterValuePlaceholder\' | i18n: {defaultMessage: \'Enter value\'} }}"\n        list=\'{{entity.fieldName}}_datalist\' />\n    </div>\n\n    <button\n      class="kuiButton kuiButton--primary"\n      ng-click="saveSeriesPropertiesAndRefresh()"\n      aria-label="{{ ::\'xpack.ml.timeSeriesExplorer.refreshButtonAriLabel\' | i18n: {defaultMessage: \'refresh\'} }}"\n    >\n      <i class="fa fa-play" ></i>\n    </button>\n\n    <ml-forecasting-modal\n      job="selectedJob"\n      detectorIndex="+detectorId"\n      entities="entities"\n      loadForForecastId="loadForForecastId"\n      class="forecast-controls"\n    />\n\n  </div>\n\n  <ml-loading-indicator\n    label="{{ ::\'xpack.ml.timeSeriesExplorer.loadingLabel\' | i18n: {defaultMessage: \'Loading\'} }}"\n    is-loading="loading === true"\n  />\n\n  <div class="no-results-container"\n    ng-show="jobs.length > 0 && loading === false && hasResults === false && dataNotChartable === false">\n    <div class="no-results">\n      <div\n        i18n-id="xpack.ml.timeSeriesExplorer.noResultsFoundLabel"\n        i18n-default-message="{icon} No results found"\n        i18n-values="{ html_icon: \'<i class=\\\'fa fa-info-circle\\\'></i>\' }"\n      ></div>\n      <div\n        i18n-id="xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription"\n        i18n-default-message="Try widening the time selection or moving further back in time"\n      ></div>\n    </div>\n  </div>\n\n  <div class="no-results-container"\n    ng-show="jobs.length > 0 && loading === false && hasResults === false && dataNotChartable === true">\n    <div class="no-results">\n      <div\n        i18n-id="xpack.ml.timeSeriesExplorer.noResultsFoundLabel"\n        i18n-default-message="{icon} No results found"\n        i18n-values="{ html_icon: \'<i class=\\\'fa fa-info-circle\\\'></i>\' }"\n      ></div>\n      <div\n        i18n-id="xpack.ml.timeSeriesExplorer.dataNotChartableDescription"\n        i18n-default-message="Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}} and the source data cannot be plotted for this detector"\n        i18n-values="{\n          entityCount: entities.length\n        }"\n      ></div>\n    </div>\n  </div>\n\n  <div ng-show="jobs.length > 0 && loading === false && hasResults === true">\n    <div class="results-container">\n\n      <span\n        class="panel-title euiText"\n        i18n-id="xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle"\n        i18n-default-message="Single time series analysis of {functionLabel}"\n        i18n-values="{ functionLabel: chartDetails.functionLabel }"\n      ></span>\n      <span ng-if="chartDetails.entityData.count === 1" class="entity-count-text">\n        <span ng-repeat="entity in chartDetails.entityData.entities">\n          {{$first ? \'(\' : \'\'}}{{entity.fieldName}}: {{entity.fieldValue}}{{$last ? \')\' : \', \'}}\n        </span>\n      </span>\n      <span ng-if="chartDetails.entityData.count !== 1" class="entity-count-text">\n        <span\n          ng-repeat="countData in chartDetails.entityData.entities"\n          i18n-id="xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription"\n          i18n-default-message="{openBrace}{cardinality} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}"\n          i18n-values="{\n            openBrace: $first ? \'(\' : \'\',\n            closeBrace: $last ? \')\' : \', \',\n            cardinality: countData.cardinality,\n            fieldName: countData.fieldName\n          }"\n        >\n        </span>\n      </span>\n\n      <div class="show-model-controls">\n        <div ng-show="showModelBoundsCheckbox === true">\n          <input id="toggleShowModelBoundsCheckbox"\n            type="checkbox"\n            class="kuiCheckBox"\n            ng-click="toggleShowModelBounds()"\n            ng-checked="showModelBounds === true">\n          <label\n            for="toggleShowModelBoundsCheckbox"\n            class="kuiCheckBoxLabel"\n            i18n-id="xpack.ml.timeSeriesExplorer.showModelBoundsLabel"\n            i18n-default-message="show model bounds"\n          ></label>\n        </div>\n\n        <div ng-show="showAnnotationsCheckbox === true">\n          <input id="toggleAnnotationsCheckbox"\n            type="checkbox"\n            class="kuiCheckBox"\n            ng-click="toggleShowAnnotations()"\n            ng-checked="showAnnotations === true">\n          <label\n            for="toggleAnnotationsCheckbox"\n            class="kuiCheckBoxLabel"\n            i18n-id="xpack.ml.timeSeriesExplorer.annotationsLabel"\n            i18n-default-message="annotations"\n          ></label>\n        </div>\n\n        <div ng-show="showForecastCheckbox === true">\n          <input id="toggleShowForecastCheckbox"\n            type="checkbox"\n            class="kuiCheckBox"\n            ng-click="toggleShowForecast()"\n            ng-checked="showForecast === true">\n          <label\n            for="toggleShowForecastCheckbox"\n            class="kuiCheckBoxLabel"\n            i18n-id="xpack.ml.timeSeriesExplorer.showForecastLabel"\n            i18n-default-message="show forecast"\n          ></label>\n        </div>\n      </div>\n\n      <div class="ml-timeseries-chart">\n\n        <ml-timeseries-chart style="width: 1200px; height: 400px;"\n          annotations-enabled="showAnnotationsCheckbox"\n          selected-job="selectedJob"\n          detector-index="detectorId"\n          model-plot-enabled="modelPlotEnabled"\n          context-chart-data="contextChartData"\n          context-forecast-data="contextForecastData"\n          context-aggregation-interval="contextAggregationInterval"\n          swimlane-data="swimlaneData"\n          focus-annotation-data="focusAnnotationData"\n          focus-chart-data="focusChartData"\n          focus-forecast-data="focusForecastData"\n          focus-aggregation-interval="focusAggregationInterval"\n          show-annotations="showAnnotations"\n          show-model-bounds="showModelBounds"\n          show-forecast="showForecast"\n          zoom-from="zoomFrom"\n          zoom-to="zoomTo"\n          auto-zoom-duration="autoZoomDuration"\n        />\n\n      </div>\n\n      <div ng-show="showAnnotations && focusAnnotationData.length > 0">\n        <span\n          class="panel-title euiText"\n          i18n-id="xpack.ml.timeSeriesExplorer.annotationsTitle"\n          i18n-default-message="Annotations"\n        ></span>\n\n        <ml-annotation-table\n          annotations="focusAnnotationData"\n          drill-down="false"\n          number-badge="true"\n        />\n\n        <div class="euiSpacer euiSpacer--l"></div>\n      </div>\n\n      <ml-annotation-flyout />\n\n      <span\n        class="panel-title euiText"\n        i18n-id="xpack.ml.timeSeriesExplorer.anomaliesTitle"\n        i18n-default-message="Anomalies"\n      ></span>\n\n      <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--directionRow euiFlexGroup--responsive ml-anomalies-controls">\n        <div class="euiFlexItem euiFlexItem--flexGrowZero" style="width:170px">\n          <div class="euiFormRow" id="select_severity_control">\n            <label\n              class="euiFormLabel"\n              for="select_severity"\n              i18n-id="xpack.ml.timeSeriesExplorer.severityThresholdLabel"\n              i18n-default-message="Severity threshold"\n            ></label>\n            <div class="euiFormControlLayout">\n              <ml-select-severity id="select_severity" />\n            </div>\n          </div>\n        </div>\n        <div class="euiFlexItem euiFlexItem--flexGrowZero" style="width:170px">\n          <div class="euiFormRow" id="select_interval_control">\n            <label\n              class="euiFormLabel"\n              for="select_interval"\n              i18n-id="xpack.ml.timeSeriesExplorer.intervalLabel"\n              i18n-default-message="Interval"\n            ></label>\n            <div class="euiFormControlLayout">\n              <ml-select-interval id="select_interval" />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <ml-anomalies-table\n        table-data="tableData"\n        filter="filter"\n      />\n\n    </div>\n  </div>\n\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3124)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _angular=_interopRequireDefault(__webpack_require__(26));var _modules=__webpack_require__(8);var _form_label=__webpack_require__(3125);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlFormLabel",function(){return{scope:{labelId:"@"},restrict:"E",replace:false,transclude:true,link:function link(scope,element,attrs,ctrl,transclude){var props={labelId:scope.labelId,labelClassName:"kuiFormLabel",ref:function ref(c){return _angular.default.element(c.labelRef.current).append(transclude())}};_reactDom.default.render(_react.default.createElement(_form_label.FormLabel,props),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FormLabel=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _json_tooltip=__webpack_require__(893);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var FormLabel=function(_Component){_inherits(FormLabel,_Component);function FormLabel(props){var _this;_classCallCheck(this,FormLabel);_this=_possibleConstructorReturn(this,_getPrototypeOf(FormLabel).call(this,props));_this.labelRef=_react.default.createRef();return _this}_createClass(FormLabel,[{key:"render",value:function render(){var _this$props=this.props,labelId=_this$props.labelId,_this$props$labelClas=_this$props.labelClassName,labelClassName=_this$props$labelClas===void 0?"euiFormLabel":_this$props$labelClas,children=_this$props.children;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("label",{className:labelClassName,id:"ml_aria_label_".concat(labelId),ref:this.labelRef},children),_react.default.createElement(_json_tooltip.JsonTooltip,{id:labelId,position:"top"}))}}]);return FormLabel}(_react.Component);exports.FormLabel=FormLabel;FormLabel.propTypes={labelId:_propTypes.default.string}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3127)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _json_tooltip=__webpack_require__(893);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlInfoIcon",function(){return{scope:{id:"@mlInfoIcon",position:"@"},restrict:"AE",replace:false,link:function link(scope,element){var props={id:scope.id,position:scope.position};_reactDom.default.render(_react.default.createElement(_json_tooltip.JsonTooltip,props),element[0])}}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3129)},function(module,exports,__webpack_require__){"use strict";var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _tooltip_view=__webpack_require__(3130);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);_module.directive("mlTooltip",function($compile){var link=function link(scope,element){var content=element.html();element.html("");var props={position:scope.position,text:scope.text,transclude:function transclude(el){var transcludeScope=scope.$new();var compiled=$compile(content)(transcludeScope);el.append(compiled[0])}};_reactDom.default.render(_react.default.createElement(_tooltip_view.Tooltip,props),element[0])};return{restrict:"A",replace:true,scope:false,transclude:false,link:link}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tooltip=Tooltip;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Tooltip(_ref){var _ref$position=_ref.position,position=_ref$position===void 0?"top":_ref$position,text=_ref.text,transclude=_ref.transclude;return _react.default.createElement(_eui.EuiToolTip,{position:position,content:text},_react.default.createElement("span",{ref:transclude}))}Tooltip.propTypes={position:_propTypes.default.string,text:_propTypes.default.string,transclude:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3132);__webpack_require__(3134)},function(module,exports,__webpack_require__){"use strict";var _confirm_modal=_interopRequireDefault(__webpack_require__(3133));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.service("mlConfirmModalService",function($modal){this.open=function(options){return new Promise(function(resolve,reject){$modal.open({template:_confirm_modal.default,controller:"MlConfirmModal",backdrop:"static",keyboard:false,size:options.size===undefined?"sm":options.size,resolve:{params:function params(){return{message:options.message,title:options.title,okLabel:options.okLabel,cancelLabel:options.cancelLabel,hideCancel:options.hideCancel,ok:resolve,cancel:reject}}}})})}})},function(module,exports){module.exports='<div class="confirm-modal">\n  <div class="modal-title" ng-show="(title !== undefined && title !== \'\' )">{{title}}</div>\n  <div class="modal-body" bind-html-unsafe="message"></div>\n  <div class="modal-footer">\n    <button\n      ng-click="ok()"\n      ng-disabled="(saveLock === true)"\n      class="kuiButton kuiButton--primary"\n      aria-label="{{ ::\'xpack.ml.confirmModal.okButtonAriaLabel\' | i18n: {defaultMessage: \'Ok\'} }}">\n      {{okLabel}}\n    </button>\n    <button\n      ng-hide="hideCancel"\n      ng-click="cancel()"\n      ng-disabled="(saveLock === true)"\n      class="kuiButton kuiButton--primary"\n      aria-label="{{ ::\'xpack.ml.confirmModal.cancelButtonAriaLabel\' | i18n: {defaultMessage: \'Cancel\'} }}">\n      {{cancelLabel}}\n    </button>\n  </div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(8);var _i18n=__webpack_require__(4);var _module=_modules.uiModules.get("apps/ml");_module.controller("MlConfirmModal",function($scope,$modalInstance,params){$scope.okFunc=params.ok;$scope.cancelFunc=params.cancel;$scope.message=params.message||"";$scope.title=params.title||"";$scope.okLabel=params.okLabel||_i18n.i18n.translate("xpack.ml.confirmModal.okButtonLabel",{defaultMessage:"OK"});$scope.cancelLabel=params.cancelLabel||_i18n.i18n.translate("xpack.ml.confirmModal.cancelButtonLabel",{defaultMessage:"Cancel"});$scope.hideCancel=params.hideCancel||false;$scope.ok=function(){$scope.okFunc();$modalInstance.close()};$scope.cancel=function(){$scope.cancelFunc();$modalInstance.close()}})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3136)},function(module,exports,__webpack_require__){"use strict";var _nav_menu=_interopRequireDefault(__webpack_require__(3137));var _check_license=__webpack_require__(66);var _modules=__webpack_require__(8);__webpack_require__(567);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlNavMenu",function(){return{restrict:"E",transclude:true,template:_nav_menu.default,link:function link(scope,el,attrs){scope.name=attrs.name;scope.showTabs=false;if(scope.name==="jobs"||scope.name==="settings"||scope.name==="data_frame"||scope.name==="datavisualizer"||scope.name==="filedatavisualizer"||scope.name==="timeseriesexplorer"||scope.name==="access-denied"||scope.name==="explorer"){scope.showTabs=true}scope.isActiveTab=function(path){return scope.name===path};scope.disableLinks=(0,_check_license.isFullLicense)()===false}}})},function(module,exports){module.exports='<kbn-top-nav name="dashboard" config="topNavMenu">\n  <div data-transclude-slots>\n    \x3c!-- Tabs --\x3e\n    <div data-transclude-slot="bottomRow">\n      <div ng-if="showTabs" class="kuiLocalTabs" role="tablist">\n        <a kbn-href="#/jobs" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'jobs\'), \'disabled-nav-link\': disableLinks}">\n          <span\n            i18n-id="xpack.ml.navMenu.jobManagementTabLinkText"\n            i18n-default-message="Job Management"\n          ></span>\n        </a>\n        <a kbn-href="#/explorer" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'explorer\'), \'disabled-nav-link\': disableLinks}">\n          <span\n            i18n-id="xpack.ml.navMenu.anomalyExplorerTabLinkText"\n            i18n-default-message="Anomaly Explorer"\n          ></span>\n        </a>\n        <a kbn-href="#/timeseriesexplorer" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'timeseriesexplorer\'), \'disabled-nav-link\': disableLinks}">\n          <span\n            i18n-id="xpack.ml.navMenu.singleMetricViewerTabLinkText"\n            i18n-default-message="Single Metric Viewer"\n          ></span>\n        </a>\n        <a kbn-href="#/data_frames" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'data_frame\')}">\n          <span\n            i18n-id="xpack.ml.navMenu.dataFrameTabLinkText"\n            i18n-default-message="Data Frames"\n          ></span>\n        </a>\n        <a kbn-href="#/datavisualizer" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'datavisualizer\')}">\n          <span\n            i18n-id="xpack.ml.navMenu.dataVisualizerTabLinkText"\n            i18n-default-message="Data Visualizer"\n          ></span>\n        </a>\n        <a kbn-href="#/settings" class="kuiLocalTab" role="tab"\n        ng-class="{\'kuiLocalTab-isSelected\': isActiveTab(\'settings\'), \'disabled-nav-link\': disableLinks}">\n          <span\n            i18n-id="xpack.ml.navMenu.settingsTabLinkText"\n            i18n-default-message="Settings"\n          ></span>\n        </a>\n      </div>\n    </div>\n  </div>\n</kbn-top-nav>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3139)},function(module,exports,__webpack_require__){"use strict";var _loading_indicator=_interopRequireDefault(__webpack_require__(3140));var _modules=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml");_module.directive("mlLoadingIndicator",function(){return{restrict:"E",template:_loading_indicator.default,transclude:true,scope:{label:"@?",isLoading:"<",height:"<?"},link:function link(scope){scope.height=scope.height?+scope.height:100}}})},function(module,exports){module.exports='<div ng-if="isLoading" class="loading-indicator" style="height: {{height}}px">\n  <div class="loading-spinner"><i class=\'fa fa-spinner fa-spin\'></i></div>\n  <div ng-if="label!==undefined" ml-loading-indicator-label>{{label}}</div>\n</div>\n'},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3142);__webpack_require__(3144);__webpack_require__(3166)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _breadcrumbs=__webpack_require__(582);var _i18n=__webpack_require__(15);var _routes=_interopRequireDefault(__webpack_require__(19));var _timefilter=__webpack_require__(22);var _settings=__webpack_require__(3143);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="settings" />\n  <ml-settings />\n';_routes.default.when("/settings",{template:template,k7Breadcrumbs:_breadcrumbs.getSettingsBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount}});_module.directive("mlSettings",function(){var canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");var canGetCalendars=(0,_check_privilege.checkPermission)("canGetCalendars");return{restrict:"E",replace:false,scope:{},link:function link(scope,element){_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_settings.Settings,{canGetFilters:canGetFilters,canGetCalendars:canGetCalendars})),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Settings=Settings;var _react=_interopRequireDefault(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _chrome=_interopRequireDefault(__webpack_require__(9));var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Settings(_ref){var canGetFilters=_ref.canGetFilters,canGetCalendars=_ref.canGetCalendars;return _react.default.createElement(_eui.EuiPage,{className:"mlSettingsPage"},_react.default.createElement(_eui.EuiPageBody,{className:"mlSettingsPage__body"},_react.default.createElement(_eui.EuiPageContent,{className:"mlSettingsPage__content",horizontalPosition:"center"},_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.jobManagementTitle",defaultMessage:"Job Management"})))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{"data-testid":"ml_calendar_mng_button",size:"l",color:"primary",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list"),isDisabled:canGetCalendars===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendarManagementButtonLabel",defaultMessage:"Calendar management"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{"data-testid":"ml_filter_lists_button",size:"l",color:"primary",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/filter_lists"),isDisabled:canGetFilters===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterListsButtonLabel",defaultMessage:"Filter Lists"})))))))}Settings.propTypes={canGetFilters:_propTypes.PropTypes.bool.isRequired,canGetCalendars:_propTypes.PropTypes.bool.isRequired}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3145);__webpack_require__(3152)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3146)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _breadcrumbs=__webpack_require__(582);var _routes=_interopRequireDefault(__webpack_require__(19));var _i18n=__webpack_require__(15);var _calendars_list=__webpack_require__(3147);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="settings" />\n  <ml-calendars-list />\n';_routes.default.when("/settings/calendars_list",{template:template,k7Breadcrumbs:_breadcrumbs.getCalendarManagementBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount}});_module.directive("mlCalendarsList",function(){return{restrict:"E",replace:false,scope:{},link:function link(scope,element){var props={canCreateCalendar:(0,_check_privilege.checkPermission)("canCreateCalendar"),canDeleteCalendar:(0,_check_privilege.checkPermission)("canDeleteCalendar")};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_calendars_list.CalendarsList,props)),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsList=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _header=__webpack_require__(3148);var _table=__webpack_require__(3149);var _ml_api_service=__webpack_require__(24);var _notify=__webpack_require__(14);var _check_ml_nodes=__webpack_require__(71);var _delete_calendars=__webpack_require__(3151);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CalendarsList=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(CalendarsList,_Component);function CalendarsList(props){var _this;_classCallCheck(this,CalendarsList);_this=_possibleConstructorReturn(this,_getPrototypeOf(CalendarsList).call(this,props));_defineProperty(_assertThisInitialized(_this),"loadCalendars",_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var calendars;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.prev=1;_context.next=4;return _ml_api_service.ml.calendars();case 4:calendars=_context.sent;_this.setState({calendars:calendars,loading:false,isDestroyModalVisible:false});_context.next=13;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);console.log(_context.t0);_this.setState({loading:false});_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.calendarsList.errorWithLoadingListOfCalendarsErrorMessage",defaultMessage:"An error occurred loading the list of calendars."}));case 13:case"end":return _context.stop()}}},_callee,null,[[1,8]])})));_defineProperty(_assertThisInitialized(_this),"closeDestroyModal",function(){_this.setState({isDestroyModalVisible:false,calendarId:null})});_defineProperty(_assertThisInitialized(_this),"showDestroyModal",function(){_this.setState({isDestroyModalVisible:true})});_defineProperty(_assertThisInitialized(_this),"setSelectedCalendarList",function(selectedCalendars){_this.setState({selectedForDeletion:selectedCalendars})});_defineProperty(_assertThisInitialized(_this),"deleteCalendars",function(){var selectedForDeletion=_this.state.selectedForDeletion;_this.closeDestroyModal();(0,_delete_calendars.deleteCalendars)(selectedForDeletion,_this.loadCalendars)});_defineProperty(_assertThisInitialized(_this),"addRequiredFieldsToList",function(){var calendarsList=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];for(var i=0;i<calendarsList.length;i++){calendarsList[i].job_ids_string=calendarsList[i].job_ids.join(", ");calendarsList[i].events_length=calendarsList[i].events.length}return calendarsList});_this.state={loading:true,calendars:[],isDestroyModalVisible:false,calendarId:null,selectedForDeletion:[],nodesAvailable:(0,_check_ml_nodes.mlNodesAvailable)()};return _this}_createClass(CalendarsList,[{key:"componentDidMount",value:function componentDidMount(){this.loadCalendars()}},{key:"render",value:function render(){var _this$state=this.state,calendars=_this$state.calendars,selectedForDeletion=_this$state.selectedForDeletion,loading=_this$state.loading,nodesAvailable=_this$state.nodesAvailable;var _this$props=this.props,canCreateCalendar=_this$props.canCreateCalendar,canDeleteCalendar=_this$props.canDeleteCalendar;var destroyModal="";if(this.state.isDestroyModalVisible){destroyModal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteCalendarTitle",defaultMessage:"Delete calendar"}),onCancel:this.closeDestroyModal,onConfirm:this.deleteCalendars,cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteCalendarsDescription",defaultMessage:"Delete {calendarsCount, plural, one {this calendar} other {these calendars}}? {calendarsList}",values:{calendarsCount:selectedForDeletion.length,calendarsList:selectedForDeletion.map(function(c){return c.calendar_id}).join(", ")}}))))}return _react.default.createElement(_eui.EuiPage,{className:"mlCalendarList"},_react.default.createElement(_eui.EuiPageContent,{className:"mlCalendarList__content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.CalendarsListHeader,{totalCount:calendars.length,refreshCalendars:this.loadCalendars}),_react.default.createElement(_table.CalendarsListTable,{loading:loading,calendarsList:this.addRequiredFieldsToList(calendars),onDeleteClick:this.showDestroyModal,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,mlNodesAvailable:nodesAvailable,setSelectedCalendarList:this.setSelectedCalendarList,itemsSelected:selectedForDeletion.length>0})),destroyModal)}}]);return CalendarsList}(_react.Component),_defineProperty(_class,"propTypes",{canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired}),_temp));exports.CalendarsList=CalendarsList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsListHeader=CalendarsListHeader;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _metadata=__webpack_require__(241);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var docsUrl="https://www.elastic.co/guide/en/elastic-stack-overview/".concat(_metadata.metadata.branch,"/ml-calendars.html");function CalendarsListHeader(_ref){var totalCount=_ref.totalCount,refreshCalendars=_ref.refreshCalendars;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsTitle",defaultMessage:"Calendars"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsListTotalCount",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:refreshCalendars},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays. The same calendar can be assigned to multiple jobs.{br}{learnMoreLink}",values:{br:_react.default.createElement("br",null),learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}CalendarsListHeader.propTypes={totalCount:_propTypes.default.number.isRequired,refreshCalendars:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarsListTable",{enumerable:true,get:function get(){return _table.CalendarsListTable}});var _table=__webpack_require__(3150)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsListTable=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _chrome=_interopRequireDefault(__webpack_require__(9));var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CalendarsListTable=(0,_react2.injectI18n)(function CalendarsListTable(_ref){var calendarsList=_ref.calendarsList,onDeleteClick=_ref.onDeleteClick,setSelectedCalendarList=_ref.setSelectedCalendarList,loading=_ref.loading,canCreateCalendar=_ref.canCreateCalendar,canDeleteCalendar=_ref.canDeleteCalendar,mlNodesAvailable=_ref.mlNodesAvailable,itemsSelected=_ref.itemsSelected,intl=_ref.intl;var sorting={sort:{field:"calendar_id",direction:"asc"}};var pagination={initialPageSize:20,pageSizeOptions:[10,20]};var columns=[{field:"calendar_id",name:intl.formatMessage({id:"xpack.ml.calendarsList.table.idColumnName",defaultMessage:"ID"}),sortable:true,truncateText:true,render:function render(id){return _react.default.createElement(_eui.EuiLink,{href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list/edit_calendar/").concat(id)},id)}},{field:"job_ids_string",name:intl.formatMessage({id:"xpack.ml.calendarsList.table.jobsColumnName",defaultMessage:"Jobs"}),sortable:true,truncateText:true},{field:"events_length",name:intl.formatMessage({id:"xpack.ml.calendarsList.table.eventsColumnName",defaultMessage:"Events"}),sortable:true,render:function render(eventsLength){return intl.formatMessage({id:"xpack.ml.calendarsList.table.eventsCountLabel",defaultMessage:"{eventsLength, plural, one {# event} other {# events}}"},{eventsLength:eventsLength})}}];var tableSelection={onSelectionChange:function onSelectionChange(selection){return setSelectedCalendarList(selection)}};var search={toolsRight:[_react.default.createElement(_eui.EuiButton,{size:"s","data-testid":"new_calendar_button",key:"new_calendar_button",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list/new_calendar"),isDisabled:canCreateCalendar===false||mlNodesAvailable===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.table.newButtonLabel",defaultMessage:"New"})),_react.default.createElement(_eui.EuiButton,{size:"s",color:"danger",iconType:"trash",onClick:onDeleteClick,isDisabled:canDeleteCalendar===false||mlNodesAvailable===false||itemsSelected===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.table.deleteButtonLabel",defaultMessage:"Delete"}))],box:{incremental:true},filters:[]};return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiInMemoryTable,{items:calendarsList,itemId:"calendar_id",columns:columns,search:search,pagination:pagination,sorting:sorting,loading:loading,selection:tableSelection,isSelectable:true}))});exports.CalendarsListTable=CalendarsListTable;CalendarsListTable.WrappedComponent.propTypes={calendarsList:_propTypes.default.array.isRequired,onDeleteClick:_propTypes.default.func.isRequired,loading:_propTypes.default.bool.isRequired,canCreateCalendar:_propTypes.default.bool.isRequired,canDeleteCalendar:_propTypes.default.bool.isRequired,mlNodesAvailable:_propTypes.default.bool.isRequired,setSelectedCalendarList:_propTypes.default.func.isRequired,itemsSelected:_propTypes.default.bool.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.deleteCalendars=deleteCalendars;var _notify=__webpack_require__(14);var _ml_api_service=__webpack_require__(24);var _i18n=__webpack_require__(4);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function deleteCalendars(_x,_x2){return _deleteCalendars.apply(this,arguments)}function _deleteCalendars(){_deleteCalendars=_asyncToGenerator(regeneratorRuntime.mark(function _callee(calendarsToDelete,callback){var messageId,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,calendar,calendarId,errorMessage;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(calendarsToDelete===undefined||calendarsToDelete.length===0)){_context.next=2;break}return _context.abrupt("return");case 2:messageId=calendarsToDelete.length>1?_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.calendarsLabel",{defaultMessage:"{calendarsToDeleteCount} calendars",values:{calendarsToDeleteCount:calendarsToDelete.length}}):"".concat(calendarsToDelete[0].calendar_id);_notify.toastNotifications.add(_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarsNotificationMessage",{defaultMessage:"Deleting {messageId}",values:{messageId:messageId}}));_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=7;_iterator=calendarsToDelete[Symbol.iterator]();case 9:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=25;break}calendar=_step.value;calendarId=calendar.calendar_id;_context.prev=12;_context.next=15;return _ml_api_service.ml.deleteCalendar({calendarId:calendarId});case 15:_context.next=22;break;case 17:_context.prev=17;_context.t0=_context["catch"](12);console.log("Error deleting calendar:",_context.t0);errorMessage=_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarErrorMessage",{defaultMessage:"An error occurred deleting calendar {calendarId}{errorMessage}",values:{calendarId:calendar.calendar_id,errorMessage:_context.t0.message?" : ".concat(_context.t0.message):""}});_notify.toastNotifications.addDanger(errorMessage);case 22:_iteratorNormalCompletion=true;_context.next=9;break;case 25:_context.next=31;break;case 27:_context.prev=27;_context.t1=_context["catch"](7);_didIteratorError=true;_iteratorError=_context.t1;case 31:_context.prev=31;_context.prev=32;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}case 34:_context.prev=34;if(!_didIteratorError){_context.next=37;break}throw _iteratorError;case 37:return _context.finish(34);case 38:return _context.finish(31);case 39:_notify.toastNotifications.addSuccess(_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarSuccessNotificationMessage",{defaultMessage:"{messageId} deleted",values:{messageId:messageId}}));callback();case 41:case"end":return _context.stop()}}},_callee,null,[[7,27,31,39],[12,17],[32,,34,38]])}));return _deleteCalendars.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3153)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _modules=__webpack_require__(8);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _breadcrumbs=__webpack_require__(582);var _routes=_interopRequireDefault(__webpack_require__(19));var _i18n=__webpack_require__(15);var _new_calendar=__webpack_require__(3154);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="settings" />\n  <ml-new-calendar />\n';_routes.default.when("/settings/calendars_list/new_calendar",{template:template,k7Breadcrumbs:_breadcrumbs.getCreateCalendarBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}}).when("/settings/calendars_list/edit_calendar/:calendarId",{template:template,k7Breadcrumbs:_breadcrumbs.getEditCalendarBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}});_module.directive("mlNewCalendar",function($route){return{restrict:"E",replace:false,scope:{},link:function link(scope,element){var props={calendarId:$route.current.params.calendarId,canCreateCalendar:(0,_check_privilege.checkPermission)("canCreateCalendar"),canDeleteCalendar:(0,_check_privilege.checkPermission)("canDeleteCalendar")};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_new_calendar.NewCalendar,props)),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewCalendar=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _chrome=_interopRequireDefault(__webpack_require__(9));var _utils=__webpack_require__(902);var _calendar_form=__webpack_require__(3155);var _new_event_modal=__webpack_require__(3158);var _import_modal=__webpack_require__(3160);var _ml_api_service=__webpack_require__(24);var _notify=__webpack_require__(14);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var NewCalendar=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(NewCalendar,_Component);function NewCalendar(props){var _this;_classCallCheck(this,NewCalendar);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewCalendar).call(this,props));_defineProperty(_assertThisInitialized(_this),"isDuplicateId",function(){var _this$state=_this.state,calendars=_this$state.calendars,formCalendarId=_this$state.formCalendarId;for(var i=0;i<calendars.length;i++){if(calendars[i].calendar_id===formCalendarId){return true}}return false});_defineProperty(_assertThisInitialized(_this),"onCreate",_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var formCalendarId,intl,calendar;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formCalendarId=_this.state.formCalendarId;intl=_this.props.intl;if(!_this.isDuplicateId()){_context.next=6;break}_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.calendarsEdit.canNotCreateCalendarWithExistingIdErrorMessag",defaultMessage:"Cannot create calendar with id [{formCalendarId}] as it already exists."},{formCalendarId:formCalendarId}));_context.next=19;break;case 6:calendar=_this.setUpCalendarForApi();_this.setState({saving:true});_context.prev=8;_context.next=11;return _ml_api_service.ml.addCalendar(calendar);case 11:window.location="".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list");_context.next=19;break;case 14:_context.prev=14;_context.t0=_context["catch"](8);console.log("Error saving calendar",_context.t0);_this.setState({saving:false});_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.calendarsEdit.errorWithCreatingCalendarErrorMessage",defaultMessage:"An error occurred creating calendar {calendarId}"},{calendarId:calendar.calendarId}));case 19:case"end":return _context.stop()}}},_callee,null,[[8,14]])})));_defineProperty(_assertThisInitialized(_this),"onEdit",_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var calendar;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:calendar=_this.setUpCalendarForApi();_this.setState({saving:true});_context2.prev=2;_context2.next=5;return _ml_api_service.ml.updateCalendar(calendar);case 5:window.location="".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list");_context2.next=13;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](2);console.log("Error saving calendar",_context2.t0);_this.setState({saving:false});_notify.toastNotifications.addDanger(_this.props.intl.formatMessage({id:"xpack.ml.calendarsEdit.errorWithUpdatingCalendarErrorMessage",defaultMessage:"An error occurred saving calendar {calendarId}. Try refreshing the page."},{calendarId:calendar.calendarId}));case 13:case"end":return _context2.stop()}}},_callee2,null,[[2,8]])})));_defineProperty(_assertThisInitialized(_this),"setUpCalendarForApi",function(){var _this$state2=_this.state,formCalendarId=_this$state2.formCalendarId,description=_this$state2.description,events=_this$state2.events,selectedGroupOptions=_this$state2.selectedGroupOptions,selectedJobOptions=_this$state2.selectedJobOptions;var jobIds=selectedJobOptions.map(function(option){return option.label});var groupIds=selectedGroupOptions.map(function(option){return option.label});var eventsToSave=events.map(function(event){return{description:event.description,start_time:event.start_time,end_time:event.end_time}});var calendar={calendarId:formCalendarId,description:description,events:eventsToSave,job_ids:[].concat(_toConsumableArray(jobIds),_toConsumableArray(groupIds))};return calendar});_defineProperty(_assertThisInitialized(_this),"onCreateGroupOption",function(newGroup){var newOption={label:newGroup};_this.setState(function(prevState){return{selectedGroupOptions:prevState.selectedGroupOptions.concat(newOption)}})});_defineProperty(_assertThisInitialized(_this),"onJobSelection",function(selectedJobOptions){_this.setState({selectedJobOptions:selectedJobOptions})});_defineProperty(_assertThisInitialized(_this),"onGroupSelection",function(selectedGroupOptions){_this.setState({selectedGroupOptions:selectedGroupOptions})});_defineProperty(_assertThisInitialized(_this),"onCalendarIdChange",function(e){var isValid=(0,_utils.validateCalendarId)(e.target.value);_this.setState({formCalendarId:e.target.value,isNewCalendarIdValid:isValid})});_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",function(e){_this.setState({description:e.target.value})});_defineProperty(_assertThisInitialized(_this),"showImportModal",function(){_this.setState(function(prevState){return{isImportModalVisible:!prevState.isImportModalVisible}})});_defineProperty(_assertThisInitialized(_this),"closeImportModal",function(){_this.setState({isImportModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"onEventDelete",function(eventId){_this.setState(function(prevState){return{events:prevState.events.filter(function(event){return event.event_id!==eventId})}})});_defineProperty(_assertThisInitialized(_this),"closeNewEventModal",function(){_this.setState({isNewEventModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"showNewEventModal",function(){_this.setState({isNewEventModalVisible:true})});_defineProperty(_assertThisInitialized(_this),"addEvent",function(event){_this.setState(function(prevState){return{events:[].concat(_toConsumableArray(prevState.events),[event]),isNewEventModalVisible:false}})});_defineProperty(_assertThisInitialized(_this),"addImportedEvents",function(events){_this.setState(function(prevState){return{events:[].concat(_toConsumableArray(prevState.events),_toConsumableArray(events)),isImportModalVisible:false}})});_this.state={isNewEventModalVisible:false,isImportModalVisible:false,isNewCalendarIdValid:null,loading:true,jobIds:[],jobIdOptions:[],groupIds:[],groupIdOptions:[],calendars:[],formCalendarId:"",description:"",selectedJobOptions:[],selectedGroupOptions:[],events:[],saving:false,selectedCalendar:undefined};return _this}_createClass(NewCalendar,[{key:"componentDidMount",value:function componentDidMount(){this.formSetup()}},{key:"formSetup",value:function(){var _formSetup=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var _this2=this;var _ref3,jobIds,groupIds,calendars,jobIdOptions,groupIdOptions,selectedJobOptions,selectedGroupOptions,eventsList,selectedCalendar,formCalendarId;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return(0,_utils.getCalendarSettingsData)();case 3:_ref3=_context3.sent;jobIds=_ref3.jobIds;groupIds=_ref3.groupIds;calendars=_ref3.calendars;jobIdOptions=jobIds.map(function(jobId){return{label:jobId}});groupIdOptions=groupIds.map(function(groupId){return{label:groupId}});selectedJobOptions=[];selectedGroupOptions=[];eventsList=[];formCalendarId="";if(this.props.calendarId!==undefined){selectedCalendar=calendars.find(function(cal){return cal.calendar_id===_this2.props.calendarId});if(selectedCalendar){formCalendarId=selectedCalendar.calendar_id;eventsList=selectedCalendar.events;selectedCalendar.job_ids.forEach(function(id){if(jobIds.find(function(jobId){return jobId===id})){selectedJobOptions.push({label:id})}else if(groupIds.find(function(groupId){return groupId===id})){selectedGroupOptions.push({label:id})}})}}this.setState({events:eventsList,formCalendarId:formCalendarId,jobIds:jobIds,jobIdOptions:jobIdOptions,groupIds:groupIds,groupIdOptions:groupIdOptions,calendars:calendars,loading:false,selectedJobOptions:selectedJobOptions,selectedGroupOptions:selectedGroupOptions,selectedCalendar:selectedCalendar});_context3.next=22;break;case 17:_context3.prev=17;_context3.t0=_context3["catch"](0);console.log(_context3.t0);this.setState({loading:false});_notify.toastNotifications.addDanger(this.props.intl.formatMessage({id:"xpack.ml.calendarsEdit.errorWithLoadingCalendarFromDataErrorMessage",defaultMessage:"An error occurred loading calendar form data. Try refreshing the page."}));case 22:case"end":return _context3.stop()}}},_callee3,this,[[0,17]])}));function formSetup(){return _formSetup.apply(this,arguments)}return formSetup}()},{key:"render",value:function render(){var _this$state3=this.state,events=_this$state3.events,isNewEventModalVisible=_this$state3.isNewEventModalVisible,isImportModalVisible=_this$state3.isImportModalVisible,isNewCalendarIdValid=_this$state3.isNewCalendarIdValid,formCalendarId=_this$state3.formCalendarId,description=_this$state3.description,groupIdOptions=_this$state3.groupIdOptions,jobIdOptions=_this$state3.jobIdOptions,saving=_this$state3.saving,selectedCalendar=_this$state3.selectedCalendar,selectedJobOptions=_this$state3.selectedJobOptions,selectedGroupOptions=_this$state3.selectedGroupOptions;var modal="";if(isNewEventModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_new_event_modal.NewEventModal,{addEvent:this.addEvent,closeModal:this.closeNewEventModal}))}else if(isImportModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_import_modal.ImportModal,{addImportedEvents:this.addImportedEvents,closeImportModal:this.closeImportModal}))}return _react.default.createElement(_eui.EuiPage,{className:"mlCalendarEditForm"},_react.default.createElement(_eui.EuiPageContent,{className:"mlCalendarEditForm__content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_calendar_form.CalendarForm,{calendarId:selectedCalendar?selectedCalendar.calendar_id:formCalendarId,canCreateCalendar:this.props.canCreateCalendar,canDeleteCalendar:this.props.canDeleteCalendar,description:selectedCalendar?selectedCalendar.description:description,eventsList:events,groupIds:groupIdOptions,isEdit:selectedCalendar!==undefined,isNewCalendarIdValid:selectedCalendar||isNewCalendarIdValid===null?true:isNewCalendarIdValid,jobIds:jobIdOptions,onCalendarIdChange:this.onCalendarIdChange,onCreate:this.onCreate,onDescriptionChange:this.onDescriptionChange,onEdit:this.onEdit,onEventDelete:this.onEventDelete,onGroupSelection:this.onGroupSelection,showImportModal:this.showImportModal,onJobSelection:this.onJobSelection,saving:saving,selectedGroupOptions:selectedGroupOptions,selectedJobOptions:selectedJobOptions,onCreateGroupOption:this.onCreateGroupOption,showNewEventModal:this.showNewEventModal})),modal)}}]);return NewCalendar}(_react.Component),_defineProperty(_class,"propTypes",{calendarId:_propTypes.PropTypes.string,canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired}),_temp));exports.NewCalendar=NewCalendar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarForm",{enumerable:true,get:function get(){return _calendar_form.CalendarForm}});var _calendar_form=__webpack_require__(3156)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarForm=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _chrome=_interopRequireDefault(__webpack_require__(9));var _events_table=__webpack_require__(903);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function EditHeader(_ref){var calendarId=_ref.calendarId,description=_ref.description;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarTitle",defaultMessage:"Calendar {calendarId}",values:{calendarId:calendarId}}))),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,description)),_react.default.createElement(_eui.EuiSpacer,{size:"l"}))}var CalendarForm=(0,_react2.injectI18n)(function CalendarForm(_ref2){var calendarId=_ref2.calendarId,canCreateCalendar=_ref2.canCreateCalendar,canDeleteCalendar=_ref2.canDeleteCalendar,description=_ref2.description,eventsList=_ref2.eventsList,groupIds=_ref2.groupIds,isEdit=_ref2.isEdit,isNewCalendarIdValid=_ref2.isNewCalendarIdValid,jobIds=_ref2.jobIds,onCalendarIdChange=_ref2.onCalendarIdChange,onCreate=_ref2.onCreate,onCreateGroupOption=_ref2.onCreateGroupOption,onDescriptionChange=_ref2.onDescriptionChange,onEdit=_ref2.onEdit,onEventDelete=_ref2.onEventDelete,onGroupSelection=_ref2.onGroupSelection,showImportModal=_ref2.showImportModal,onJobSelection=_ref2.onJobSelection,saving=_ref2.saving,selectedGroupOptions=_ref2.selectedGroupOptions,selectedJobOptions=_ref2.selectedJobOptions,showNewEventModal=_ref2.showNewEventModal,intl=_ref2.intl;var msg=intl.formatMessage({id:"xpack.ml.calendarsEdit.calendarForm.allowedCharactersDescription",defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});var helpText=isNewCalendarIdValid===true&&!isEdit?msg:undefined;var error=isNewCalendarIdValid===false&&!isEdit?[msg]:undefined;var saveButtonDisabled=canCreateCalendar===false||saving||!isNewCalendarIdValid||calendarId==="";return _react.default.createElement(_eui.EuiForm,null,!isEdit&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.createCalendarTitle",defaultMessage:"Create new calendar"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarIdLabel",defaultMessage:"Calendar ID"}),helpText:helpText,error:error,isInvalid:!isNewCalendarIdValid},_react.default.createElement(_eui.EuiFieldText,{name:"calendarId",value:calendarId,onChange:onCalendarIdChange,disabled:isEdit===true||saving===true})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.descriptionLabel",defaultMessage:"Description"})},_react.default.createElement(_eui.EuiFieldText,{name:"description",value:description,onChange:onDescriptionChange,disabled:isEdit===true||saving===true}))),isEdit&&_react.default.createElement(EditHeader,{calendarId:calendarId,description:description}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.jobsLabel",defaultMessage:"Jobs"})},_react.default.createElement(_eui.EuiComboBox,{options:jobIds,selectedOptions:selectedJobOptions,onChange:onJobSelection,isDisabled:saving===true||canCreateCalendar===false})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.groupsLabel",defaultMessage:"Groups"})},_react.default.createElement(_eui.EuiComboBox,{onCreateOption:onCreateGroupOption,options:groupIds,selectedOptions:selectedGroupOptions,onChange:onGroupSelection,isDisabled:saving===true||canCreateCalendar===false})),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.eventsLabel",defaultMessage:"Events"}),fullWidth:true},_react.default.createElement(_events_table.EventsTable,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,eventsList:eventsList,onDeleteClick:onEventDelete,showImportModal:showImportModal,showNewEventModal:showNewEventModal,showSearchBar:true})),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{"data-testid":"ml_save_calendar_button",fill:true,onClick:isEdit?onEdit:onCreate,isDisabled:saveButtonDisabled},saving?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.savingButtonLabel",defaultMessage:"Saving…"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.saveButtonLabel",defaultMessage:"Save"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{isDisabled:saving,href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/calendars_list")},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.cancelButtonLabel",defaultMessage:"Cancel"})))))});exports.CalendarForm=CalendarForm;CalendarForm.WrappedComponent.propTypes={calendarId:_propTypes.PropTypes.string.isRequired,canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired,description:_propTypes.PropTypes.string,groupIds:_propTypes.PropTypes.array.isRequired,isEdit:_propTypes.PropTypes.bool.isRequired,isNewCalendarIdValid:_propTypes.PropTypes.bool.isRequired,jobIds:_propTypes.PropTypes.array.isRequired,onCalendarIdChange:_propTypes.PropTypes.func.isRequired,onCreate:_propTypes.PropTypes.func.isRequired,onCreateGroupOption:_propTypes.PropTypes.func.isRequired,onDescriptionChange:_propTypes.PropTypes.func.isRequired,onEdit:_propTypes.PropTypes.func.isRequired,onEventDelete:_propTypes.PropTypes.func.isRequired,onGroupSelection:_propTypes.PropTypes.func.isRequired,showImportModal:_propTypes.PropTypes.func.isRequired,onJobSelection:_propTypes.PropTypes.func.isRequired,saving:_propTypes.PropTypes.bool.isRequired,selectedGroupOptions:_propTypes.PropTypes.array.isRequired,selectedJobOptions:_propTypes.PropTypes.array.isRequired,showNewEventModal:_propTypes.PropTypes.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventsTable=exports.TIME_FORMAT=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _moment=_interopRequireDefault(__webpack_require__(16));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";exports.TIME_FORMAT=TIME_FORMAT;function DeleteButton(_ref){var onClick=_ref.onClick,canDeleteCalendar=_ref.canDeleteCalendar;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiButtonEmpty,{size:"xs",color:"danger",onClick:onClick,isDisabled:canDeleteCalendar===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.deleteButtonLabel",defaultMessage:"Delete"})))}var EventsTable=(0,_react2.injectI18n)(function EventsTable(_ref2){var canCreateCalendar=_ref2.canCreateCalendar,canDeleteCalendar=_ref2.canDeleteCalendar,eventsList=_ref2.eventsList,onDeleteClick=_ref2.onDeleteClick,showSearchBar=_ref2.showSearchBar,showImportModal=_ref2.showImportModal,showNewEventModal=_ref2.showNewEventModal,intl=_ref2.intl;var sorting={sort:{field:"description",direction:"asc"}};var pagination={initialPageSize:5,pageSizeOptions:[5,10]};var columns=[{field:"description",name:intl.formatMessage({id:"xpack.ml.calendarsEdit.eventsTable.descriptionColumnName",defaultMessage:"Description"}),sortable:true,truncateText:true},{field:"start_time",name:intl.formatMessage({id:"xpack.ml.calendarsEdit.eventsTable.startColumnName",defaultMessage:"Start"}),sortable:true,render:function render(timeMs){var time=(0,_moment.default)(timeMs);return time.format(TIME_FORMAT)}},{field:"end_time",name:intl.formatMessage({id:"xpack.ml.calendarsEdit.eventsTable.endColumnName",defaultMessage:"End"}),sortable:true,render:function render(timeMs){var time=(0,_moment.default)(timeMs);return time.format(TIME_FORMAT)}},{field:"",name:"",render:function render(event){return _react.default.createElement(DeleteButton,{"data-testid":"event_delete",canDeleteCalendar:canDeleteCalendar,onClick:function onClick(){onDeleteClick(event.event_id)}})}}];var search={toolsRight:[_react.default.createElement(_eui.EuiButton,{isDisabled:canCreateCalendar===false,key:"ml_new_event","data-testid":"ml_new_event",size:"s",iconType:"plusInCircle",onClick:showNewEventModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.newEventButtonLabel",defaultMessage:"New event"})),_react.default.createElement(_eui.EuiButton,{isDisabled:canCreateCalendar===false,key:"ml_import_event","data-testid":"ml_import_events",size:"s",iconType:"importAction",onClick:showImportModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsButtonLabel",defaultMessage:"Import events"}))],box:{incremental:true},filters:[]};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiInMemoryTable,{items:eventsList,itemId:"event_id",columns:columns,pagination:pagination,sorting:sorting,search:showSearchBar?search:undefined}))});exports.EventsTable=EventsTable;EventsTable.WrappedComponent.propTypes={canCreateCalendar:_propTypes.default.bool,canDeleteCalendar:_propTypes.default.bool,eventsList:_propTypes.default.array.isRequired,onDeleteClick:_propTypes.default.func.isRequired,showImportModal:_propTypes.default.func,showNewEventModal:_propTypes.default.func,showSearchBar:_propTypes.default.bool};EventsTable.WrappedComponent.defaultProps={showSearchBar:false,canCreateCalendar:true,canDeleteCalendar:true}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewEventModal",{enumerable:true,get:function get(){return _new_event_modal.NewEventModal}});var _new_event_modal=__webpack_require__(3159)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewEventModal=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(16));var _events_table=__webpack_require__(903);var _utils=__webpack_require__(902);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var VALID_DATE_STRING_LENGTH=19;var NewEventModal=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(NewEventModal,_Component);function NewEventModal(props){var _this;_classCallCheck(this,NewEventModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewEventModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",function(e){_this.setState({description:e.target.value})});_defineProperty(_assertThisInitialized(_this),"handleAddEvent",function(){var _this$state=_this.state,description=_this$state.description,startDate=_this$state.startDate,endDate=_this$state.endDate;var tempId=(0,_utils.generateTempId)();var event={description:description,start_time:startDate.valueOf(),end_time:endDate.valueOf(),event_id:tempId};_this.props.addEvent(event)});_defineProperty(_assertThisInitialized(_this),"handleChangeStart",function(date){var start=null;var end=_this.state.endDate;var startMoment=(0,_moment.default)(date);var endMoment=(0,_moment.default)(date);start=startMoment.startOf("day");if(start>end){end=endMoment.startOf("day").add(1,"days")}_this.setState({startDate:start,endDate:end,startDateString:start.format(_events_table.TIME_FORMAT),endDateString:end.format(_events_table.TIME_FORMAT)})});_defineProperty(_assertThisInitialized(_this),"handleChangeEnd",function(date){var start=_this.state.startDate;var end=null;var startMoment=(0,_moment.default)(date);var endMoment=(0,_moment.default)(date);end=endMoment.startOf("day");if(start>end){start=startMoment.startOf("day").subtract(1,"days")}_this.setState({startDate:start,endDate:end,startDateString:start.format(_events_table.TIME_FORMAT),endDateString:end.format(_events_table.TIME_FORMAT)})});_defineProperty(_assertThisInitialized(_this),"handleTimeStartChange",function(event){var dateString=event.target.value;var isValidDate=false;if(dateString.length===VALID_DATE_STRING_LENGTH){isValidDate=(0,_moment.default)(dateString).isValid(_events_table.TIME_FORMAT,true)}else{_this.setState({startDateString:dateString})}if(isValidDate){_this.setState({startDateString:dateString,startDate:(0,_moment.default)(dateString)})}});_defineProperty(_assertThisInitialized(_this),"handleTimeEndChange",function(event){var dateString=event.target.value;var isValidDate=false;if(dateString.length===VALID_DATE_STRING_LENGTH){isValidDate=(0,_moment.default)(dateString).isValid(_events_table.TIME_FORMAT,true)}else{_this.setState({endDateString:dateString})}if(isValidDate){_this.setState({endDateString:dateString,endDate:(0,_moment.default)(dateString)})}});_defineProperty(_assertThisInitialized(_this),"renderRangedDatePicker",function(){var _this$state2=_this.state,startDate=_this$state2.startDate,endDate=_this$state2.endDate,startDateString=_this$state2.startDateString,endDateString=_this$state2.endDateString;var intl=_this.props.intl;var timeInputs=_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.fromLabel",defaultMessage:"From:"}),helpText:_events_table.TIME_FORMAT},_react.default.createElement(_eui.EuiFieldText,{name:"startTime",onChange:_this.handleTimeStartChange,placeholder:_events_table.TIME_FORMAT,value:startDateString}))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.toLabel",defaultMessage:"To:"}),helpText:_events_table.TIME_FORMAT},_react.default.createElement(_eui.EuiFieldText,{name:"endTime",onChange:_this.handleTimeEndChange,placeholder:_events_table.TIME_FORMAT,value:endDateString})))));return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),timeInputs,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true},_react.default.createElement(_eui.EuiDatePickerRange,{fullWidth:true,iconType:false,startDateControl:_react.default.createElement(_eui.EuiDatePicker,{fullWidth:true,inline:true,selected:startDate,onChange:_this.handleChangeStart,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":intl.formatMessage({id:"xpack.ml.calendarsEdit.newEventModal.startDateAriaLabel",defaultMessage:"Start date"}),timeFormat:_events_table.TIME_FORMAT,dateFormat:_events_table.TIME_FORMAT}),endDateControl:_react.default.createElement(_eui.EuiDatePicker,{fullWidth:true,inline:true,selected:endDate,onChange:_this.handleChangeEnd,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":intl.formatMessage({id:"xpack.ml.calendarsEdit.newEventModal.endDateAriaLabel",defaultMessage:"End date"}),timeFormat:_events_table.TIME_FORMAT,dateFormat:_events_table.TIME_FORMAT})})))});var _startDate=(0,_moment.default)().startOf("day");var _endDate=(0,_moment.default)().startOf("day").add(1,"days");_this.state={startDate:_startDate,endDate:_endDate,description:"",startDateString:_startDate.format(_events_table.TIME_FORMAT),endDateString:_endDate.format(_events_table.TIME_FORMAT)};return _this}_createClass(NewEventModal,[{key:"render",value:function render(){var closeModal=this.props.closeModal;var description=this.state.description;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiModal,{onClose:closeModal,initialFocus:"[name=eventDescription]",maxWidth:false},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.createNewEventTitle",defaultMessage:"Create new event"}))),_react.default.createElement(_eui.EuiModalBody,null,_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.descriptionLabel",defaultMessage:"Description"}),fullWidth:true},_react.default.createElement(_eui.EuiFieldText,{name:"eventDescription",onChange:this.onDescriptionChange,isInvalid:!description,fullWidth:true})),this.renderRangedDatePicker())),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:closeModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.cancelButtonLabel",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:this.handleAddEvent,fill:true,disabled:!description},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.addButtonLabel",defaultMessage:"Add"})))))}}]);return NewEventModal}(_react.Component),_defineProperty(_class,"propTypes",{closeModal:_propTypes.PropTypes.func.isRequired,addEvent:_propTypes.PropTypes.func.isRequired}),_temp));exports.NewEventModal=NewEventModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportModal",{enumerable:true,get:function get(){return _import_modal.ImportModal}});var _import_modal=__webpack_require__(3161)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportModal=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _imported_events=__webpack_require__(3162);var _utils=__webpack_require__(3164);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MAX_FILE_SIZE_MB=100;var ImportModal=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(ImportModal,_Component);function ImportModal(props){var _this;_classCallCheck(this,ImportModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(ImportModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"handleImport",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(loadedFile){var incomingFile,errorMessage,events,parsedFile;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:incomingFile=loadedFile[0];errorMessage=_this.props.intl.formatMessage({id:"xpack.ml.calendarsEdit.importModal.couldNotParseICSFileErrorMessage",defaultMessage:"Could not parse ICS file."});events=[];if(!(incomingFile&&incomingFile.size<=MAX_FILE_SIZE_MB*1e6)){_context.next=19;break}_this.setState({fileLoading:true,fileLoaded:true});_context.prev=5;_context.next=8;return(0,_utils.readFile)(incomingFile);case 8:parsedFile=_context.sent;events=(0,_utils.parseICSFile)(parsedFile.data);_this.setState({allImportedEvents:events,selectedEvents:(0,_utils.filterEvents)(events),fileLoading:false,errorMessage:null,includePastEvents:false});_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](5);console.log(errorMessage,_context.t0);_this.setState({errorMessage:errorMessage,fileLoading:false});case 17:_context.next=20;break;case 19:if(incomingFile&&incomingFile.size>MAX_FILE_SIZE_MB*1e6){_this.setState({fileLoading:false,errorMessage:errorMessage})}else{_this.setState({fileLoading:false,errorMessage:null})}case 20:case"end":return _context.stop()}}},_callee,null,[[5,13]])}));return function(_x){return _ref.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"onEventDelete",function(eventId){_this.setState(function(prevState){return{allImportedEvents:prevState.allImportedEvents.filter(function(event){return event.event_id!==eventId}),selectedEvents:prevState.selectedEvents.filter(function(event){return event.event_id!==eventId})}})});_defineProperty(_assertThisInitialized(_this),"onCheckboxToggle",function(e){_this.setState({includePastEvents:e.target.checked})});_defineProperty(_assertThisInitialized(_this),"handleEventsAdd",function(){var _this$state=_this.state,allImportedEvents=_this$state.allImportedEvents,selectedEvents=_this$state.selectedEvents,includePastEvents=_this$state.includePastEvents;var eventsToImport=includePastEvents?allImportedEvents:selectedEvents;var events=eventsToImport.map(function(event){return{description:event.description,start_time:event.start_time,end_time:event.end_time,event_id:event.event_id}});_this.props.addImportedEvents(events)});_defineProperty(_assertThisInitialized(_this),"renderCallout",function(){return _react.default.createElement(_eui.EuiCallOut,{color:"danger"},_react.default.createElement("p",null,_this.state.errorMessage))});_this.state={includePastEvents:false,allImportedEvents:[],selectedEvents:[],fileLoading:false,fileLoaded:false,errorMessage:null};return _this}_createClass(ImportModal,[{key:"render",value:function render(){var _this$props=this.props,closeImportModal=_this$props.closeImportModal,intl=_this$props.intl;var _this$state2=this.state,fileLoading=_this$state2.fileLoading,fileLoaded=_this$state2.fileLoaded,allImportedEvents=_this$state2.allImportedEvents,selectedEvents=_this$state2.selectedEvents,errorMessage=_this$state2.errorMessage,includePastEvents=_this$state2.includePastEvents;var showRecurringWarning=false;var importedEvents;if(includePastEvents){importedEvents=allImportedEvents}else{importedEvents=selectedEvents}if(importedEvents.find(function(e){return e.asterisk})!==undefined){showRecurringWarning=true}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiModal,{onClose:closeImportModal,maxWidth:true},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsTitle",defaultMessage:"Import events"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsDescription",defaultMessage:"Import events from an ICS file."}))))),_react.default.createElement(_eui.EuiModalBody,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFilePicker,{compressed:true,initialPromptText:intl.formatMessage({id:"xpack.ml.calendarsEdit.importModal.selectOrDragAndDropFilePromptText",defaultMessage:"Select or drag and drop a file"}),onChange:this.handleImport,disabled:fileLoading})),errorMessage!==null&&this.renderCallout(),allImportedEvents.length>0&&_react.default.createElement(_imported_events.ImportedEvents,{events:importedEvents,showRecurringWarning:showRecurringWarning,includePastEvents:includePastEvents,onCheckboxToggle:this.onCheckboxToggle,onEventDelete:this.onEventDelete}))),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:closeImportModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.cancelButtonLabel",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:this.handleEventsAdd,fill:true,disabled:fileLoaded===false||errorMessage!==null},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importButtonLabel",defaultMessage:"Import"})))))}}]);return ImportModal}(_react.Component),_defineProperty(_class,"propTypes",{addImportedEvents:_propTypes.PropTypes.func.isRequired,closeImportModal:_propTypes.PropTypes.func.isRequired}),_temp));exports.ImportModal=ImportModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportedEvents",{enumerable:true,get:function get(){return _imported_events.ImportedEvents}});var _imported_events=__webpack_require__(3163)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportedEvents=ImportedEvents;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _events_table=__webpack_require__(903);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ImportedEvents(_ref){var events=_ref.events,showRecurringWarning=_ref.showRecurringWarning,includePastEvents=_ref.includePastEvents,onCheckboxToggle=_ref.onCheckboxToggle,onEventDelete=_ref.onEventDelete;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.eventsToImportTitle",defaultMessage:"Events to import: {eventsCount}",values:{eventsCount:events.length}})),showRecurringWarning&&_react.default.createElement(_eui.EuiText,{color:"danger"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.recurringEventsNotSupportedDescription",defaultMessage:"Recurring events not supported. Only the first event will be imported."}))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_events_table.EventsTable,{eventsList:events,onDeleteClick:onEventDelete})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"ml-include-past-events",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.includePastEventsLabel",defaultMessage:"Include past events"}),checked:includePastEvents,onChange:onCheckboxToggle})))}ImportedEvents.propTypes={events:_propTypes.PropTypes.array.isRequired,showRecurringWarning:_propTypes.PropTypes.bool.isRequired,includePastEvents:_propTypes.PropTypes.bool.isRequired,onCheckboxToggle:_propTypes.PropTypes.func.isRequired,onEventDelete:_propTypes.PropTypes.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filterEvents=filterEvents;exports.parseICSFile=parseICSFile;exports.readFile=readFile;var _moment=_interopRequireDefault(__webpack_require__(16));var _utils=__webpack_require__(902);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var icalendar=__webpack_require__(3165);function createEvents(ical){var events=ical.events();var mlEvents=[];events.forEach(function(e){if(e.element==="VEVENT"){var description=e.properties.SUMMARY;var start=e.properties.DTSTART;var end=e.properties.DTEND;var recurring=e.properties.RRULE!==undefined;if(description&&start&&end&&description.length&&start.length&&end.length){var tempId=(0,_utils.generateTempId)();mlEvents.push({event_id:tempId,description:description[0].value,start_time:start[0].value.valueOf(),end_time:end[0].value.valueOf(),asterisk:recurring})}}});return mlEvents}function filterEvents(events){var now=(0,_moment.default)().valueOf();return events.filter(function(e){return e.start_time>now})}function parseICSFile(data){var cal=icalendar.parse_calendar(data);return createEvents(cal)}function readFile(file){return new Promise(function(resolve,reject){if(file&&file.size){var reader=new FileReader;reader.readAsText(file);reader.onload=function(){return function(){var data=reader.result;if(data===""){reject()}else{resolve({data:data})}}}(file)}else{reject()}})}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(1395)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3167);__webpack_require__(3182)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3168)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _breadcrumbs=__webpack_require__(582);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _edit_filter_list=__webpack_require__(3169);var _routes=_interopRequireDefault(__webpack_require__(19));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="settings" />\n  <ml-edit-filter-list />\n';_routes.default.when("/settings/filter_lists/new_filter_list",{template:template,k7Breadcrumbs:_breadcrumbs.getCreateFilterListBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount}}).when("/settings/filter_lists/edit_filter_list/:filterId",{template:template,k7Breadcrumbs:_breadcrumbs.getEditFilterListBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount}});_module.directive("mlEditFilterList",function($route){return{restrict:"E",replace:false,scope:{},link:function link(scope,element){var props={filterId:$route.current.params.filterId,canCreateFilter:(0,_check_privilege.checkPermission)("canCreateFilter"),canDeleteFilter:(0,_check_privilege.checkPermission)("canDeleteFilter")};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_edit_filter_list.EditFilterList,props)),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterList=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _notify=__webpack_require__(14);var _header=__webpack_require__(3170);var _toolbar=__webpack_require__(3175);var _items_grid=__webpack_require__(3178);var _utils=__webpack_require__(3181);var _ml_api_service=__webpack_require__(24);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var DEFAULT_ITEMS_PER_PAGE=50;function getMatchingFilterItems(searchBarQuery,items){if(items===undefined){return[]}if(searchBarQuery===undefined){return _toConsumableArray(items)}var allItems=items.map(function(item){return{value:item}});var matchingObjects=_eui.EuiSearchBar.Query.execute(searchBarQuery,allItems,{defaultFields:["value"]});return matchingObjects.map(function(item){return item.value})}function getActivePage(activePageState,itemsPerPage,numMatchingItems){var activePage=activePageState;var activePageStartIndex=itemsPerPage*activePageState;if(activePageStartIndex>numMatchingItems){activePage=Math.max(Math.ceil(numMatchingItems/itemsPerPage)-1,0)}return activePage}function returnToFiltersList(){window.location.href="#/settings/filter_lists"}var EditFilterList=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(_class,_Component);function _class(props){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this,props));_defineProperty(_assertThisInitialized(_this),"loadFilterList",function(filterId){var intl=_this.props.intl;_ml_api_service.ml.filters.filters({filterId:filterId}).then(function(filter){_this.setLoadedFilterState(filter)}).catch(function(resp){console.log("Error loading filter ".concat(filterId,":"),resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",defaultMessage:"An error occurred loading details of filter {filterId}"},{filterId:filterId}))})});_defineProperty(_assertThisInitialized(_this),"setLoadedFilterState",function(loadedFilter){_this.setState(function(prevState){var itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var matchingItems=getMatchingFilterItems(searchQuery,loadedFilter.items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{description:loadedFilter.description,items:loadedFilter.items!==undefined?_toConsumableArray(loadedFilter.items):[],matchingItems:matchingItems,selectedItems:[],loadedFilter:loadedFilter,isNewFilterIdInvalid:false,activePage:activePage,searchQuery:searchQuery,saveInProgress:false}})});_defineProperty(_assertThisInitialized(_this),"updateNewFilterId",function(newFilterId){_this.setState({newFilterId:newFilterId,isNewFilterIdInvalid:!(0,_utils.isValidFilterListId)(newFilterId)})});_defineProperty(_assertThisInitialized(_this),"updateDescription",function(description){_this.setState({description:description})});_defineProperty(_assertThisInitialized(_this),"addItems",function(itemsToAdd){var intl=_this.props.intl;_this.setState(function(prevState){var itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var items=_toConsumableArray(prevState.items);var alreadyInFilter=[];itemsToAdd.forEach(function(item){if(items.indexOf(item)===-1){items.push(item)}else{alreadyInFilter.push(item)}});items.sort(function(str1,str2){return str1.localeCompare(str2)});if(alreadyInFilter.length>0){_notify.toastNotifications.addWarning(intl.formatMessage({id:"xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",defaultMessage:"The following items were already in the filter list: {alreadyInFilter}"},{alreadyInFilter:alreadyInFilter}))}var matchingItems=getMatchingFilterItems(searchQuery,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,activePage:activePage,searchQuery:searchQuery}})});_defineProperty(_assertThisInitialized(_this),"deleteSelectedItems",function(){_this.setState(function(prevState){var selectedItems=prevState.selectedItems,itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var items=_toConsumableArray(prevState.items);selectedItems.forEach(function(item){var index=items.indexOf(item);if(index!==-1){items.splice(index,1)}});var matchingItems=getMatchingFilterItems(searchQuery,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,selectedItems:[],activePage:activePage,searchQuery:searchQuery}})});_defineProperty(_assertThisInitialized(_this),"onSearchChange",function(_ref){var query=_ref.query;_this.setState(function(prevState){var items=prevState.items,itemsPerPage=prevState.itemsPerPage;var matchingItems=getMatchingFilterItems(query,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{matchingItems:matchingItems,activePage:activePage,searchQuery:query}})});_defineProperty(_assertThisInitialized(_this),"setItemSelected",function(item,isSelected){_this.setState(function(prevState){var selectedItems=_toConsumableArray(prevState.selectedItems);var index=selectedItems.indexOf(item);if(isSelected===true&&index===-1){selectedItems.push(item)}else if(isSelected===false&&index!==-1){selectedItems.splice(index,1)}return{selectedItems:selectedItems}})});_defineProperty(_assertThisInitialized(_this),"setActivePage",function(activePage){_this.setState({activePage:activePage})});_defineProperty(_assertThisInitialized(_this),"setItemsPerPage",function(itemsPerPage){_this.setState({itemsPerPage:itemsPerPage,activePage:0})});_defineProperty(_assertThisInitialized(_this),"save",function(){_this.setState({saveInProgress:true});var _this$state=_this.state,loadedFilter=_this$state.loadedFilter,newFilterId=_this$state.newFilterId,description=_this$state.description,items=_this$state.items;var intl=_this.props.intl;var filterId=_this.props.filterId!==undefined?_this.props.filterId:newFilterId;(0,_utils.saveFilterList)(filterId,description,items,loadedFilter).then(function(savedFilter){_this.setLoadedFilterState(savedFilter);returnToFiltersList()}).catch(function(resp){console.log("Error saving filter ".concat(filterId,":"),resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",defaultMessage:"An error occurred saving filter {filterId}"},{filterId:filterId}));_this.setState({saveInProgress:false})})});_this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:true,activePage:0,itemsPerPage:DEFAULT_ITEMS_PER_PAGE,saveInProgress:false};return _this}_createClass(_class,[{key:"componentDidMount",value:function componentDidMount(){var filterId=this.props.filterId;if(filterId!==undefined){this.loadFilterList(filterId)}else{this.setState({newFilterId:""})}}},{key:"render",value:function render(){var _this$state2=this.state,loadedFilter=_this$state2.loadedFilter,newFilterId=_this$state2.newFilterId,isNewFilterIdInvalid=_this$state2.isNewFilterIdInvalid,description=_this$state2.description,items=_this$state2.items,matchingItems=_this$state2.matchingItems,selectedItems=_this$state2.selectedItems,itemsPerPage=_this$state2.itemsPerPage,activePage=_this$state2.activePage,saveInProgress=_this$state2.saveInProgress;var _this$props=this.props,canCreateFilter=_this$props.canCreateFilter,canDeleteFilter=_this$props.canDeleteFilter;var totalItemCount=items!==undefined?items.length:0;return _react.default.createElement(_eui.EuiPage,{className:"ml-edit-filter-lists"},_react.default.createElement(_eui.EuiPageContent,{className:"ml-edit-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.EditFilterListHeader,{canCreateFilter:canCreateFilter,filterId:this.props.filterId,newFilterId:newFilterId,isNewFilterIdInvalid:isNewFilterIdInvalid,updateNewFilterId:this.updateNewFilterId,description:description,updateDescription:this.updateDescription,totalItemCount:totalItemCount,usedBy:loadedFilter.used_by}),_react.default.createElement(_toolbar.EditFilterListToolbar,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:selectedItems.length}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_items_grid.ItemsGrid,{totalItemCount:totalItemCount,items:matchingItems,selectedItems:selectedItems,itemsPerPage:itemsPerPage,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:activePage,setActivePage:this.setActivePage}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:returnToFiltersList},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.save,disabled:saveInProgress===true||isNewFilterIdInvalid===true||canCreateFilter===false,fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))))}}]);return _class}(_react.Component),_defineProperty(_class,"displayName","EditFilterList"),_defineProperty(_class,"propTypes",{filterId:_propTypes.default.string,canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired}),_temp));exports.EditFilterList=EditFilterList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterListHeader=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _edit_description_popover=__webpack_require__(3171);var _filter_list_usage_popover=__webpack_require__(3173);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EditFilterListHeader=(0,_react2.injectI18n)(function(_ref){var canCreateFilter=_ref.canCreateFilter,filterId=_ref.filterId,totalItemCount=_ref.totalItemCount,description=_ref.description,updateDescription=_ref.updateDescription,newFilterId=_ref.newFilterId,isNewFilterIdInvalid=_ref.isNewFilterIdInvalid,updateNewFilterId=_ref.updateNewFilterId,usedBy=_ref.usedBy,intl=_ref.intl;var title=filterId!==undefined?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:filterId}}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});var idField;var descriptionField;var usedByElement;if(filterId===undefined){var msg=intl.formatMessage({id:"xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores;"+" must start and end with an alphanumeric character"});var helpText=isNewFilterIdInvalid===false?msg:undefined;var error=isNewFilterIdInvalid===true?[msg]:undefined;idField=_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:helpText,error:error,isInvalid:isNewFilterIdInvalid},_react.default.createElement(_eui.EuiFieldText,{name:"new_filter_id",value:newFilterId,isInvalid:isNewFilterIdInvalid,onChange:function onChange(e){return updateNewFilterId(e.target.value)}}))}if(description!==undefined&&description.length>0){descriptionField=_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,description))}else{descriptionField=_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"})))}if(filterId!==undefined){if(usedBy!==undefined&&usedBy.jobs.length>0){usedByElement=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"ml-filter-list-usage"},_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),_react.default.createElement(_filter_list_usage_popover.FilterListUsagePopover,{entityType:"detector",entityValues:usedBy.detectors}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),_react.default.createElement(_filter_list_usage_popover.FilterListUsagePopover,{entityType:"job",entityValues:usedBy.jobs})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))}else{usedByElement=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))}}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,title))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:totalItemCount}}))))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),idField,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},descriptionField),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_edit_description_popover.EditDescriptionPopover,{canCreateFilter:canCreateFilter,description:description,updateDescription:updateDescription}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),usedByElement)});exports.EditFilterListHeader=EditFilterListHeader;EditFilterListHeader.WrappedComponent.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,filterId:_propTypes.default.string,newFilterId:_propTypes.default.string,isNewFilterIdInvalid:_propTypes.default.bool,updateNewFilterId:_propTypes.default.func.isRequired,totalItemCount:_propTypes.default.number.isRequired,description:_propTypes.default.string,updateDescription:_propTypes.default.func.isRequired,usedBy:_propTypes.default.object};EditFilterListHeader.displayName="EditFilterListHeader"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditDescriptionPopover",{enumerable:true,get:function get(){return _edit_description_popover.EditDescriptionPopover}});var _edit_description_popover=__webpack_require__(3172)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditDescriptionPopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditDescriptionPopover=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(_class,_Component);function _class(props){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this,props));_defineProperty(_assertThisInitialized(_this),"onChange",function(e){_this.setState({value:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){if(_this.state.isPopoverOpen===false){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen,value:_this.props.description})}else{_this.closePopover()}});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){if(_this.state.isPopoverOpen===true){_this.setState({isPopoverOpen:false});_this.props.updateDescription(_this.state.value)}});_this.state={isPopoverOpen:false,value:props.description};return _this}_createClass(_class,[{key:"render",value:function render(){var _this$state=this.state,isPopoverOpen=_this$state.isPopoverOpen,value=_this$state.value;var intl=this.props.intl;var button=_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":intl.formatMessage({id:"xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",defaultMessage:"Edit description"}),isDisabled:this.props.canCreateFilter===false});return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"filter_list_description_popover",ownFocus:true,button:button,isOpen:isPopoverOpen,closePopover:this.closePopover},_react.default.createElement("div",{style:{width:"300px"}},_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},_react.default.createElement(_eui.EuiFieldText,{name:"filter_list_description",value:value,onChange:this.onChange}))))))}}]);return _class}(_react.Component),_defineProperty(_class,"displayName","EditDescriptionPopover"),_defineProperty(_class,"propTypes",{description:_propTypes.default.string,updateDescription:_propTypes.default.func.isRequired,canCreateFilter:_propTypes.default.bool.isRequired}),_temp));exports.EditDescriptionPopover=EditDescriptionPopover},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FilterListUsagePopover",{enumerable:true,get:function get(){return _filter_list_usage_popover.FilterListUsagePopover}});var _filter_list_usage_popover=__webpack_require__(3174)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListUsagePopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FilterListUsagePopover=function(_Component){_inherits(FilterListUsagePopover,_Component);function FilterListUsagePopover(props){var _this;_classCallCheck(this,FilterListUsagePopover);_this=_possibleConstructorReturn(this,_getPrototypeOf(FilterListUsagePopover).call(this,props));_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({isPopoverOpen:false})});_this.state={isPopoverOpen:false};return _this}_createClass(FilterListUsagePopover,[{key:"render",value:function render(){var _this$props=this.props,entityType=_this$props.entityType,entityValues=_this$props.entityValues;var linkText="".concat(entityValues.length," ").concat(entityType).concat(entityValues.length!==1?"s":"");var listItems=entityValues.map(function(value){return _react.default.createElement("li",{key:value},value)});var button=_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},linkText);return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"".concat(entityType,"_filter_list_usage"),panelClassName:"ml-filter-list-usage-popover",ownFocus:true,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},_react.default.createElement("ul",null,listItems)))}}]);return FilterListUsagePopover}(_react.Component);exports.FilterListUsagePopover=FilterListUsagePopover;FilterListUsagePopover.propTypes={entityType:_propTypes.default.oneOf(["job","detector"]),entityValues:_propTypes.default.array.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterListToolbar=EditFilterListToolbar;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _add_item_popover=__webpack_require__(3176);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function renderToolsRight(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount){return[_react.default.createElement(_add_item_popover.AddItemPopover,{addItems:addItems,canCreateFilter:canCreateFilter,key:"add_item_btn"}),_react.default.createElement(_eui.EuiButton,{color:"danger",size:"s",disabled:selectedItemCount===0||canDeleteFilter===false,onClick:deleteSelectedItems,key:"delete_item_btn"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}function EditFilterListToolbar(_ref){var canCreateFilter=_ref.canCreateFilter,canDeleteFilter=_ref.canDeleteFilter,onSearchChange=_ref.onSearchChange,addItems=_ref.addItems,deleteSelectedItems=_ref.deleteSelectedItems,selectedItemCount=_ref.selectedItemCount;var toolsRight=renderToolsRight(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiSearchBar,{toolsRight:toolsRight,onChange:onSearchChange,filters:[]}))))}EditFilterListToolbar.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired,onSearchChange:_propTypes.default.func.isRequired,addItems:_propTypes.default.func.isRequired,deleteSelectedItems:_propTypes.default.func.isRequired,selectedItemCount:_propTypes.default.number.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AddItemPopover",{enumerable:true,get:function get(){return _add_item_popover.AddItemPopover}});var _add_item_popover=__webpack_require__(3177)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddItemPopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var AddItemPopover=function(_Component){_inherits(AddItemPopover,_Component);function AddItemPopover(props){var _this;_classCallCheck(this,AddItemPopover);_this=_possibleConstructorReturn(this,_getPrototypeOf(AddItemPopover).call(this,props));_defineProperty(_assertThisInitialized(_this),"onItemsTextChange",function(e){_this.setState({itemsText:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({isPopoverOpen:false})});_defineProperty(_assertThisInitialized(_this),"onAddButtonClick",function(){var items=_this.state.itemsText.split("\n");var addItems=[];items.forEach(function(item){if(addItems.indexOf(item)===-1&&item.length>0){addItems.push(item)}});_this.props.addItems(addItems);_this.setState({isPopoverOpen:false,itemsText:""})});_this.state={isPopoverOpen:false,itemsText:""};return _this}_createClass(AddItemPopover,[{key:"render",value:function render(){var button=_react.default.createElement(_eui.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:this.props.canCreateFilter===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:true,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},_react.default.createElement(_eui.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange}))),_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.onAddButtonClick,disabled:this.state.itemsText.length===0},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}]);return AddItemPopover}(_react.Component);exports.AddItemPopover=AddItemPopover;_defineProperty(AddItemPopover,"displayName","AddItemPopover");_defineProperty(AddItemPopover,"propTypes",{addItems:_propTypes.default.func.isRequired,canCreateFilter:_propTypes.default.bool.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ItemsGrid",{enumerable:true,get:function get(){return _items_grid.ItemsGrid}});var _items_grid=__webpack_require__(3179)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemsGrid=ItemsGrid;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _items_grid_pagination=__webpack_require__(3180);var _react2=__webpack_require__(5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ItemsGrid(_ref){var numberColumns=_ref.numberColumns,totalItemCount=_ref.totalItemCount,items=_ref.items,selectedItems=_ref.selectedItems,itemsPerPage=_ref.itemsPerPage,itemsPerPageOptions=_ref.itemsPerPageOptions,setItemsPerPage=_ref.setItemsPerPage,setItemSelected=_ref.setItemSelected,activePage=_ref.activePage,setActivePage=_ref.setActivePage;if(items===undefined||items.length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,totalItemCount===0?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))))}var startIndex=activePage*itemsPerPage;var pageItems=items.slice(startIndex,startIndex+itemsPerPage);var gridItems=pageItems.map(function(item,index){return _react.default.createElement(_eui.EuiFlexItem,{key:"ml_grid_item_".concat(index)},_react.default.createElement(_eui.EuiCheckbox,{id:"ml_grid_item_".concat(index),label:item,checked:selectedItems.indexOf(item)>=0,onChange:function onChange(e){setItemSelected(item,e.target.checked)}}))});return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiFlexGrid,{columns:numberColumns,className:"eui-textBreakWord",gutterSize:"m"},gridItems),_react.default.createElement(_items_grid_pagination.ItemsGridPagination,{itemCount:items.length,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,setItemsPerPage:setItemsPerPage,activePage:activePage,setActivePage:setActivePage}))}ItemsGrid.propTypes={numberColumns:_propTypes.default.oneOf([2,3,4]),totalItemCount:_propTypes.default.number.isRequired,items:_propTypes.default.array,selectedItems:_propTypes.default.array,itemsPerPage:_propTypes.default.number,itemsPerPageOptions:_propTypes.default.arrayOf(_propTypes.default.number),setItemsPerPage:_propTypes.default.func.isRequired,setItemSelected:_propTypes.default.func.isRequired,activePage:_propTypes.default.number.isRequired,setActivePage:_propTypes.default.func.isRequired};ItemsGrid.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemsGridPagination=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getContextMenuItemIcon(menuItemSetting,itemsPerPage){return menuItemSetting===itemsPerPage?"check":"empty"}var ItemsGridPagination=function(_Component){_inherits(ItemsGridPagination,_Component);function ItemsGridPagination(props){var _this;_classCallCheck(this,ItemsGridPagination);_this=_possibleConstructorReturn(this,_getPrototypeOf(ItemsGridPagination).call(this,props));_defineProperty(_assertThisInitialized(_this),"onButtonClick",function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})});_defineProperty(_assertThisInitialized(_this),"closePopover",function(){_this.setState({isPopoverOpen:false})});_defineProperty(_assertThisInitialized(_this),"onPageClick",function(pageNumber){_this.props.setActivePage(pageNumber)});_defineProperty(_assertThisInitialized(_this),"onChangeItemsPerPage",function(pageSize){_this.closePopover();_this.props.setItemsPerPage(pageSize)});_this.state={isPopoverOpen:false};return _this}_createClass(ItemsGridPagination,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,itemCount=_this$props.itemCount,itemsPerPage=_this$props.itemsPerPage,itemsPerPageOptions=_this$props.itemsPerPageOptions,activePage=_this$props.activePage;var button=_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:itemsPerPage}}));var pageCount=Math.ceil(itemCount/itemsPerPage);var items=itemsPerPageOptions.map(function(pageSize){return _react.default.createElement(_eui.EuiContextMenuItem,{key:"".concat(pageSize," items"),icon:getContextMenuItemIcon(pageSize,itemsPerPage),onClick:function onClick(){_this2.onChangeItemsPerPage(pageSize)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:pageSize}}))});return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"customizablePagination",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},_react.default.createElement(_eui.EuiContextMenuPanel,{items:items,className:"ml-items-grid-page-size-menu"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPagination,{pageCount:pageCount,activePage:activePage,onPageClick:this.onPageClick})))}}]);return ItemsGridPagination}(_react.Component);exports.ItemsGridPagination=ItemsGridPagination;ItemsGridPagination.propTypes={itemCount:_propTypes.default.number.isRequired,itemsPerPage:_propTypes.default.number.isRequired,itemsPerPageOptions:_propTypes.default.arrayOf(_propTypes.default.number).isRequired,setItemsPerPage:_propTypes.default.func.isRequired,activePage:_propTypes.default.number.isRequired,setActivePage:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isValidFilterListId=isValidFilterListId;exports.saveFilterList=saveFilterList;exports.addFilterList=addFilterList;exports.updateFilterList=updateFilterList;var _i18n=__webpack_require__(4);var _notify=__webpack_require__(14);var _job_utils=__webpack_require__(58);var _ml_api_service=__webpack_require__(24);function isValidFilterListId(id){return id!==undefined&&id.length>0&&(0,_job_utils.isJobIdValid)(id)}function saveFilterList(filterId,description,items,loadedFilterList){return new Promise(function(resolve,reject){if(loadedFilterList===undefined||loadedFilterList.filter_id===undefined){addFilterList(filterId,description,items).then(function(newFilter){resolve(newFilter)}).catch(function(error){reject(error)})}else{updateFilterList(loadedFilterList,description,items).then(function(updatedFilter){resolve(updatedFilter)}).catch(function(error){reject(error)})}})}function addFilterList(filterId,description,items){var filterWithIdExistsErrorMessage=_i18n.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:filterId}});return new Promise(function(resolve,reject){_ml_api_service.ml.filters.filtersStats().then(function(filterLists){var savedFilterIds=filterLists.map(function(filterList){return filterList.filter_id});if(savedFilterIds.indexOf(filterId)===-1){_ml_api_service.ml.filters.addFilter(filterId,description,items).then(function(newFilter){resolve(newFilter)}).catch(function(error){reject(error)})}else{_notify.toastNotifications.addDanger(filterWithIdExistsErrorMessage);reject(new Error(filterWithIdExistsErrorMessage))}}).catch(function(error){reject(error)})})}function updateFilterList(loadedFilterList,description,items){return new Promise(function(resolve,reject){var loadedItems=loadedFilterList.items;var addItems=items.filter(function(item){return loadedItems.includes(item)===false});var removeItems=loadedItems.filter(function(item){return items.includes(item)===false});_ml_api_service.ml.filters.updateFilter(loadedFilterList.filter_id,description,addItems,removeItems).then(function(updatedFilter){resolve(updatedFilter)}).catch(function(error){reject(error)})})}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3183)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _react=_interopRequireDefault(__webpack_require__(0));var _reactDom=_interopRequireDefault(__webpack_require__(17));var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _breadcrumbs=__webpack_require__(582);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _filter_lists=__webpack_require__(3184);var _routes=_interopRequireDefault(__webpack_require__(19));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="settings" />\n  <ml-filter-lists />\n';_routes.default.when("/settings/filter_lists",{template:template,k7Breadcrumbs:_breadcrumbs.getFilterListsBreadcrumbs,resolve:{CheckLicense:_check_license.checkFullLicense,privileges:_check_privilege.checkGetJobsPrivilege,mlNodeCount:_check_ml_nodes.getMlNodeCount}});_module.directive("mlFilterLists",function(){return{restrict:"E",replace:false,scope:{},link:function link(scope,element){var props={canCreateFilter:(0,_check_privilege.checkPermission)("canCreateFilter"),canDeleteFilter:(0,_check_privilege.checkPermission)("canDeleteFilter")};_reactDom.default.render(_react.default.createElement(_i18n.I18nContext,null,_react.default.createElement(_filter_lists.FilterLists,props)),element[0])}}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterLists=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _notify=__webpack_require__(14);var _header=__webpack_require__(3185);var _table=__webpack_require__(3186);var _ml_api_service=__webpack_require__(24);var _class,_temp;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FilterLists=(0,_react2.injectI18n)((_temp=_class=function(_Component){_inherits(_class,_Component);function _class(props){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this,props));_defineProperty(_assertThisInitialized(_this),"setFilterLists",function(filterLists){_this.setState(function(prevState){var loadedFilterIds=filterLists.map(function(filterList){return filterList.filter_id});var selectedFilterLists=prevState.selectedFilterLists.filter(function(filterList){return loadedFilterIds.indexOf(filterList.filter_id)!==-1});return{filterLists:filterLists,selectedFilterLists:selectedFilterLists}})});_defineProperty(_assertThisInitialized(_this),"setSelectedFilterLists",function(selectedFilterLists){_this.setState({selectedFilterLists:selectedFilterLists})});_defineProperty(_assertThisInitialized(_this),"refreshFilterLists",function(){var intl=_this.props.intl;_ml_api_service.ml.filters.filtersStats().then(function(filterLists){_this.setFilterLists(filterLists)}).catch(function(resp){console.log("Error loading list of filters:",resp);_notify.toastNotifications.addDanger(intl.formatMessage({id:"xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",defaultMessage:"An error occurred loading the filter lists"}))})});_this.state={filterLists:[],selectedFilterLists:[]};return _this}_createClass(_class,[{key:"componentDidMount",value:function componentDidMount(){this.refreshFilterLists()}},{key:"render",value:function render(){var _this$state=this.state,filterLists=_this$state.filterLists,selectedFilterLists=_this$state.selectedFilterLists;var _this$props=this.props,canCreateFilter=_this$props.canCreateFilter,canDeleteFilter=_this$props.canDeleteFilter;return _react.default.createElement(_eui.EuiPage,{className:"ml-list-filter-lists"},_react.default.createElement(_eui.EuiPageContent,{className:"ml-list-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.FilterListsHeader,{totalCount:filterLists.length,refreshFilterLists:this.refreshFilterLists}),_react.default.createElement(_table.FilterListsTable,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,filterLists:filterLists,selectedFilterLists:selectedFilterLists,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})))}}]);return _class}(_react.Component),_defineProperty(_class,"displayName","FilterLists"),_defineProperty(_class,"propTypes",{canCreateFilter:_propTypes.PropTypes.bool.isRequired,canDeleteFilter:_propTypes.PropTypes.bool.isRequired}),_temp));exports.FilterLists=FilterLists},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListsHeader=FilterListsHeader;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _metadata=__webpack_require__(241);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var docsUrl="https://www.elastic.co/guide/en/elastic-stack-overview/".concat(_metadata.metadata.branch,"/ml-rules.html");function FilterListsHeader(_ref){var totalCount=_ref.totalCount,refreshFilterLists=_ref.refreshFilterLists;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:function onClick(){return refreshFilterLists()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:_react.default.createElement("br",null),learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}FilterListsHeader.propTypes={totalCount:_propTypes.default.number.isRequired,refreshFilterLists:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListsTable=FilterListsTable;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _i18n=__webpack_require__(4);var _chrome=_interopRequireDefault(__webpack_require__(9));var _delete_filter_list_modal=__webpack_require__(3187);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var UsedByIcon=(0,_react2.injectI18n)(function(_ref){var usedBy=_ref.usedBy,intl=_ref.intl;var icon;if(usedBy!==undefined&&usedBy.jobs.length>0){icon=_react.default.createElement(_eui.EuiIcon,{type:"check","aria-label":intl.formatMessage({id:"xpack.ml.settings.filterLists.table.inUseAriaLabel",defaultMessage:"In use"})})}else{icon=_react.default.createElement(_eui.EuiIcon,{type:"cross","aria-label":intl.formatMessage({id:"xpack.ml.settings.filterLists.table.notInUseAriaLabel",defaultMessage:"Not in use"})})}return icon});UsedByIcon.WrappedComponent.propTypes={usedBy:_propTypes.default.object};function NewFilterButton(_ref2){var canCreateFilter=_ref2.canCreateFilter;return _react.default.createElement(_eui.EuiButton,{key:"new_filter_list",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/filter_lists/new_filter_list"),isDisabled:canCreateFilter===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function getColumns(){var columns=[{field:"filter_id",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:function render(id){return _react.default.createElement(_eui.EuiLink,{href:"".concat(_chrome.default.getBasePath(),"/app/ml#/settings/filter_lists/edit_filter_list/").concat(id)},id)},sortable:true},{field:"description",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:true},{field:"item_count",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:true},{field:"used_by",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:function render(usedBy){return _react.default.createElement(UsedByIcon,{usedBy:usedBy})},sortable:true}];return columns}function renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists){return[_react.default.createElement(NewFilterButton,{key:"new_filter_list",canCreateFilter:canCreateFilter}),_react.default.createElement(_delete_filter_list_modal.DeleteFilterListModal,{canDeleteFilter:canDeleteFilter,selectedFilterLists:selectedFilterLists,refreshFilterLists:refreshFilterLists})]}function FilterListsTable(_ref3){var canCreateFilter=_ref3.canCreateFilter,canDeleteFilter=_ref3.canDeleteFilter,filterLists=_ref3.filterLists,selectedFilterLists=_ref3.selectedFilterLists,setSelectedFilterLists=_ref3.setSelectedFilterLists,refreshFilterLists=_ref3.refreshFilterLists;var sorting={sort:{field:"filter_id",direction:"asc"}};var search={toolsRight:renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists),box:{incremental:true},filters:[]};var tableSelection={selectable:function selectable(filterList){return filterList.used_by===undefined||filterList.used_by.jobs.length===0},selectableMessage:function selectableMessage(){return undefined},onSelectionChange:function onSelectionChange(selection){return setSelectedFilterLists(selection)}};return _react.default.createElement(_react.default.Fragment,null,filterLists===undefined||filterLists.length===0?_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(NewFilterButton,null))),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiInMemoryTable,{className:"ml-filter-lists-table",items:filterLists,itemId:"filter_id",columns:getColumns(),search:search,pagination:true,sorting:sorting,selection:tableSelection,isSelectable:true})))}FilterListsTable.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired,filterLists:_propTypes.default.array,selectedFilterLists:_propTypes.default.array,setSelectedFilterLists:_propTypes.default.func.isRequired,refreshFilterLists:_propTypes.default.func.isRequired};UsedByIcon.displayName="UsedByIcon"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DeleteFilterListModal",{enumerable:true,get:function get(){return _delete_filter_list_modal.DeleteFilterListModal}});var _delete_filter_list_modal=__webpack_require__(3188)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DeleteFilterListModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(6));var _react=_interopRequireWildcard(__webpack_require__(0));var _react2=__webpack_require__(5);var _eui=__webpack_require__(1);var _delete_filter_lists=__webpack_require__(3189);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DeleteFilterListModal=function(_Component){_inherits(DeleteFilterListModal,_Component);function DeleteFilterListModal(props){var _this;_classCallCheck(this,DeleteFilterListModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(DeleteFilterListModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeModal",function(){_this.setState({isModalVisible:false})});_defineProperty(_assertThisInitialized(_this),"showModal",function(){_this.setState({isModalVisible:true})});_defineProperty(_assertThisInitialized(_this),"onConfirmDelete",function(){_this.doDelete()});_this.state={isModalVisible:false};return _this}_createClass(DeleteFilterListModal,[{key:"doDelete",value:function(){var _doDelete=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this$props,selectedFilterLists,refreshFilterLists;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=this.props,selectedFilterLists=_this$props.selectedFilterLists,refreshFilterLists=_this$props.refreshFilterLists;_context.next=3;return(0,_delete_filter_lists.deleteFilterLists)(selectedFilterLists);case 3:refreshFilterLists();this.closeModal();case 5:case"end":return _context.stop()}}},_callee,this)}));function doDelete(){return _doDelete.apply(this,arguments)}return doDelete}()},{key:"render",value:function render(){var _this$props2=this.props,selectedFilterLists=_this$props2.selectedFilterLists,canDeleteFilter=_this$props2.canDeleteFilter;var modal;if(this.state.isModalVisible){var title=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}",values:{selectedFilterListsLength:selectedFilterLists.length,selectedFilterId:!!selectedFilterLists.length&&selectedFilterLists[0].filter_id}});modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:title,className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteWarningMessage",defaultMessage:"Are you sure you want to delete\n{selectedFilterListsLength, plural, one {this filter list} other {these filter lists}}",values:{selectedFilterListsLength:selectedFilterLists.length}}))))}return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:selectedFilterLists===undefined||selectedFilterLists.length===0||canDeleteFilter===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),modal)}}]);return DeleteFilterListModal}(_react.Component);exports.DeleteFilterListModal=DeleteFilterListModal;_defineProperty(DeleteFilterListModal,"displayName","DeleteFilterListModal");_defineProperty(DeleteFilterListModal,"propTypes",{selectedFilterLists:_propTypes.default.array,canDeleteFilter:_propTypes.default.bool.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.deleteFilterLists=deleteFilterLists;var _notify=__webpack_require__(14);var _i18n=__webpack_require__(4);var _ml_api_service=__webpack_require__(24);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function deleteFilterLists(_x){return _deleteFilterLists.apply(this,arguments)}function _deleteFilterLists(){_deleteFilterLists=_asyncToGenerator(regeneratorRuntime.mark(function _callee(filterListsToDelete){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,filterList,filterId;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(filterListsToDelete===undefined||filterListsToDelete.length===0)){_context.next=2;break}return _context.abrupt("return");case 2:_notify.toastNotifications.add(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}));_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=6;_iterator=filterListsToDelete[Symbol.iterator]();case 8:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=23;break}filterList=_step.value;filterId=filterList.filter_id;_context.prev=11;_context.next=14;return _ml_api_service.ml.filters.deleteFilter(filterId);case 14:_context.next=20;break;case 16:_context.prev=16;_context.t0=_context["catch"](11);console.log("Error deleting filter list:",_context.t0);_notify.toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:filterList.filter_id,respMessage:_context.t0.message?" : ".concat(_context.t0.message):""}}));case 20:_iteratorNormalCompletion=true;_context.next=8;break;case 23:_context.next=29;break;case 25:_context.prev=25;_context.t1=_context["catch"](6);_didIteratorError=true;_iteratorError=_context.t1;case 29:_context.prev=29;_context.prev=30;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}case 32:_context.prev=32;if(!_didIteratorError){_context.next=35;break}throw _iteratorError;case 35:return _context.finish(32);case 36:return _context.finish(29);case 37:_notify.toastNotifications.addSuccess(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}));case 38:case"end":return _context.stop()}}},_callee,null,[[6,25,29,37],[11,16],[30,,32,36]])}));return _deleteFilterLists.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(3191)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(51);var _i18n=__webpack_require__(15);var _modules=__webpack_require__(8);var _breadcrumbs=__webpack_require__(3192);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);var _new_job_defaults=__webpack_require__(337);var _index_utils=__webpack_require__(226);var _file_datavisualizer=__webpack_require__(3193);var _routes=_interopRequireDefault(__webpack_require__(19));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _module=_modules.uiModules.get("apps/ml",["react"]);var template='\n  <div class="euiSpacer euiSpacer--s" />\n  <ml-nav-menu name="datavisualizer" />\n  <file-datavisualizer-page />\n';_routes.default.when("/filedatavisualizer/?",{template:template,k7Breadcrumbs:_breadcrumbs.getFileDataVisualizerBreadcrumbs,resolve:{CheckLicense:_check_license.checkBasicLicense,privileges:_check_privilege.checkFindFileStructurePrivilege,indexPatterns:_index_utils.loadIndexPatterns,mlNodeCount:_check_ml_nodes.getMlNodeCount,loadNewJobDefaults:_new_job_defaults.loadNewJobDefaults}});_module.directive("fileDatavisualizerPage",function($injector){var reactDirective=$injector.get("reactDirective");var indexPatterns=$injector.get("indexPatterns");var kibanaConfig=$injector.get("config");return reactDirective((0,_i18n.wrapInI18nContext)(_file_datavisualizer.FileDataVisualizerPage),undefined,{restrict:"E"},{indexPatterns:indexPatterns,kibanaConfig:kibanaConfig})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFileDataVisualizerBreadcrumbs=getFileDataVisualizerBreadcrumbs;var _breadcrumbs=__webpack_require__(432);function getFileDataVisualizerBreadcrumbs(){return[_breadcrumbs.ML_BREADCRUMB]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileDataVisualizerPage=FileDataVisualizerPage;var _file_datavisualizer_view=__webpack_require__(1397);var _react=_interopRequireDefault(__webpack_require__(0));var _timefilter=__webpack_require__(22);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FileDataVisualizerPage(_ref){var indexPatterns=_ref.indexPatterns,kibanaConfig=_ref.kibanaConfig;_timefilter.timefilter.disableTimeRangeSelector();_timefilter.timefilter.disableAutoRefreshSelector();return _react.default.createElement(_file_datavisualizer_view.FileDataVisualizerView,{indexPatterns:indexPatterns,kibanaConfig:kibanaConfig})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileDataVisualizerView=exports.MODE=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _lodash=__webpack_require__(3);var _ml_api_service=__webpack_require__(24);var _about_panel=__webpack_require__(3195);var _bottom_bar=__webpack_require__(3199);var _results_view=__webpack_require__(3201);var _file_error_callouts=__webpack_require__(3212);var _edit_flyout=__webpack_require__(3213);var _import_view=__webpack_require__(3219);var _file_datavisualizer=__webpack_require__(3239);var _utils=__webpack_require__(1401);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MODE={READ:0,IMPORT:1};exports.MODE=MODE;var UPLOAD_SIZE_MB=5;var FileDataVisualizerView=function(_Component){_inherits(FileDataVisualizerView,_Component);function FileDataVisualizerView(props){var _this;_classCallCheck(this,FileDataVisualizerView);_this=_possibleConstructorReturn(this,_getPrototypeOf(FileDataVisualizerView).call(this,props));_defineProperty(_assertThisInitialized(_this),"onFilePickerChange",function(files){_this.overrides={};_this.setState({loading:files.length>0,bottomBarVisible:files.length>0,loaded:false,fileContents:"",fileSize:0,fileTooLarge:false,fileCouldNotBeRead:false,serverErrorMessage:"",results:undefined},function(){if(files.length){_this.loadFile(files[0])}})});_defineProperty(_assertThisInitialized(_this),"closeEditFlyout",function(){_this.setState({isEditFlyoutVisible:false});_this.showBottomBar()});_defineProperty(_assertThisInitialized(_this),"showEditFlyout",function(){_this.setState({isEditFlyoutVisible:true});_this.hideBottomBar()});_defineProperty(_assertThisInitialized(_this),"showBottomBar",function(){_this.setState({bottomBarVisible:true})});_defineProperty(_assertThisInitialized(_this),"hideBottomBar",function(){_this.setState({bottomBarVisible:false})});_defineProperty(_assertThisInitialized(_this),"setOverrides",function(overrides){console.log("setOverrides",overrides);_this.setState({loading:true,loaded:false},function(){var formattedOverrides=(0,_utils.createUrlOverrides)(overrides,_this.originalSettings);_this.loadSettings(_this.state.fileContents,formattedOverrides)})});_defineProperty(_assertThisInitialized(_this),"changeMode",function(mode){_this.setState({mode:mode})});_defineProperty(_assertThisInitialized(_this),"onCancel",function(){_this.changeMode(MODE.READ);_this.onFilePickerChange([])});_this.state={files:{},fileContents:"",fileSize:0,fileTooLarge:false,fileCouldNotBeRead:false,serverErrorMessage:"",loading:false,loaded:false,results:undefined,mode:MODE.READ,isEditFlyoutVisible:false,bottomBarVisible:false,hasPermissionToImport:false};_this.overrides={};_this.previousOverrides={};_this.originalSettings={};return _this}_createClass(FileDataVisualizerView,[{key:"componentDidMount",value:function(){var _componentDidMount=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var hasPermissionToImport;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return(0,_utils.hasImportPermission)();case 2:hasPermissionToImport=_context.sent;this.setState({hasPermissionToImport:hasPermissionToImport});case 4:case"end":return _context.stop()}}},_callee,this)}));function componentDidMount(){return _componentDidMount.apply(this,arguments)}return componentDidMount}()},{key:"loadFile",value:function(){var _loadFile=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(file){var fileContents,data;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(file.size<=_file_datavisualizer.MAX_BYTES)){_context2.next=17;break}_context2.prev=1;_context2.next=4;return(0,_utils.readFile)(file);case 4:fileContents=_context2.sent;data=fileContents.data;this.setState({fileContents:data,fileSize:file.size});_context2.next=9;return this.loadSettings(data);case 9:_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](1);console.error(_context2.t0);this.setState({loaded:false,loading:false,fileCouldNotBeRead:true});case 15:_context2.next=18;break;case 17:this.setState({loaded:false,loading:false,fileTooLarge:true,fileSize:file.size});case 18:case"end":return _context2.stop()}}},_callee2,this,[[1,11]])}));function loadFile(_x){return _loadFile.apply(this,arguments)}return loadFile}()},{key:"loadSettings",value:function(){var _loadSettings=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(data,overrides){var _this2=this;var isRetry,lessData,analyzeFile,resp,serverSettings,serverOverrides,_args3=arguments;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isRetry=_args3.length>2&&_args3[2]!==undefined?_args3[2]:false;_context3.prev=1;lessData=(0,_utils.reduceData)(data,UPLOAD_SIZE_MB);console.log("overrides",overrides);analyzeFile=_ml_api_service.ml.fileDatavisualizer.analyzeFile;_context3.next=7;return analyzeFile(lessData,overrides);case 7:resp=_context3.sent;serverSettings=(0,_utils.processResults)(resp.results);serverOverrides=resp.overrides;this.previousOverrides=this.overrides;this.overrides={};if(!(serverSettings.format==="xml")){_context3.next=14;break}throw{message:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileDatavisualizerView.xmlNotCurrentlySupportedErrorMessage",defaultMessage:"XML not currently supported"})};case 14:if(serverOverrides===undefined){this.originalSettings=serverSettings}else{Object.keys(serverOverrides).forEach(function(o){var camelCaseO=o.replace(/_\w/g,function(m){return m[1].toUpperCase()});_this2.overrides[camelCaseO]=serverOverrides[o]});Object.keys(serverSettings).forEach(function(o){var value=serverSettings[o];if(_this2.overrides[o]===undefined&&(Array.isArray(value)&&(0,_lodash.isEqual)(value,_this2.originalSettings[o])===false||value!==_this2.originalSettings[o])){_this2.originalSettings[o]=value}})}this.setState({results:resp.results,loaded:true,loading:false,fileCouldNotBeRead:isRetry});_context3.next=23;break;case 18:_context3.prev=18;_context3.t0=_context3["catch"](1);console.error(_context3.t0);this.setState({results:undefined,loaded:false,loading:false,fileCouldNotBeRead:true,serverErrorMessage:_context3.t0.message});if(overrides!==undefined&&(0,_lodash.isEqual)(this.previousOverrides,overrides)===false){this.setState({loading:true,loaded:false});this.loadSettings(data,this.previousOverrides,true)}case 23:case"end":return _context3.stop()}}},_callee3,this,[[1,18]])}));function loadSettings(_x2,_x3){return _loadSettings.apply(this,arguments)}return loadSettings}()},{key:"render",value:function render(){var _this3=this;var _this$state=this.state,loading=_this$state.loading,loaded=_this$state.loaded,results=_this$state.results,fileContents=_this$state.fileContents,fileSize=_this$state.fileSize,fileTooLarge=_this$state.fileTooLarge,fileCouldNotBeRead=_this$state.fileCouldNotBeRead,serverErrorMessage=_this$state.serverErrorMessage,mode=_this$state.mode,isEditFlyoutVisible=_this$state.isEditFlyoutVisible,bottomBarVisible=_this$state.bottomBarVisible,hasPermissionToImport=_this$state.hasPermissionToImport;var fields=results!==undefined&&results.field_stats!==undefined?Object.keys(results.field_stats):[];return _react2.default.createElement("div",{className:"file-datavisualizer__content"},mode===MODE.READ&&_react2.default.createElement(_react2.default.Fragment,null,!loading&&!loaded&&_react2.default.createElement(_about_panel.AboutPanel,{onFilePickerChange:this.onFilePickerChange}),loading&&_react2.default.createElement(_about_panel.LoadingPanel,null),fileTooLarge&&_react2.default.createElement(_file_error_callouts.FileTooLarge,{fileSize:fileSize,maxFileSize:_file_datavisualizer.MAX_BYTES}),fileCouldNotBeRead&&loading===false&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_file_error_callouts.FileCouldNotBeRead,{error:serverErrorMessage,loaded:loaded}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"})),loaded&&_react2.default.createElement(_results_view.ResultsView,{results:results,data:fileContents,showEditFlyout:function showEditFlyout(){return _this3.showEditFlyout()}}),_react2.default.createElement(_edit_flyout.EditFlyout,{setOverrides:this.setOverrides,closeEditFlyout:this.closeEditFlyout,isFlyoutVisible:isEditFlyoutVisible,originalSettings:this.originalSettings,overrides:this.overrides,fields:fields}),_react2.default.createElement(_bottom_bar.BottomBar,{showBar:bottomBarVisible&&loaded,mode:MODE.READ,changeMode:this.changeMode,onCancel:this.onCancel,disableImport:hasPermissionToImport===false}),_react2.default.createElement(BottomPadding,null)),mode===MODE.IMPORT&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_import_view.ImportView,{results:results,fileContents:fileContents,fileSize:fileSize,indexPatterns:this.props.indexPatterns,kibanaConfig:this.props.kibanaConfig,showBottomBar:this.showBottomBar,hideBottomBar:this.hideBottomBar}),_react2.default.createElement(_bottom_bar.BottomBar,{showBar:bottomBarVisible,mode:MODE.IMPORT,changeMode:this.changeMode,onCancel:this.onCancel}),_react2.default.createElement(BottomPadding,null)))}}]);return FileDataVisualizerView}(_react2.Component);exports.FileDataVisualizerView=FileDataVisualizerView;function BottomPadding(){return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AboutPanel",{enumerable:true,get:function get(){return _about_panel.AboutPanel}});Object.defineProperty(exports,"LoadingPanel",{enumerable:true,get:function get(){return _about_panel.LoadingPanel}});var _about_panel=__webpack_require__(3196)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingPanel=LoadingPanel;exports.AboutPanel=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _welcome_content=__webpack_require__(3197);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AboutPanel=(0,_react.injectI18n)(function AboutPanel(_ref){var onFilePickerChange=_ref.onFilePickerChange,intl=_ref.intl;return _react2.default.createElement(_eui.EuiPage,{restrictWidth:1e3},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContent,{className:"file-datavisualizer-about-panel__content"},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react2.default.createElement(_eui.EuiFlexItem,{grow:true},_react2.default.createElement(_welcome_content.WelcomeContent,null),_react2.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react2.default.createElement("div",{style:{textAlign:"center"}},_react2.default.createElement(_eui.EuiFilePicker,{id:"filePicker",initialPromptText:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.aboutPanel.selectOrDragAndDropFileDescription",defaultMessage:"Select or drag and drop a file"}),onChange:function onChange(files){return onFilePickerChange(files)},className:"file-datavisualizer-file-picker"})),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}))))))});exports.AboutPanel=AboutPanel;function LoadingPanel(){return _react2.default.createElement(_eui.EuiPage,{restrictWidth:400},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContent,{className:"file-datavisualizer-about-panel__content",paddingSize:"l"},_react2.default.createElement("div",{style:{textAlign:"center"}},_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",{role:"alert"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.aboutPanel.analyzingDataTitle",defaultMessage:"Analyzing data"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"})))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WelcomeContent=WelcomeContent;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _experimental_badge=__webpack_require__(1398);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function WelcomeContent(){return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"addDataApp",className:"file-datavisualizer-about-panel__icon"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiTitle,{size:"m"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.visualizeDataFromLogFileTitle",defaultMessage:"Visualize data from a log file {experimentalBadge}",values:{experimentalBadge:_react2.default.createElement(_experimental_badge.ExperimentalBadge,{tooltipContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.experimentalFeatureTooltip",defaultMessage:"Experimental feature. We'd love to hear your feedback."})})}}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.visualizeDataFromLogFileDescription",defaultMessage:"The File Data Visualizer helps you understand the fields and metrics in a log file. Upload your file, analyze its data, and then choose whether to import the data into an Elasticsearch index."}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.supportedFileFormatDescription",defaultMessage:"The File Data Visualizer supports these file formats:"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.delimitedTextFilesDescription",defaultMessage:"Delimited text files, such as CSV and TSV"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.newlineDelimitedJsonDescription",defaultMessage:"Newline-delimited JSON"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.logFilesWithCommonFormatDescription",defaultMessage:"Log files with a common format for the timestamp"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.uploadedFilesAllowedSizeDescription",defaultMessage:"You can upload files up to 100 MB."}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.experimentalFeatureDescription",defaultMessage:"This feature is experimental. Got feedback? Please create an issue in {githubLink}.",values:{githubLink:_react2.default.createElement(_eui.EuiLink,{href:"https://github.com/elastic/kibana/issues/new",target:"_blank"},"GitHub")}})))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExperimentalBadge=ExperimentalBadge;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExperimentalBadge(_ref){var tooltipContent=_ref.tooltipContent;return _react2.default.createElement("span",null,_react2.default.createElement(_eui.EuiBetaBadge,{className:"ml-experimental-badge",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.experimentalBadge.experimentalLabel",defaultMessage:"Experimental"}),tooltipContent:tooltipContent}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"BottomBar",{enumerable:true,get:function get(){return _bottom_bar.BottomBar}});var _bottom_bar=__webpack_require__(3200)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BottomBar=BottomBar;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _file_datavisualizer_view=__webpack_require__(1397);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function BottomBar(_ref){var showBar=_ref.showBar,mode=_ref.mode,changeMode=_ref.changeMode,onCancel=_ref.onCancel,disableImport=_ref.disableImport;if(showBar){if(mode===_file_datavisualizer_view.MODE.READ){return _react2.default.createElement(_eui.EuiBottomBar,null,_react2.default.createElement(_eui.EuiFlexGroup,null,_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{fill:true,isDisabled:disableImport===true,onClick:function onClick(){return changeMode(_file_datavisualizer_view.MODE.IMPORT)}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.readMode.importButtonLabel",defaultMessage:"Import"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{color:"ghost",onClick:function onClick(){return onCancel()}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.readMode.cancelButtonLabel",defaultMessage:"Cancel"})))))}else{return _react2.default.createElement(_eui.EuiBottomBar,null,_react2.default.createElement(_eui.EuiFlexGroup,null,_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{color:"ghost",onClick:function onClick(){return changeMode(_file_datavisualizer_view.MODE.READ)}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.backButtonLabel",defaultMessage:"Back"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{color:"ghost",onClick:function onClick(){return onCancel()}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.cancelButtonLabel",defaultMessage:"Cancel"})))))}}return null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ResultsView",{enumerable:true,get:function get(){return _results_view.ResultsView}});var _results_view=__webpack_require__(3202)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsView=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _file_contents=__webpack_require__(3203);var _analysis_summary=__webpack_require__(3205);var _fields_stats=__webpack_require__(3207);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ResultsView=(0,_react.injectI18n)(function(_ref){var data=_ref.data,results=_ref.results,showEditFlyout=_ref.showEditFlyout,intl=_ref.intl;console.log(results);var tabs=[{id:"file-stats",name:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.resultsView.fileStatsTabName",defaultMessage:"File stats"}),content:_react2.default.createElement(_fields_stats.FieldsStats,{results:results})}];return _react2.default.createElement("div",{className:"results"},_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_file_contents.FileContents,{data:data,format:results.format,numberOfLines:results.num_lines_analyzed})),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_analysis_summary.AnalysisSummary,{results:results}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiButton,{onClick:function onClick(){return showEditFlyout()}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsView.overrideSettingsButtonLabel",defaultMessage:"Override settings"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}})))});exports.ResultsView=ResultsView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FileContents",{enumerable:true,get:function get(){return _file_contents.FileContents}});var _file_contents=__webpack_require__(3204)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileContents=FileContents;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _ml_job_editor=__webpack_require__(575);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FileContents(_ref){var data=_ref.data,format=_ref.format,numberOfLines=_ref.numberOfLines;var mode=_ml_job_editor.EDITOR_MODE.TEXT;if(format===_ml_job_editor.EDITOR_MODE.JSON){mode=_ml_job_editor.EDITOR_MODE.JSON}var formattedData=limitByNumberOfLines(data,numberOfLines);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileContents.fileContentsTitle",defaultMessage:"File contents"}))),_react2.default.createElement("div",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileContents.firstLinesDescription",defaultMessage:"First {numberOfLines, plural, zero {# line} one {# line} other {# lines}}",values:{numberOfLines:numberOfLines}})),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:mode,readOnly:true,value:formattedData,height:"200px",syntaxChecking:false}))}function limitByNumberOfLines(data,numberOfLines){return data.split("\n").slice(0,numberOfLines).join("\n")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnalysisSummary",{enumerable:true,get:function get(){return _analysis_summary.AnalysisSummary}});var _analysis_summary=__webpack_require__(3206)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnalysisSummary=AnalysisSummary;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AnalysisSummary(_ref){var results=_ref.results;var items=createDisplayItems(results);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.summaryTitle",defaultMessage:"Summary"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:items,className:"analysis-summary-list"}))}function createDisplayItems(results){var items=[{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.analyzedLinesNumberTitle",defaultMessage:"Number of lines analyzed"}),description:results.num_lines_analyzed}];if(results.format!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.formatTitle",defaultMessage:"Format"}),description:results.format});if(results.format==="delimited"){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.delimiterTitle",defaultMessage:"Delimiter"}),description:results.delimiter});items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.hasHeaderRowTitle",defaultMessage:"Has header row"}),description:"".concat(results.has_header_row)})}}if(results.grok_pattern!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.grokPatternTitle",defaultMessage:"Grok pattern"}),description:results.grok_pattern})}if(results.timestamp_field!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.timeFieldTitle",defaultMessage:"Time field"}),description:results.timestamp_field})}if(results.java_timestamp_formats!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.timeFormatTitle",defaultMessage:"Time {timestampFormats, plural, zero {format} one {format} other {formats}}",values:{timestampFormats:results.java_timestamp_formats.length}}),description:results.java_timestamp_formats.join(", ")})}return items}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldsStats",{enumerable:true,get:function get(){return _fields_stats.FieldsStats}});var _fields_stats=__webpack_require__(3208)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldsStats=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _field_stats_card=__webpack_require__(3209);var _get_field_names=__webpack_require__(3210);var _field_types=__webpack_require__(295);var _round_to_decimal_place=__webpack_require__(3211);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var FieldsStats=function(_Component){_inherits(FieldsStats,_Component);function FieldsStats(props){var _this;_classCallCheck(this,FieldsStats);_this=_possibleConstructorReturn(this,_getPrototypeOf(FieldsStats).call(this,props));_this.state={fields:[]};return _this}_createClass(FieldsStats,[{key:"componentDidMount",value:function componentDidMount(){this.setState({fields:createFields(this.props.results)})}},{key:"render",value:function render(){return _react.default.createElement("div",{className:"fields-stats"},this.state.fields.map(function(f){return _react.default.createElement(_field_stats_card.FieldStatsCard,{field:f,key:f.name})}))}}]);return FieldsStats}(_react.Component);exports.FieldsStats=FieldsStats;function createFields(results){var mappings=results.mappings,fieldStats=results.field_stats,numMessagesAnalyzed=results.num_messages_analyzed,timestampField=results.timestamp_field;if(mappings&&fieldStats){var fieldNames=(0,_get_field_names.getFieldNames)(results);return fieldNames.map(function(name){if(fieldStats[name]!==undefined){var field={name:name};var f=fieldStats[name];var m=mappings[name];if(name===timestampField&&field.type===undefined){field.type=_field_types.ML_JOB_FIELD_TYPES.DATE}if(f!==undefined){Object.assign(field,f)}if(m!==undefined){field.type=m.type;if(m.format!==undefined){field.format=m.format}}var percent=field.count/numMessagesAnalyzed*100;field.percent=(0,_round_to_decimal_place.roundToDecimalPlace)(percent);if(field.median_value!==undefined){field.median_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.median_value);field.mean_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.mean_value);field.min_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.min_value);field.max_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.max_value)}return field}else{var type=mappings[name]&&mappings[name].type===_field_types.ML_JOB_FIELD_TYPES.TEXT?_field_types.ML_JOB_FIELD_TYPES.TEXT:_field_types.ML_JOB_FIELD_TYPES.UNKNOWN;return{name:name,type:type,mean_value:0,count:0,cardinality:0,percent:0}}})}return[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldStatsCard=FieldStatsCard;var _react=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _react2=__webpack_require__(5);var _field_type_icon=__webpack_require__(402);var _display_value=__webpack_require__(1381);var _field_types_utils=__webpack_require__(578);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FieldStatsCard(_ref){var field=_ref.field;var type=field.type;if(type==="double"||type==="long"){type="number"}var typeAriaLabel=(0,_field_types_utils.getMLJobTypeAriaLabel)(type);var cardTitleAriaLabel=[field.name];if(typeAriaLabel){cardTitleAriaLabel.unshift(typeAriaLabel)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"card-container"},_react.default.createElement("div",{className:"ml-field-data-card"},_react.default.createElement("div",{className:"ml-field-title-bar ".concat(type)},_react.default.createElement(_field_type_icon.FieldTypeIcon,{type:type,needsAria:false}),_react.default.createElement("div",{className:"field-name",tabIndex:"0","aria-label":"".concat(cardTitleAriaLabel.join(", "))},field.name)),_react.default.createElement("div",{className:"card-contents"},field.count>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement("i",{className:"fa fa-files-o","aria-hidden":"true"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.documentsCountDescription",defaultMessage:"{fieldCount, plural, zero {# document} one {# document} other {# documents}} ({fieldPercent}%)",values:{fieldCount:field.count,fieldPercent:field.percent}})),_react.default.createElement("div",{className:"stat"},_react.default.createElement("i",{className:"fa fa-cubes","aria-hidden":"true"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.distinctCountDescription",defaultMessage:"{fieldCardinality} distinct {fieldCardinality, plural, zero {value} one {value} other {values}}",values:{fieldCardinality:field.cardinality}})),field.median_value&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",null,_react.default.createElement("div",{className:"stat min heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.minTitle",defaultMessage:"min"})),_react.default.createElement("div",{className:"stat median heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.medianTitle",defaultMessage:"median"})),_react.default.createElement("div",{className:"stat max heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.maxTitle",defaultMessage:"max"}))),_react.default.createElement("div",null,_react.default.createElement("div",{className:"stat min value"},_react.default.createElement(_display_value.DisplayValue,{value:field.min_value})),_react.default.createElement("div",{className:"stat median value"},_react.default.createElement(_display_value.DisplayValue,{value:field.median_value})),_react.default.createElement("div",{className:"stat max value"},_react.default.createElement(_display_value.DisplayValue,{value:field.max_value}))))),field.top_hits&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.topStatsValuesDescription",defaultMessage:"top values"})),field.top_hits.map(function(_ref2){var count=_ref2.count,value=_ref2.value;var pcnt=Math.round(count/field.count*100*100)/100;return _react.default.createElement("div",{key:value,className:"top-value"},_react.default.createElement("div",{className:"field-label"},value," "),_react.default.createElement("div",{className:"top-value-bar-holder"},_react.default.createElement("div",{className:"top-value-bar ".concat(type),style:{width:"".concat(pcnt,"%")}})),_react.default.createElement("div",{className:"count-label"},pcnt,"%"))})))),field.count===0&&_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.noFieldInformationAvailableDescription",defaultMessage:"No field information available"})))))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFieldNames=getFieldNames;var _lodash=__webpack_require__(3);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getFieldNames(results){var mappings=results.mappings,fieldStats=results.field_stats,columnNames=results.column_names;var tempFields=columnNames!==undefined?columnNames:Object.keys(fieldStats);var differenceFields=(0,_lodash.difference)(Object.keys(mappings),tempFields);var timestampIndex=differenceFields.indexOf("@timestamp");if(timestampIndex!==-1){differenceFields.splice(timestampIndex,1)}if(differenceFields.length){tempFields.push.apply(tempFields,_toConsumableArray(differenceFields))}return tempFields}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.roundToDecimalPlace=roundToDecimalPlace;function roundToDecimalPlace(num){var dp=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(Math.abs(num)<Math.pow(10,-dp)){return Number.parseFloat(num).toExponential(2)}else{var m=Math.pow(10,dp);return Math.round(num*m)/m}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileTooLarge=FileTooLarge;exports.FileCouldNotBeRead=FileCouldNotBeRead;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _numeral=_interopRequireDefault(__webpack_require__(217));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FILE_SIZE_DISPLAY_FORMAT="0,0.[0] b";function FileTooLarge(_ref){var fileSize=_ref.fileSize,maxFileSize=_ref.maxFileSize;var fileSizeFormatted=(0,_numeral.default)(fileSize).format(FILE_SIZE_DISPLAY_FORMAT);var maxFileSizeFormatted=(0,_numeral.default)(maxFileSize).format(FILE_SIZE_DISPLAY_FORMAT);var errorText;if(fileSizeFormatted!==maxFileSizeFormatted){errorText=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeExceedsAllowedSizeErrorMessage",defaultMessage:"The size of the file you selected for upload is {fileSizeFormatted} which exceeds the maximum permitted size of {maxFileSizeFormatted}",values:{fileSizeFormatted:fileSizeFormatted,maxFileSizeFormatted:maxFileSizeFormatted}}))}else{var diffFormatted=(0,_numeral.default)(fileSize-maxFileSize).format(FILE_SIZE_DISPLAY_FORMAT);errorText=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeExceedsAllowedSizeByDiffFormatErrorMessage",defaultMessage:"The size of the file you selected for upload exceeds the maximum permitted size of {maxFileSizeFormatted} by {diffFormatted}",values:{maxFileSizeFormatted:maxFileSizeFormatted,diffFormatted:diffFormatted}}))}return _react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeTooLargeTitle",defaultMessage:"File size is too large"}),color:"danger",iconType:"cross"},errorText)}function FileCouldNotBeRead(_ref2){var error=_ref2.error,loaded=_ref2.loaded;return _react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileCouldNotBeReadTitle",defaultMessage:"File could not be read"}),color:"danger",iconType:"cross"},error!==undefined&&_react2.default.createElement("p",null,error),loaded&&_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.revertingToPreviousSettingsDescription",defaultMessage:"Reverting to previous settings"})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditFlyout",{enumerable:true,get:function get(){return _edit_flyout.EditFlyout}});var _edit_flyout=__webpack_require__(3214)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFlyout=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _overrides=__webpack_require__(3215);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditFlyout=function(_Component){_inherits(EditFlyout,_Component);function EditFlyout(props){var _this;_classCallCheck(this,EditFlyout);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditFlyout).call(this,props));_defineProperty(_assertThisInitialized(_this),"applyAndClose",function(){_this.applyOverrides();_this.props.closeEditFlyout()});_defineProperty(_assertThisInitialized(_this),"setApplyOverrides",function(applyOverrides){_this.applyOverrides=applyOverrides});_defineProperty(_assertThisInitialized(_this),"unsetApplyOverrides",function(){_this.applyOverrides=function(){}});_defineProperty(_assertThisInitialized(_this),"setOverridesValid",function(overridesValid){_this.setState({overridesValid:overridesValid})});_this.applyOverrides=function(){};_this.state={overridesValid:true};return _this}_createClass(EditFlyout,[{key:"render",value:function render(){var _this$props=this.props,isFlyoutVisible=_this$props.isFlyoutVisible,closeEditFlyout=_this$props.closeEditFlyout,setOverrides=_this$props.setOverrides,overrides=_this$props.overrides,originalSettings=_this$props.originalSettings,fields=_this$props.fields;return _react2.default.createElement(_react2.default.Fragment,null,isFlyoutVisible&&_react2.default.createElement(_eui.EuiFlyout,{onClose:closeEditFlyout,size:"m"},_react2.default.createElement(_eui.EuiFlyoutHeader,null,_react2.default.createElement(_eui.EuiTitle,null,_react2.default.createElement("h2",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrideSettingsTitle",defaultMessage:"Override settings"})))),_react2.default.createElement(_eui.EuiFlyoutBody,null,_react2.default.createElement(_overrides.Overrides,{setOverrides:setOverrides,overrides:overrides,originalSettings:originalSettings,setApplyOverrides:this.setApplyOverrides,setOverridesValid:this.setOverridesValid,fields:fields})),_react2.default.createElement(_eui.EuiFlyoutFooter,null,_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:closeEditFlyout,flush:"left"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.closeOverrideSettingsButtonLabel",defaultMessage:"Close"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{onClick:this.applyAndClose,isDisabled:this.state.overridesValid===false,fill:true},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.applyOverrideSettingsButtonLabel",defaultMessage:"Apply"})))))))}}]);return EditFlyout}(_react2.Component);exports.EditFlyout=EditFlyout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Overrides=void 0;var _react=__webpack_require__(5);var _i18n=__webpack_require__(4);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _options=__webpack_require__(3216);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var formatOptions=(0,_options.getFormatOptions)();var timestampFormatOptions=(0,_options.getTimestampFormatOptions)();var delimiterOptions=(0,_options.getDelimiterOptions)();var quoteOptions=(0,_options.getQuoteOptions)();var LINES_TO_SAMPLE_VALUE_MIN=3;var LINES_TO_SAMPLE_VALUE_MAX=1e6;var Overrides=function(_Component){_inherits(Overrides,_Component);function Overrides(props){var _this;_classCallCheck(this,Overrides);_this=_possibleConstructorReturn(this,_getPrototypeOf(Overrides).call(this,props));_defineProperty(_assertThisInitialized(_this),"linesToSampleErrors",_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.linesToSampleErrorMessage",{defaultMessage:"Value must be greater than {min} and less than or equal to {max}",values:{min:LINES_TO_SAMPLE_VALUE_MIN,max:LINES_TO_SAMPLE_VALUE_MAX}}));_defineProperty(_assertThisInitialized(_this),"applyOverrides",function(){var overrides=_objectSpread({},_this.state.overrides);overrides.delimiter=convertDelimiterBack(overrides.delimiter,_this.state.customDelimiter);_this.props.setOverrides(overrides)});_defineProperty(_assertThisInitialized(_this),"onFormatChange",function(_ref){var _ref2=_slicedToArray(_ref,1),opt=_ref2[0];var format=opt?opt.label:"";_this.setOverride({format:format})});_defineProperty(_assertThisInitialized(_this),"onTimestampFormatChange",function(_ref3){var _ref4=_slicedToArray(_ref3,1),opt=_ref4[0];var timestampFormat=opt?opt.label:"";_this.setOverride({timestampFormat:timestampFormat})});_defineProperty(_assertThisInitialized(_this),"onTimestampFieldChange",function(_ref5){var _ref6=_slicedToArray(_ref5,1),opt=_ref6[0];var timestampField=opt?opt.label:"";_this.setOverride({timestampField:timestampField})});_defineProperty(_assertThisInitialized(_this),"onDelimiterChange",function(_ref7){var _ref8=_slicedToArray(_ref7,1),opt=_ref8[0];var delimiter=opt?opt.label:"";_this.setOverride({delimiter:delimiter})});_defineProperty(_assertThisInitialized(_this),"onCustomDelimiterChange",function(e){_this.setState({customDelimiter:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onQuoteChange",function(_ref9){var _ref10=_slicedToArray(_ref9,1),opt=_ref10[0];var quote=opt?opt.label:"";_this.setOverride({quote:quote})});_defineProperty(_assertThisInitialized(_this),"onHasHeaderRowChange",function(e){_this.setOverride({hasHeaderRow:e.target.checked})});_defineProperty(_assertThisInitialized(_this),"onShouldTrimFieldsChange",function(e){_this.setOverride({shouldTrimFields:e.target.checked})});_defineProperty(_assertThisInitialized(_this),"onCharsetChange",function(_ref11){var _ref12=_slicedToArray(_ref11,1),opt=_ref12[0];var charset=opt?opt.label:"";_this.setOverride({charset:charset})});_defineProperty(_assertThisInitialized(_this),"onColumnNameChange",function(e,i){var columnNames=_this.state.overrides.columnNames;columnNames[i]=e.target.value;_this.setOverride({columnNames:columnNames})});_defineProperty(_assertThisInitialized(_this),"grokPatternChange",function(e){_this.setOverride({grokPattern:e.target.value})});_defineProperty(_assertThisInitialized(_this),"onLinesToSampleChange",function(e){var linesToSample=+e.target.value;_this.setOverride({linesToSample:linesToSample});var linesToSampleValid=isLinesToSampleValid(linesToSample);_this.setState({linesToSampleValid:linesToSampleValid});_this.props.setOverridesValid(linesToSampleValid)});_this.state={};return _this}_createClass(Overrides,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setApplyOverrides==="function"){this.props.setApplyOverrides(this.applyOverrides)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetApplyOverrides==="function"){this.props.unsetApplyOverrides()}}},{key:"setOverride",value:function setOverride(o){var overrides=_objectSpread({},this.state.overrides,o);this.setState({overrides:overrides})}},{key:"render",value:function render(){var _this2=this;var fields=this.props.fields;var _this$state=this.state,customDelimiter=_this$state.customDelimiter,originalColumnNames=_this$state.originalColumnNames,linesToSampleValid=_this$state.linesToSampleValid,overrides=_this$state.overrides;var timestampFormat=overrides.timestampFormat,timestampField=overrides.timestampField,format=overrides.format,delimiter=overrides.delimiter,quote=overrides.quote,hasHeaderRow=overrides.hasHeaderRow,shouldTrimFields=overrides.shouldTrimFields,columnNames=overrides.columnNames,grokPattern=overrides.grokPattern,linesToSample=overrides.linesToSample;var fieldOptions=getSortedFields(fields);return _react2.default.createElement(_eui.EuiForm,null,_react2.default.createElement(_eui.EuiFormRow,{error:this.linesToSampleErrors,isInvalid:linesToSampleValid===false,label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.linesToSampleFormRowLabel",defaultMessage:"Number of lines to sample"})},_react2.default.createElement(_eui.EuiFieldNumber,{value:linesToSample,onChange:this.onLinesToSampleChange,isInvalid:linesToSampleValid===false})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.dataFormatFormRowLabel",defaultMessage:"Data format"})},_react2.default.createElement(_eui.EuiComboBox,{options:formatOptions,selectedOptions:selectedOption(format),onChange:this.onFormatChange,singleSelection:{asPlainText:true},isClearable:false})),format==="delimited"&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.delimiterFormRowLabel",defaultMessage:"Delimiter"})},_react2.default.createElement(_eui.EuiComboBox,{options:delimiterOptions,selectedOptions:selectedOption(delimiter),onChange:this.onDelimiterChange,singleSelection:{asPlainText:true},isClearable:false})),delimiter==="other"&&_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.customDelimiterFormRowLabel",defaultMessage:"Custom delimiter"})},_react2.default.createElement(_eui.EuiFieldText,{value:customDelimiter,onChange:this.onCustomDelimiterChange})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.quoteCharacterFormRowLabel",defaultMessage:"Quote character"})},_react2.default.createElement(_eui.EuiComboBox,{options:quoteOptions,selectedOptions:selectedOption(quote),onChange:this.onQuoteChange,singleSelection:{asPlainText:true},isClearable:false})),_react2.default.createElement(_eui.EuiFormRow,null,_react2.default.createElement(_eui.EuiCheckbox,{id:"hasHeaderRow",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.hasHeaderRowLabel",defaultMessage:"Has header row"}),checked:hasHeaderRow,onChange:this.onHasHeaderRowChange})),_react2.default.createElement(_eui.EuiFormRow,null,_react2.default.createElement(_eui.EuiCheckbox,{id:"shouldTrimFields",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.trimFieldsLabel",defaultMessage:"Should trim fields"}),checked:shouldTrimFields,onChange:this.onShouldTrimFieldsChange}))),format==="semi_structured_text"&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.grokPatternFormRowLabel",defaultMessage:"Grok pattern"})},_react2.default.createElement(_eui.EuiTextArea,{placeholder:grokPattern,value:grokPattern,onChange:this.grokPatternChange}))),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampFormatFormRowLabel",defaultMessage:"Timestamp format"})},_react2.default.createElement(_eui.EuiComboBox,{options:timestampFormatOptions,selectedOptions:selectedOption(timestampFormat),onChange:this.onTimestampFormatChange,singleSelection:{asPlainText:true},isClearable:false})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.timeFieldFormRowLabel",defaultMessage:"Time field"})},_react2.default.createElement(_eui.EuiComboBox,{options:fieldOptions,selectedOptions:selectedOption(timestampField),onChange:this.onTimestampFieldChange,singleSelection:{asPlainText:true},isClearable:false})),format==="delimited"&&originalColumnNames.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.editFieldNamesTitle",defaultMessage:"Edit field names"}))),originalColumnNames.map(function(f,i){return _react2.default.createElement(_eui.EuiFormRow,{label:f,key:f},_react2.default.createElement(_eui.EuiFieldText,{value:columnNames[i],onChange:function onChange(e){return _this2.onColumnNameChange(e,i)}}))})))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){var originalSettings=props.originalSettings;var _props$overrides=props.overrides,charset=_props$overrides.charset,format=_props$overrides.format,hasHeaderRow=_props$overrides.hasHeaderRow,columnNames=_props$overrides.columnNames,delimiter=_props$overrides.delimiter,quote=_props$overrides.quote,shouldTrimFields=_props$overrides.shouldTrimFields,grokPattern=_props$overrides.grokPattern,timestampField=_props$overrides.timestampField,timestampFormat=_props$overrides.timestampFormat,linesToSample=_props$overrides.linesToSample;var _convertDelimiter=convertDelimiter(delimiter===undefined?originalSettings.delimiter:delimiter),d=_convertDelimiter.delimiter,customD=_convertDelimiter.customDelimiter;var _getColumnNames=getColumnNames(columnNames,originalSettings),newColumnNames=_getColumnNames.newColumnNames,originalColumnNames=_getColumnNames.originalColumnNames;var overrides={charset:charset===undefined?originalSettings.charset:charset,format:format===undefined?originalSettings.format:format,hasHeaderRow:hasHeaderRow===undefined?originalSettings.hasHeaderRow:hasHeaderRow,columnNames:newColumnNames,delimiter:d,quote:quote===undefined?originalSettings.quote:quote,shouldTrimFields:shouldTrimFields===undefined?originalSettings.shouldTrimFields:shouldTrimFields,grokPattern:grokPattern===undefined?originalSettings.grokPattern:grokPattern,timestampFormat:timestampFormat===undefined?originalSettings.timestampFormat:timestampFormat,timestampField:timestampField===undefined?originalSettings.timestampField:timestampField,linesToSample:linesToSample===undefined?originalSettings.linesToSample:+linesToSample};return _objectSpread({originalColumnNames:originalColumnNames,customDelimiter:customD===undefined?"":customD,linesToSampleValid:true,overrides:overrides},state)}}]);return Overrides}(_react2.Component);exports.Overrides=Overrides;function selectedOption(opt){return[{label:opt||""}]}function getSortedFields(fields){return fields.map(function(f){return{label:f}}).sort(function(a,b){return a.label.localeCompare(b.label,undefined,{numeric:true})})}function convertDelimiter(d){switch(d){case",":return{delimiter:"comma"};case"\t":return{delimiter:"tab"};case";":return{delimiter:"semicolon"};case"|":return{delimiter:"pipe"};case" ":return{delimiter:"space"};default:return{delimiter:"other",customDelimiter:d}}}function convertDelimiterBack(delimiter,customDelimiter){switch(delimiter){case"comma":return",";case"tab":return"\t";case"semicolon":return";";case"pipe":return"|";case"space":return" ";case"other":return customDelimiter;default:return undefined}}function getColumnNames(columnNames,originalSettings){var newColumnNames=columnNames===undefined&&originalSettings.columnNames!==undefined?_toConsumableArray(originalSettings.columnNames):columnNames;var originalColumnNames=newColumnNames!==undefined?_toConsumableArray(newColumnNames):[];return{newColumnNames:newColumnNames,originalColumnNames:originalColumnNames}}function isLinesToSampleValid(linesToSample){return linesToSample>LINES_TO_SAMPLE_VALUE_MIN&&linesToSample<=LINES_TO_SAMPLE_VALUE_MAX}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"getCharsetOptions",{enumerable:true,get:function get(){return _options.getCharsetOptions}});Object.defineProperty(exports,"getFormatOptions",{enumerable:true,get:function get(){return _options.getFormatOptions}});Object.defineProperty(exports,"getTimestampFormatOptions",{enumerable:true,get:function get(){return _options.getTimestampFormatOptions}});Object.defineProperty(exports,"getDelimiterOptions",{enumerable:true,get:function get(){return _options.getDelimiterOptions}});Object.defineProperty(exports,"getQuoteOptions",{enumerable:true,get:function get(){return _options.getQuoteOptions}});var _options=__webpack_require__(3217)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFormatOptions=getFormatOptions;exports.getTimestampFormatOptions=getTimestampFormatOptions;exports.getDelimiterOptions=getDelimiterOptions;exports.getQuoteOptions=getQuoteOptions;exports.getCharsetOptions=getCharsetOptions;var _option_lists=__webpack_require__(3218);function getOptions(list){return list.map(function(o){return{label:o}})}function getFormatOptions(){return getOptions(_option_lists.FORMAT_OPTIONS)}function getTimestampFormatOptions(){return getOptions(_option_lists.TIMESTAMP_OPTIONS)}function getDelimiterOptions(){return getOptions(_option_lists.DELIMITER_OPTIONS)}function getQuoteOptions(){return getOptions(_option_lists.QUOTE_OPTIONS)}function getCharsetOptions(){return getOptions(_option_lists.CHARSET_OPTIONS)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CHARSET_OPTIONS=exports.QUOTE_OPTIONS=exports.DELIMITER_OPTIONS=exports.TIMESTAMP_OPTIONS=exports.FORMAT_OPTIONS=void 0;var FORMAT_OPTIONS=["delimited","ndjson","semi_structured_text"];exports.FORMAT_OPTIONS=FORMAT_OPTIONS;var TIMESTAMP_OPTIONS=["dd/MMM/yyyy:HH:mm:ss XX","EEE MMM dd HH:mm zzz yyyy","EEE MMM dd HH:mm:ss yyyy","EEE MMM dd HH:mm:ss zzz yyyy","EEE MMM dd yyyy HH:mm zzz","EEE MMM dd yyyy HH:mm:ss zzz","EEE, dd MMM yyyy HH:mm XX","EEE, dd MMM yyyy HH:mm XXX","EEE, dd MMM yyyy HH:mm:ss XX","EEE, dd MMM yyyy HH:mm:ss XXX","ISO8601","MMM dd HH:mm:ss","MMM dd HH:mm:ss,SSS","MMM dd HH:mm:ss,SSSSSS","MMM dd HH:mm:ss,SSSSSSSSS","MMM dd HH:mm:ss.SSS","MMM dd HH:mm:ss.SSSSSS","MMM dd HH:mm:ss.SSSSSSSSS","MMM dd HH:mm:ss:SSS","MMM dd HH:mm:ss:SSSSSS","MMM dd HH:mm:ss:SSSSSSSSS","MMM dd yyyy HH:mm:ss","MMM dd, yyyy h:mm:ss a","TAI64N","UNIX","UNIX_MS","yyyy-MM-dd HH:mm:ss","yyyy-MM-dd HH:mm:ss,SSS","yyyy-MM-dd HH:mm:ss,SSSSSS","yyyy-MM-dd HH:mm:ss,SSSSSSSSS","yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd HH:mm:ss.SSSSSS","yyyy-MM-dd HH:mm:ss.SSSSSSSSS","yyyy-MM-dd HH:mm:ss:SSS","yyyy-MM-dd HH:mm:ss:SSSSSS","yyyy-MM-dd HH:mm:ss:SSSSSSSSS","yyyy-MM-dd HH:mm:ss,SSS XX","yyyy-MM-dd HH:mm:ss,SSSSSS XX","yyyy-MM-dd HH:mm:ss,SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss.SSS XX","yyyy-MM-dd HH:mm:ss.SSSSSS XX","yyyy-MM-dd HH:mm:ss.SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss:SSS XX","yyyy-MM-dd HH:mm:ss:SSSSSS XX","yyyy-MM-dd HH:mm:ss:SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss,SSSXX","yyyy-MM-dd HH:mm:ss,SSSSSSXX","yyyy-MM-dd HH:mm:ss,SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss.SSSXX","yyyy-MM-dd HH:mm:ss.SSSSSSXX","yyyy-MM-dd HH:mm:ss.SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss:SSSXX","yyyy-MM-dd HH:mm:ss:SSSSSSXX","yyyy-MM-dd HH:mm:ss:SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss,SSSXXX","yyyy-MM-dd HH:mm:ss,SSSSSSXXX","yyyy-MM-dd HH:mm:ss,SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ss.SSSXXX","yyyy-MM-dd HH:mm:ss.SSSSSSXXX","yyyy-MM-dd HH:mm:ss.SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ss:SSSXXX","yyyy-MM-dd HH:mm:ss:SSSSSSXXX","yyyy-MM-dd HH:mm:ss:SSSSSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss,SSS","yyyy-MM-dd'T'HH:mm:ss,SSSSSS","yyyy-MM-dd'T'HH:mm:ss,SSSSSSSSS","yyyy-MM-dd'T'HH:mm:ss.SSS","yyyy-MM-dd'T'HH:mm:ss.SSSSSS","yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS","yyyy-MM-dd'T'HH:mm:ss:SSS","yyyy-MM-dd'T'HH:mm:ss:SSSSSS","yyyy-MM-dd'T'HH:mm:ss:SSSSSSSSS","yyyy-MM-dd'T'HH:mm:ss,SSSXX","yyyy-MM-dd'T'HH:mm:ss,SSSSSSXX","yyyy-MM-dd'T'HH:mm:ss,SSSSSSSSSXX","yyyy-MM-dd'T'HH:mm:ss.SSSXX","yyyy-MM-dd'T'HH:mm:ss.SSSSSSXX","yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSSXX","yyyy-MM-dd'T'HH:mm:ss:SSSXX","yyyy-MM-dd'T'HH:mm:ss:SSSSSSXX","yyyy-MM-dd'T'HH:mm:ss:SSSSSSSSSXX","yyyy-MM-dd'T'HH:mm:ss,SSSXXX","yyyy-MM-dd'T'HH:mm:ss,SSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss,SSSSSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss.SSSXXX","yyyy-MM-dd'T'HH:mm:ss.SSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss:SSSXXX","yyyy-MM-dd'T'HH:mm:ss:SSSSSSXXX","yyyy-MM-dd'T'HH:mm:ss:SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ssXX","yyyy-MM-dd HH:mm:ssXXX","yyyyMMddHHmmss"];exports.TIMESTAMP_OPTIONS=TIMESTAMP_OPTIONS;var DELIMITER_OPTIONS=["comma","tab","semicolon","pipe","space","other"];exports.DELIMITER_OPTIONS=DELIMITER_OPTIONS;var QUOTE_OPTIONS=["'",'"',"`"];exports.QUOTE_OPTIONS=QUOTE_OPTIONS;var CHARSET_OPTIONS=["IBM00858","IBM437","IBM775","IBM850","IBM852","IBM855","IBM857","IBM862","IBM866","ISO-8859-1","ISO-8859-2","ISO-8859-4","ISO-8859-5","ISO-8859-7","ISO-8859-9","ISO-8859-13","ISO-8859-15","KOI8-R","KOI8-U","US-ASCII","UTF-8","UTF-16","UTF-16BE","UTF-16LE","UTF-32","UTF-32BE","UTF-32LE","x-UTF-32BE-BOM","x-UTF-32LE-BOM","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1257","Not available","x-IBM737","x-IBM874","x-UTF-16LE-BOM","Big5","Big5-HKSCS","EUC-JP","EUC-KR","GB18030","GB2312","GBK","IBM-Thai","IBM01140","IBM01141","IBM01142","IBM01143","IBM01144","IBM01145","IBM01146","IBM01147","IBM01148","IBM01149","IBM037","IBM1026","IBM1047","IBM273","IBM277","IBM278","IBM280","IBM284","IBM285","IBM297","IBM420","IBM424","IBM500","IBM860","IBM861","IBM863","IBM864","IBM865","IBM868","IBM869","IBM870","IBM871","IBM918","ISO-2022-CN","ISO-2022-JP","ISO-2022-KR","ISO-8859-3","ISO-8859-6","ISO-8859-8","JIS_X0201","JIS_X0212-1990","Shift_JIS","TIS-620","windows-1255","windows-1256","windows-1258","windows-31j","x-Big5-Solaris","x-euc-jp-linux","x-EUC-TW","x-eucJP-Open","x-IBM1006","x-IBM1025","x-IBM1046","x-IBM1097","x-IBM1098","x-IBM1112","x-IBM1122","x-IBM1123","x-IBM1124","x-IBM1381","x-IBM1383","x-IBM33722","x-IBM834","x-IBM856","x-IBM875","x-IBM921","x-IBM922","x-IBM930","x-IBM933","x-IBM935","x-IBM937","x-IBM939","x-IBM942","x-IBM942C","x-IBM943","x-IBM943C","x-IBM948","x-IBM949","x-IBM949C","x-IBM950","x-IBM964","x-IBM970","x-ISCII91","x-ISO2022-CN-CNS","x-ISO2022-CN-GB","x-iso-8859-11","x-JIS0208","x-JISAutoDetect","x-Johab","x-MacArabic","x-MacCentralEurope","x-MacCroatian","x-MacCyrillic","x-MacDingbat","x-MacGreek","x-MacHebrew","x-MacIceland","x-MacRoman","x-MacRomania","x-MacSymbol","x-MacThai","x-MacTurkish","x-MacUkraine","x-MS950-HKSCS","x-mswin-936","x-PCK","x-SJIS_0213","x-windows-50220","x-windows-50221","x-windows-874","x-windows-949","x-windows-950","x-windows-iso2022jp"];exports.CHARSET_OPTIONS=CHARSET_OPTIONS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportView",{enumerable:true,get:function get(){return _import_view.ImportView}});var _import_view=__webpack_require__(3220)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportView=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _i18n=__webpack_require__(4);var _importer=__webpack_require__(3221);var _results_links=__webpack_require__(3226);var _import_progress=__webpack_require__(1400);var _import_errors=__webpack_require__(3229);var _import_summary=__webpack_require__(3231);var _import_settings=__webpack_require__(3233);var _experimental_badge=__webpack_require__(1398);var _index_utils=__webpack_require__(226);var _ml_api_service=__webpack_require__(24);var _utils=__webpack_require__(1401);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULT_TIME_FIELD="@timestamp";var DEFAULT_INDEX_SETTINGS={number_of_shards:1};var CONFIG_MODE={SIMPLE:0,ADVANCED:1};var DEFAULT_STATE={index:"",importing:false,imported:false,initialized:false,reading:false,readProgress:0,readStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,parseJSONStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,indexCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,indexPatternCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,ingestPipelineCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,permissionCheckStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,uploadProgress:0,uploadStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,createIndexPattern:true,indexPattern:"",indexPatternId:"",ingestPipelineId:"",errors:[],importFailures:[],docCount:0,configMode:CONFIG_MODE.SIMPLE,indexSettingsString:"",mappingsString:"",pipelineString:"",indexNames:[],indexPatternNames:[],indexNameError:"",indexPatternNameError:"",timeFieldName:undefined};var ImportView=function(_Component){_inherits(ImportView,_Component);function ImportView(props){var _this;_classCallCheck(this,ImportView);_this=_possibleConstructorReturn(this,_getPrototypeOf(ImportView).call(this,props));_defineProperty(_assertThisInitialized(_this),"clickReset",function(){var state=getDefaultState(_this.state,_this.props.results);_this.setState(state,function(){_this.loadIndexNames();_this.loadIndexPatternNames()})});_defineProperty(_assertThisInitialized(_this),"clickImport",function(){_this.import()});_defineProperty(_assertThisInitialized(_this),"onConfigModeChange",function(configMode){_this.setState({configMode:configMode})});_defineProperty(_assertThisInitialized(_this),"onIndexChange",function(e){var name=e.target.value;_this.setState({index:name,indexNameError:isIndexNameValid(name,_this.state.indexNames)})});_defineProperty(_assertThisInitialized(_this),"onIndexPatternChange",function(e){var name=e.target.value;var _this$state=_this.state,indexPatternNames=_this$state.indexPatternNames,index=_this$state.index;_this.setState({indexPattern:name,indexPatternNameError:isIndexPatternNameValid(name,indexPatternNames,index)})});_defineProperty(_assertThisInitialized(_this),"onCreateIndexPatternChange",function(e){_this.setState({createIndexPattern:e.target.checked})});_defineProperty(_assertThisInitialized(_this),"onIndexSettingsStringChange",function(text){_this.setState({indexSettingsString:text})});_defineProperty(_assertThisInitialized(_this),"onMappingsStringChange",function(text){_this.setState({mappingsString:text})});_defineProperty(_assertThisInitialized(_this),"onPipelineStringChange",function(text){_this.setState({pipelineString:text})});_defineProperty(_assertThisInitialized(_this),"setImportProgress",function(progress){_this.setState({uploadProgress:progress})});_defineProperty(_assertThisInitialized(_this),"setReadProgress",function(progress){_this.setState({readProgress:progress})});_this.state=getDefaultState(DEFAULT_STATE,_this.props.results);return _this}_createClass(ImportView,[{key:"componentDidMount",value:function componentDidMount(){this.loadIndexNames();this.loadIndexPatternNames()}},{key:"import",value:function(){var _import2=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var _this2=this;var _this$props,fileContents,results,indexPatterns,kibanaConfig,showBottomBar,format,timeFieldName,_this$state2,index,indexPattern,createIndexPattern,indexSettingsString,mappingsString,pipelineString,errors;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props=this.props,fileContents=_this$props.fileContents,results=_this$props.results,indexPatterns=_this$props.indexPatterns,kibanaConfig=_this$props.kibanaConfig,showBottomBar=_this$props.showBottomBar;format=results.format;timeFieldName=this.state.timeFieldName;_this$state2=this.state,index=_this$state2.index,indexPattern=_this$state2.indexPattern,createIndexPattern=_this$state2.createIndexPattern,indexSettingsString=_this$state2.indexSettingsString,mappingsString=_this$state2.mappingsString,pipelineString=_this$state2.pipelineString;errors=[];if(index!==""){this.setState({importing:true,errors:errors},_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_utils.hasImportPermission)(index);case 2:_context2.t0=_context2.sent;if(!(_context2.t0===false)){_context2.next=7;break}errors.push(_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.importPermissionError",{defaultMessage:"You do not have permission to create or import data into index {index}.",values:{index:index}}));_this2.setState({permissionCheckStatus:_import_progress.IMPORT_STATUS.FAILED,importing:false,imported:false,errors:errors});return _context2.abrupt("return");case 7:_this2.setState({importing:true,imported:false,reading:true,initialized:true,permissionCheckStatus:_import_progress.IMPORT_STATUS.COMPLETE},function(){_this2.props.hideBottomBar();setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var success,createPipeline,settings,mappings,pipeline,parseError,_parseError,indexCreationSettings,_parseError2,importer,readResp,initializeImportResp,indexCreated,pipelineCreated,importId,pipelineId,importResp,indexPatternName,indexPatternResp;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:success=true;createPipeline=pipelineString!=="";settings={};mappings={};pipeline={};try{settings=JSON.parse(indexSettingsString)}catch(error){success=false;parseError=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parseSettingsError",{defaultMessage:"Error parsing settings:"});errors.push("".concat(parseError," ").concat(error.message))}try{mappings=JSON.parse(mappingsString)}catch(error){success=false;_parseError=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parseMappingsError",{defaultMessage:"Error parsing mappings:"});errors.push("".concat(_parseError," ").concat(error.message))}indexCreationSettings={settings:settings,mappings:mappings};try{if(createPipeline){pipeline=JSON.parse(pipelineString);indexCreationSettings.pipeline=pipeline}}catch(error){success=false;_parseError2=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parsePipelineError",{defaultMessage:"Error parsing ingest pipeline:"});errors.push("".concat(_parseError2," ").concat(error.message))}_this2.setState({parseJSONStatus:success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED});if(mappings[DEFAULT_TIME_FIELD]!==undefined){timeFieldName=DEFAULT_TIME_FIELD;_this2.setState({timeFieldName:timeFieldName})}if(!success){_context.next=50;break}importer=(0,_importer.importerFactory)(format,results,indexCreationSettings);if(!(importer!==undefined)){_context.next=50;break}_context.next=16;return importer.read(fileContents,_this2.setReadProgress);case 16:readResp=_context.sent;success=readResp.success;_this2.setState({readStatus:success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,reading:false});if(readResp.success===false){console.error(readResp.error);errors.push(readResp.error)}if(!success){_context.next=50;break}_context.next=23;return importer.initializeImport(index);case 23:initializeImportResp=_context.sent;indexCreated=initializeImportResp.index!==undefined;_this2.setState({indexCreatedStatus:indexCreated?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED});if(createPipeline){pipelineCreated=initializeImportResp.pipelineId!==undefined;if(indexCreated){_this2.setState({ingestPipelineCreatedStatus:pipelineCreated?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,ingestPipelineId:pipelineCreated?initializeImportResp.pipelineId:""})}success=indexCreated&&pipelineCreated}else{success=indexCreated}if(!success){_context.next=49;break}importId=initializeImportResp.id;pipelineId=initializeImportResp.pipelineId;_context.next=32;return importer.import(importId,index,pipelineId,_this2.setImportProgress);case 32:importResp=_context.sent;success=importResp.success;_this2.setState({uploadStatus:importResp.success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,importFailures:importResp.failures,docCount:importResp.docCount});if(!success){_context.next=46;break}if(!createIndexPattern){_context.next=44;break}indexPatternName=indexPattern===""?index:indexPattern;_context.next=40;return createKibanaIndexPattern(indexPatternName,indexPatterns,timeFieldName,kibanaConfig);case 40:indexPatternResp=_context.sent;success=indexPatternResp.success;_this2.setState({indexPatternCreatedStatus:indexPatternResp.success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,indexPatternId:indexPatternResp.id});if(indexPatternResp.success===false){errors.push(indexPatternResp.error)}case 44:_context.next=47;break;case 46:errors.push(importResp.error);case 47:_context.next=50;break;case 49:errors.push(initializeImportResp.error);case 50:showBottomBar();_this2.setState({importing:false,imported:success,errors:errors});case 52:case"end":return _context.stop()}}},_callee)})),500)});case 8:case"end":return _context2.stop()}}},_callee2)})))}case 6:case"end":return _context3.stop()}}},_callee3,this)}));function _import(){return _import2.apply(this,arguments)}return _import}()},{key:"loadIndexNames",value:function(){var _loadIndexNames=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var indices,indexNames;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _ml_api_service.ml.getIndices();case 2:indices=_context4.sent;indexNames=indices.map(function(i){return i.name});this.setState({indexNames:indexNames});case 5:case"end":return _context4.stop()}}},_callee4,this)}));function loadIndexNames(){return _loadIndexNames.apply(this,arguments)}return loadIndexNames}()},{key:"loadIndexPatternNames",value:function(){var _loadIndexPatternNames=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(){var indexPatternNames;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return(0,_index_utils.refreshIndexPatterns)();case 2:indexPatternNames=(0,_index_utils.getIndexPatternNames)();this.setState({indexPatternNames:indexPatternNames});case 4:case"end":return _context5.stop()}}},_callee5,this)}));function loadIndexPatternNames(){return _loadIndexPatternNames.apply(this,arguments)}return loadIndexPatternNames}()},{key:"render",value:function render(){var _this$state3=this.state,index=_this$state3.index,indexPattern=_this$state3.indexPattern,indexPatternId=_this$state3.indexPatternId,ingestPipelineId=_this$state3.ingestPipelineId,importing=_this$state3.importing,imported=_this$state3.imported,reading=_this$state3.reading,initialized=_this$state3.initialized,readStatus=_this$state3.readStatus,parseJSONStatus=_this$state3.parseJSONStatus,indexCreatedStatus=_this$state3.indexCreatedStatus,ingestPipelineCreatedStatus=_this$state3.ingestPipelineCreatedStatus,indexPatternCreatedStatus=_this$state3.indexPatternCreatedStatus,permissionCheckStatus=_this$state3.permissionCheckStatus,uploadProgress=_this$state3.uploadProgress,uploadStatus=_this$state3.uploadStatus,createIndexPattern=_this$state3.createIndexPattern,errors=_this$state3.errors,docCount=_this$state3.docCount,importFailures=_this$state3.importFailures,indexSettingsString=_this$state3.indexSettingsString,mappingsString=_this$state3.mappingsString,pipelineString=_this$state3.pipelineString,indexNameError=_this$state3.indexNameError,indexPatternNameError=_this$state3.indexPatternNameError,timeFieldName=_this$state3.timeFieldName;var createPipeline=pipelineString!=="";var statuses={reading:reading,readStatus:readStatus,parseJSONStatus:parseJSONStatus,indexCreatedStatus:indexCreatedStatus,ingestPipelineCreatedStatus:ingestPipelineCreatedStatus,indexPatternCreatedStatus:indexPatternCreatedStatus,permissionCheckStatus:permissionCheckStatus,uploadProgress:uploadProgress,uploadStatus:uploadStatus,createIndexPattern:createIndexPattern,createPipeline:createPipeline};var disableImport=index===""||indexNameError!==""||createIndexPattern===true&&indexPatternNameError!==""||initialized===true;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.importDataTitle",defaultMessage:"Import data"})," ",_react2.default.createElement(_experimental_badge.ExperimentalBadge,{tooltipContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.experimentalFeatureTooltip",defaultMessage:"Experimental feature. We'd love to hear your feedback."})}))),_react2.default.createElement(_import_settings.ImportSettings,{index:index,indexPattern:indexPattern,initialized:initialized,onIndexChange:this.onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:this.onCreateIndexPatternChange,onIndexPatternChange:this.onIndexPatternChange,indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,onIndexSettingsStringChange:this.onIndexSettingsStringChange,onMappingsStringChange:this.onMappingsStringChange,onPipelineStringChange:this.onPipelineStringChange,indexNameError:indexNameError,indexPatternNameError:indexPatternNameError}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),(initialized===false||importing===true)&&_react2.default.createElement(_eui.EuiButton,{isDisabled:disableImport,onClick:this.clickImport,isLoading:importing,iconSide:"right",fill:true},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.importButtonLabel",defaultMessage:"Import"})),initialized===true&&importing===false&&_react2.default.createElement(_eui.EuiButton,{onClick:this.clickReset},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.resetButtonLabel",defaultMessage:"Reset"}))),initialized===true&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_import_progress.ImportProgress,{statuses:statuses}),imported===true&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_import_summary.ImportSummary,{index:index,indexPattern:indexPattern===""?index:indexPattern,ingestPipelineId:ingestPipelineId,docCount:docCount,importFailures:importFailures,createIndexPattern:createIndexPattern,createPipeline:createPipeline}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_results_links.ResultsLinks,{index:index,indexPatternId:indexPatternId,timeFieldName:timeFieldName,createIndexPattern:createIndexPattern})))),errors.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_import_errors.ImportErrors,{errors:errors,statuses:statuses})))}}]);return ImportView}(_react2.Component);exports.ImportView=ImportView;function createKibanaIndexPattern(_x,_x2,_x3,_x4){return _createKibanaIndexPattern.apply(this,arguments)}function _createKibanaIndexPattern(){_createKibanaIndexPattern=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(indexPatternName,indexPatterns,timeFieldName,kibanaConfig){var emptyPattern,id;return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return indexPatterns.get();case 3:emptyPattern=_context6.sent;Object.assign(emptyPattern,{id:"",title:indexPatternName,timeFieldName:timeFieldName});_context6.next=7;return emptyPattern.create();case 7:id=_context6.sent;if(kibanaConfig.get("defaultIndex")){_context6.next=11;break}_context6.next=11;return kibanaConfig.set("defaultIndex",id);case 11:return _context6.abrupt("return",{success:true,id:id});case 14:_context6.prev=14;_context6.t0=_context6["catch"](0);console.error(_context6.t0);return _context6.abrupt("return",{success:false,error:_context6.t0});case 18:case"end":return _context6.stop()}}},_callee6,null,[[0,14]])}));return _createKibanaIndexPattern.apply(this,arguments)}function getDefaultState(state,results){var indexSettingsString=state.indexSettingsString===""?JSON.stringify(DEFAULT_INDEX_SETTINGS,null,2):state.indexSettingsString;var mappingsString=state.mappingsString===""?JSON.stringify(results.mappings,null,2):state.mappingsString;var pipelineString=state.pipelineString===""&&results.ingest_pipeline!==undefined?JSON.stringify(results.ingest_pipeline,null,2):state.pipelineString;var timeFieldName=results.timestamp_field;return _objectSpread({},DEFAULT_STATE,{indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,timeFieldName:timeFieldName})}function isIndexNameValid(name,indexNames){if(indexNames.find(function(i){return i===name})){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexNameAlreadyExistsErrorMessage",defaultMessage:"Index name already exists"})}var reg=new RegExp('[\\\\/*?"<>|\\s,#]+');if(name!==name.toLowerCase()||name==="."||name===".."||name.match(/^[-_+]/)!==null||name.match(reg)!==null){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexNameContainsIllegalCharactersErrorMessage",defaultMessage:"Index name contains illegal characters"})}return""}function isIndexPatternNameValid(name,indexPatternNames,index){if(name===""){return""}if(indexPatternNames.find(function(i){return i===name})){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexPatternNameAlreadyExistsErrorMessage",defaultMessage:"Index pattern name already exists"})}var newName=name.replace(/\./g,"\\.");newName=newName.replace(/\+/g,"\\+");newName=newName.replace(/\*/g,".*");var reg=new RegExp("^".concat(newName,"$"));if(index.match(reg)===null){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexPatternDoesNotMatchIndexNameErrorMessage",defaultMessage:"Index pattern does not match index name"})}return""}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"importerFactory",{enumerable:true,get:function get(){return _importer_factory.importerFactory}});var _importer_factory=__webpack_require__(3222)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.importerFactory=importerFactory;var _csv_importer=__webpack_require__(3223);var _sst_importer=__webpack_require__(3224);var _ndjson_importer=__webpack_require__(3225);function importerFactory(format,results,settings){switch(format){case"delimited":return new _csv_importer.CsvImporter(results,settings);case"semi_structured_text":return new _sst_importer.SstImporter(results,settings);case"ndjson":return new _ndjson_importer.NdjsonImporter(results,settings);default:return}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CsvImporter=void 0;var _importer=__webpack_require__(904);var _papaparse=_interopRequireDefault(__webpack_require__(1399));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var CsvImporter=function(_Importer){_inherits(CsvImporter,_Importer);function CsvImporter(results,settings){var _this;_classCallCheck(this,CsvImporter);_this=_possibleConstructorReturn(this,_getPrototypeOf(CsvImporter).call(this,settings));_this.format=results.format;_this.delimiter=results.delimiter;_this.quote=results.quote;_this.hasHeaderRow=results.has_header_row;_this.columnNames=results.column_names;_this.shouldTrimFields=results.should_trim_fields||false;return _this}_createClass(CsvImporter,[{key:"read",value:function(){var _read=_asyncToGenerator(regeneratorRuntime.mark(function _callee(csv){var transform,config,parserOutput;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;transform=this.shouldTrimFields?function(f){return f.trim()}:function(f){return f};config={header:false,skipEmptyLines:"greedy",delimiter:this.delimiter,quoteChar:this.quote,transform:transform};parserOutput=_papaparse.default.parse(csv,config);if(!parserOutput.errors.length){_context.next=6;break}throw parserOutput.errors[0].message;case 6:this.data=parserOutput.data;if(this.hasHeaderRow){this.data.shift()}this.docArray=formatToJson(this.data,this.columnNames);return _context.abrupt("return",{success:true});case 12:_context.prev=12;_context.t0=_context["catch"](0);return _context.abrupt("return",{success:false,error:_context.t0});case 15:case"end":return _context.stop()}}},_callee,this,[[0,12]])}));function read(_x){return _read.apply(this,arguments)}return read}()}]);return CsvImporter}(_importer.Importer);exports.CsvImporter=CsvImporter;function formatToJson(data,columnNames){var docArray=[];for(var i=0;i<data.length;i++){var line={};for(var c=0;c<columnNames.length;c++){var col=columnNames[c];line[col]=data[i][c]}docArray.push(line)}return docArray}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SstImporter=void 0;var _importer=__webpack_require__(904);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var SstImporter=function(_Importer){_inherits(SstImporter,_Importer);function SstImporter(results,settings){var _this;_classCallCheck(this,SstImporter);_this=_possibleConstructorReturn(this,_getPrototypeOf(SstImporter).call(this,settings));_this.format=results.format;_this.multilineStartPattern=results.multiline_start_pattern;_this.grokPattern=results.grok_pattern;return _this}_createClass(SstImporter,[{key:"read",value:function(){var _read=_asyncToGenerator(regeneratorRuntime.mark(function _callee(text){var data,message,line,i,char;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;data=[];message="";line="";for(i=0;i<text.length;i++){char=text[i];if(char==="\n"){if(line.match(this.multilineStartPattern)!==null){data.push({message:message});message=""}else{message+=char}message+=line;line=""}else{line+=char}}if(message!==""){data.push({message:message})}if(data[0]&&data[0].message===""){data.shift()}this.data=data;this.docArray=this.data;return _context.abrupt("return",{success:true});case 12:_context.prev=12;_context.t0=_context["catch"](0);console.error(_context.t0);return _context.abrupt("return",{success:false,error:_context.t0});case 16:case"end":return _context.stop()}}},_callee,this,[[0,12]])}));function read(_x){return _read.apply(this,arguments)}return read}()}]);return SstImporter}(_importer.Importer);exports.SstImporter=SstImporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NdjsonImporter=void 0;var _importer=__webpack_require__(904);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var NdjsonImporter=function(_Importer){_inherits(NdjsonImporter,_Importer);function NdjsonImporter(results,settings){_classCallCheck(this,NdjsonImporter);return _possibleConstructorReturn(this,_getPrototypeOf(NdjsonImporter).call(this,settings))}_createClass(NdjsonImporter,[{key:"read",value:function(){var _read=_asyncToGenerator(regeneratorRuntime.mark(function _callee(json){var splitJson,ndjson,i;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;splitJson=json.split(/}\s*\n/);ndjson=[];for(i=0;i<splitJson.length;i++){if(splitJson[i]!==""){ndjson.push("".concat(splitJson[i],"}"))}}this.docArray=ndjson;return _context.abrupt("return",{success:true});case 8:_context.prev=8;_context.t0=_context["catch"](0);return _context.abrupt("return",{success:false,error:_context.t0});case 11:case"end":return _context.stop()}}},_callee,this,[[0,8]])}));function read(_x){return _read.apply(this,arguments)}return read}()}]);return NdjsonImporter}(_importer.Importer);exports.NdjsonImporter=NdjsonImporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ResultsLinks",{enumerable:true,get:function get(){return _results_links.ResultsLinks}});var _results_links=__webpack_require__(3227)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsLinks=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireWildcard(__webpack_require__(0));var _eui=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(16));var _chrome=_interopRequireDefault(__webpack_require__(9));var _ml_api_service=__webpack_require__(24);var _check_license=__webpack_require__(66);var _check_privilege=__webpack_require__(39);var _check_ml_nodes=__webpack_require__(71);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var RECHECK_DELAY_MS=3e3;var ResultsLinks=function(_Component){_inherits(ResultsLinks,_Component);function ResultsLinks(props){var _this;_classCallCheck(this,ResultsLinks);_this=_possibleConstructorReturn(this,_getPrototypeOf(ResultsLinks).call(this,props));_this.state={from:"now-30m",to:"now"};_this.recheckTimeout=null;_this.showCreateJobLink=true;return _this}_createClass(ResultsLinks,[{key:"componentDidMount",value:function componentDidMount(){this.showCreateJobLink=(0,_check_privilege.checkPermission)("canCreateJob")&&(0,_check_ml_nodes.mlNodesAvailable)();if(this.props.timeFieldName!==undefined){this.updateTimeValues()}}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.recheckTimeout)}},{key:"updateTimeValues",value:function(){var _updateTimeValues=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this2=this;var recheck,_this$props,index,timeFieldName,_ref,from,to,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:recheck=_args.length>0&&_args[0]!==undefined?_args[0]:true;_this$props=this.props,index=_this$props.index,timeFieldName=_this$props.timeFieldName;_context.next=4;return getFullTimeRange(index,timeFieldName);case 4:_ref=_context.sent;from=_ref.from;to=_ref.to;this.setState({from:from===null?this.state.from:from,to:to===null?this.state.to:to});if(recheck&&(from===null||to===null)){this.recheckTimeout=setTimeout(function(){_this2.updateTimeValues(false)},RECHECK_DELAY_MS)}case 9:case"end":return _context.stop()}}},_callee,this)}));function updateTimeValues(){return _updateTimeValues.apply(this,arguments)}return updateTimeValues}()},{key:"render",value:function render(){var _this$props2=this.props,index=_this$props2.index,indexPatternId=_this$props2.indexPatternId,timeFieldName=_this$props2.timeFieldName,createIndexPattern=_this$props2.createIndexPattern;var _this$state=this.state,from=_this$state.from,to=_this$state.to;var _g=this.props.timeFieldName!==undefined?"&_g=(time:(from:'".concat(from,"',mode:quick,to:'").concat(to,"'))"):"";return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},createIndexPattern&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiCard,{icon:_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"discoverApp"}),title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.viewIndexInDiscoverTitle",defaultMessage:"View index in Discover"}),description:"",href:"".concat(_chrome.default.getBasePath(),"/app/kibana#/discover?&_a=(index:'").concat(indexPatternId,"')").concat(_g)})),(0,_check_license.isFullLicense)()===true&&timeFieldName!==undefined&&this.showCreateJobLink&&createIndexPattern&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiCard,{icon:_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"machineLearningApp"}),title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.createNewMLJobTitle",defaultMessage:"Create new ML job"}),description:"",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/jobs/new_job/step/job_type?index=").concat(indexPatternId).concat(_g)})),createIndexPattern&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiCard,{icon:_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.openInDataVisualizerTitle",defaultMessage:"Open in Data Visualizer"}),description:"",href:"".concat(_chrome.default.getBasePath(),"/app/ml#/jobs/new_job/datavisualizer?index=").concat(indexPatternId).concat(_g)})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiCard,{icon:_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"managementApp"}),title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.indexManagementTitle",defaultMessage:"Index Management"}),description:"",href:"".concat(_chrome.default.getBasePath(),"/app/kibana#/management/elasticsearch/index_management/indices/filter/").concat(index)})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiCard,{icon:_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"managementApp"}),title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.indexPatternManagementTitle",defaultMessage:"Index Pattern Management"}),description:"",href:"".concat(_chrome.default.getBasePath(),"/app/kibana#/management/kibana/index_patterns/").concat(createIndexPattern?indexPatternId:"")})))}}]);return ResultsLinks}(_react2.Component);exports.ResultsLinks=ResultsLinks;function getFullTimeRange(_x,_x2){return _getFullTimeRange.apply(this,arguments)}function _getFullTimeRange(){_getFullTimeRange=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(index,timeFieldName){var query,resp;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:query={bool:{must:[{query_string:{analyze_wildcard:true,query:"*"}}]}};_context2.next=3;return _ml_api_service.ml.getTimeFieldRange({index:index,timeFieldName:timeFieldName,query:query});case 3:resp=_context2.sent;return _context2.abrupt("return",{from:(0,_moment.default)(resp.start.epoch).toISOString(),to:(0,_moment.default)(resp.end.epoch).toISOString()});case 5:case"end":return _context2.stop()}}},_callee2)}));return _getFullTimeRange.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportProgress=exports.IMPORT_STATUS=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var IMPORT_STATUS={INCOMPLETE:"incomplete",COMPLETE:"complete",FAILED:"danger"};exports.IMPORT_STATUS=IMPORT_STATUS;var ImportProgress=(0,_react.injectI18n)(function(_ref){var statuses=_ref.statuses,intl=_ref.intl;var reading=statuses.reading,readStatus=statuses.readStatus,parseJSONStatus=statuses.parseJSONStatus,indexCreatedStatus=statuses.indexCreatedStatus,ingestPipelineCreatedStatus=statuses.ingestPipelineCreatedStatus,indexPatternCreatedStatus=statuses.indexPatternCreatedStatus,uploadProgress=statuses.uploadProgress,uploadStatus=statuses.uploadStatus,createIndexPattern=statuses.createIndexPattern,createPipeline=statuses.createPipeline;var statusInfo=null;var completedStep=0;if(reading===true&&readStatus===IMPORT_STATUS.INCOMPLETE&&parseJSONStatus===IMPORT_STATUS.INCOMPLETE){completedStep=0}if(readStatus===IMPORT_STATUS.COMPLETE&&indexCreatedStatus===IMPORT_STATUS.INCOMPLETE&&ingestPipelineCreatedStatus===IMPORT_STATUS.INCOMPLETE){completedStep=1}if(indexCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=2}if(ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE||createPipeline===false&&indexCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=3}if(uploadStatus===IMPORT_STATUS.COMPLETE){completedStep=4}if(indexPatternCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=5}var processFileTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.processFileTitle",defaultMessage:"Process file"});var createIndexTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.createIndexTitle",defaultMessage:"Create index"});var createIngestPipelineTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.createIngestPipelineTitle",defaultMessage:"Create ingest pipeline"});var uploadingDataTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.uploadDataTitle",defaultMessage:"Upload data"});var createIndexPatternTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.createIndexPatternTitle",defaultMessage:"Create index pattern"});var creatingIndexStatus=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.stepTwoCreatingIndexDescription",defaultMessage:"Creating index"}));var creatingIndexAndIngestPipelineStatus=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.stepTwoCreatingIndexIngestPipelineDescription",defaultMessage:"Creating index and ingest pipeline"}));if(completedStep>=0){processFileTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.processingFileTitle",defaultMessage:"Processing file"});statusInfo=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.processingImportedFileDescription",defaultMessage:"Processing file for import"}))}if(completedStep>=1){processFileTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.fileProcessedTitle",defaultMessage:"File processed"});createIndexTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.creatingIndexTitle",defaultMessage:"Creating index"});statusInfo=createPipeline===true?creatingIndexAndIngestPipelineStatus:creatingIndexStatus}if(completedStep>=2){createIndexTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.indexCreatedTitle",defaultMessage:"Index created"});createIngestPipelineTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.creatingIngestPipelineTitle",defaultMessage:"Creating ingest pipeline"});statusInfo=createPipeline===true?creatingIndexAndIngestPipelineStatus:creatingIndexStatus}if(completedStep>=3){createIngestPipelineTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.ingestPipelineCreatedTitle",defaultMessage:"Ingest pipeline created"});uploadingDataTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.uploadingDataTitle",defaultMessage:"Uploading data"});statusInfo=_react2.default.createElement(UploadFunctionProgress,{progress:uploadProgress})}if(completedStep>=4){uploadingDataTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.dataUploadedTitle",defaultMessage:"Data uploaded"});if(createIndexPattern===true){createIndexPatternTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.creatingIndexPatternTitle",defaultMessage:"Creating index pattern"});statusInfo=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.creatingIndexPatternDescription",defaultMessage:"Creating index pattern"}))}else{statusInfo=null}}if(completedStep>=5){createIndexPatternTitle=intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importProgress.indexPatternCreatedTitle",defaultMessage:"Index pattern created"});statusInfo=null}var steps=[{title:processFileTitle,isSelected:true,isComplete:readStatus===IMPORT_STATUS.COMPLETE&&parseJSONStatus===IMPORT_STATUS.COMPLETE,status:parseJSONStatus===IMPORT_STATUS.FAILED?parseJSONStatus:readStatus,onClick:function onClick(){}},{title:createIndexTitle,isSelected:readStatus===IMPORT_STATUS.COMPLETE,isComplete:indexCreatedStatus===IMPORT_STATUS.COMPLETE,status:indexCreatedStatus,onClick:function onClick(){}},{title:uploadingDataTitle,isSelected:indexCreatedStatus===IMPORT_STATUS.COMPLETE&&(createPipeline===false||createPipeline===true&&ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE),isComplete:uploadStatus===IMPORT_STATUS.COMPLETE,status:uploadStatus,onClick:function onClick(){}}];if(createPipeline===true){steps.splice(2,0,{title:createIngestPipelineTitle,isSelected:indexCreatedStatus===IMPORT_STATUS.COMPLETE,isComplete:ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE,status:ingestPipelineCreatedStatus,onClick:function onClick(){}})}if(createIndexPattern===true){steps.push({title:createIndexPatternTitle,isSelected:uploadStatus===IMPORT_STATUS.COMPLETE,isComplete:indexPatternCreatedStatus===IMPORT_STATUS.COMPLETE,status:indexPatternCreatedStatus,onClick:function onClick(){}})}return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiStepsHorizontal,{steps:steps,style:{backgroundColor:"transparent"}}),statusInfo&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),statusInfo))});exports.ImportProgress=ImportProgress;function UploadFunctionProgress(_ref2){var progress=_ref2.progress;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.uploadingDataDescription",defaultMessage:"Uploading data"})),progress<100&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiProgress,{value:progress,max:100,color:"primary",size:"s"})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportErrors",{enumerable:true,get:function get(){return _errors.ImportErrors}});var _errors=__webpack_require__(3230)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportErrors=ImportErrors;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _import_progress=__webpack_require__(1400);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function ImportErrors(_ref){var errors=_ref.errors,statuses=_ref.statuses;return _react2.default.createElement(_eui.EuiCallOut,{title:title(statuses),color:"danger",iconType:"cross"},errors.map(function(e,i){return _react2.default.createElement(ImportError,{error:e,key:i})}))}function title(statuses){switch(_import_progress.IMPORT_STATUS.FAILED){case statuses.readStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.readingFileErrorMessage",defaultMessage:"Error reading file"});case statuses.parseJSONStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.parsingJSONErrorMessage",defaultMessage:"Error parsing JSON"});case statuses.indexCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIndexErrorMessage",defaultMessage:"Error creating index"});case statuses.ingestPipelineCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIngestPipelineErrorMessage",defaultMessage:"Error creating ingest pipeline"});case statuses.uploadStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.uploadingDataErrorMessage",defaultMessage:"Error uploading data"});case statuses.indexPatternCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIndexPatternErrorMessage",defaultMessage:"Error creating index pattern"});case statuses.permissionCheckStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.checkingPermissionErrorMessage",defaultMessage:"Import permissions error"});default:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.defaultErrorMessage",defaultMessage:"Error"})}}function ImportError(error,key){var errorObj=toString(error);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement("p",{key:key},errorObj.msg),errorObj.more!==undefined&&_react2.default.createElement(_eui.EuiAccordion,{id:"more",buttonContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.moreButtonLabel",defaultMessage:"More"}),paddingSize:"m"},errorObj.more))}function toString(error){if(typeof error==="string"){return{msg:error}}if(_typeof(error)==="object"){if(error.msg!==undefined){return{msg:error.msg}}else if(error.error!==undefined){if(_typeof(error.error)==="object"){if(error.error.msg!==undefined){var errorObj={msg:error.error.msg};if(error.error.body!==undefined){errorObj.more=error.error.response}return errorObj}if(error.error.message!==undefined){return{msg:error.error.message}}}else{return{msg:error.error}}}else{return{msg:JSON.stringify(error)}}}return{msg:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.unknownErrorMessage",defaultMessage:"Unknown error"})}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportSummary",{enumerable:true,get:function get(){return _import_summary.ImportSummary}});var _import_summary=__webpack_require__(3232)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportSummary=ImportSummary;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ImportSummary(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,ingestPipelineId=_ref.ingestPipelineId,docCount=_ref.docCount,importFailures=_ref.importFailures,createIndexPattern=_ref.createIndexPattern,createPipeline=_ref.createPipeline;var items=createDisplayItems(index,indexPattern,ingestPipelineId,docCount,importFailures,createIndexPattern,createPipeline);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.importCompleteTitle",defaultMessage:"Import complete"}),color:"success",iconType:"check"},_react2.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:items,className:"import-summary-list"})),importFailures&&importFailures.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsCouldNotBeImportedTitle",defaultMessage:"Some documents could not be imported"}),color:"warning",iconType:"help"},_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsCouldNotBeImportedDescription",defaultMessage:"{importFailuresLength} out of {docCount} documents could not be imported. This could be due to lines not matching the Grok pattern.",values:{importFailuresLength:importFailures.length,docCount:docCount}})),_react2.default.createElement(Failures,{failedDocs:importFailures}))))}function Failures(_ref2){var failedDocs=_ref2.failedDocs;return _react2.default.createElement(_eui.EuiAccordion,{id:"failureList",buttonContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.failedDocumentsButtonLabel",defaultMessage:"Failed documents"}),paddingSize:"m"},_react2.default.createElement("div",{className:"failure-list"},failedDocs.map(function(_ref3){var item=_ref3.item,reason=_ref3.reason,doc=_ref3.doc;return _react2.default.createElement("div",{key:item},_react2.default.createElement("div",{className:"error-message"},item,": ",reason),_react2.default.createElement("div",null,JSON.stringify(doc)))})))}function createDisplayItems(index,indexPattern,ingestPipelineId,docCount,importFailures,createIndexPattern,createPipeline){var items=[{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.indexTitle",defaultMessage:"Index"}),description:index},{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsIngestedTitle",defaultMessage:"Documents ingested"}),description:docCount-(importFailures&&importFailures.length||0)}];if(createPipeline){items.splice(1,0,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.ingestPipelineTitle",defaultMessage:"Ingest pipeline"}),description:ingestPipelineId})}if(createIndexPattern){items.splice(1,0,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.indexPatternTitle",defaultMessage:"Index pattern"}),description:indexPattern})}if(importFailures&&importFailures.length>0){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.failedDocumentsTitle",defaultMessage:"Failed documents"}),description:importFailures.length})}return items}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportSettings",{enumerable:true,get:function get(){return _import_settings.ImportSettings}});var _import_settings=__webpack_require__(3234)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportSettings=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _simple=__webpack_require__(3235);var _advanced=__webpack_require__(3236);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ImportSettings=(0,_react.injectI18n)(function(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,onIndexPatternChange=_ref.onIndexPatternChange,indexSettingsString=_ref.indexSettingsString,mappingsString=_ref.mappingsString,pipelineString=_ref.pipelineString,onIndexSettingsStringChange=_ref.onIndexSettingsStringChange,onMappingsStringChange=_ref.onMappingsStringChange,onPipelineStringChange=_ref.onPipelineStringChange,indexNameError=_ref.indexNameError,indexPatternNameError=_ref.indexPatternNameError,intl=_ref.intl;var tabs=[{id:"simple-settings",name:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importSettings.simpleTabName",defaultMessage:"Simple"}),content:_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_simple.SimpleSettings,{index:index,initialized:initialized,onIndexChange:onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:onCreateIndexPatternChange,indexNameError:indexNameError}))},{id:"advanced-settings",name:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.importSettings.advancedTabName",defaultMessage:"Advanced"}),content:_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_advanced.AdvancedSettings,{index:index,indexPattern:indexPattern,initialized:initialized,onIndexChange:onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:onCreateIndexPatternChange,onIndexPatternChange:onIndexPatternChange,indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,onIndexSettingsStringChange:onIndexSettingsStringChange,onMappingsStringChange:onMappingsStringChange,onPipelineStringChange:onPipelineStringChange,indexNameError:indexNameError,indexPatternNameError:indexPatternNameError}))}];return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}}))});exports.ImportSettings=ImportSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleSettings=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SimpleSettings=(0,_react.injectI18n)(function(_ref){var index=_ref.index,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,indexNameError=_ref.indexNameError,intl=_ref.intl;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.simpleImportSettings.indexNameFormRowLabel",defaultMessage:"Index name"}),isInvalid:indexNameError!=="",error:[indexNameError]},_react2.default.createElement(_eui.EuiFieldText,{placeholder:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.simpleImportSettings.indexNamePlaceholder",defaultMessage:"index name"}),value:index,disabled:initialized===true,onChange:onIndexChange,isInvalid:indexNameError!=="","aria-label":intl.formatMessage({id:"xpack.ml.fileDatavisualizer.simpleImportSettings.indexNameAriaLabel",defaultMessage:"Index name, required field"})})),_react2.default.createElement(_eui.EuiCheckbox,{id:"createIndexPattern",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.simpleImportSettings.createIndexPatternLabel",defaultMessage:"Create index pattern"}),checked:createIndexPattern===true,disabled:initialized===true,onChange:onCreateIndexPatternChange}))});exports.SimpleSettings=SimpleSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedSettings=void 0;var _react=__webpack_require__(5);var _react2=_interopRequireDefault(__webpack_require__(0));var _eui=__webpack_require__(1);var _ml_job_editor=__webpack_require__(575);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EDITOR_HEIGHT="300px";function AdvancedSettingsUi(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,onIndexPatternChange=_ref.onIndexPatternChange,indexSettingsString=_ref.indexSettingsString,mappingsString=_ref.mappingsString,pipelineString=_ref.pipelineString,onIndexSettingsStringChange=_ref.onIndexSettingsStringChange,onMappingsStringChange=_ref.onMappingsStringChange,onPipelineStringChange=_ref.onPipelineStringChange,indexNameError=_ref.indexNameError,indexPatternNameError=_ref.indexPatternNameError,intl=_ref.intl;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexNameLabel",defaultMessage:"Index name"}),isInvalid:indexNameError!=="",error:[indexNameError]},_react2.default.createElement(_eui.EuiFieldText,{placeholder:intl.formatMessage({id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexNamePlaceholder",defaultMessage:"index name"}),value:index,disabled:initialized===true,onChange:onIndexChange,isInvalid:indexNameError!=="","aria-label":intl.formatMessage({id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexNameAriaLabel",defaultMessage:"Index name, required field"})})),_react2.default.createElement(_eui.EuiCheckbox,{id:"createIndexPattern",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.createIndexPatternLabel",defaultMessage:"Create index pattern"}),checked:createIndexPattern===true,disabled:initialized===true,onChange:onCreateIndexPatternChange}),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexPatternNameLabel",defaultMessage:"Index pattern name"}),disabled:createIndexPattern===false||initialized===true,isInvalid:indexPatternNameError!=="",error:[indexPatternNameError]},_react2.default.createElement(_eui.EuiFieldText,{disabled:createIndexPattern===false||initialized===true,placeholder:createIndexPattern===true?index:"",value:indexPattern,onChange:onIndexPatternChange,isInvalid:indexPatternNameError!==""})),_react2.default.createElement(_eui.EuiFlexGroup,null,_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(IndexSettings,{initialized:initialized,data:indexSettingsString,onChange:onIndexSettingsStringChange})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(Mappings,{initialized:initialized,data:mappingsString,onChange:onMappingsStringChange})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(IngestPipeline,{initialized:initialized,data:pipelineString,onChange:onPipelineStringChange}))))}var AdvancedSettings=(0,_react.injectI18n)(AdvancedSettingsUi);exports.AdvancedSettings=AdvancedSettings;function IndexSettings(_ref2){var initialized=_ref2.initialized,data=_ref2.data,onChange=_ref2.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexSettingsLabel",defaultMessage:"Index settings"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}function Mappings(_ref3){var initialized=_ref3.initialized,data=_ref3.data,onChange=_ref3.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.mappingsLabel",defaultMessage:"Mappings"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}function IngestPipeline(_ref4){var initialized=_ref4.initialized,data=_ref4.data,onChange=_ref4.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.ingestPipelineLabel",defaultMessage:"Ingest pipeline"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.readFile=readFile;exports.reduceData=reduceData;exports.createUrlOverrides=createUrlOverrides;exports.processResults=processResults;exports.hasImportPermission=hasImportPermission;var _overrides=__webpack_require__(3238);var _lodash=__webpack_require__(3);var _ml_api_service=__webpack_require__(24);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function readFile(file){return new Promise(function(resolve,reject){if(file&&file.size){var reader=new FileReader;reader.readAsText(file);reader.onload=function(){return function(){var data=reader.result;if(data===""){reject()}else{resolve({data:data})}}}(file)}else{reject()}})}function reduceData(data,mb){var size=mb*Math.pow(2,20);return data.length>=size?data.slice(0,size):data}function createUrlOverrides(overrides,originalSettings){var formattedOverrides={};for(var o in _overrides.overrideDefaults){if(_overrides.overrideDefaults.hasOwnProperty(o)){var value=overrides[o];if(Array.isArray(value)&&(0,_lodash.isEqual)(value,originalSettings[o])||value===undefined||value===originalSettings[o]){value=""}var snakeCaseO=o.replace(/([A-Z])/g,function($1){return"_".concat($1.toLowerCase())});formattedOverrides[snakeCaseO]=value}}if(formattedOverrides.format===""&&originalSettings.format==="delimited"){if(formattedOverrides.should_trim_fields!==""||formattedOverrides.has_header_row!==""||formattedOverrides.delimiter!==""||formattedOverrides.quote!==""||formattedOverrides.column_names!==""){formattedOverrides.format=originalSettings.format}}if(formattedOverrides.format===""&&originalSettings.format==="semi_structured_text"){if(formattedOverrides.grok_pattern!==""){formattedOverrides.format=originalSettings.format}}if(formattedOverrides.format==="ndjson"||originalSettings.format==="ndjson"){formattedOverrides.should_trim_fields="";formattedOverrides.has_header_row="";formattedOverrides.delimiter="";formattedOverrides.quote="";formattedOverrides.column_names=""}if(formattedOverrides.grok_pattern!==""){formattedOverrides.grok_pattern=encodeURIComponent(formattedOverrides.grok_pattern)}if(formattedOverrides.lines_to_sample===""){formattedOverrides.lines_to_sample=overrides.linesToSample}return formattedOverrides}function processResults(results){var timestampFormat=results.java_timestamp_formats!==undefined&&results.java_timestamp_formats.length?results.java_timestamp_formats[0]:undefined;var linesToSample=results.overrides!==undefined&&results.overrides.lines_to_sample!==undefined?results.overrides.lines_to_sample:_overrides.DEFAULT_LINES_TO_SAMPLE;return{format:results.format,delimiter:results.delimiter,timestampField:results.timestamp_field,timestampFormat:timestampFormat,quote:results.quote,hasHeaderRow:results.has_header_row,shouldTrimFields:results.should_trim_fields,charset:results.charset,columnNames:results.column_names,grokPattern:results.grok_pattern,linesToSample:linesToSample}}function hasImportPermission(_x){return _hasImportPermission.apply(this,arguments)}function _hasImportPermission(){_hasImportPermission=_asyncToGenerator(regeneratorRuntime.mark(function _callee(indexName){var priv,resp;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:priv={cluster:["cluster:monitor/nodes/info","cluster:admin/ingest/pipeline/put"]};if(indexName!==undefined){priv.index=[{names:[indexName],privileges:["indices:data/write/bulk","indices:data/write/index","indices:admin/create"]}]}_context.next=4;return _ml_api_service.ml.checkPrivilege(priv);case 4:resp=_context.sent;return _context.abrupt("return",resp.securityDisabled===true||resp.has_all_requested===true);case 6:case"end":return _context.stop()}}},_callee)}));return _hasImportPermission.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.overrideDefaults=exports.DEFAULT_LINES_TO_SAMPLE=void 0;var DEFAULT_LINES_TO_SAMPLE=1e3;exports.DEFAULT_LINES_TO_SAMPLE=DEFAULT_LINES_TO_SAMPLE;var overrideDefaults={timestampFormat:undefined,timestampField:undefined,format:undefined,delimiter:undefined,quote:undefined,hasHeaderRow:undefined,charset:undefined,columnNames:undefined,shouldTrimFields:undefined,grokPattern:undefined,linesToSample:undefined};exports.overrideDefaults=overrideDefaults},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_BYTES=104857600;exports.INDEX_META_DATA_CREATED_BY="ml-file-data-visualizer"}])["plugin"];